<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Springäº‹åŠ¡å¤±æ•ˆçš„æƒ…å†µï¼Œåœºæ™¯å’Œè§£å†³åŠæ³•  ä»¥åŠå¼•å‡ºçš„Springåº•å±‚æ³¨å…¥åŸç†å½»åº•åˆ†æ</title>
      <link href="/2025/11/03/Spring%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20%20%E4%BB%A5%E5%8F%8A%E5%BC%95%E5%87%BA%E7%9A%84Spring%E5%BA%95%E5%B1%82%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86%E5%BD%BB%E5%BA%95%E5%88%86%E6%9E%90/"/>
      <url>/2025/11/03/Spring%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20%20%E4%BB%A5%E5%8F%8A%E5%BC%95%E5%87%BA%E7%9A%84Spring%E5%BA%95%E5%B1%82%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86%E5%BD%BB%E5%BA%95%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-äº‹åŠ¡å¤±æ•ˆçš„3å¤§æƒ…å†µæ¦‚è§ˆ"><a href="#Spring-äº‹åŠ¡å¤±æ•ˆçš„3å¤§æƒ…å†µæ¦‚è§ˆ" class="headerlink" title="Spring äº‹åŠ¡å¤±æ•ˆçš„3å¤§æƒ…å†µæ¦‚è§ˆ"></a>Spring äº‹åŠ¡å¤±æ•ˆçš„3å¤§æƒ…å†µæ¦‚è§ˆ</h1><ol><li><p>æ–¹æ³•å†…è‡ªè°ƒç”¨</p><p>è§£å†³åŠæ³•ï¼š</p><ol><li>æŠŠè°ƒç”¨æ–¹æ³•æ‹†åˆ†åˆ°å¦å¤–ä¸€ä¸ªbeanä¸­</li><li>è‡ªå·±æ³¨å…¥è‡ªå·±ï¼ˆSpringçš„ç¼“å­˜æœºåˆ¶èƒ½å¤Ÿé¿å…å¾ªç¯ä¾èµ–ï¼Œä¸æ”¾å¿ƒå¯ä»¥åŠ @Lazyæ³¨è§£ï¼‰</li><li>AopContext.currentProxy()æ–¹æ³•è·å–å½“å‰çš„ä»£ç†å¯¹è±¡ï¼Œç”¨è¿™ä¸ªæ–¹æ³•å¯åŠ¨ç±»è¦åŠ æ³¨è§£@EnableAspectJAutoProxy(exposeProxt &#x3D; true)ï¼ŒåŒæ—¶ä¹Ÿè¦å¼•ä¸€ä¸‹ä¾èµ–</li></ol></li><li><p>æ–¹æ³•æ˜¯private æˆ– final çš„ï¼Œä»£ç†å¯¹è±¡å°±ä¸èƒ½é‡å†™è¿™ä¸ªæ–¹æ³•äº†ï¼Œå› æ­¤è°ƒç”¨å®ƒçš„æ—¶å€™ï¼Œå®é™…è°ƒç”¨çš„æ˜¯extendsçš„çˆ¶ç±»çš„æ™®é€šæ–¹æ³•</p></li><li><p>å•ç‹¬çš„çº¿ç¨‹è°ƒç”¨æ–¹æ³•ï¼š</p><p>å½“MyBatisæ‰§è¡Œsqlçš„æ—¶å€™ï¼Œä¼šä»ThreadLocalä¸­è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œå¦‚æœå¼€å¯äº‹åŠ¡çš„çº¿ç¨‹å’Œæ‰§è¡ŒSQLçš„çº¿ç¨‹æ˜¯åŒä¸€ä¸ªï¼Œå°±èƒ½æ‹¿åˆ°æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œå¦‚æœä¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå°±æ‹¿ä¸åˆ°ï¼Œè¿™æ—¶ä¼šæ–°å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œè¿™ä¸ªæ•°æ®åº“é“¾æ¥é»˜è®¤ç›´æ¥æäº¤</p><p>è§£å†³æ–¹æ³•ï¼šä¸èƒ½åœ¨äº‹åŠ¡æ–¹æ³•å†…å¼€å¯å¤šçº¿ç¨‹æ“ä½œæ•°æ®åº“ï¼Œå¯ä»¥å¼€å¯å¤šçº¿ç¨‹ç»™æ¯ä¸ªçº¿ç¨‹æ·»åŠ äº‹åŠ¡</p></li></ol><h1 id="Springåº•å±‚æ³¨å…¥å’Œäº‹åŠ¡æ³¨è§£çš„å‰–æ"><a href="#Springåº•å±‚æ³¨å…¥å’Œäº‹åŠ¡æ³¨è§£çš„å‰–æ" class="headerlink" title="Springåº•å±‚æ³¨å…¥å’Œäº‹åŠ¡æ³¨è§£çš„å‰–æ"></a>Springåº•å±‚æ³¨å…¥å’Œäº‹åŠ¡æ³¨è§£çš„å‰–æ</h1><h2 id="Springçš„æ³¨å…¥è¿‡ç¨‹ï¼š"><a href="#Springçš„æ³¨å…¥è¿‡ç¨‹ï¼š" class="headerlink" title="Springçš„æ³¨å…¥è¿‡ç¨‹ï¼š"></a>Springçš„æ³¨å…¥è¿‡ç¨‹ï¼š</h2><p>ç”±è¡¨å…¥é‡Œï¼Œå±‚å±‚é€’è¿›ï¼Œç›´è‡³åº•å±‚</p><p>ä»åº•å±‚å¼€å§‹æ³¨å…¥ï¼Œåº•å±‚æ³¨å…¥ä¹‹åæ³¨å…¥ä¸Šå±‚</p><h2 id="Springæ³¨å…¥ç»†èŠ‚ï¼š"><a href="#Springæ³¨å…¥ç»†èŠ‚ï¼š" class="headerlink" title="Springæ³¨å…¥ç»†èŠ‚ï¼š"></a>Springæ³¨å…¥ç»†èŠ‚ï¼š</h2><p>å‡å®šä¸€ä¸ªç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MyMapper myMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">simpleMethod</span><span class="params">()</span>&#123;</span><br><span class="line">        lockMethod_2();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lockMethod_1</span><span class="params">()</span>&#123;</span><br><span class="line">        lockMethod_2();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lockMethod_2</span><span class="params">()</span>&#123;</span><br><span class="line">        simpleMethod();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»çš„æ³¨å…¥æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>Springåˆ›å»ºä¸€ä¸ªçœŸå®çš„å¯¹è±¡ myService</li><li>Springåˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ myServiceProxyï¼Œç»§æ‰¿MyServiceç±»</li><li>SpringProxyä¸­ï¼ŒæŠŠmyServiceå¯¹è±¡èµ‹å€¼ç»™æˆå‘˜å˜é‡targetMyServiceï¼ˆæŒæœ‰ä¸€ä¸ªçœŸå®çš„MyServiceå®ç°ç±»å¯¹è±¡ï¼‰ï¼ŒæŠŠä¸Šä¸€å±‚åˆ›å»ºå¥½äº†çš„myMapperå¯¹è±¡ä¹Ÿèµ‹å€¼ç»™æˆå‘˜å˜é‡targetMyMapper</li></ol><p>æœ€ç»ˆä»£ç†ç±»ä¼ªä»£ç é•¿è¿™æ ·ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServiceProxy</span> <span class="keyword">extends</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> MyService targetMyService;</span><br><span class="line">    <span class="keyword">private</span> MyMapper targetMyMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç±»ä¼¼æ„é€ å‡½æ•°çš„ä¸œè¥¿ï¼ŒæŠŠåˆ›å»ºå¥½çš„myServiceå¯¹è±¡å’ŒmyMapperèµ‹å€¼</span></span><br><span class="line">    <span class="comment">/*ä¸€ä¸ªå‡½æ•°*/</span>&#123;</span><br><span class="line">        targetMyService = myService;</span><br><span class="line">        <span class="comment">//mapperç•¥</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">simpleMethod</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>.lockMethod_2(); <span class="comment">//ç›´æ¥è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œä¸ºæ€§èƒ½è€ƒè™‘</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åé¢ä¸¤ä¸ªæ˜¯æœ‰äº‹åŠ¡æ³¨è§£çš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lockMethod_1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//å¼€å¯äº‹åŠ¡ï¼Œç•¥</span></span><br><span class="line">        targetMyService.lockMethod_2(); <span class="comment">//è°ƒç”¨çœŸå®å¯¹è±¡ï¼Œå°±æ˜¯è¿™é‡Œäº‹åŠ¡ä¼šå¤±æ•ˆï¼Œå› ä¸ºè¿™é‡Œç›¸å½“äºåˆ‡æ¢å¯¹è±¡äº†ï¼Œæ–¹æ³•çš„å®é™…è°ƒç”¨è€…å·²ç»ä¸å†æ˜¯ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡ï¼Œç•¥</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lockMethod_1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//å¼€å¯äº‹åŠ¡ï¼Œç•¥</span></span><br><span class="line">        targetMyService.simpleMethod();  <span class="comment">//è°ƒç”¨çœŸå®å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡ï¼Œç•¥</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–¹æ³•è‡ªè°ƒç”¨åœºæ™¯æ¼”ç¤ºï¼š"><a href="#æ–¹æ³•è‡ªè°ƒç”¨åœºæ™¯æ¼”ç¤ºï¼š" class="headerlink" title="æ–¹æ³•è‡ªè°ƒç”¨åœºæ™¯æ¼”ç¤ºï¼š"></a>æ–¹æ³•è‡ªè°ƒç”¨åœºæ™¯æ¼”ç¤ºï¼š</h1><p>é»‘é©¬ç‚¹è¯„P54ï¼Œå®ç°ä¸€äººä¸€å•çš„ä»£ç é‚£é‡Œï¼š</p><p>åœ¨å®ç°ä¸€äººä¸€å•ä¹‹å‰ï¼Œé€šè¿‡ <strong>ä¹è§‚é”</strong> çš„æ–¹å¼è§£å†³äº†åº“å­˜è¶…å–é—®é¢˜</p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgf93539f6e999f22039fd14104a584e4c.jpg" alt="f93539f6e999f22039fd14104a584e4c"></p><p>è€Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œéœ€è¦æ·»åŠ é™åˆ¶è®¢å•æ•°é‡ï¼ˆè¿™é‡Œæ˜¯ä¸€äººä¸€å•ï¼‰çš„åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½éœ€è¦ <strong>å•ç‹¬æŸ¥ä¸€æ¬¡æ•°æ®åº“</strong>ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•ä¸­å¿…ç„¶æ¶‰åŠä¸¤æ¬¡æ•°æ®åº“çš„æ“ä½œï¼Œåœ¨è¿™ä¸¤æ¬¡çš„é—´éš™å†…ï¼Œå°±ä¼šå‡ºç°å’Œè¶…å–ä¸åŠ é”ä¸€æ ·çš„é—®é¢˜ï¼Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_img52a43d89cfda781c2315be517cfcf6c0.jpg" alt="52a43d89cfda781c2315be517cfcf6c0"></p><p>å› æ­¤ï¼Œéœ€è¦ç»™ï¼š</p><p><strong>æ•°æ®åº“æ˜¯å¦å……è¶³ï¼Ÿ</strong></p><p><strong>å½“å‰ç”¨æˆ·ä¹°è¿‡å—ï¼Ÿ</strong></p><p><strong>å‡åº“å­˜</strong></p><p>ä¸‰ä¸ªæ“ä½œåŠ ä¸Šäº‹åŠ¡ï¼Œä¿è¯è¿™ä¸‰æ­¥æ“ä½œçš„çš„åŸå­æ€§ï¼Œå› æ­¤æŠŠè¿™ä¸‰æ­¥æå–å‡ºæ¥ï¼Œå½“æˆä¸€ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> Result <span class="title function_">createVoucherOrder</span><span class="params">(Long voucherId)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> UserHolder.getUser().getId();</span><br><span class="line">         <span class="comment">// 5.1.æŸ¥è¯¢è®¢å•</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> query().eq(<span class="string">&quot;user_id&quot;</span>, userId).eq(<span class="string">&quot;voucher_id&quot;</span>, voucherId).count();</span><br><span class="line">        <span class="comment">// 5.2.åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// ç”¨æˆ·å·²ç»è´­ä¹°è¿‡äº†</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·å·²ç»è´­ä¹°è¿‡ä¸€æ¬¡ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6.æ‰£å‡åº“å­˜</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> seckillVoucherService.update()</span><br><span class="line">                .setSql(<span class="string">&quot;stock = stock - 1&quot;</span>) <span class="comment">// set stock = stock - 1</span></span><br><span class="line">                .eq(<span class="string">&quot;voucher_id&quot;</span>, voucherId).gt(<span class="string">&quot;stock&quot;</span>, <span class="number">0</span>) <span class="comment">// where id = ? and stock &gt; 0</span></span><br><span class="line">                .update();</span><br><span class="line">        <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">            <span class="comment">// æ‰£å‡å¤±è´¥</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åº“å­˜ä¸è¶³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.åˆ›å»ºè®¢å•</span></span><br><span class="line">        <span class="type">VoucherOrder</span> <span class="variable">voucherOrder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">VoucherOrder</span>();</span><br><span class="line">        <span class="comment">// 7.1.è®¢å•id</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">orderId</span> <span class="operator">=</span> redisIdWorker.nextId(<span class="string">&quot;order&quot;</span>);</span><br><span class="line">        voucherOrder.setId(orderId);</span><br><span class="line">        <span class="comment">// 7.2.ç”¨æˆ·id</span></span><br><span class="line">        voucherOrder.setUserId(userId);</span><br><span class="line">        <span class="comment">// 7.3.ä»£é‡‘åˆ¸id</span></span><br><span class="line">        voucherOrder.setVoucherId(voucherId);</span><br><span class="line">        save(voucherOrder);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.è¿”å›è®¢å•id</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok(orderId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·åšä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œè¿™å°±æ¶‰åŠåˆ°é”çš„åº•å±‚åŸç†ï¼Œç›´æ¥åœ¨æ–¹æ³•ä¸ŠåŠ é”ï¼Œç›¸å½“äºé”ä½äº† è¿™ä¸ªæ–¹æ³•çš„ <strong>æ–¹æ³•å¯¹è±¡</strong>ï¼Œå¯¼è‡´è¿™ä¸ªæ–¹æ³•åªèƒ½å•çº¿ç¨‹æ‰§è¡Œï¼Œä½†æˆ‘ä»¬çš„ç›®çš„ä¸æ˜¯é”è¿™ä¸ªæ–¹æ³•ï¼Œè€Œåªæ˜¯æƒ³é”é‡Œé¢çš„ä¸‰æ­¥æ“ä½œ</p><p><strong>æ³¨æ„åŒºåˆ«</strong>ï¼é”æ–¹æ³•å’Œé”æ–¹æ³•ä½“è¿˜èƒ½ä¸ä¸€æ ·ï¼Ÿå½“ç„¶ä¸ä¸€æ ·ï¼Œé‡ç‚¹å°±åœ¨äºï¼Œé”è¿™ä¸ªè¿‡ç¨‹ç©¶ç«Ÿæ‰€çš„æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼š</p><p>æ–¹æ³•ï¼šé”ä½æ–¹æ³•å¯¹è±¡</p><p>æ–¹æ³•ä½“ï¼šç»†èŠ‚åˆ°çœŸæ­£éœ€æ±‚ï¼Œå¯ä»¥é”ç”¨æˆ·idï¼Œè¿™æ ·è¿™ä¸ªæ–¹æ³•å¯ä»¥åŒæ—¶æ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯æ–¹æ³•ä½“å†…ï¼ŒåŒä¸€ä¸ªidåªèƒ½é¡ºåºæ‰§è¡Œ</p><p>æ‰€ä»¥æ”¹é€ æˆ2.0ç‰ˆæœ¬ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span>  Result <span class="title function_">createVoucherOrder</span><span class="params">(Long voucherId)</span> &#123;</span><br><span class="line"><span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> UserHolder.getUser().getId();</span><br><span class="line"><span class="keyword">synchronized</span>(userId.toString().intern())&#123;  <span class="comment">//è¿™é‡Œå¾ˆç»†èŠ‚</span></span><br><span class="line"><span class="comment">//åŸæœ‰é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>**ç»†èŠ‚ userId.toString().intern()**ï¼šsynchronizedæ˜¯é”ä¸€ä¸ªå¯¹è±¡ï¼Œç›´æ¥é”userIdçš„è¯ï¼Œå…¶å®åŒä¸€ä¸ªidè¿›æ¥ï¼Œä¼šnewå‡ºæ–°çš„userIdå¯¹è±¡,è¿™å¾ˆå¥½ç†è§£ï¼Œå› æ­¤æ˜¯é”ä¸ä½çš„</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆæŠŠä»– ç»†èŠ‚tostringï¼Œå˜æˆå­—ç¬¦ä¸²åŒ…è£…ç±»ï¼ˆæ­¤æ—¶ä¹Ÿä¸è¡Œï¼Œä¹Ÿæ˜¯å¯¹è±¡ï¼‰</p><p>å†ç„¶åï¼Œè°ƒç”¨ <strong>.intern()</strong> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç‰µæ‰¯åˆ°jvmçš„åº•å±‚å¯¹äºä¸€äº›æ•°æ®ç±»å‹çš„ä¼˜åŒ–ï¼Œåœ¨è¿™é‡Œï¼Œå°±æ˜¯å†…å®¹ç›¸åŒçš„Stringå¯¹è±¡çš„å…±åŒåœ°å€çš„ç¼“å­˜ï¼Œå› æ­¤å¯ä»¥å°†åŒä¸€ä¸ªidé”ä½</p><p>ä½†æ˜¯ï¼Œä¸ºäº†æœ€å¤§é™åº¦çš„ä¿è¯å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼šè¿™æ ·ä¹Ÿç‰µæ‰¯å‡ºäº†æ³¨è§£å¤±æ•ˆçš„åœºæ™¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*è°ƒç”¨è€…*/</span>&#123;</span><br><span class="line">    <span class="comment">//è°ƒç”¨è€…é€»è¾‘</span></span><br><span class="line"><span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> UserHolder.getUser().getId();</span><br><span class="line">    createVoucherOrder(userId);  <span class="comment">//ç›¸å½“äºè‡ªè°ƒç”¨ï¼Œthis.è°ƒç”¨ï¼Œäº‹åŠ¡æ³¨è§£å¤±æ•ˆäº†</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span>  Result <span class="title function_">createVoucherOrder</span><span class="params">(Long voucherId)</span> &#123;</span><br><span class="line"><span class="keyword">synchronized</span>(userId.toString().intern())&#123;  <span class="comment">//è¿™é‡Œå¾ˆç»†èŠ‚</span></span><br><span class="line"><span class="comment">//åŸæœ‰é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åº”è¯¥æ”¹æˆï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20251104012043581.png" alt="image-20251104012043581"></p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è‡ªæ³¨å…¥è§£å†³</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Springäº‹åŠ¡ </tag>
            
            <tag> æ‚²è§‚é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘å…³è·¯ç”±ã€ç»Ÿä¸€é‰´æƒä¸åŠ¨æ€é…ç½®ç®¡ç†</title>
      <link href="/2025/10/30/Nacos%E8%BF%9B%E9%98%B6/"/>
      <url>/2025/10/30/Nacos%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-Cloudå¾®æœåŠ¡-â€”â€”-ç½‘å…³è·¯ç”±ã€ç»Ÿä¸€é‰´æƒä¸åŠ¨æ€é…ç½®ç®¡ç†"><a href="#Spring-Cloudå¾®æœåŠ¡-â€”â€”-ç½‘å…³è·¯ç”±ã€ç»Ÿä¸€é‰´æƒä¸åŠ¨æ€é…ç½®ç®¡ç†" class="headerlink" title="Spring Cloudå¾®æœåŠ¡ â€”â€” ç½‘å…³è·¯ç”±ã€ç»Ÿä¸€é‰´æƒä¸åŠ¨æ€é…ç½®ç®¡ç†"></a>Spring Cloudå¾®æœåŠ¡ â€”â€” ç½‘å…³è·¯ç”±ã€ç»Ÿä¸€é‰´æƒä¸åŠ¨æ€é…ç½®ç®¡ç†</h1><hr><h2 id="ä¸€ã€é—®é¢˜å¼•å…¥ï¼šå¾®æœåŠ¡æ‹†åˆ†åçš„ç—›ç‚¹"><a href="#ä¸€ã€é—®é¢˜å¼•å…¥ï¼šå¾®æœåŠ¡æ‹†åˆ†åçš„ç—›ç‚¹" class="headerlink" title="ä¸€ã€é—®é¢˜å¼•å…¥ï¼šå¾®æœåŠ¡æ‹†åˆ†åçš„ç—›ç‚¹"></a>ä¸€ã€é—®é¢˜å¼•å…¥ï¼šå¾®æœåŠ¡æ‹†åˆ†åçš„ç—›ç‚¹</h2><table><thead><tr><th>æ¨¡å—</th><th>æœåŠ¡åç§°</th></tr></thead><tbody><tr><td>ç”¨æˆ·æœåŠ¡</td><td>user-service</td></tr><tr><td>å•†å“æœåŠ¡</td><td>item-service</td></tr><tr><td>è´­ç‰©è½¦æœåŠ¡</td><td>cart-service</td></tr><tr><td>äº¤æ˜“æœåŠ¡</td><td>trade-service</td></tr><tr><td>æ”¯ä»˜æœåŠ¡</td><td>pay-service</td></tr></tbody></table><p>æ‹†åˆ†åå‡ºç°äº†å‡ ä¸ªå¸¸è§é—®é¢˜ </p><h3 id="é—®é¢˜ä¸€ï¼šå‰ç«¯è®¿é—®å›°éš¾"><a href="#é—®é¢˜ä¸€ï¼šå‰ç«¯è®¿é—®å›°éš¾" class="headerlink" title="é—®é¢˜ä¸€ï¼šå‰ç«¯è®¿é—®å›°éš¾"></a>é—®é¢˜ä¸€ï¼šå‰ç«¯è®¿é—®å›°éš¾</h3><ul><li>æ¯ä¸ªå¾®æœåŠ¡çš„ç«¯å£ä¸åŒï¼Œå‰ç«¯è¦ç»´æŠ¤å¤šä¸ªåœ°å€ï¼›</li><li>å‰ç«¯æ— æ³•é€šè¿‡ Nacos è·å–å®æ—¶æœåŠ¡åˆ—è¡¨ã€‚</li></ul><h3 id="é—®é¢˜äºŒï¼šèº«ä»½è®¤è¯å‰²è£‚"><a href="#é—®é¢˜äºŒï¼šèº«ä»½è®¤è¯å‰²è£‚" class="headerlink" title="é—®é¢˜äºŒï¼šèº«ä»½è®¤è¯å‰²è£‚"></a>é—®é¢˜äºŒï¼šèº«ä»½è®¤è¯å‰²è£‚</h3><p>å•ä½“æ¶æ„ä¸‹åªéœ€ç™»å½•ä¸€æ¬¡å³å¯å…±äº«ç”¨æˆ·ä¿¡æ¯ï¼›<br> è€Œå¾®æœåŠ¡æ‹†åˆ†åï¼Œæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦å•ç‹¬åšç™»å½•æ ¡éªŒä¸ç”¨æˆ·ä¿¡æ¯ä¼ é€’ã€‚</p><blockquote><p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å¾®æœåŠ¡ç½‘å…³ Gatewayï¼</strong></p></blockquote><hr><h2 id="äºŒã€ç½‘å…³è·¯ç”±ï¼ˆGateway-Routingï¼‰"><a href="#äºŒã€ç½‘å…³è·¯ç”±ï¼ˆGateway-Routingï¼‰" class="headerlink" title="äºŒã€ç½‘å…³è·¯ç”±ï¼ˆGateway Routingï¼‰"></a>äºŒã€ç½‘å…³è·¯ç”±ï¼ˆGateway Routingï¼‰</h2><h3 id="2-1-ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-1-ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.1 ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2.1 ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ç½‘å…³ï¼ˆGatewayï¼‰æ˜¯<strong>å¾®æœåŠ¡ç³»ç»Ÿçš„ç»Ÿä¸€å…¥å£</strong>ï¼Œæ‰¿æ‹…ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>è¯·æ±‚è½¬å‘ä¸è·¯ç”±ï¼›</li><li>ç™»å½•æ ¡éªŒä¸æƒé™æ§åˆ¶ï¼›</li><li>æ—¥å¿—è®°å½•ä¸é™æµã€‚</li></ul><p> ç±»æ¯”ç°å®ï¼š</p><blockquote><p>ç½‘å…³å°±åƒå›­åŒºä¼ è¾¾å®¤çš„å¤§çˆ·ï¼Œæ‰€æœ‰äººï¼ˆè¯·æ±‚ï¼‰éƒ½å¾—å…ˆç»è¿‡ä»–ï¼š</p><ul><li>ä¸åˆæ³•çš„è¯·æ±‚ä¼šè¢«æ‹¦æˆªï¼›</li><li>åˆæ³•è¯·æ±‚ä¼šè¢«å¸¦åˆ°å¯¹åº”çš„æœåŠ¡ã€‚</li></ul></blockquote><h3 id="2-2-Spring-Cloud-Gateway-ç®€ä»‹"><a href="#2-2-Spring-Cloud-Gateway-ç®€ä»‹" class="headerlink" title="2.2 Spring Cloud Gateway ç®€ä»‹"></a>2.2 Spring Cloud Gateway ç®€ä»‹</h3><p>Spring æä¾›äº†ä¸¤ç§ç½‘å…³æ–¹æ¡ˆï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>çŠ¶æ€</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>Netflix Zuul</td><td>å·²æ·˜æ±°</td><td>Servlet æ¨¡å¼ï¼Œæ€§èƒ½ä½</td></tr><tr><td><strong>Spring Cloud Gateway</strong></td><td>âœ… æ¨è</td><td>åŸºäº WebFluxï¼Œæ€§èƒ½é«˜ï¼Œå“åº”å¼æ”¯æŒ</td></tr></tbody></table><p>å®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-cloud-gateway">https://spring.io/projects/spring-cloud-gateway</a></p><hr><h3 id="2-3-å¿«é€Ÿä¸Šæ‰‹"><a href="#2-3-å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="2.3 å¿«é€Ÿä¸Šæ‰‹"></a>2.3 å¿«é€Ÿä¸Šæ‰‹</h3><h4 id="â‘ -åˆ›å»ºç½‘å…³æ¨¡å—"><a href="#â‘ -åˆ›å»ºç½‘å…³æ¨¡å—" class="headerlink" title="â‘  åˆ›å»ºç½‘å…³æ¨¡å—"></a>â‘  åˆ›å»ºç½‘å…³æ¨¡å—</h4><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–°æ¨¡å—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hm-gateway</span><br></pre></td></tr></table></figure><h4 id="â‘¡-å¼•å…¥ä¾èµ–"><a href="#â‘¡-å¼•å…¥ä¾èµ–" class="headerlink" title="â‘¡ å¼•å…¥ä¾èµ–"></a>â‘¡ å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="â‘¢-å¯åŠ¨ç±»"><a href="#â‘¢-å¯åŠ¨ç±»" class="headerlink" title="â‘¢ å¯åŠ¨ç±»"></a>â‘¢ å¯åŠ¨ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GatewayApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(GatewayApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="â‘£-è·¯ç”±é…ç½®"><a href="#â‘£-è·¯ç”±é…ç½®" class="headerlink" title="â‘£ è·¯ç”±é…ç½®"></a>â‘£ è·¯ç”±é…ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">gateway</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.150</span><span class="number">.101</span><span class="string">:8848</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">item</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://item-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/items/**,/search/**</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">user</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://user-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/users/**,/addresses/**</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">cart</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cart-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/carts/**</span></span><br></pre></td></tr></table></figure><h4 id="â‘¤-æµ‹è¯•è®¿é—®"><a href="#â‘¤-æµ‹è¯•è®¿é—®" class="headerlink" title="â‘¤ æµ‹è¯•è®¿é—®"></a>â‘¤ æµ‹è¯•è®¿é—®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/items/page?pageNo=1&amp;pageSize=1</span><br></pre></td></tr></table></figure><p>è¯·æ±‚ä¼šè‡ªåŠ¨è¢«è½¬å‘åˆ° <code>item-service</code>ã€‚</p><hr><h2 id="ä¸‰ã€ç½‘å…³ç»Ÿä¸€é‰´æƒï¼ˆJWT-ç™»å½•æ ¡éªŒï¼‰"><a href="#ä¸‰ã€ç½‘å…³ç»Ÿä¸€é‰´æƒï¼ˆJWT-ç™»å½•æ ¡éªŒï¼‰" class="headerlink" title="ä¸‰ã€ç½‘å…³ç»Ÿä¸€é‰´æƒï¼ˆJWT ç™»å½•æ ¡éªŒï¼‰"></a>ä¸‰ã€ç½‘å…³ç»Ÿä¸€é‰´æƒï¼ˆJWT ç™»å½•æ ¡éªŒï¼‰</h2><h3 id="3-1-é‰´æƒé€»è¾‘"><a href="#3-1-é‰´æƒé€»è¾‘" class="headerlink" title="3.1 é‰´æƒé€»è¾‘"></a>3.1 é‰´æƒé€»è¾‘</h3><p>ä¼ ç»Ÿæ–¹æ¡ˆä¸­ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½éªŒè¯ JWTï¼Œå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>æ¯ä¸ªæœåŠ¡éƒ½éœ€ä¿å­˜ç§˜é’¥ï¼Œä¸å®‰å…¨ï¼›</li><li>æ¯ä¸ªæœåŠ¡éƒ½è¦å†™ä¸€éé‰´æƒé€»è¾‘ï¼Œå†—ä½™ã€‚</li></ul><blockquote><p> è§£å†³æ–¹æ¡ˆï¼š<strong>ç»Ÿä¸€åœ¨ç½‘å…³å±‚åšç™»å½•æ ¡éªŒ</strong></p></blockquote><hr><h3 id="3-2-ç½‘å…³è¿‡æ»¤å™¨-Filter-æœºåˆ¶"><a href="#3-2-ç½‘å…³è¿‡æ»¤å™¨-Filter-æœºåˆ¶" class="headerlink" title="3.2 ç½‘å…³è¿‡æ»¤å™¨ Filter æœºåˆ¶"></a>3.2 ç½‘å…³è¿‡æ»¤å™¨ Filter æœºåˆ¶</h3><p>Gateway çš„è¯·æ±‚å¤„ç†æµç¨‹ï¼š</p><ol><li>HandlerMapping åŒ¹é…è·¯ç”±ï¼›</li><li>WebHandler æ‰§è¡Œè¿‡æ»¤å™¨é“¾ï¼›</li><li>æ¯ä¸ª Filter æ‰§è¡Œ pre&#x2F;post ä¸¤æ®µé€»è¾‘ï¼›</li><li>åªæœ‰ pre å…¨é€šè¿‡ï¼Œè¯·æ±‚æ‰ä¼šè¢«è·¯ç”±ã€‚</li></ol><blockquote><p>ğŸ§  å› æ­¤ï¼Œåªè¦æˆ‘ä»¬åœ¨ <strong>NettyRoutingFilter ä¹‹å‰</strong> æ’å…¥è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œå³å¯å®ç°ç™»å½•æ ¡éªŒã€‚</p></blockquote><hr><h3 id="3-3-è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"><a href="#3-3-è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="3.3 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"></a>3.3 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthGlobalFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span>, Ordered &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> JwtTool jwtTool;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AuthProperties authProperties;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AntPathMatcher</span> <span class="variable">matcher</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AntPathMatcher</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">        <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> exchange.getRequest();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•</span></span><br><span class="line">        <span class="keyword">if</span> (isExclude(request.getPath().toString())) <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. è·å– token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeaders().getFirst(<span class="string">&quot;authorization&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. æ ¡éªŒå¹¶è§£æ</span></span><br><span class="line">        Long userId;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            userId = jwtTool.parseToken(token);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnauthorizedException e) &#123;</span><br><span class="line">            exchange.getResponse().setRawStatusCode(<span class="number">401</span>);</span><br><span class="line">            <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥è¯·æ±‚å¤´</span></span><br><span class="line">        <span class="type">ServerHttpRequest</span> <span class="variable">newRequest</span> <span class="operator">=</span> exchange.getRequest()</span><br><span class="line">                .mutate()</span><br><span class="line">                .header(<span class="string">&quot;user-info&quot;</span>, userId.toString())</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange.mutate().request(newRequest).build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isExclude</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> authProperties.getExcludePaths().stream()</span><br><span class="line">                .anyMatch(pattern -&gt; matcher.match(pattern, path));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOrder</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… æ ¡éªŒæˆåŠŸåï¼Œç”¨æˆ·ä¿¡æ¯é€šè¿‡è¯·æ±‚å¤´ä¼ é€’åˆ°ä¸‹æ¸¸æœåŠ¡ã€‚</p><h2 id="å››ã€å¾®æœåŠ¡ä¸­è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯"><a href="#å››ã€å¾®æœåŠ¡ä¸­è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="å››ã€å¾®æœåŠ¡ä¸­è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯"></a>å››ã€å¾®æœåŠ¡ä¸­è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯</h2><h3 id="4-1-æ‹¦æˆªå™¨ä¿å­˜ç”¨æˆ·ä¸Šä¸‹æ–‡"><a href="#4-1-æ‹¦æˆªå™¨ä¿å­˜ç”¨æˆ·ä¸Šä¸‹æ–‡" class="headerlink" title="4.1 æ‹¦æˆªå™¨ä¿å­˜ç”¨æˆ·ä¸Šä¸‹æ–‡"></a>4.1 æ‹¦æˆªå™¨ä¿å­˜ç”¨æˆ·ä¸Šä¸‹æ–‡</h3><p>åœ¨ <code>hm-common</code> æ¨¡å—ä¸­å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserInfoInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest req, HttpServletResponse res, Object handler)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userInfo</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;user-info&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isNotBlank(userInfo)) &#123;</span><br><span class="line">            UserContext.setUser(Long.valueOf(userInfo));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest req, HttpServletResponse res, Object handler, Exception ex)</span> &#123;</span><br><span class="line">        UserContext.removeUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è‡ªåŠ¨è£…é… (<code>spring.factories</code>) å…¨å±€ç”Ÿæ•ˆã€‚</p><hr><h2 id="äº”ã€Feign-è°ƒç”¨ä¸­çš„ç”¨æˆ·ä¿¡æ¯ä¼ é€’"><a href="#äº”ã€Feign-è°ƒç”¨ä¸­çš„ç”¨æˆ·ä¿¡æ¯ä¼ é€’" class="headerlink" title="äº”ã€Feign è°ƒç”¨ä¸­çš„ç”¨æˆ·ä¿¡æ¯ä¼ é€’"></a>äº”ã€Feign è°ƒç”¨ä¸­çš„ç”¨æˆ·ä¿¡æ¯ä¼ é€’</h2><p>å¾®æœåŠ¡ä¹‹é—´é€šè¿‡ OpenFeign è°ƒç”¨æ—¶ï¼Œä¹Ÿè¦ä¼ é€’ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>å®ç°æ–¹å¼ï¼šå®šä¹‰ä¸€ä¸ª Feign è¯·æ±‚æ‹¦æˆªå™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> RequestInterceptor <span class="title function_">userInfoRequestInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> template -&gt; &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> UserContext.getUser();</span><br><span class="line">        <span class="keyword">if</span> (userId != <span class="literal">null</span>) &#123;</span><br><span class="line">            template.header(<span class="string">&quot;user-info&quot;</span>, userId.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæ¯ä¸ª Feign è¯·æ±‚éƒ½ä¼šè‡ªåŠ¨é™„å¸¦ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå®ç°ç«¯åˆ°ç«¯çš„é‰´æƒé“¾è·¯ã€‚</p><hr><h2 id="å…­ã€ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆNacos-Configï¼‰"><a href="#å…­ã€ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆNacos-Configï¼‰" class="headerlink" title="å…­ã€ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆNacos Configï¼‰"></a>å…­ã€ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆNacos Configï¼‰</h2><h3 id="6-1-ä¸ºä»€ä¹ˆè¦ç”¨é…ç½®ä¸­å¿ƒï¼Ÿ"><a href="#6-1-ä¸ºä»€ä¹ˆè¦ç”¨é…ç½®ä¸­å¿ƒï¼Ÿ" class="headerlink" title="6.1 ä¸ºä»€ä¹ˆè¦ç”¨é…ç½®ä¸­å¿ƒï¼Ÿ"></a>6.1 ä¸ºä»€ä¹ˆè¦ç”¨é…ç½®ä¸­å¿ƒï¼Ÿ</h3><p>å½“å‰é—®é¢˜ï¼š</p><ul><li>é…ç½®åˆ†æ•£åœ¨å„æœåŠ¡ï¼›</li><li>ä¿®æ”¹é…ç½®éœ€é‡å¯ï¼›</li><li>å¤šå¤„é‡å¤é…ç½®ã€‚</li></ul><p> ä½¿ç”¨ <strong>Nacos Config</strong>ï¼Œé›†ä¸­ç®¡ç†ã€åŠ¨æ€åˆ·æ–°ã€å…±äº«é…ç½®ã€‚</p><hr><h3 id="6-2-å…±äº«é…ç½®æ­¥éª¤"><a href="#6-2-å…±äº«é…ç½®æ­¥éª¤" class="headerlink" title="6.2 å…±äº«é…ç½®æ­¥éª¤"></a>6.2 å…±äº«é…ç½®æ­¥éª¤</h3><p>1ï¸âƒ£ Nacos æ§åˆ¶å°åˆ›å»ºå…±äº«é…ç½®ï¼š</p><ul><li><code>shared-jdbc.yaml</code>ï¼ˆæ•°æ®åº“ï¼‰</li><li><code>shared-log.yaml</code>ï¼ˆæ—¥å¿—ï¼‰</li><li><code>shared-swagger.yaml</code>ï¼ˆæ¥å£æ–‡æ¡£ï¼‰</li></ul><p>2ï¸âƒ£ åœ¨æœåŠ¡ä¸­å¼•å…¥ä¾èµ–å¹¶åˆ›å»º <code>bootstrap.yaml</code>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cart-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.150</span><span class="number">.101</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">        <span class="attr">shared-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">shared-jdbc.yaml</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">shared-log.yaml</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">shared-swagger.yaml</span></span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ æœ¬åœ° <code>application.yaml</code> ä¿ç•™ä¸ªæ€§åŒ–é…ç½®ã€‚</p><hr><h3 id="6-3-é…ç½®çƒ­æ›´æ–°"><a href="#6-3-é…ç½®çƒ­æ›´æ–°" class="headerlink" title="6.3 é…ç½®çƒ­æ›´æ–°"></a>6.3 é…ç½®çƒ­æ›´æ–°</h3><p>åœ¨ Nacos ä¸­åˆ›å»ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Data ID: cart-service.yaml</span><br></pre></td></tr></table></figure><p>å†…å®¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hm:</span></span><br><span class="line">  <span class="attr">cart:</span></span><br><span class="line">    <span class="attr">maxAmount:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>åœ¨å¾®æœåŠ¡ä¸­è¯»å–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;hm.cart&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CartProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer maxAmount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… ä¿®æ”¹ Nacos é…ç½®åæ— éœ€é‡å¯å³å¯ç”Ÿæ•ˆï¼</p><hr><h2 id="ä¸ƒã€åŠ¨æ€è·¯ç”±ï¼ˆGateway-Nacosï¼‰"><a href="#ä¸ƒã€åŠ¨æ€è·¯ç”±ï¼ˆGateway-Nacosï¼‰" class="headerlink" title="ä¸ƒã€åŠ¨æ€è·¯ç”±ï¼ˆGateway + Nacosï¼‰"></a>ä¸ƒã€åŠ¨æ€è·¯ç”±ï¼ˆGateway + Nacosï¼‰</h2><p>é™æ€è·¯ç”±å†™åœ¨ <code>application.yml</code> ä¸­ï¼Œæ›´æ–°éœ€é‡å¯ã€‚<br> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>Nacos åŠ¨æ€ç›‘å¬ + RouteDefinitionWriter</strong> å®ç°çƒ­æ›´æ–°ã€‚</p><h3 id="å®ç°æ­¥éª¤ï¼š"><a href="#å®ç°æ­¥éª¤ï¼š" class="headerlink" title="å®ç°æ­¥éª¤ï¼š"></a>å®ç°æ­¥éª¤ï¼š</h3><p> åœ¨ Nacos æ·»åŠ  <code>gateway-routes.json</code>ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;item&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;predicates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Path&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;_genkey_0&quot;</span><span class="punctuation">:</span><span class="string">&quot;/items/**&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;uri&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lb://item-service&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p> ç½‘å…³ä¸­ç›‘å¬é…ç½®å˜æ›´ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hmall.gateway.route;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.json.JSONUtil;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.cloud.nacos.NacosConfigManager;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.config.listener.Listener;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.exception.NacosException;</span><br><span class="line"><span class="keyword">import</span> com.hmall.common.utils.CollUtils;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.route.RouteDefinition;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.route.RouteDefinitionWriter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicRouteLoader</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RouteDefinitionWriter writer;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> NacosConfigManager nacosConfigManager;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·¯ç”±é…ç½®æ–‡ä»¶çš„idå’Œåˆ†ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">dataId</span> <span class="operator">=</span> <span class="string">&quot;gateway-routes.json&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">group</span> <span class="operator">=</span> <span class="string">&quot;DEFAULT_GROUP&quot;</span>;</span><br><span class="line">    <span class="comment">// ä¿å­˜æ›´æ–°è¿‡çš„è·¯ç”±id</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Set&lt;String&gt; routeIds = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initRouteConfigListener</span><span class="params">()</span> <span class="keyword">throws</span> NacosException &#123;</span><br><span class="line">        <span class="comment">// 1.æ³¨å†Œç›‘å¬å™¨å¹¶é¦–æ¬¡æ‹‰å–é…ç½®</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">configInfo</span> <span class="operator">=</span> nacosConfigManager.getConfigService()</span><br><span class="line">                .getConfigAndSignListener(dataId, group, <span class="number">5000</span>, <span class="keyword">new</span> <span class="title class_">Listener</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> Executor <span class="title function_">getExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveConfigInfo</span><span class="params">(String configInfo)</span> &#123;</span><br><span class="line">                        updateConfigInfo(configInfo);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 2.é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œæ›´æ–°ä¸€æ¬¡é…ç½®</span></span><br><span class="line">        updateConfigInfo(configInfo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">updateConfigInfo</span><span class="params">(String configInfo)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;ç›‘å¬åˆ°è·¯ç”±é…ç½®å˜æ›´ï¼Œ&#123;&#125;&quot;</span>, configInfo);</span><br><span class="line">        <span class="comment">// 1.ååºåˆ—åŒ–</span></span><br><span class="line">        List&lt;RouteDefinition&gt; routeDefinitions = JSONUtil.toList(configInfo, RouteDefinition.class);</span><br><span class="line">        <span class="comment">// 2.æ›´æ–°å‰å…ˆæ¸…ç©ºæ—§è·¯ç”±</span></span><br><span class="line">        <span class="comment">// 2.1.æ¸…é™¤æ—§è·¯ç”±</span></span><br><span class="line">        <span class="keyword">for</span> (String routeId : routeIds) &#123;</span><br><span class="line">            writer.delete(Mono.just(routeId)).subscribe();</span><br><span class="line">        &#125;</span><br><span class="line">        routeIds.clear();</span><br><span class="line">        <span class="comment">// 2.2.åˆ¤æ–­æ˜¯å¦æœ‰æ–°çš„è·¯ç”±è¦æ›´æ–°</span></span><br><span class="line">        <span class="keyword">if</span> (CollUtils.isEmpty(routeDefinitions)) &#123;</span><br><span class="line">            <span class="comment">// æ— æ–°è·¯ç”±é…ç½®ï¼Œç›´æ¥ç»“æŸ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3.æ›´æ–°è·¯ç”±</span></span><br><span class="line">        routeDefinitions.forEach(routeDefinition -&gt; &#123;</span><br><span class="line">            <span class="comment">// 3.1.æ›´æ–°è·¯ç”±</span></span><br><span class="line">            writer.save(Mono.just(routeDefinition)).subscribe();</span><br><span class="line">            <span class="comment">// 3.2.è®°å½•è·¯ç”±idï¼Œæ–¹ä¾¿å°†æ¥åˆ é™¤</span></span><br><span class="line">            routeIds.add(routeDefinition.getId());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> ä¿®æ”¹ Nacos é…ç½®åï¼Œå‡ ç§’é’Ÿå†…è·¯ç”±è‡ªåŠ¨æ›´æ–°ï¼Œæ— éœ€é‡å¯ï¼</p><hr><h2 id="å…«ã€çŸ¥è¯†æ€»ç»“"><a href="#å…«ã€çŸ¥è¯†æ€»ç»“" class="headerlink" title="å…«ã€çŸ¥è¯†æ€»ç»“"></a>å…«ã€çŸ¥è¯†æ€»ç»“</h2><table><thead><tr><th>åŠŸèƒ½</th><th>å®ç°ç»„ä»¶</th><th>æ ¸å¿ƒæŠ€æœ¯</th></tr></thead><tbody><tr><td>è·¯ç”±è½¬å‘</td><td>Spring Cloud Gateway</td><td>routes + predicates</td></tr><tr><td>ç™»å½•é‰´æƒ</td><td>GlobalFilter + JWT</td><td>ç»Ÿä¸€æ ¡éªŒå…¥å£</td></tr><tr><td>ç”¨æˆ·ä¼ é€’</td><td>è¯·æ±‚å¤´ + æ‹¦æˆªå™¨</td><td>UserContext</td></tr><tr><td>å¾®æœåŠ¡é—´ä¼ é€’</td><td>Feign RequestInterceptor</td><td>è‡ªåŠ¨é™„åŠ è¯·æ±‚å¤´</td></tr><tr><td>é…ç½®å…±äº«</td><td>Nacos Config</td><td>shared-configs</td></tr><tr><td>çƒ­æ›´æ–°</td><td>Nacos æ¨é€æœºåˆ¶</td><td>@ConfigurationProperties</td></tr><tr><td>åŠ¨æ€è·¯ç”±</td><td>Nacos + RouteDefinitionWriter</td><td>JSON åŠ¨æ€åŠ è½½</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> Nacos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringCloud å¾®æœåŠ¡â€”â€”Nacos ä¸ OpenFeign è¯¦è§£</title>
      <link href="/2025/10/30/Nacos/"/>
      <url>/2025/10/30/Nacos/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringCloud-å¾®æœåŠ¡â€”â€”Nacos-ä¸-OpenFeign-è¯¦è§£"><a href="#SpringCloud-å¾®æœåŠ¡â€”â€”Nacos-ä¸-OpenFeign-è¯¦è§£" class="headerlink" title="SpringCloud å¾®æœåŠ¡â€”â€”Nacos ä¸ OpenFeign è¯¦è§£"></a>SpringCloud å¾®æœåŠ¡â€”â€”Nacos ä¸ OpenFeign è¯¦è§£</h1><h2 id="ä¸€ã€å¾®æœåŠ¡é€šä¿¡çš„åŸºç¡€ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#ä¸€ã€å¾®æœåŠ¡é€šä¿¡çš„åŸºç¡€ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="ä¸€ã€å¾®æœåŠ¡é€šä¿¡çš„åŸºç¡€ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°"></a>ä¸€ã€å¾®æœåŠ¡é€šä¿¡çš„åŸºç¡€ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°</h2><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œç³»ç»Ÿè¢«æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„æœåŠ¡ï¼ˆå¦‚ç”¨æˆ·æœåŠ¡ã€å•†å“æœåŠ¡ã€è®¢å•æœåŠ¡ç­‰ï¼‰ã€‚<br> ä¸ºäº†è®©è¿™äº›æœåŠ¡èƒ½å¤Ÿç›¸äº’è°ƒç”¨ï¼Œå°±éœ€è¦ä¸€ä¸ª<strong>æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰</strong>æ¥ç®¡ç†æœåŠ¡å®ä¾‹çš„æ³¨å†Œå’Œå‘ç°ã€‚</p><h3 id="æ³¨å†Œä¸­å¿ƒåŸç†"><a href="#æ³¨å†Œä¸­å¿ƒåŸç†" class="headerlink" title="æ³¨å†Œä¸­å¿ƒåŸç†"></a>æ³¨å†Œä¸­å¿ƒåŸç†</h3><p>æ³¨å†Œä¸­å¿ƒçš„æ ¸å¿ƒæµç¨‹åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p><ol><li><strong>æœåŠ¡æ³¨å†Œï¼ˆService Registrationï¼‰</strong><br> å„ä¸ªå¾®æœåŠ¡åœ¨å¯åŠ¨æ—¶ï¼Œå°†è‡ªå·±çš„ IPã€ç«¯å£ã€æœåŠ¡åç­‰ä¿¡æ¯æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒã€‚</li><li><strong>æœåŠ¡å‘ç°ï¼ˆService Discoveryï¼‰</strong><br> å…¶ä»–æœåŠ¡åœ¨è°ƒç”¨æ—¶ï¼Œå…ˆå‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢è¦è°ƒç”¨çš„æœåŠ¡åœ°å€ã€‚</li><li><strong>å¥åº·æ£€æµ‹ä¸å‰”é™¤ï¼ˆHealth Checkï¼‰</strong><br> æ³¨å†Œä¸­å¿ƒå®šæœŸæ£€æµ‹æœåŠ¡æ˜¯å¦å­˜æ´»ï¼Œå¤±æ•ˆçš„å®ä¾‹ä¼šè¢«å‰”é™¤ã€‚</li></ol><hr><h2 id="äºŒã€Nacos-æ³¨å†Œä¸­å¿ƒè¯¦è§£"><a href="#äºŒã€Nacos-æ³¨å†Œä¸­å¿ƒè¯¦è§£" class="headerlink" title="äºŒã€Nacos æ³¨å†Œä¸­å¿ƒè¯¦è§£"></a>äºŒã€Nacos æ³¨å†Œä¸­å¿ƒè¯¦è§£</h2><h3 id="1-Nacos-ç®€ä»‹"><a href="#1-Nacos-ç®€ä»‹" class="headerlink" title="1. Nacos ç®€ä»‹"></a>1. Nacos ç®€ä»‹</h3><p>Nacos æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„<strong>åŠ¨æ€æœåŠ¡å‘ç°ä¸é…ç½®ç®¡ç†å¹³å°</strong>ï¼Œå…¼å®¹ Spring Cloud Alibaba ç”Ÿæ€ã€‚</p><p>åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>æœåŠ¡æ³¨å†Œä¸å‘ç°</li><li>é…ç½®ç®¡ç†</li><li>åŠ¨æ€è´Ÿè½½å‡è¡¡</li><li>å¥åº·æ£€æµ‹</li></ul><hr><h3 id="2-é¡¹ç›®ä¸­å¼•å…¥-Nacos"><a href="#2-é¡¹ç›®ä¸­å¼•å…¥-Nacos" class="headerlink" title="2. é¡¹ç›®ä¸­å¼•å…¥ Nacos"></a>2. é¡¹ç›®ä¸­å¼•å…¥ Nacos</h3><h4 id="â‘ -æ·»åŠ ä¾èµ–"><a href="#â‘ -æ·»åŠ ä¾èµ–" class="headerlink" title="â‘  æ·»åŠ ä¾èµ–"></a>â‘  æ·»åŠ ä¾èµ–</h4><p>åœ¨å¾®æœåŠ¡çš„ <code>pom.xml</code> ä¸­å¼•å…¥ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="â‘¡-é…ç½®-Nacos-åœ°å€"><a href="#â‘¡-é…ç½®-Nacos-åœ°å€" class="headerlink" title="â‘¡ é…ç½® Nacos åœ°å€"></a>â‘¡ é…ç½® Nacos åœ°å€</h4><p>åœ¨ <code>application.yml</code> ä¸­é…ç½® Nacos æœåŠ¡ç«¯ä¿¡æ¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">user-service</span>  <span class="comment"># å½“å‰å¾®æœåŠ¡å</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span>  <span class="comment"># NacosæœåŠ¡å™¨åœ°å€</span></span><br></pre></td></tr></table></figure><h4 id="â‘¢-å¯åŠ¨æ³¨å†Œ"><a href="#â‘¢-å¯åŠ¨æ³¨å†Œ" class="headerlink" title="â‘¢ å¯åŠ¨æ³¨å†Œ"></a>â‘¢ å¯åŠ¨æ³¨å†Œ</h4><p>åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(UserApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ… å¯åŠ¨åå³å¯åœ¨ <strong>Nacos æ§åˆ¶å°</strong>çœ‹åˆ°æ³¨å†Œçš„æœåŠ¡å®ä¾‹ã€‚</p><hr><h3 id="3-æœåŠ¡å‘ç°ä¸è°ƒç”¨"><a href="#3-æœåŠ¡å‘ç°ä¸è°ƒç”¨" class="headerlink" title="3. æœåŠ¡å‘ç°ä¸è°ƒç”¨"></a>3. æœåŠ¡å‘ç°ä¸è°ƒç”¨</h3><p>å½“å¦ä¸€ä¸ªå¾®æœåŠ¡ï¼ˆä¾‹å¦‚ <code>order-service</code>ï¼‰æƒ³è°ƒç”¨ <code>user-service</code> æ—¶ï¼Œå¯ä»¥é€šè¿‡æœåŠ¡åè®¿é—®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/order&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ user-service æœåŠ¡</span></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">&quot;http://user-service/user/info&quot;</span>, String.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦åœ¨é…ç½®ç±»ä¸­ä¸º RestTemplate å¼€å¯è´Ÿè½½å‡è¡¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span></span><br><span class="line"><span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å³å¯é€šè¿‡ <strong>æœåŠ¡å</strong> ç›´æ¥è®¿é—®ï¼Œè€Œä¸æ˜¯å†™æ­» IP åœ°å€ã€‚</p><hr><h2 id="ä¸‰ã€OpenFeignï¼šæ›´ä¼˜é›…çš„æœåŠ¡è¿œç¨‹è°ƒç”¨æ–¹å¼"><a href="#ä¸‰ã€OpenFeignï¼šæ›´ä¼˜é›…çš„æœåŠ¡è¿œç¨‹è°ƒç”¨æ–¹å¼" class="headerlink" title="ä¸‰ã€OpenFeignï¼šæ›´ä¼˜é›…çš„æœåŠ¡è¿œç¨‹è°ƒç”¨æ–¹å¼"></a>ä¸‰ã€OpenFeignï¼šæ›´ä¼˜é›…çš„æœåŠ¡è¿œç¨‹è°ƒç”¨æ–¹å¼</h2><p>è™½ç„¶ RestTemplate å¯ä»¥å®ç°æœåŠ¡é—´è°ƒç”¨ï¼Œä½†å…¶ä»£ç å¯è¯»æ€§å·®ã€éš¾ç»´æŠ¤ã€‚<br> SpringCloud æä¾›äº†æ›´é«˜çº§çš„å£°æ˜å¼ HTTP å®¢æˆ·ç«¯â€”â€”<strong>OpenFeign</strong>ã€‚</p><hr><h3 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h3><p>åœ¨è°ƒç”¨æ–¹ï¼ˆä¾‹å¦‚ <code>order-service</code>ï¼‰çš„ <code>pom.xml</code> ä¸­åŠ å…¥ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-å¯ç”¨-OpenFeign"><a href="#2-å¯ç”¨-OpenFeign" class="headerlink" title="2. å¯ç”¨ OpenFeign"></a>2. å¯ç”¨ OpenFeign</h3><p>åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(OrderApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="3-ç¼–å†™-Feign-å®¢æˆ·ç«¯æ¥å£"><a href="#3-ç¼–å†™-Feign-å®¢æˆ·ç«¯æ¥å£" class="headerlink" title="3. ç¼–å†™ Feign å®¢æˆ·ç«¯æ¥å£"></a>3. ç¼–å†™ Feign å®¢æˆ·ç«¯æ¥å£</h3><p>åœ¨ <code>order-service</code> ä¸­åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œå£°æ˜è¦è°ƒç”¨çš„è¿œç¨‹æœåŠ¡åŠæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(&quot;user-service&quot;)</span> <span class="comment">// æœåŠ¡åï¼Œå¯¹åº” Nacos æ³¨å†Œå</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/info&quot;)</span></span><br><span class="line">    String <span class="title function_">getUserInfo</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="4-ä½¿ç”¨-FeignClient-å‘èµ·è¿œç¨‹è°ƒç”¨"><a href="#4-ä½¿ç”¨-FeignClient-å‘èµ·è¿œç¨‹è°ƒç”¨" class="headerlink" title="4. ä½¿ç”¨ FeignClient å‘èµ·è¿œç¨‹è°ƒç”¨"></a>4. ä½¿ç”¨ FeignClient å‘èµ·è¿œç¨‹è°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/order&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserClient userClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userClient.getUserInfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OpenFeign åº•å±‚ä¼šï¼š</p><ul><li>è‡ªåŠ¨ä» Nacos æ‹‰å– <code>user-service</code> çš„æœåŠ¡åœ°å€ï¼›</li><li>é€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©ä¸€ä¸ªå®ä¾‹ï¼›</li><li>å‘èµ· HTTP è¯·æ±‚å¹¶è¿”å›ç»“æœã€‚</li></ul><p>è°ƒç”¨æ–¹å¼æ›´ç›´è§‚ï¼Œå®Œå…¨ä¸ç”¨å…³å¿ƒç½‘ç»œç»†èŠ‚ã€‚</p><hr><h3 id="5-Feign-çš„é«˜çº§ç‰¹æ€§"><a href="#5-Feign-çš„é«˜çº§ç‰¹æ€§" class="headerlink" title="5. Feign çš„é«˜çº§ç‰¹æ€§"></a>5. Feign çš„é«˜çº§ç‰¹æ€§</h3><h4 id="ï¼ˆ1ï¼‰è¿æ¥æ± ä¸è¶…æ—¶é…ç½®"><a href="#ï¼ˆ1ï¼‰è¿æ¥æ± ä¸è¶…æ—¶é…ç½®" class="headerlink" title="ï¼ˆ1ï¼‰è¿æ¥æ± ä¸è¶…æ—¶é…ç½®"></a>ï¼ˆ1ï¼‰è¿æ¥æ± ä¸è¶…æ—¶é…ç½®</h4><p>åœ¨ <code>application.yml</code> ä¸­å¯é…ç½®è¶…æ—¶æ—¶é—´å’Œè¿æ¥æ± å¤§å°ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">connectTimeout:</span> <span class="number">5000</span></span><br><span class="line">        <span class="attr">readTimeout:</span> <span class="number">10000</span></span><br><span class="line">  <span class="attr">okhttp:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span>  <span class="comment"># å¯ç”¨OkHttpè¿æ¥æ± </span></span><br></pre></td></tr></table></figure><h4 id="ï¼ˆ2ï¼‰FeignClient-æŠ½å–ä¸å¤ç”¨"><a href="#ï¼ˆ2ï¼‰FeignClient-æŠ½å–ä¸å¤ç”¨" class="headerlink" title="ï¼ˆ2ï¼‰FeignClient æŠ½å–ä¸å¤ç”¨"></a>ï¼ˆ2ï¼‰FeignClient æŠ½å–ä¸å¤ç”¨</h4><p>å¦‚æœå¤šä¸ªæœåŠ¡éƒ½éœ€è¦è°ƒç”¨ <code>user-service</code>ï¼Œå¯ä»¥å°† <code>UserClient</code> æŠ½å–åˆ°ä¸€ä¸ªå…¬å…±æ¨¡å—ä¸­ï¼Œé€šè¿‡ä¾èµ–å¤ç”¨ï¼Œé¿å…ä»£ç é‡å¤ã€‚</p><hr><h2 id="å››ã€Nacos-Feign-çš„åä½œæœºåˆ¶"><a href="#å››ã€Nacos-Feign-çš„åä½œæœºåˆ¶" class="headerlink" title="å››ã€Nacos + Feign çš„åä½œæœºåˆ¶"></a>å››ã€Nacos + Feign çš„åä½œæœºåˆ¶</h2><ol><li>æœåŠ¡å¯åŠ¨æ—¶ï¼Œ<code>Nacos</code> æ³¨å†Œä¸­å¿ƒä¼šè®°å½•ä¸‹æœåŠ¡åä¸å®ä¾‹ä¿¡æ¯ï¼›</li><li><code>Feign</code> å®¢æˆ·ç«¯é€šè¿‡ <strong>æœåŠ¡å</strong> è°ƒç”¨ï¼›</li><li>åº•å±‚è‡ªåŠ¨ä» Nacos è·å–åœ°å€ï¼Œå¹¶è´Ÿè½½å‡è¡¡ï¼›</li><li>æœåŠ¡é—´é€šä¿¡æ— éœ€å…³å¿ƒ IP å˜åŒ–ï¼Œå…·å¤‡é«˜å¯æ‰©å±•æ€§ã€‚</li></ol><h2 id=""><a href="#" class="headerlink" title=""></a></h2><hr><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><table><thead><tr><th>æŠ€æœ¯</th><th>ä½œç”¨</th><th>æ ¸å¿ƒæ³¨è§£</th><th>å…¸å‹é…ç½®</th></tr></thead><tbody><tr><td><strong>Nacos</strong></td><td>æœåŠ¡æ³¨å†Œä¸å‘ç°</td><td><code>@EnableDiscoveryClient</code></td><td><code>spring.cloud.nacos.discovery.server-addr</code></td></tr><tr><td><strong>OpenFeign</strong></td><td>å£°æ˜å¼æœåŠ¡è°ƒç”¨</td><td><code>@EnableFeignClients</code>ã€<code>@FeignClient</code></td><td><code>feign.client.config</code>ã€<code>feign.okhttp.enabled</code></td></tr></tbody></table><p>äºŒè€…ç»“åˆåï¼ŒSpringCloud åº”ç”¨å³å¯å®ç°ï¼š</p><ul><li>æœåŠ¡åŠ¨æ€æ³¨å†Œä¸å‘ç°ï¼›</li><li>å£°æ˜å¼è¿œç¨‹è°ƒç”¨ï¼›</li><li>è‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼›</li><li>æœåŠ¡é—´é€šä¿¡é«˜å¯ç»´æŠ¤æ€§ã€‚</li></ul><hr><p> <strong>æ€»ç»“ä¸€å¥è¯ï¼š</strong></p><blockquote><p>Nacos è´Ÿè´£â€œæ‰¾åˆ°è°â€ï¼ŒOpenFeign è´Ÿè´£â€œæ€ä¹ˆè¯´â€ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> Nacos </tag>
            
            <tag> OpenFeign </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæ–°ç‰¹æ€§</title>
      <link href="/2025/10/29/JDK%E6%96%B0%E7%89%B9%E6%80%A7/"/>
      <url>/2025/10/29/JDK%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h1><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼šLambdaè¡¨è¾¾å¼æ˜¯ç”±åŒ¿åå†…éƒ¨ç±»ä¼ å‚ç®€åŒ–è€Œæ¥</p><p>ä½¿ç”¨lambdaè¡¨è¾¾å¼çš„åœºæ™¯ï¼š</p><p><strong>å‡½æ•°å¼æ¥å£åšæ–¹æ³•å‚æ•°ä¼ é€’</strong></p><p>(åªè¦æ˜¯æƒ³newä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå°±èƒ½ç”¨lambdaï¼Œåªæ˜¯ç”¨çš„æ—¶å€™å¤§å¤šå‡ºç°åœ¨ä¼ é€’å‚æ•°çš„æ—¶å€™)</p><p>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ â€”â€”&gt; ä¸€ä¸ªæ¥å£æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªé‡å†™æ–¹æ³• å¯ä»¥ç”¨è¿‡åœ¨æ¥å£ä¸ŠåŠ ä¸Š@FunctionalInterfaceæ³¨è§£æ¥åˆ¤æ–­</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String [] args)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> run &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;a new thread&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œnew Threadä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªrunnableçš„å®ç°ç±»å¯¹è±¡ï¼ˆåŒ¿åå†…éƒ¨ç±»ï¼‰ï¼Œè€Œrunnableæ¥å£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå®ƒé‡Œé¢æœ‰ä¸”åªæœ‰ä¸€ä¸ªrunæ–¹æ³•éœ€è¦é‡å†™ï¼Œæ‰€ä»¥å¯ä»¥æ”¹æˆlambdaè¡¨è¾¾å¼ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String []args)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(</span><br><span class="line">            ()-&gt;&#123;System.out.println(<span class="string">&quot;a new thread made by lambda&quot;</span>);&#125;</span><br><span class="line">        ).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>()å†…æ˜¯æ–¹æ³•çš„å‚æ•°ï¼Œå‚æ•°çš„ç±»å‹å¯ä»¥çœç•¥ï¼Œå‚æ•°æœ¬èº«ä¸èƒ½çœç•¥ï¼Œå½“æœ‰ä¸”åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œå°æ‹¬å·å¯ä»¥çœç•¥</li><li>{}å†…æ˜¯é‡å†™çš„æ–¹æ³•ä½“ï¼Œåªæœ‰ä¸€è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥çœç•¥å¤§æ‹¬å·ï¼Œåªæœ‰ä¸€è¡Œreturnçš„æ—¶å€™ï¼Œå¯ä»¥çœç•¥returnå…³é”®å­—</li></ul><h2 id="å‡ ç§å¸¸è§çš„å‡½æ•°å¼æ¥å£ï¼š"><a href="#å‡ ç§å¸¸è§çš„å‡½æ•°å¼æ¥å£ï¼š" class="headerlink" title="å‡ ç§å¸¸è§çš„å‡½æ•°å¼æ¥å£ï¼š"></a>å‡ ç§å¸¸è§çš„å‡½æ•°å¼æ¥å£ï¼š</h2><p>Supplier ä¾›åº”è€…ï¼Œä¸æ¥å—æ•°æ®ï¼Œè¿”å›æ•°æ®ï¼Œé‡å†™getæ–¹æ³•</p><p>Consumer æ¶ˆè´¹è€…ï¼Œæ¥å—æ•°æ®ï¼Œä¸è¿”å›æ•°æ®ï¼Œé‡å†™acceptæ–¹æ³•</p><p>Function å‡½æ•°å¼æ¥å£ï¼Œæ¥å—æ•°æ®ï¼Œè¿”å›æ•°æ®ï¼Œé‡å†™applyæ–¹æ³•</p><p>Predicate æ–­è¨€æ¥å£ï¼Œæ¥æ”¶æ•°æ®ï¼Œè¿”å›çœŸå‡ï¼Œé‡å†™testæ–¹æ³•</p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String []args)</span>&#123;</span><br><span class="line">    </span><br><span class="line">    testSupplier(</span><br><span class="line">        ()-&gt;<span class="string">&quot;rjctx&quot;</span>   <span class="comment">//è¿”å›æ•°æ®</span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    testConsumer(</span><br><span class="line">        s -&gt; System.out.println(s + <span class="string">&quot;ctx&quot;</span>);  <span class="comment">//æ¶ˆè´¹æ•°æ®</span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    testFunction(</span><br><span class="line">        s -&gt;&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.equals(<span class="string">&quot;rjctx&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    testPredicate(</span><br><span class="line">        s -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span>(s.equals(<span class="string">&quot;rjctx&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSupplier</span><span class="params">(Supplier&lt;String&gt; sp)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> sp.get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConsumer</span><span class="params">(Consumer&lt;String&gt; cm)</span>&#123;</span><br><span class="line">    cm.accept(<span class="string">&quot;rj&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFunction</span><span class="params">(Function&lt;String,<span class="type">boolean</span>&gt; func)</span>&#123;</span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">boolean</span> <span class="operator">=</span> func.apply(<span class="string">&quot;rjctx&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPredicate</span><span class="params">(Predicate&lt;String&gt; pd)</span>&#123;</span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">boolean</span> <span class="operator">=</span> pd.test(<span class="string">&quot;rjctx&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼Œå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³å’Œé¢å‘å¯¹è±¡ä¸åŒ</p><p>é¢å‘å¯¹è±¡æ€æƒ³ä¸­ï¼Œæˆ‘ä»¬ä¼šå¾€å‡½æ•°ä¸­ä¼ é€’ç¡®å®šçš„å‚æ•°ï¼Œè®©å‡½æ•°æ‹¿åˆ°è¿™ä¸ªå‚æ•°å»è‡ªå·±åšä¸€äº›æ“ä½œ</p><p>è€Œåœ¨å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ä¸­ï¼Œç»™å‡½æ•°ä¼ é€’çš„å‚æ•°å˜æˆäº†<strong>å‡½æ•°å¼æ¥å£</strong>ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†æƒ³ä¼ é€’ç¡®å®šçš„å¯¹è±¡ï¼Œç„¶å‡½æ•°è‡ªå·±æ‹¿å»ä½¿ç”¨ï¼Œ</p><p>è€Œæ˜¯æƒ³ä¼ é€’ä¸€ä¸ª<strong>â€œå‡½æ•°æ¨¡æ¿â€</strong>ï¼Œç»™è¿™ä¸ªå‡½æ•°<strong>é¢„ç•™å‡ºä¸€äº›å…¶ä»–çš„æ“ä½œç©ºé—´</strong>ï¼Œåœ¨è°ƒç”¨å®ƒçš„æ—¶å€™ï¼Œç»™ä»–ä¼ è¿›å»ä¸€äº›æ“ä½œï¼Œ</p><p>è¿™æ ·è¿™ä¸ªå‡½æ•°åœ¨ä¸åŒåœºæ™¯ä¸‹å°±èƒ½ä¼ é€’<strong>ä¸åŒçš„æ¨¡æ¿å†…å®¹</strong>ï¼Œ<strong>å®ç°ä¸åŒçš„åŠŸèƒ½</strong></p><h1 id="Streamæµ"><a href="#Streamæµ" class="headerlink" title="Streamæµ"></a>Streamæµ</h1><p>ä¸¤ç§è·å–æ–¹æ³•ï¼š</p><ul><li>stream.ofï¼Œä»¥æ•°ç»„å½¢å¼è·å–</li><li>é›†åˆçš„å®ç°ç±».stream()ï¼Œä»¥é›†åˆçš„æ–¹å¼è·å–</li></ul><p>æ–¹æ³•ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20251029124829230.png" alt="image-20251029124829230"></p><p>ç»ˆç»“æ–¹æ³•ï¼šforEachå’Œcount</p><h1 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h1><p>ä»€ä¹ˆæ—¶å€™ç”¨æ–¹æ³•å¼•ç”¨ â€”â€”&gt; å½“é‡å†™æ–¹æ³•ä¸­ï¼Œè°ƒç”¨äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•çš„å‚æ•°ï¼Œè¿”å›å€¼éƒ½å’Œé‡å†™æ–¹æ³•ç›¸åŒæ—¶</p><p>æ›´å‡†ç¡®çš„è¯´æ³•ï¼š</p><p><strong>æ–¹æ³•å¼•ç”¨çš„ä½¿ç”¨æ—¶æœº</strong>ï¼šå½“ Lambda è¡¨è¾¾å¼çš„<strong>æ•´ä¸ªå®ç°</strong>åªæ˜¯ç®€å•åœ°è°ƒç”¨ä¸€ä¸ªå·²æœ‰çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ç”¨æ–¹æ³•å¼•ç”¨æ›¿æ¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªlambdaï¼š</span></span><br><span class="line">Consumer&lt;String&gt; consumer = s -&gt; System.out.println(s);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ä»¥æ¢æˆï¼š</span></span><br><span class="line">Consumer&lt;String&gt; consumer = System.out::println;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//MyBatisPlusä¸­çš„æ–¹æ³•å¼•ç”¨ï¼š</span></span><br><span class="line"><span class="comment">// ä¼ ç»Ÿæ–¹å¼ - å­—ç¬¦ä¸²å­—æ®µåï¼ˆå®¹æ˜“å‡ºé”™ï¼‰</span></span><br><span class="line">QueryWrapper&lt;User&gt; wrapper1 = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">wrapper1.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>)</span><br><span class="line">        .gt(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>)</span><br><span class="line">        .select(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;email&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// MPæ–¹æ³•å¼•ç”¨æ–¹å¼ - ç±»å‹å®‰å…¨</span></span><br><span class="line">QueryWrapper&lt;User&gt; wrapper2 = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">wrapper2.eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>)        <span class="comment">// æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        .gt(User::getAge, <span class="number">18</span>)            <span class="comment">// ç¼–è¯‘æ—¶æ£€æŸ¥</span></span><br><span class="line">        .select(User::getId, User::getName, User::getEmail);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸç†ï¼š</span></span><br><span class="line"><span class="comment">// MP æ ¸å¿ƒæ¥å£å®šä¹‰</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SFunction</span>&lt;T, R&gt; <span class="keyword">extends</span> <span class="title class_">Function</span>&lt;T, R&gt;, Serializable &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®é™…ä½¿ç”¨çš„æ–¹æ³•å¼•ç”¨ç±»å‹</span></span><br><span class="line">SFunction&lt;User, String&gt; getNameRef = User::getName;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Lambdaè¡¨è¾¾å¼ </tag>
            
            <tag> Streamæµ </tag>
            
            <tag> æ–¹æ³•å¼•ç”¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker</title>
      <link href="/2025/10/19/Docker/"/>
      <url>/2025/10/19/Docker/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="å‘½ä»¤æ ‘ï¼š"><a href="#å‘½ä»¤æ ‘ï¼š" class="headerlink" title="å‘½ä»¤æ ‘ï¼š"></a>å‘½ä»¤æ ‘ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">Docker å‘½ä»¤æ ‘</span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ é•œåƒç®¡ç† (Images)</span><br><span class="line">â”‚   â”œâ”€â”€ docker search [é•œåƒå]           <span class="comment"># ä»ä»“åº“æœç´¢é•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker pull [é•œåƒå]:[æ ‡ç­¾]      <span class="comment"># æ‹‰å–é•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker images                    <span class="comment"># åˆ—å‡ºæœ¬åœ°é•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker rmi [é•œåƒID/å]          <span class="comment"># åˆ é™¤é•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker build -t [é•œåƒå] [è·¯å¾„]  <span class="comment"># æ„å»ºé•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker tag [æ—§å] [æ–°å]        <span class="comment"># ç»™é•œåƒæ‰“æ–°æ ‡ç­¾</span></span><br><span class="line">â”‚   â””â”€â”€ docker save -o [æ–‡ä»¶.tar] [é•œåƒ] <span class="comment"># å¯¼å‡ºé•œåƒ</span></span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ å®¹å™¨ç”Ÿå‘½å‘¨æœŸ (Container Lifecycle)</span><br><span class="line">â”‚   â”œâ”€â”€ docker run [é€‰é¡¹] [é•œåƒ] [å‘½ä»¤]  <span class="comment"># åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ -d                          <span class="comment"># åå°è¿è¡Œ (å®ˆæŠ¤è¿›ç¨‹)</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ -it                         <span class="comment"># äº¤äº’å¼ç»ˆç«¯ (-i äº¤äº’å¼ -t ä¼ªç»ˆç«¯)</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ --name [å®¹å™¨å]             <span class="comment"># æŒ‡å®šå®¹å™¨åç§°</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ -p [ä¸»æœºç«¯å£]:[å®¹å™¨ç«¯å£]     <span class="comment"># ç«¯å£æ˜ å°„</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -v [ä¸»æœºè·¯å¾„]:[å®¹å™¨è·¯å¾„]     <span class="comment"># æ•°æ®å·æŒ‚è½½</span></span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”œâ”€â”€ docker start [å®¹å™¨]             <span class="comment"># å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker stop [å®¹å™¨]              <span class="comment"># åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨ (SIGTERM)</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker restart [å®¹å™¨]           <span class="comment"># é‡å¯å®¹å™¨</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker <span class="built_in">rm</span> [å®¹å™¨]                <span class="comment"># åˆ é™¤å·²åœæ­¢çš„å®¹å™¨</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -f                          <span class="comment"># å¼ºåˆ¶åˆ é™¤ (åŒ…æ‹¬è¿è¡Œä¸­çš„)</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker pause/unpause [å®¹å™¨]     <span class="comment"># æš‚åœ/æ¢å¤å®¹å™¨è¿›ç¨‹</span></span><br><span class="line">â”‚   â””â”€â”€ docker create [é€‰é¡¹] [é•œåƒ]      <span class="comment"># åªåˆ›å»ºä¸å¯åŠ¨å®¹å™¨</span></span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ å®¹å™¨æŸ¥è¯¢ä¸æ“ä½œ (Container Inspection &amp; Operations)</span><br><span class="line">â”‚   â”œâ”€â”€ docker ps                       <span class="comment"># æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -a                         <span class="comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢ï¼‰</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker logs [å®¹å™¨]              <span class="comment"># æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -f                         <span class="comment"># å®æ—¶è·Ÿè¸ªæ—¥å¿—</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker <span class="built_in">exec</span> [é€‰é¡¹] [å®¹å™¨] [å‘½ä»¤] <span class="comment"># åœ¨è¿è¡Œä¸­çš„å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -it                        <span class="comment"># äº¤äº’å¼æ¨¡å¼ (å¸¸ç”¨ï¼šdocker exec -it bash)</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker inspect [å®¹å™¨/é•œåƒ]      <span class="comment"># æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker stats [å®¹å™¨]             <span class="comment"># å®æ—¶æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">â”‚   â””â”€â”€ docker top [å®¹å™¨]               <span class="comment"># æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹</span></span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ æ•°æ®å·ç®¡ç† (Volumes)</span><br><span class="line">â”‚   â”œâ”€â”€ docker volume <span class="built_in">ls</span>                <span class="comment"># åˆ—å‡ºæ•°æ®å·</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker volume create [å·å]     <span class="comment"># åˆ›å»ºæ•°æ®å·</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker volume inspect [å·å]    <span class="comment"># æŸ¥çœ‹æ•°æ®å·è¯¦æƒ…</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker volume <span class="built_in">rm</span> [å·å]        <span class="comment"># åˆ é™¤æ•°æ®å·</span></span><br><span class="line">â”‚   â””â”€â”€ docker volume prune            <span class="comment"># æ¸…ç†æœªè¢«ä½¿ç”¨çš„æ•°æ®å·</span></span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ ç½‘ç»œç®¡ç† (Networks)</span><br><span class="line">â”‚   â”œâ”€â”€ docker network <span class="built_in">ls</span>              <span class="comment"># åˆ—å‡ºç½‘ç»œ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker network create [ç½‘ç»œå]  <span class="comment"># åˆ›å»ºç½‘ç»œ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker network inspect [ç½‘ç»œå] <span class="comment"># æŸ¥çœ‹ç½‘ç»œè¯¦æƒ…ï¼ˆå¦‚è¿æ¥çš„å®¹å™¨ï¼‰</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker network connect [ç½‘ç»œ] [å®¹å™¨] <span class="comment"># å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker network disconnect [ç½‘ç»œ] [å®¹å™¨] <span class="comment"># å°†å®¹å™¨ä»ç½‘ç»œæ–­å¼€</span></span><br><span class="line">â”‚   â””â”€â”€ docker network <span class="built_in">rm</span> [ç½‘ç»œå]      <span class="comment"># åˆ é™¤ç½‘ç»œ</span></span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ Docker Compose (å®¹å™¨ç¼–æ’)</span><br><span class="line">â”‚   â”œâ”€â”€ docker compose up              <span class="comment"># åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ -d                         <span class="comment"># åå°è¿è¡Œ</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ --build                    <span class="comment"># å¯åŠ¨å‰é‡æ–°æ„å»ºé•œåƒ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose down            <span class="comment"># åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œ</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose ps              <span class="comment"># åˆ—å‡º compose é¡¹ç›®ä¸­çš„å®¹å™¨</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose logs [æœåŠ¡å]    <span class="comment"># æŸ¥çœ‹æœåŠ¡çš„æ—¥å¿—</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ -f                         <span class="comment"># å®æ—¶è·Ÿè¸ªæ—¥å¿—</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose <span class="built_in">exec</span> [æœåŠ¡å] [å‘½ä»¤] <span class="comment"># åœ¨æœåŠ¡å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose stop            <span class="comment"># åœæ­¢æœåŠ¡ï¼Œä¸åˆ é™¤å®¹å™¨</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose start           <span class="comment"># å¯åŠ¨å·²åœæ­¢çš„æœåŠ¡</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose restart         <span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">â”‚   â”œâ”€â”€ docker compose build           <span class="comment"># æ„å»ºæˆ–é‡æ–°æ„å»ºæœåŠ¡é•œåƒ</span></span><br><span class="line">â”‚   â””â”€â”€ docker compose pull            <span class="comment"># æ‹‰å–æœåŠ¡ä¾èµ–çš„é•œåƒ</span></span><br><span class="line">â”‚</span><br><span class="line">â””â”€â”€ ç³»ç»Ÿæ¸…ç†ä¸ä¿¡æ¯ (System &amp; Cleanup)</span><br><span class="line">    â”œâ”€â”€ docker system <span class="built_in">df</span>               <span class="comment"># æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼ˆé•œåƒã€å®¹å™¨ã€å·ï¼‰</span></span><br><span class="line">    â”œâ”€â”€ docker system prune            <span class="comment"># æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æº</span></span><br><span class="line">    â”‚   â”œâ”€â”€ -a                         <span class="comment"># åŒæ—¶æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ</span></span><br><span class="line">    â”‚   â””â”€â”€ --volumes                  <span class="comment"># åŒæ—¶æ¸…ç†æœªä½¿ç”¨çš„æ•°æ®å·ï¼ˆè°¨æ…ï¼ï¼‰</span></span><br><span class="line">    â””â”€â”€ docker version                 <span class="comment"># æ˜¾ç¤º Docker ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">    â””â”€â”€ docker info                    <span class="comment"># æ˜¾ç¤ºç³»ç»ŸèŒƒå›´çš„è¯¦ç»†ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>DockeråŸºç¡€å‘½ä»¤å…³ç³»ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20251019191540957.png" alt="image-20251019191540957"></p><h2 id="æ•°æ®å·"><a href="#æ•°æ®å·" class="headerlink" title="æ•°æ®å·"></a>æ•°æ®å·</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20251019191619185.png" alt="image-20251019191619185"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Docker </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MyBatisPlus</title>
      <link href="/2025/10/18/MyBatisPlus_Stream%E6%B5%81_Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2025/10/18/MyBatisPlus_Stream%E6%B5%81_Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="MybatisPlus"><a href="#MybatisPlus" class="headerlink" title="MybatisPlus"></a>MybatisPlus</h1><h2 id="MPå¼•å…¥"><a href="#MPå¼•å…¥" class="headerlink" title="MPå¼•å…¥"></a>MPå¼•å…¥</h2><p>Mpçš„ä½¿ç”¨ï¼š</p><p>1.mapperå±‚ï¼šç»§æ‰¿BasMapperæ¥å£</p><p>2.serviceå±‚ï¼šserviceæ¥å£å®ç°IServiceæ¥å£ï¼Œserviceå®ç°ç±»ç»§æ‰¿IServiceImplå®ç°ç±»</p><p>Mpå°†å®ä½“ç±»å’Œæ•°æ®åº“è¡¨æ˜å¯¹åº”çš„çº¦å®šï¼š</p><ul><li>MybatisPlusä¼šæŠŠPOå®ä½“çš„ç±»åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨å</li><li>MybatisPlusä¼šæŠŠPOå®ä½“çš„æ‰€æœ‰å˜é‡åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨çš„å­—æ®µåï¼Œå¹¶æ ¹æ®å˜é‡ç±»å‹æ¨æ–­å­—æ®µç±»å‹</li><li>MybatisPlusä¼šæŠŠåä¸ºidçš„å­—æ®µä½œä¸ºä¸»é”®</li></ul><p>å¸¸è§æ³¨è§£ï¼š</p><p>@TableName å½“å®ä½“ç±»åç§°å’Œæ•°æ®åº“åç§°ä¸ä¸€è‡´æ—¶ï¼Œä½¿ç”¨è¯¥æ³¨è§£å¯ä»¥æŒ‡å®šå®ä½“ç±»å¯¹åº”çš„æ•°æ®åº“è¡¨å</p><p>@TableId ä¸€ä¸ªä½œç”¨æ˜¯æŒ‡å®šidï¼Œå¦ä¸€ä¸ªä½œç”¨æ˜¯è§„å®šidçš„å¢é•¿é€»è¾‘ï¼Œæ²¡æœ‰æŒ‡å®šé»˜è®¤æ˜¯é›ªèŠ±ç®—æ³•ï¼š</p><table><thead><tr><th align="left"><strong>å€¼</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left">AUTO</td><td align="left">æ•°æ®åº“ ID è‡ªå¢</td></tr><tr><td align="left">NONE</td><td align="left">æ— çŠ¶æ€ï¼Œè¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹ï¼ˆæ³¨è§£é‡Œç­‰äºè·Ÿéšå…¨å±€ï¼Œå…¨å±€é‡Œçº¦ç­‰äº INPUTï¼‰</td></tr><tr><td align="left">INPUT</td><td align="left">insert å‰è‡ªè¡Œ set ä¸»é”®å€¼</td></tr><tr><td align="left">ASSIGN_ID</td><td align="left">åˆ†é… ID(ä¸»é”®ç±»å‹ä¸º Number(Long å’Œ Integer)æˆ– String)(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextId(é»˜è®¤å®ç°ç±»ä¸ºDefaultIdentifierGeneratoré›ªèŠ±ç®—æ³•)</td></tr><tr><td align="left">ASSIGN_UUID</td><td align="left">åˆ†é… UUID,ä¸»é”®ç±»å‹ä¸º String(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextUUID(é»˜è®¤ default æ–¹æ³•)</td></tr></tbody></table><p>@TableField æŒ‡å®šå­—æ®µåï¼Œå½“ç±»ä¸­æŸä¸ªå±æ€§å¹¶ä¸åœ¨è¡¨ä¸­çš„æ—¶å€™ï¼Œé€šè¿‡ exist å‚æ•°è®¾ç½®ä¸º false <strong>æ¥æ’é™¤åœ¨å¤–</strong>,æ³¨æ„å¿…é¡»è¿™ä¹ˆåšï¼Œä¸ç„¶ä¼šæŠ¥é”™</p><h2 id="MPæ ¸å¿ƒåŠŸèƒ½"><a href="#MPæ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="MPæ ¸å¿ƒåŠŸèƒ½"></a>MPæ ¸å¿ƒåŠŸèƒ½</h2><h3 id="æ¡ä»¶æ„é€ å™¨"><a href="#æ¡ä»¶æ„é€ å™¨" class="headerlink" title="æ¡ä»¶æ„é€ å™¨"></a>æ¡ä»¶æ„é€ å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AbstractWrapper</span><br><span class="line">    â”œâ”€â”€ QueryWrapper (æŸ¥è¯¢æ¡ä»¶å°è£…)</span><br><span class="line">    â”œâ”€â”€ UpdateWrapper (æ›´æ–°æ¡ä»¶å°è£…)</span><br><span class="line">    â””â”€â”€ LambdaWrapper</span><br><span class="line">        â”œâ”€â”€ LambdaQueryWrapper (Lambdaè¯­æ³•æŸ¥è¯¢)</span><br><span class="line">        â””â”€â”€ LambdaUpdateWrapper (Lambdaè¯­æ³•æ›´æ–°)</span><br></pre></td></tr></table></figure><ul><li><strong>é“¾å¼è°ƒç”¨</strong>ï¼šæ”¯æŒé“¾å¼ç¼–ç¨‹ï¼Œä»£ç æ›´ç®€æ´</li><li><strong>Lambdaæ”¯æŒ</strong>ï¼šé¿å…å­—æ®µåç¡¬ç¼–ç ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥</li><li><strong>é˜²SQLæ³¨å…¥</strong>ï¼šè‡ªåŠ¨å¤„ç†å‚æ•°ï¼Œé˜²æ­¢SQLæ³¨å…¥</li><li><strong>å¤šæ¡ä»¶ç»„åˆ</strong>ï¼šæ”¯æŒANDã€ORç­‰å¤æ‚é€»è¾‘ç»„åˆ</li></ul><h4 id="Query-Wrapper"><a href="#Query-Wrapper" class="headerlink" title="Query Wrapper"></a>Query Wrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//æ„é€ æŸ¥è¯¢æ¡ä»¶ï¼Œä¼ å…¥æ³›å‹</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;()</span><br><span class="line">            .select(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;username&quot;</span>, <span class="string">&quot;info&quot;</span>, <span class="string">&quot;balance&quot;</span>)</span><br><span class="line">            .like(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;o&quot;</span>)</span><br><span class="line">            .ge(<span class="string">&quot;balance&quot;</span>, <span class="number">1000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿™é‡Œä»€ä¹ˆä¹Ÿä¸ç”¨å¹²ï¼Œå› ä¸ºselectList(wrapper)ä¹Ÿæ˜¯MPå®šä¹‰å¥½çš„ï¼Œæ˜¯mapperå±‚ç»§æ‰¿è‡ªBaseMapperè·å¾—çš„æ–¹æ³•</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="UpdateWrapper"><a href="#UpdateWrapper" class="headerlink" title="UpdateWrapper"></a>UpdateWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿™å¥ä»£ç åˆ©ç”¨ Java 9 çš„ List.of() å·¥å‚æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« 1Lã€2L å’Œ 4L è¿™ä¸‰ä¸ª Long ç±»å‹å…ƒç´ çš„ä¸å¯å˜åˆ—è¡¨ ids</span></span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">3L</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">Integer</span> <span class="variable">fangzhuru</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ„é€ æ›´æ–°æ¡ä»¶</span></span><br><span class="line">    UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>()</span><br><span class="line">        <span class="comment">//set(&quot;balance&quot;, 100)ä¼šå°†ä½™é¢ç›´æ¥è¦†ç›–ä¸º 100ï¼Œè€Œä¸æ˜¯åœ¨ç°æœ‰å€¼åŸºç¡€ä¸Šå¢åŠ  100</span></span><br><span class="line">        .setSql(<span class="string">&quot;balance = balance - &#123;0&#125;&quot;</span>,fangzhuru)  <span class="comment">//setSqlç›´æ¥æ‹¼æ¥setè¯­å¥  &#123;0&#125;,&#123;1&#125;...æ˜¯MPçš„å ä½ç¬¦</span></span><br><span class="line">        .in(<span class="string">&quot;id&quot;</span>,ids);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•° null è¡¨ç¤ºä¸ä½¿ç”¨å®ä½“å¯¹è±¡çš„å­—æ®µè¿›è¡Œæ›´æ–°ï¼Œè€Œæ˜¯å®Œå…¨ä¾èµ–äº UpdateWrapper ä¸­è®¾ç½®çš„æ¡ä»¶å’Œ setSql è¯­å¥</span></span><br><span class="line">    userMapper.update(<span class="literal">null</span>,wrapper);</span><br><span class="line">    <span class="comment">//å¦‚æœè¿™é‡Œæ²¡æœ‰ç”¨setSqlï¼Œè€Œæ˜¯ç”¨ç®€å•çš„æ›´æ–°ä¸€ä¸ªbalanceä¸ºuserå¯¹è±¡ä¸­ç°æˆçš„å±æ€§å€¼çš„è¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±ä¼ å…¥Userï¼Œå¦‚ï¼š</span></span><br><span class="line">   userMapper.update(User,<span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;User&gt;().in(<span class="string">&quot;id&quot;</span>,ids));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="LambdaQueryWrapper"><a href="#LambdaQueryWrapper" class="headerlink" title="LambdaQueryWrapper"></a>LambdaQueryWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨lambdaè¡¨è¾¾å¼å°†quarymapperæ”¹é€ å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testLambdaQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæ¡ä»¶ WHERE username LIKE &quot;%o%&quot; AND balance &gt;= 1000</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    wrapper.lambda()</span><br><span class="line">            .select(User::getId, User::getUsername, User::getInfo, User::getBalance)</span><br><span class="line">            .like(User::getUsername, <span class="string">&quot;o&quot;</span>)</span><br><span class="line">            .ge(User::getBalance, <span class="number">1000</span>);</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢</span></span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰Sql"><a href="#è‡ªå®šä¹‰Sql" class="headerlink" title="è‡ªå®šä¹‰Sql"></a>è‡ªå®šä¹‰Sql</h3><p>ä¸Šé¢çš„æ¡ˆä¾‹ä¸­çš„Updateé‚£é‡Œçš„setSqlæ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨serviceå±‚å†™äº†Sqlè¯­å¥ï¼Œè¿™æ˜¯ä¸ç¬¦åˆè§„èŒƒçš„</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„<strong>ç›®çš„æ˜¯ä½¿ç”¨IServiceä¸­çš„å¥½ç”¨æ¡ä»¶è¯­å¥</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p><p>æŠŠæ¡ä»¶è¯­å¥å°è£…åˆ°wrapperä¸­ï¼Œç„¶å<strong>ä¼ é€’</strong>ä¸‹å»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//serviceå±‚ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">3L</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å°è£…ä¸€ä¸ªæŸ¥è¯¢wrapper</span></span><br><span class="line">    QueryWrapper&lt;User&gt; QueryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span></span><br><span class="line">        .in(<span class="string">&quot;id&quot;</span>,ids);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è°ƒç”¨mapperå±‚æˆ‘ä»¬è‡ªå·±çš„è‡ªå®šä¹‰æ–¹æ³•</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.deductBalanceByIds(<span class="number">200</span>,wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mapperå±‚</span></span><br><span class="line"><span class="comment">//æˆ‘ä»¬çš„è‡ªå®šä¹‰æ–¹æ³•</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set balance = balance - #&#123;money&#125; $&#123;ew.customWrapperSegment&#125;&quot;)</span> <span class="comment">//åˆ€ä¹ç¬¦åŠä»¥åçš„è¯­æ³•ç¡¬æ€§çº¦å®š</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">deductBalanceByIds</span><span class="params">(<span class="meta">@Param(&quot;money&quot;)</span>Integer money, <span class="meta">@Param(&quot;ew&quot;)</span> QueryWrapper&lt;User&gt; QueryWrapper)</span>; <span class="comment">//ew ç¡¬æ€§çº¦å®š</span></span><br></pre></td></tr></table></figure><h4 id="å¤šè¡¨è”æŸ¥"><a href="#å¤šè¡¨è”æŸ¥" class="headerlink" title="å¤šè¡¨è”æŸ¥"></a>å¤šè¡¨è”æŸ¥</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‡è®¾æœ‰ç”¨æˆ·è¡¨å’Œåœ°å€è¡¨ï¼Œæˆ‘ä»¬è¦æŸ¥ç”¨æˆ·idåœ¨ä¸€å®šèŒƒå›´å†…ï¼Œä¸”åœ°å€åœ¨æŸä¸€å¤„çš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment">//serviceå±‚</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testJoinWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">3L</span>); </span><br><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>()</span><br><span class="line">        .in(<span class="string">&quot;u.id&quot;</span>,ids);</span><br><span class="line">    .eq(<span class="string">&quot;a.city&quot;</span>,<span class="string">&quot;åŒ—äº¬&quot;</span>);</span><br><span class="line">    List&lt;User&gt; userlist = userMapper.getUsersByIdAndAddress(wrapper);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mapperå±‚</span></span><br><span class="line"><span class="meta">@Select(&quot;Select u.* from user u Left join address a on a.user_id = u.id $&#123;ew.customWrapperSegment&#125;&quot;)</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUsersByIdAndAddress</span> <span class="params">(<span class="meta">@Param(&quot;ew&quot;)</span>QueryWrapper&lt;User&gt; QueryWrapper)</span>;</span><br></pre></td></tr></table></figure><h3 id="Serviceæ¥å£"><a href="#Serviceæ¥å£" class="headerlink" title="Serviceæ¥å£"></a>Serviceæ¥å£</h3><p>serviceæ¥å£å¯ä»¥è®©å¾ˆå¤šç®€å•çš„å•è¡¨curdï¼Œç›´æ¥åœ¨controlleré‡Œå°±èƒ½å®Œæˆ</p><h4 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h4><p>ç›´æ¥çœ‹ä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœªä½¿ç”¨Lambda</span></span><br><span class="line"><span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUsers</span><span class="params">(UserQuery query)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.ç»„ç»‡æ¡ä»¶</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> query.getName();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> query.getStatus();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">minBalance</span> <span class="operator">=</span> query.getMinBalance();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">maxBalance</span> <span class="operator">=</span> query.getMaxBalance();</span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;().lambda()</span><br><span class="line">            .like(username != <span class="literal">null</span>, User::getUsername, username)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .ge(minBalance != <span class="literal">null</span>, User::getBalance, minBalance)</span><br><span class="line">            .le(maxBalance != <span class="literal">null</span>, User::getBalance, maxBalance);</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">    List&lt;User&gt; users = userService.list(wrapper);</span><br><span class="line">    <span class="comment">// 3.å¤„ç†vo</span></span><br><span class="line">    <span class="keyword">return</span> BeanUtil.copyToList(users, UserVO.class);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> <span class="comment">//ä½¿ç”¨Lambda</span></span><br><span class="line"><span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUsers</span><span class="params">(UserQuery query)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.ç»„ç»‡æ¡ä»¶</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> query.getName();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> query.getStatus();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">minBalance</span> <span class="operator">=</span> query.getMinBalance();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">maxBalance</span> <span class="operator">=</span> query.getMaxBalance();</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">    List&lt;User&gt; users = userService.lambdaQuery()</span><br><span class="line">            .like(username != <span class="literal">null</span>, User::getUsername, username)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .ge(minBalance != <span class="literal">null</span>, User::getBalance, minBalance)</span><br><span class="line">            .le(maxBalance != <span class="literal">null</span>, User::getBalance, maxBalance)</span><br><span class="line">            .list();</span><br><span class="line">    <span class="comment">// 3.å¤„ç†vo</span></span><br><span class="line">    <span class="keyword">return</span> BeanUtil.copyToList(users, UserVO.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œlambdaçœç•¥äº†è‡ªå®šä¹‰wrapperå’Œè°ƒç”¨serviceæŸ¥è¯¢æ¥å£ä¼ å…¥wrapperçš„è¿‡ç¨‹</p><p>ç›´æ¥ç”¨IServiceæ¥å£ä¸­çš„lambdaQueryæ–¹æ³•ï¼Œæœ€åä¸€ä¸ª.list()æŠŠè¿”å›å€¼ä¹Ÿè·å¾—äº†</p><p>å¾—åˆ°ç»“æœçš„ä¸€æ­¥ä¸ä»…å¯ä»¥ç”¨<code>list()</code>ï¼Œå¯é€‰çš„æ–¹æ³•æœ‰ï¼š</p><ul><li><code>.one()</code>ï¼šæœ€å¤š1ä¸ªç»“æœ</li><li><code>.list()</code>ï¼šè¿”å›é›†åˆç»“æœ</li><li><code>.count()</code>ï¼šè¿”å›è®¡æ•°ç»“æœ</li></ul><p>MybatisPlusä¼šæ ¹æ®é“¾å¼ç¼–ç¨‹çš„æœ€åä¸€ä¸ªæ–¹æ³•æ¥åˆ¤æ–­æœ€ç»ˆçš„è¿”å›ç»“æœ</p><h3 id="æ‰¹å¤„ç†"><a href="#æ‰¹å¤„ç†" class="headerlink" title="æ‰¹å¤„ç†"></a>æ‰¹å¤„ç†</h3><p>åœ¨jdbcçš„urlåé¢æ·»åŠ å‚æ•°<code>&amp;rewriteBatchedStatements=true</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/mp?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai&amp;rewriteBatchedStatements=true</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">MySQL123</span></span><br></pre></td></tr></table></figure><h2 id="æ‰©å±•åŠŸèƒ½"><a href="#æ‰©å±•åŠŸèƒ½" class="headerlink" title="æ‰©å±•åŠŸèƒ½"></a>æ‰©å±•åŠŸèƒ½</h2><h3 id="é™æ€å·¥å…·"><a href="#é™æ€å·¥å…·" class="headerlink" title="é™æ€å·¥å…·"></a>é™æ€å·¥å…·</h3><p>serviceä¹‹é—´å¦‚æœç›¸äº’è°ƒç”¨ï¼Œå°±å¯èƒ½å‡ºç°é—®é¢˜ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡@Lazyæ³¨è§£è§£å†³ï¼‰</p><p>MybatisPlusæä¾›ä¸€ä¸ªé™æ€å·¥å…·ç±»ï¼šDbï¼Œå…¶ä¸­çš„ä¸€äº›é™æ€æ–¹æ³•ä¸ IService ä¸­æ–¹æ³•ç­¾ååŸºæœ¬ä¸€è‡´</p><p>ç›¸æ¯”äºä½¿ç”¨IServiceæ¥å£ä¸­çš„æ–¹æ³•ï¼Œä½¿ç”¨Dbä¸­çš„æ–¹æ³•ä¸åŒä¹‹å¤„å°±åœ¨äºï¼Œè¦å¤šä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼šç›®æ ‡å®ä½“å¯¹è±¡çš„ç±»çš„å­—èŠ‚ç ï¼Œå› ä¸ºé™æ€æ–¹æ³•ä¸çŸ¥é“ä½ è¦ç”¨å“ªä¸ªç±»æ¥å’Œæ•°æ®åº“æ˜ å°„</p><h3 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h3><p>å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šé‡‡ç”¨é€»è¾‘åˆ é™¤çš„æ–¹æ¡ˆï¼Œå³ï¼š</p><ul><li>åœ¨è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µæ ‡è®°æ•°æ®æ˜¯å¦è¢«åˆ é™¤</li><li>å½“åˆ é™¤æ•°æ®æ—¶æŠŠæ ‡è®°ç½®ä¸ºtrue</li><li>æŸ¥è¯¢æ—¶è¿‡æ»¤æ‰æ ‡è®°ä¸ºtrueçš„æ•°æ®</li><li><strong>æ³¨æ„</strong>ï¼Œåªæœ‰MybatisPlusç”Ÿæˆçš„SQLè¯­å¥æ‰æ”¯æŒè‡ªåŠ¨çš„é€»è¾‘åˆ é™¤ï¼Œè‡ªå®šä¹‰SQLéœ€è¦è‡ªå·±æ‰‹åŠ¨å¤„ç†é€»è¾‘åˆ é™¤</li></ul><p>åœ¨application.ymlä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">deleted</span> <span class="comment"># å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå(since 3.3.0,é…ç½®åå¯ä»¥å¿½ç•¥ä¸é…ç½®æ­¥éª¤2)</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span> <span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span> <span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)</span></span><br></pre></td></tr></table></figure><h3 id="é€šç”¨æšä¸¾"><a href="#é€šç”¨æšä¸¾" class="headerlink" title="é€šç”¨æšä¸¾"></a>é€šç”¨æšä¸¾</h3><p>å®šä¹‰ä¸€ä¸ªæšä¸¾ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.mp.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.EnumValue;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UserStatus</span> &#123;</span><br><span class="line">    NORMAL(<span class="number">1</span>, <span class="string">&quot;æ­£å¸¸&quot;</span>),</span><br><span class="line">    FREEZE(<span class="number">2</span>, <span class="string">&quot;å†»ç»“&quot;</span>)</span><br><span class="line">    ;</span><br><span class="line">    <span class="meta">@EnumValue</span> <span class="comment">//ä½¿ç”¨è¿™ä¸ªæ³¨è§£å‘Šè¯‰MPç”¨int valueå­—æ®µå’Œæ•°æ®åº“åŒ¹é…</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="meta">@JsonValue</span> <span class="comment">//ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œå°±å¯ä»¥è®©VOå¯¹è±¡åœ¨jsonåºåˆ—åŒ–çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªString descå­—æ®µ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line"></span><br><span class="line">    UserStatus(<span class="type">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æŠŠç”¨æˆ·ç±»ä¸­çš„statuså­—æ®µçš„ç±»å‹ç”±Integeræ”¹ä¸º UserStatus ï¼Œæ›´åŠ ç›´è§‚</p><p>é‚£ä¹ˆå¦‚ä½•è®©MPèƒ½æŠŠæ•°æ®åº“ä¸­çš„å®é™…ç±»å‹ä¸ºæ•´æ•°çš„statuså’Œæšä¸¾ç±»å‹å¯¹ä¸Šï¼Ÿ</p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨æšä¸¾ç±»å‹ä¸­ä½¿ç”¨æ³¨è§£ï¼š@EnumValueï¼Œæ ‡æ³¨çš„å±æ€§æ˜¯å®é™…å’Œæ•°æ®åº“ç›¸åŒ¹é…çš„å±æ€§</p><p>ç¬¬äºŒéƒ¨ï¼Œé…ç½®æšä¸¾å¤„ç†å™¨ï¼Œä¾æ—§æ·»åŠ application.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">default-enum-type-handler:</span> <span class="string">com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¿”å›å€¼VOä¸­çš„statuså­—æ®µä¹Ÿæ”¹æˆæšä¸¾ç±»å‹ï¼Œé‚£ä¹ˆåœ¨å®é™…è¿”å›çš„æ—¶å€™ï¼Œå¦‚ä½•æŒ‡å®šjsonåºåˆ—åŒ–æ—¶ï¼Œä½¿ç”¨çš„å®é™…å±æ€§ï¼Ÿ</p><p>ä½¿ç”¨ @JsonValue æ³¨è§£ï¼Œï¼ˆè¿™ä¸ªæ³¨è§£æ˜¯springmvcçš„ï¼Œä¸æ˜¯MPçš„ï¼‰</p><h3 id="JSONç±»å‹å¤„ç†å™¨"><a href="#JSONç±»å‹å¤„ç†å™¨" class="headerlink" title="JSONç±»å‹å¤„ç†å™¨"></a>JSONç±»å‹å¤„ç†å™¨</h3><p>å‡è®¾ç°åœ¨userè¡¨ä¸­æœ‰ä¸€ä¸ªinfoå­—æ®µï¼Œæ˜¯jsonç±»å‹ï¼Œuserä¸­å´æ˜¯Stringç±»å‹ï¼Œé‚£æ‹†åˆ†æ•°æ®å°±ä¼šå¾ˆéº»çƒ¦</p><p>MPæä¾›äº†jsonç±»å‹å¤„ç†å™¨ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬è‡ªå·±å®šä¹‰ä¸€ä¸ªå®ä½“ç±»UserInfoï¼Œå±æ€§å’Œjsonå­—æ®µç›¸å¯¹åº”</p><p>ç¬¬äºŒæ­¥ï¼ŒæŠŠuserç±»ä¸­çš„infoå­—æ®µæ”¹ä¸ºUserInfoç±»å‹çš„ï¼Œå¹¶åŠ ä¸Šæ³¨è§£ <strong>@TableField(typeHandler &#x3D; JacksonTypeHandler.class)</strong></p><p>ç¬¬ä¸‰æ­¥ï¼Œåœ¨userç±»ä¸ŠåŠ ä¸€ä¸ªæ³¨è§£ï¼Œå£°æ˜è‡ªåŠ¨æ˜ å°„ @TableName(value &#x3D; â€œuserâ€, autoResultMap &#x3D; true)</p><h2 id="æ’ä»¶åŠŸèƒ½"><a href="#æ’ä»¶åŠŸèƒ½" class="headerlink" title="æ’ä»¶åŠŸèƒ½"></a>æ’ä»¶åŠŸèƒ½</h2><h3 id="åˆ†é¡µæ’ä»¶"><a href="#åˆ†é¡µæ’ä»¶" class="headerlink" title="åˆ†é¡µæ’ä»¶"></a>åˆ†é¡µæ’ä»¶</h3><p>è‡ªå®šä¹‰ä¸€ä¸ªé…ç½®ç±»ï¼Œé…ç½®åˆ†é¡µæ’ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.mp.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–æ ¸å¿ƒæ’ä»¶</span></span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ åˆ†é¡µæ’ä»¶</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹ç›¸å½“äºæœ‰ä¸¤å±‚ï¼Œæ³¨å…¥äº†ä¸€ä¸ªMPçš„æ‹¦æˆªå™¨æ€»å¯¹è±¡ï¼Œè¿™ä¸ªæ€»å¯¹è±¡è¿˜å¯ä»¥addå°å¯¹è±¡ï¼Œè¿™é‡Œå°±æ˜¯addäº†ä¸€ä¸ªåˆ†é¡µæ’ä»¶å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>, pageSize = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// åˆ†é¡µå‚æ•°</span></span><br><span class="line">Page&lt;User&gt; page = Page.of(pageNo, pageSize);  </span><br><span class="line"><span class="comment">// æ’åºå‚æ•°, é€šè¿‡OrderItemæ¥æŒ‡å®š</span></span><br><span class="line">page.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(<span class="string">&quot;balance&quot;</span>, <span class="literal">false</span>));</span><br><span class="line"></span><br><span class="line">userService.page(page);  <span class="comment">//pageæ–¹æ³•ç›´æ¥ä¿®æ”¹å‚æ•°å¯¹è±¡</span></span><br></pre></td></tr></table></figure><h3 id="é€šç”¨åˆ†é¡µå®ä½“"><a href="#é€šç”¨åˆ†é¡µå®ä½“" class="headerlink" title="é€šç”¨åˆ†é¡µå®ä½“"></a>é€šç”¨åˆ†é¡µå®ä½“</h3><p>pageQueryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.mp.domain.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageQuery</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer pageNo;</span><br><span class="line">    <span class="keyword">private</span> Integer pageSize;</span><br><span class="line">    <span class="keyword">private</span> String sortBy;</span><br><span class="line">    <span class="keyword">private</span> Boolean isAsc;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt;  Page&lt;T&gt; <span class="title function_">toMpPage</span><span class="params">(OrderItem ... orders)</span>&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ†é¡µæ¡ä»¶</span></span><br><span class="line">        Page&lt;T&gt; p = Page.of(pageNo, pageSize);</span><br><span class="line">        <span class="comment">// 2.æ’åºæ¡ä»¶</span></span><br><span class="line">        <span class="comment">// 2.1.å…ˆçœ‹å‰ç«¯æœ‰æ²¡æœ‰ä¼ æ’åºå­—æ®µ</span></span><br><span class="line">        <span class="keyword">if</span> (sortBy != <span class="literal">null</span>) &#123;</span><br><span class="line">            p.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(sortBy, isAsc));</span><br><span class="line">            <span class="keyword">return</span> p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.2.å†çœ‹æœ‰æ²¡æœ‰æ‰‹åŠ¨æŒ‡å®šæ’åºå­—æ®µ</span></span><br><span class="line">        <span class="keyword">if</span>(orders != <span class="literal">null</span>)&#123;</span><br><span class="line">            p.addOrder(orders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPage</span><span class="params">(String defaultSortBy, <span class="type">boolean</span> isAsc)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.toMpPage(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(defaultSortBy, isAsc));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPageDefaultSortByCreateTimeDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toMpPage(<span class="string">&quot;create_time&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPageDefaultSortByUpdateTimeDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toMpPage(<span class="string">&quot;update_time&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pageDTOï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.mp.domain.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Function;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageDTO</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Long total;</span><br><span class="line">    <span class="keyword">private</span> Long pages;</span><br><span class="line">    <span class="keyword">private</span> List&lt;V&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ç©ºåˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> p MybatisPlusçš„åˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;V&gt; ç›®æ ‡VOç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;P&gt; åŸå§‹POç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> VOçš„åˆ†é¡µå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;V, P&gt; PageDTO&lt;V&gt; <span class="title function_">empty</span><span class="params">(Page&lt;P&gt; p)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;(p.getTotal(), p.getPages(), Collections.emptyList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†MybatisPlusåˆ†é¡µç»“æœè½¬ä¸º VOåˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> p MybatisPlusçš„åˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> voClass ç›®æ ‡VOç±»å‹çš„å­—èŠ‚ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;V&gt; ç›®æ ‡VOç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;P&gt; åŸå§‹POç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> VOçš„åˆ†é¡µå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;V, P&gt; PageDTO&lt;V&gt; <span class="title function_">of</span><span class="params">(Page&lt;P&gt; p, Class&lt;V&gt; voClass)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.éç©ºæ ¡éªŒ</span></span><br><span class="line">        List&lt;P&gt; records = p.getRecords();</span><br><span class="line">        <span class="keyword">if</span> (records == <span class="literal">null</span> || records.size() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ— æ•°æ®ï¼Œè¿”å›ç©ºç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> empty(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.æ•°æ®è½¬æ¢</span></span><br><span class="line">        List&lt;V&gt; vos = BeanUtil.copyToList(records, voClass);</span><br><span class="line">        <span class="comment">// 3.å°è£…è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;(p.getTotal(), p.getPages(), vos);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†MybatisPlusåˆ†é¡µç»“æœè½¬ä¸º VOåˆ†é¡µç»“æœï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰POåˆ°VOçš„è½¬æ¢æ–¹å¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> p MybatisPlusçš„åˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> convertor POåˆ°VOçš„è½¬æ¢å‡½æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;V&gt; ç›®æ ‡VOç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;P&gt; åŸå§‹POç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> VOçš„åˆ†é¡µå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;V, P&gt; PageDTO&lt;V&gt; <span class="title function_">of</span><span class="params">(Page&lt;P&gt; p, Function&lt;P, V&gt; convertor)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.éç©ºæ ¡éªŒ</span></span><br><span class="line">        List&lt;P&gt; records = p.getRecords();</span><br><span class="line">        <span class="keyword">if</span> (records == <span class="literal">null</span> || records.size() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ— æ•°æ®ï¼Œè¿”å›ç©ºç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> empty(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.æ•°æ®è½¬æ¢</span></span><br><span class="line">        List&lt;V&gt; vos = records.stream().map(convertor).collect(Collectors.toList());</span><br><span class="line">        <span class="comment">// 3.å°è£…è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;(p.getTotal(), p.getPages(), vos);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸šåŠ¡å±‚ä¾¿å¯ç®€åŒ–ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> PageDTO&lt;UserVO&gt; <span class="title function_">queryUserByPage</span><span class="params">(PageQuery query)</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæ¡ä»¶</span></span><br><span class="line">    Page&lt;User&gt; page = query.toMpPageDefaultSortByCreateTimeDesc();</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢</span></span><br><span class="line">    page(page);</span><br><span class="line">    <span class="comment">// 3.å°è£…è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> PageDTO.of(page, UserVO.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰æœ€ååˆ°voçš„è½¬æ¢è¿‡ç¨‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> PageDTO&lt;UserVO&gt; <span class="title function_">queryUserByPage</span><span class="params">(PageQuery query)</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæ¡ä»¶</span></span><br><span class="line">    Page&lt;User&gt; page = query.toMpPageDefaultSortByCreateTimeDesc();</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢</span></span><br><span class="line">    page(page);</span><br><span class="line">    <span class="comment">// 3.å°è£…è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> PageDTO.of(page, user -&gt; &#123;</span><br><span class="line">        <span class="comment">// æ‹·è´å±æ€§åˆ°VO</span></span><br><span class="line">        <span class="type">UserVO</span> <span class="variable">vo</span> <span class="operator">=</span> BeanUtil.copyProperties(user, UserVO.class);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·åè„±æ•</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> vo.getUsername();</span><br><span class="line">        vo.setUsername(username.substring(<span class="number">0</span>, username.length() - <span class="number">2</span>) + <span class="string">&quot;**&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> vo;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Streamæµ"><a href="#Streamæµ" class="headerlink" title="Streamæµ"></a>Streamæµ</h1><h1 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h1>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> Lambdaè¡¨è¾¾å¼ </tag>
            
            <tag> Streamæµ </tag>
            
            <tag> MybatisPlus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GORM</title>
      <link href="/2025/09/15/GORM/"/>
      <url>/2025/09/15/GORM/</url>
      
        <content type="html"><![CDATA[<h1 id="GORM"><a href="#GORM" class="headerlink" title="GORM"></a>GORM</h1><h2 id="å¿«é€Ÿä½¿ç”¨"><a href="#å¿«é€Ÿä½¿ç”¨" class="headerlink" title="å¿«é€Ÿä½¿ç”¨"></a>å¿«é€Ÿä½¿ç”¨</h2><p>å¯¼åŒ…</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">  <span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="æ¨¡å‹ç›¸å…³"><a href="#æ¨¡å‹ç›¸å…³" class="headerlink" title="æ¨¡å‹ç›¸å…³"></a>æ¨¡å‹ç›¸å…³</h3><p>ä¸€è¨€ä»¥è”½ä¹‹ï¼ŒGORMä¸­ï¼Œä½¿ç”¨æ¨¡å‹<strong>æ‰€å®ç°çš„æ•ˆæœ</strong>ï¼Œå°±ç›¸å½“äº Java Mybatis ä¸­ï¼Œè‡ªåŠ¨æŠŠå¯¹è±¡ä¸­çš„å±æ€§å˜æˆ æ•°æ®åº“å­—æ®µ &#x2F;æŠŠæ•°æ®åº“å­—æ®µå˜æˆå±æ€§</p><h4 id="åç§°ç›¸å…³"><a href="#åç§°ç›¸å…³" class="headerlink" title="åç§°ç›¸å…³"></a>åç§°ç›¸å…³</h4><ol><li>å±æ€§å &#x2F; å­—æ®µå</li></ol><p>GORMä¸­ä¹Ÿå®ç°äº† ç»“æ„ä½“å­—æ®µé©¼å³°å‘½å &lt;â€”â€”&gt; æ•°æ®åº“å­—æ®µ å°å†™+ä¸‹åˆ’çº¿ å‘½åçš„ç›¸äº’è½¬åŒ–</p><p>å¦‚æœç»“æ„ä½“ä¸­çš„å‘½åå’Œæ•°æ®åº“å­—æ®µå‘½åä¸åªæ˜¯è¿™ç§å·®å¼‚ï¼Œåˆ™é»˜è®¤æ— æ³•æ˜ å°„</p><p>åœ¨Javaä¸­ï¼Œå¯¹äºè¿™æ ·çš„å­—æ®µæˆ‘ä»¬ä½¿ç”¨@Paramæ³¨è§£ï¼Œè€Œåœ¨goä¸­ï¼Œæˆ‘ä»¬ä¸ºç»“æ„ä½“å‚æ•°é…ç½®Tagï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CreateTime <span class="type">int64</span> <span class="string">`gorm:&quot;column:createtime&quot;`</span> <span class="comment">//å¿…é¡»æŠŠcolumnåŠ ä¸Š</span></span><br></pre></td></tr></table></figure><p>è€Œgoçš„Tagè¿˜ä¸æ­¢è¿™ä¸€ä¸ªä½œç”¨ï¼Œå› ä¸ºgormè¿˜å¯ä»¥åˆ›å»ºè¡¨ï¼Œæ‰€ä»¥åé¢è¿˜å¯ä»¥è·Ÿå»ºè¡¨å±æ€§</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gorm:<span class="string">&quot;column:id; PRIMARY_KEY&quot;</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œæœ‰çš„æ—¶å€™ç»“æ„ä½“å’Œæ•°æ®åº“å¹¶ä¸æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å€ŸåŠ©æƒé™æ§åˆ¶ï¼šï¼ˆè™½ç„¶ä¸ç”¨é»˜è®¤ä¹Ÿä¸æŠ¥é”™ï¼‰</p><table><thead><tr><th><code>&lt;-</code></th><th>å…è®¸å­—æ®µè¢«å†™å…¥ï¼ˆé»˜è®¤å€¼ï¼š<code>create,update</code>ï¼‰</th><th><code>gorm:&quot;&lt;-:create&quot;</code>ï¼ˆä»…å…è®¸åˆ›å»ºæ—¶å†™å…¥ï¼‰</th></tr></thead><tbody><tr><td><code>&lt;-:create</code></td><td><strong>åªå†™</strong>ï¼ˆä»…åœ¨åˆ›å»ºæ—¶å…è®¸å†™å…¥ï¼‰</td><td><code>Password string gorm:&quot;&lt;-:create&quot;</code></td></tr><tr><td><code>&lt;-:update</code></td><td><strong>åªå†™</strong>ï¼ˆä»…åœ¨æ›´æ–°æ—¶å…è®¸å†™å…¥ï¼‰</td><td><code>Token string gorm:&quot;&lt;-:update&quot;</code></td></tr><tr><td><code>&lt;-:false</code></td><td><strong>ç¦æ­¢å†™å…¥</strong>ï¼ˆå®Œå…¨ä¸å¯ä¿®æ”¹ï¼‰</td><td><code>CreatedAt time.Time gorm:&quot;&lt;-:false&quot;</code></td></tr><tr><td><code>-&gt;</code></td><td>å…è®¸å­—æ®µè¢«è¯»å–ï¼ˆé»˜è®¤å€¼ï¼š<code>true</code>ï¼‰</td><td><code>gorm:&quot;-&gt;:false&quot;</code>ï¼ˆç¦æ­¢è¯»å–ï¼‰</td></tr><tr><td><code>-&gt;:false</code></td><td><strong>åªå†™å­—æ®µ</strong>ï¼ˆå¯å­˜å…¥æ•°æ®åº“ï¼Œä½†æŸ¥è¯¢æ—¶ä¸è¿”å›ï¼‰</td><td><code>Secret string gorm:&quot;-&gt;:false&quot;</code></td></tr><tr><td><code>-</code></td><td><strong>å®Œå…¨å¿½ç•¥</strong>ï¼ˆä¸å‚ä¸è¯»å†™å’Œè¿ç§»ï¼‰</td><td><code>TempField string gorm:&quot;-&quot;</code></td></tr></tbody></table><h4 id="è‡ªå¸¦æ—¶é—´æ›´æ–°"><a href="#è‡ªå¸¦æ—¶é—´æ›´æ–°" class="headerlink" title="è‡ªå¸¦æ—¶é—´æ›´æ–°"></a>è‡ªå¸¦æ—¶é—´æ›´æ–°</h4><p>GORM è‡ªå¸¦ä¸€ä¸ªç»“æ„ä½“é•¿è¿™æ ·ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gorm.Model çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">type</span> Model <span class="keyword">struct</span> &#123;</span><br><span class="line">  ID        <span class="type">uint</span>           <span class="string">`gorm:&quot;primaryKey&quot;`</span></span><br><span class="line">  CreatedAt time.Time</span><br><span class="line">  UpdatedAt time.Time</span><br><span class="line">  DeletedAt gorm.DeletedAt <span class="string">`gorm:&quot;index&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æƒ³ä½¿ç”¨çš„è¯ç›´æ¥æŠŠä»–åµŒå…¥æˆ‘ä»¬è‡ªå·±çš„ç»“æ„ä½“å³å¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model <span class="comment">// åµŒå…¥gorm.Modelçš„å­—æ®µ</span></span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GORM çº¦å®šä½¿ç”¨ CreatedAtã€UpdatedAt è¿½è¸ªåˆ›å»º&#x2F;æ›´æ–°æ—¶é—´ã€‚å¦‚æœå®šä¹‰äº†è¿™ç§å­—æ®µï¼ŒGORM åœ¨åˆ›å»ºã€æ›´æ–°æ—¶ä¼šè‡ªåŠ¨å¡«å……å½“å‰æ—¶é—´ï¼Œè¦ä½¿ç”¨ä¸åŒåç§°çš„å­—æ®µï¼Œå¯ä»¥ç”¨tagè‡ªå·±æŒ‡å®šé…ç½® autoCreateTimeã€autoUpdateTime æ ‡ç­¾</p><h2 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h2><h3 id="DSNæ ¼å¼ï¼š"><a href="#DSNæ ¼å¼ï¼š" class="headerlink" title="DSNæ ¼å¼ï¼š"></a>DSNæ ¼å¼ï¼š</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  charset=utf8 å®¢æˆ·ç«¯å­—ç¬¦é›†ä¸ºutf8</span></span><br><span class="line"><span class="comment">//  parseTime=true æ”¯æŒæŠŠæ•°æ®åº“datetimeå’Œdateç±»å‹è½¬æ¢ä¸ºgolangçš„time.Timeç±»å‹</span></span><br><span class="line"><span class="comment">//  loc=Local ä½¿ç”¨ç³»ç»Ÿæœ¬åœ°æ—¶åŒº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å‘çš„æ—¶å€™ç»å¸¸éœ€è¦è®¾ç½®æ•°æ®åº“è¿æ¥è¶…æ—¶å‚æ•°ï¼Œgormæ˜¯é€šè¿‡dsnçš„timeoutå‚æ•°é…ç½®ï¼Œä¾‹å¦‚ï¼Œè®¾ç½®10ç§’åè¿æ¥è¶…æ—¶ï¼Œtimeout=10s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// readTimeout - è¯»è¶…æ—¶æ—¶é—´ï¼Œ0ä»£è¡¨ä¸é™åˆ¶ï¼ŒwriteTimeout - å†™è¶…æ—¶æ—¶é—´ï¼Œ0ä»£è¡¨ä¸é™åˆ¶</span></span><br><span class="line"></span><br><span class="line">root:<span class="number">123456</span>@tcp(localhost:<span class="number">3306</span>)/tizi365?charset=utf8&amp;parseTime=True&amp;loc=Local&amp;timeout=<span class="number">10</span>s&amp;readTimeout=<span class="number">30</span>s&amp;writeTimeout=<span class="number">60</span>s</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®Œæ•´é“¾æ¥ç¤ºæ„ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">  <span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    <span class="comment">//é…ç½®MySQLè¿æ¥å‚æ•°</span></span><br><span class="line">username := <span class="string">&quot;root&quot;</span>  <span class="comment">//è´¦å·</span></span><br><span class="line">password := <span class="string">&quot;123456&quot;</span> <span class="comment">//å¯†ç </span></span><br><span class="line">host := <span class="string">&quot;127.0.0.1&quot;</span> <span class="comment">//æ•°æ®åº“åœ°å€ï¼Œå¯ä»¥æ˜¯Ipæˆ–è€…åŸŸå</span></span><br><span class="line">port := <span class="number">3306</span> <span class="comment">//æ•°æ®åº“ç«¯å£</span></span><br><span class="line">Dbname := <span class="string">&quot;tizi365&quot;</span> <span class="comment">//æ•°æ®åº“å</span></span><br><span class="line">timeout := <span class="string">&quot;10s&quot;</span> <span class="comment">//è¿æ¥è¶…æ—¶ï¼Œ10ç§’</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‹¼æ¥ä¸‹dsnå‚æ•°, dsnæ ¼å¼å¯ä»¥å‚è€ƒä¸Šé¢çš„è¯­æ³•ï¼Œè¿™é‡Œä½¿ç”¨SprintfåŠ¨æ€æ‹¼æ¥dsnå‚æ•°ï¼Œå› ä¸ºä¸€èˆ¬æ•°æ®åº“è¿æ¥å‚æ•°ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¿å­˜åœ¨é…ç½®æ–‡ä»¶é‡Œé¢ï¼Œéœ€è¦ä»é…ç½®æ–‡ä»¶åŠ è½½å‚æ•°ï¼Œç„¶åæ‹¼æ¥dsnã€‚</span></span><br><span class="line">dsn := fmt.Sprintf(<span class="string">&quot;%s:%s@tcp(%s:%d)/%s?charset=utf8&amp;parseTime=True&amp;loc=Local&amp;timeout=%s&quot;</span>, username, password, host, port, Dbname, timeout)</span><br><span class="line"><span class="comment">//è¿æ¥MYSQL, è·å¾—DBç±»å‹å®ä¾‹ï¼Œç”¨äºåé¢çš„æ•°æ®åº“è¯»å†™æ“ä½œã€‚</span></span><br><span class="line">db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(<span class="string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥, error=&quot;</span> + err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å»¶æ—¶å…³é—­æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="keyword">defer</span> db.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><p>ç›´æ¥åœ¨è¯­å¥ä¸­åŠ ä¸Š.Debug() å³å¯ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result := db.Debug().Where(<span class="string">&quot;username = ?&quot;</span>, <span class="string">&quot;edwardNygma&quot;</span>).First(&amp;u)</span><br></pre></td></tr></table></figure><h3 id="è¿æ¥æ± "><a href="#è¿æ¥æ± " class="headerlink" title="è¿æ¥æ± "></a>è¿æ¥æ± </h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªå·¥å…·åŒ…ï¼Œç”¨æ¥ç®¡ç†gormæ•°æ®åº“è¿æ¥æ± çš„åˆå§‹åŒ–å·¥ä½œã€‚</span></span><br><span class="line"><span class="keyword">package</span> tools</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰å…¨å±€çš„dbå¯¹è±¡ï¼Œæˆ‘ä»¬æ‰§è¡Œæ•°æ®åº“æ“ä½œä¸»è¦é€šè¿‡ä»–å®ç°ï¼Œè¿™ä¸ªå¾ˆåƒroutor é‚£ä¸ªè¿”å›å€¼ï¼Œä¹Ÿæ˜¯æŒ‡é’ˆç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> _db *gorm.DB</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒ…åˆå§‹åŒ–å‡½æ•°ï¼Œgolangç‰¹æ€§ï¼Œæ¯ä¸ªåŒ…åˆå§‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œinitå‡½æ•°ï¼Œè¿™é‡Œç”¨æ¥åˆå§‹åŒ–gormã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ...å¿½ç•¥dsné…ç½®ï¼Œè¯·å‚è€ƒä¸Šé¢ä¾‹å­...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å£°æ˜errå˜é‡ï¼Œä¸‹é¢ä¸èƒ½ä½¿ç”¨:=èµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦åˆ™_dbå˜é‡ä¼šå½“æˆå±€éƒ¨å˜é‡ï¼Œå¯¼è‡´å¤–éƒ¨æ— æ³•è®¿é—®_dbå˜é‡</span></span><br><span class="line">    <span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line">    <span class="comment">//è¿æ¥MYSQL, è·å¾—DBç±»å‹å®ä¾‹ï¼Œç”¨äºåé¢çš„æ•°æ®åº“è¯»å†™æ“ä½œã€‚</span></span><br><span class="line">    _db, err = gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;) <span class="comment">//openå‡½æ•°è¿”å›ä¸€ä¸ªdbå®ä¾‹çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(<span class="string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥, error=&quot;</span> + err.Error())</span><br><span class="line">&#125;</span><br><span class="line">     </span><br><span class="line">    sqlDB, _ := _db.DB()</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®æ•°æ®åº“è¿æ¥æ± å‚æ•°</span></span><br><span class="line">    sqlDB.SetMaxOpenConns(<span class="number">100</span>)   <span class="comment">//è®¾ç½®æ•°æ®åº“è¿æ¥æ± æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">    sqlDB.SetMaxIdleConns(<span class="number">20</span>)   <span class="comment">//è¿æ¥æ± æœ€å¤§å…è®¸çš„ç©ºé—²è¿æ¥æ•°ï¼Œå¦‚æœæ²¡æœ‰sqlä»»åŠ¡éœ€è¦æ‰§è¡Œçš„è¿æ¥æ•°å¤§äº20ï¼Œè¶…è¿‡çš„è¿æ¥ä¼šè¢«è¿æ¥æ± å…³é—­ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–gorm dbå¯¹è±¡ï¼Œå…¶ä»–åŒ…éœ€è¦æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œåªè¦é€šè¿‡tools.getDB()è·å–dbå¯¹è±¡å³å¯ã€‚</span></span><br><span class="line"><span class="comment">//ä¸ç”¨æ‹…å¿ƒåç¨‹å¹¶å‘ä½¿ç”¨åŒæ ·çš„dbå¯¹è±¡ä¼šå…±ç”¨åŒä¸€ä¸ªè¿æ¥ï¼Œdbå¯¹è±¡åœ¨è°ƒç”¨ä»–çš„æ–¹æ³•çš„æ—¶å€™ä¼šä»æ•°æ®åº“è¿æ¥æ± ä¸­è·å–æ–°çš„è¿æ¥</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetDB</span><span class="params">()</span></span> *gorm.DB &#123;</span><br><span class="line"><span class="keyword">return</span> _db</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>éš¾ä»¥ç†è§£çš„åœ°æ–¹</strong>ï¼š</p><ol><li><p>ConnPool æ˜¯ä¸€ä¸ªæ¥å£ï¼ŒåŒæ—¶ä½œä¸ºgormçš„ä¸€ä¸ªå­—æ®µ</p></li><li><p>*sql.DB ç±»å‹å®ç°äº† gorm.ConnPool æ¥å£çš„æ‰€æœ‰æ–¹æ³•</p></li><li><p>.DB()  æ–¹æ³•ï¼š</p></li></ol>   <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(db *DB)</span></span> DB() (*sql.DB, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> db.ConnPool.(*sql.DB) <span class="comment">// ç±»å‹æ–­è¨€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>   å®é™…ä¸Šå°±æ˜¯ *<em>é€šè¿‡ç±»å‹æ–­è¨€ä»æ¥å£å­—æ®µä¸­æå–å‡ºå…·ä½“çš„  <em>sql.DB å®ä¾‹</em></em></p><ol start="4"><li><p>å› ä¸º sqlDBå’Œ _db.ConnPoolæŒ‡å‘åŒä¸€ä¸ª *sql.DB å®ä¾‹ï¼Œæ‰€ä»¥é€šè¿‡  sqlDB ä¿®æ”¹å‚æ•°ä¼šå½±å“  _db  çš„æ‰€æœ‰åç»­æ“ä½œ</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250915225753827.png" alt="image-20250915225753827"></p></li></ol><p>ä½¿ç”¨ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">//å¯¼å…¥toolsåŒ…</span></span><br><span class="line"><span class="keyword">import</span> tools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//è·å–DB</span></span><br><span class="line">    db := tools.GetDB()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œ</span></span><br><span class="line">    u := User&#123;&#125;</span><br><span class="line"><span class="comment">//è‡ªåŠ¨ç”Ÿæˆsqlï¼š SELECT * FROM `users`  WHERE (username = &#x27;tizi365&#x27;) LIMIT 1</span></span><br><span class="line">db.Where(<span class="string">&quot;username = ?&quot;</span>, <span class="string">&quot;tizi365&quot;</span>).First(&amp;u)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™„ï¼š<strong>Go çš„æ–¹æ³•é›†è§„åˆ™</strong></p><table><thead><tr><th align="center"><strong>æ¥æ”¶è€…ç±»å‹</strong></th><th align="center"><strong>å¯è°ƒç”¨çš„æ–¹æ³•</strong></th></tr></thead><tbody><tr><td align="center"><code>T</code>ï¼ˆå€¼ç±»å‹ï¼‰</td><td align="center">æ‰€æœ‰ <code>func (t T) Method()</code> çš„æ–¹æ³•</td></tr><tr><td align="center"><code>*T</code>ï¼ˆæŒ‡é’ˆï¼‰</td><td align="center">æ‰€æœ‰ <code>func (t T) Method()</code> <strong>å’Œ</strong> <code>func (t *T) Method()</code> çš„æ–¹æ³•</td></tr></tbody></table><p><strong>ä½¿ç”¨è¿æ¥æ± æŠ€æœ¯åï¼Œåƒä¸‡ä¸è¦ä½¿ç”¨å®Œdbåè°ƒç”¨db.Closeå…³é—­æ•°æ®åº“è¿æ¥ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ•´ä¸ªæ•°æ®åº“è¿æ¥æ± å…³é—­ï¼Œå¯¼è‡´è¿æ¥æ± æ²¡æœ‰å¯ç”¨çš„è¿æ¥</strong></p><h2 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h2><h3 id="å•æ¡æ•°æ®"><a href="#å•æ¡æ•°æ®" class="headerlink" title="å•æ¡æ•°æ®"></a>å•æ¡æ•°æ®</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶åˆå§‹åŒ–æ•°æ®</span></span><br><span class="line">u := User&#123;</span><br><span class="line">Username:<span class="string">&quot;tizi365&quot;</span>,</span><br><span class="line">Password:<span class="string">&quot;123456&quot;</span>,</span><br><span class="line">CreateTime:time.Now().Unix(),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’å…¥ä¸€æ¡ç”¨æˆ·æ•°æ®</span></span><br><span class="line"><span class="comment">//ä¸‹é¢ä»£ç ä¼šè‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼šINSERT INTO `users` (`username`,`password`,`createtime`) VALUES (&#x27;tizi365&#x27;,&#x27;123456&#x27;,&#x27;1540824823&#x27;)</span></span><br><span class="line"></span><br><span class="line">db.Create(&amp;u)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸€èˆ¬é¡¹ç›®ä¸­æˆ‘ä»¬ä¼šç±»ä¼¼ä¸‹é¢çš„å†™æ³•ï¼Œé€šè¿‡Errorå¯¹è±¡æ£€æµ‹ï¼Œæ’å…¥æ•°æ®æœ‰æ²¡æœ‰æˆåŠŸï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯é‚£å°±æ˜¯æ•°æ®å†™å…¥æˆåŠŸäº†ã€‚</span></span><br><span class="line"><span class="keyword">if</span> err := db.Create(&amp;u).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æ’å…¥å¤±è´¥&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//gorm 2.0ç‰ˆæœ¬ä»¥åçš„ï¼Œé»˜è®¤ä¼šè‡ªåŠ¨è¿”å›ä¸»é”®Idå€¼</span></span><br><span class="line">u.ID           <span class="comment">// è¿”å›ä¸»é”®idï¼Œé»˜è®¤ä¸»é”®åä¸ºIDï¼Œä¹Ÿå¯ä»¥é€šè¿‡gormæ ‡ç­¾å®šä¹‰</span></span><br><span class="line">u.Error        <span class="comment">// è¿”å› error</span></span><br><span class="line">u.RowsAffected <span class="comment">// è¿”å›æ’å…¥è®°å½•çš„æ¡æ•°</span></span><br></pre></td></tr></table></figure><p>å¦‚æœgormè®¾ç½®äº†æ•°æ®åº“è¿æ¥æ± ï¼Œé‚£ä¹ˆæ¯æ¬¡æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™éƒ½ä¼šä»æ•°æ®åº“è¿æ¥æ± ç”³è¯·ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œé‚£ä¹ˆä¸Šè¿°ä»£ç å¿…é¡»ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ï¼Œç¡®ä¿æ’å…¥æ•°æ®å’ŒæŸ¥è¯¢è‡ªå¢idä¸¤æ¡sqlè¯­å¥æ˜¯åœ¨åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥ä¸‹æ‰§è¡Œï¼Œå¦åˆ™åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šæŸ¥è¯¢ä¸åˆ°è‡ªå¢idï¼Œæˆ–è€…æŸ¥è¯¢åˆ°é”™è¯¯çš„id</p><h3 id="æ‰¹é‡æ•°æ®"><a href="#æ‰¹é‡æ•°æ®" class="headerlink" title="æ‰¹é‡æ•°æ®"></a>æ‰¹é‡æ•°æ®</h3><p><strong>å¦‚æœè¦æ‰¹é‡æ’å…¥æ•°æ®çš„è¯ï¼Œç›´æ¥å®šä¹‰åˆ‡ç‰‡ï¼Œä¾æ—§ä¼ é€’å¼•ç”¨å³å¯ï¼Œä¹Ÿå¯ä»¥åˆ†æ‰¹æ’å…¥</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">users := []User&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        Username:   <span class="string">&quot;user1&quot;</span>,</span><br><span class="line">        Password:   <span class="string">&quot;pwd1&quot;</span>,</span><br><span class="line">        CreateTime: time.Now().Unix(),</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        Username:   <span class="string">&quot;user2&quot;</span>,</span><br><span class="line">        Password:   <span class="string">&quot;pwd2&quot;</span>,</span><br><span class="line">        CreateTime: time.Now().Unix(),</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤š...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰¹é‡æ’å…¥æ•°æ®ï¼ˆæ¨èä¼ é€’åˆ‡ç‰‡æŒ‡é’ˆï¼Œä¿æŒä¸å•æ¡æ’å…¥é£æ ¼ä¸€è‡´ï¼‰</span></span><br><span class="line"><span class="comment">// æŠ€æœ¯ä¸Šå…è®¸ç›´æ¥ä¼ å€¼ï¼ˆusersï¼‰ï¼Œä½†ç»Ÿä¸€ä¼ æŒ‡é’ˆ(&amp;users)æ›´ç¬¦åˆGORMæƒ¯ä¾‹</span></span><br><span class="line">result := db.Create(&amp;users) </span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤§æ‰¹é‡æ•°æ®å»ºè®®åˆ†æ‰¹æ’å…¥ï¼ˆæ¯æ‰¹100æ¡ï¼‰</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šCreateInBatchesåŒæ ·æ”¯æŒä¼ å€¼æˆ–æŒ‡é’ˆï¼Œæ­¤å¤„çœç•¥&amp;ä»…ä¸ºæ¼”ç¤ºä¸¤ç§å†™æ³•</span></span><br><span class="line">batchSize := <span class="number">100</span></span><br><span class="line">err := db.CreateInBatches(users, batchSize).Error </span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h2><ol><li>gormæŸ¥è¯¢æ•°æ®æœ¬è´¨ä¸Šå°±æ˜¯æä¾›ä¸€ç»„å‡½æ•°ï¼Œå¸®æˆ‘ä»¬å¿«é€Ÿæ‹¼æ¥sqlè¯­å¥ï¼Œå°½é‡å‡å°‘ç¼–å†™sqlè¯­å¥çš„å·¥ä½œé‡ã€‚</li><li>gormæŸ¥è¯¢ç»“æœæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä¿å­˜åˆ°ç»“æ„ä½“(struct)å˜é‡ï¼Œæ‰€ä»¥åœ¨æ‰§è¡ŒæŸ¥è¯¢æ“ä½œä¹‹å‰éœ€è¦æ ¹æ®è‡ªå·±æƒ³è¦æŸ¥è¯¢çš„æ•°æ®å®šä¹‰ç»“æ„ä½“ç±»å‹</li><li>gormåº“æ˜¯åç¨‹å®‰å…¨çš„ï¼Œgormæä¾›çš„å‡½æ•°å¯ä»¥å¹¶å‘çš„åœ¨å¤šä¸ªåç¨‹å®‰å…¨çš„æ‰§è¡Œ</li></ol><p>gormæŸ¥è¯¢ä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†çš„å‡½æ•°ç»„æˆï¼Œè¿™äº›å‡½æ•°å¯ä»¥ä¸²èµ·æ¥ç»„åˆsqlè¯­å¥ï¼Œä½¿ç”¨èµ·æ¥ç±»ä¼¼ç¼–å†™sqlè¯­å¥çš„ä¹ æƒ¯ï¼š</p><h3 id="1-query"><a href="#1-query" class="headerlink" title="1.query"></a>1.query</h3><p>æ‰§è¡ŒæŸ¥è¯¢çš„å‡½æ•°ï¼Œgormæä¾›ä¸‹é¢å‡ ä¸ªæŸ¥è¯¢å‡½æ•°ï¼š</p><h5 id="Take-â€”â€”-æŸ¥è¯¢ä¸€æ¡è®°å½•"><a href="#Take-â€”â€”-æŸ¥è¯¢ä¸€æ¡è®°å½•" class="headerlink" title="Take â€”â€”&gt; æŸ¥è¯¢ä¸€æ¡è®°å½•"></a><strong>Take</strong> â€”â€”&gt; æŸ¥è¯¢ä¸€æ¡è®°å½•</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰æ¥æ”¶æŸ¥è¯¢ç»“æœçš„ç»“æ„ä½“å˜é‡</span></span><br><span class="line">food := Food&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰ä»·äºï¼šSELECT * FROM `foods`   LIMIT 1  </span></span><br><span class="line">db.Take(&amp;food)</span><br></pre></td></tr></table></figure><h5 id="First-Last-â€”â€”-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œæ ¹æ®ä¸»é”®IDæ’åº-æ­£åº-ï¼Œè¿”å›ç¬¬ä¸€æ¡-æœ€åä¸€æ¡è®°å½•"><a href="#First-Last-â€”â€”-æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œæ ¹æ®ä¸»é”®IDæ’åº-æ­£åº-ï¼Œè¿”å›ç¬¬ä¸€æ¡-æœ€åä¸€æ¡è®°å½•" class="headerlink" title="**First **&#x2F; Last â€”â€”&gt; æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œæ ¹æ®ä¸»é”®IDæ’åº(æ­£åº)ï¼Œè¿”å›ç¬¬ä¸€æ¡&#x2F;æœ€åä¸€æ¡è®°å½•"></a>**First **&#x2F; Last â€”â€”&gt; æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œæ ¹æ®ä¸»é”®IDæ’åº(<strong>æ­£åº</strong>)ï¼Œè¿”å›ç¬¬ä¸€æ¡&#x2F;æœ€åä¸€æ¡è®°å½•</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äºï¼šSELECT * FROM `foods`   ORDER BY `foods`.`id` ASC LIMIT 1    </span></span><br><span class="line">db.First(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰ä»·äºï¼šSELECT * FROM `foods`   ORDER BY `foods`.`id` DESC LIMIT 1    </span></span><br><span class="line">db.Last(&amp;food)</span><br></pre></td></tr></table></figure><h5 id="Find-â€”â€”-æŸ¥è¯¢å¤šæ¡è®°å½•ï¼ŒFindå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„"><a href="#Find-â€”â€”-æŸ¥è¯¢å¤šæ¡è®°å½•ï¼ŒFindå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„" class="headerlink" title="Find â€”â€”&gt; æŸ¥è¯¢å¤šæ¡è®°å½•ï¼ŒFindå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„"></a><strong>Find</strong> â€”â€”&gt; æŸ¥è¯¢å¤šæ¡è®°å½•ï¼ŒFindå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äºï¼šSELECT * FROM `foods`</span></span><br><span class="line">db.Find(&amp;foods)</span><br></pre></td></tr></table></figure><h5 id="Pluck-â€”â€”-æŸ¥è¯¢ä¸€åˆ—å€¼"><a href="#Pluck-â€”â€”-æŸ¥è¯¢ä¸€åˆ—å€¼" class="headerlink" title="Pluck â€”â€”&gt; æŸ¥è¯¢ä¸€åˆ—å€¼"></a><strong>Pluck</strong> â€”â€”&gt; æŸ¥è¯¢ä¸€åˆ—å€¼</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å•†å“æ ‡é¢˜æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> titles []<span class="type">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›æ‰€æœ‰å•†å“æ ‡é¢˜</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äºï¼šSELECT title FROM `foods`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   1. Model(&amp;Food&#123;&#125;) é€šè¿‡æ¨¡å‹ç»“æ„ä½“ç¡®å®šè¡¨åï¼ˆfoodsè¡¨ï¼‰</span></span><br><span class="line"><span class="comment">//   2. Pluck() å°†æŸ¥è¯¢ç»“æœæ˜ å°„åˆ°éç»“æ„ä½“å˜é‡ï¼ˆå¦‚åŸºç¡€ç±»å‹åˆ‡ç‰‡ï¼‰</span></span><br><span class="line"><span class="comment">//   3. å¿…é¡»ä¼ é€’ &amp;titles æŒ‡é’ˆï¼Œå¦åˆ™æ— æ³•å›å†™æŸ¥è¯¢ç»“æœ</span></span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Pluck(<span class="string">&quot;title&quot;</span>, &amp;titles)</span><br></pre></td></tr></table></figure><h3 id="æœ‰å…³é”™è¯¯å¤„ç†"><a href="#æœ‰å…³é”™è¯¯å¤„ç†" class="headerlink" title="æœ‰å…³é”™è¯¯å¤„ç†"></a>æœ‰å…³é”™è¯¯å¤„ç†</h3><p>æŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œæˆ‘ä»¬ä¸ä¸€å®šä¼šå½“æˆé”™è¯¯å¤„ç†ï¼Œæœ‰å¯èƒ½æ•°æ®ç¡®å®æ²¡æœ‰ï¼Œæ‰€ä»¥è¦æŠŠå®ƒï¼ˆErrRecordNotFoundï¼‰åˆ†å‡ºæ¥</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">err := db.Take(&amp;food).Error</span><br><span class="line"><span class="keyword">if</span> errors.Is(err, gorm.ErrRecordNotFound) &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;æŸ¥è¯¢ä¸åˆ°æ•°æ®&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="comment">//å¦‚æœerrä¸ç­‰äºrecord not foundé”™è¯¯ï¼Œåˆä¸ç­‰äºnilï¼Œé‚£è¯´æ˜sqlæ‰§è¡Œå¤±è´¥äº†ã€‚</span></span><br><span class="line">fmt.Println(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>, err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="where"><a href="#where" class="headerlink" title="where"></a>where</h3><p>db.Where(query interface{}, args â€¦interface{})</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (id = &#x27;10&#x27;) LIMIT 1</span></span><br><span class="line"><span class="comment">//è¿™é‡Œé—®å·(?), åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šè¢«10æ›¿ä»£</span></span><br><span class="line">db.Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">10</span>).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">// in è¯­å¥ </span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (id in (&#x27;1&#x27;,&#x27;2&#x27;,&#x27;5&#x27;,&#x27;6&#x27;)) LIMIT 1 </span></span><br><span class="line"><span class="comment">//argså‚æ•°ä¼ é€’çš„æ˜¯æ•°ç»„</span></span><br><span class="line">db.Where(<span class="string">&quot;id in (?)&quot;</span>, []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>&#125;).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (create_time &gt;= &#x27;2018-11-06 00:00:00&#x27; and create_time &lt;= &#x27;2018-11-06 23:59:59&#x27;)</span></span><br><span class="line"><span class="comment">//è¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªé—®å·(?)å ä½ç¬¦ï¼Œåé¢ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°æ›¿æ¢ä¸¤ä¸ªé—®å·ã€‚</span></span><br><span class="line">db.Where(<span class="string">&quot;create_time &gt;= ? and create_time &lt;= ?&quot;</span>, <span class="string">&quot;2018-11-06 00:00:00&quot;</span>, <span class="string">&quot;2018-11-06 23:59:59&quot;</span>).Find(&amp;foods)</span><br><span class="line"></span><br><span class="line"><span class="comment">//likeè¯­å¥</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (title like &#x27;%å¯ä¹%&#x27;)</span></span><br><span class="line">db.Where(<span class="string">&quot;title like ?&quot;</span>, <span class="string">&quot;%å¯ä¹%&quot;</span>).Find(&amp;foods)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤æ‚æŸ¥è¯¢ï¼š</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ :name ä½œä¸ºå‘½åå‚æ•°</span></span><br><span class="line"><span class="comment">//å‚æ•°é¡ºåºæ— å…³ï¼Œå¯å¤ç”¨å˜é‡</span></span><br><span class="line">db.Where(<span class="string">&quot;id = :id OR name = :name&quot;</span>, </span><br><span class="line">    <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>:   <span class="number">10</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å¯ä¹&quot;</span>,</span><br><span class="line">    &#125;).Find(&amp;foods)</span><br></pre></td></tr></table></figure><h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT id,title FROM `foods`  WHERE `foods`.`id` = &#x27;1&#x27; AND ((id = &#x27;1&#x27;)) LIMIT 1  </span></span><br><span class="line">db.Select(<span class="string">&quot;id,title&quot;</span>).Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">1</span>).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™ç§å†™æ³•æ˜¯ç›´æ¥å¾€Selectå‡½æ•°ä¼ é€’æ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ä»£è¡¨éœ€è¦é€‰æ‹©çš„å­—æ®µå</span></span><br><span class="line">db.Select([]<span class="type">string</span>&#123;<span class="string">&quot;id&quot;</span>, <span class="string">&quot;title&quot;</span>&#125;).Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">1</span>).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ä»¥ç›´æ¥ä¹¦å†™èšåˆè¯­å¥</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT count(*) as total FROM `foods`</span></span><br><span class="line">total := []<span class="type">int</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Modelå‡½æ•°ï¼Œç”¨äºæŒ‡å®šç»‘å®šçš„æ¨¡å‹ï¼Œè¿™é‡Œç”Ÿæˆäº†ä¸€ä¸ªFood&#123;&#125;å˜é‡ã€‚ç›®çš„æ˜¯ä»æ¨¡å‹å˜é‡é‡Œé¢æå–è¡¨åï¼ŒPluckå‡½æ•°æˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä¼ é€’ç»‘å®šè¡¨åçš„ç»“æ„ä½“å˜é‡ï¼Œgormåº“ä¸çŸ¥é“è¡¨åæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æŒ‡å®šè¡¨å</span></span><br><span class="line"><span class="comment">//Pluckå‡½æ•°ï¼Œä¸»è¦ç”¨äºæŸ¥è¯¢ä¸€åˆ—å€¼</span></span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Select(<span class="string">&quot;count(*) as total&quot;</span>).Pluck(<span class="string">&quot;total&quot;</span>, &amp;total)</span><br><span class="line"></span><br><span class="line">fmt.Println(total[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (create_time &gt;= &#x27;2018-11-06 00:00:00&#x27;) ORDER BY create_time desc</span></span><br><span class="line">db.Where(<span class="string">&quot;create_time &gt;= ?&quot;</span>, <span class="string">&quot;2018-11-06 00:00:00&quot;</span>).Order(<span class="string">&quot;create_time desc&quot;</span>).Find(&amp;foods)</span><br></pre></td></tr></table></figure><h3 id="limit-offset"><a href="#limit-offset" class="headerlink" title="limit &#x2F; offset"></a>limit &#x2F; offset</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods` ORDER BY create_time desc LIMIT 10 OFFSET 0 </span></span><br><span class="line">db.Order(<span class="string">&quot;create_time desc&quot;</span>).Limit(<span class="number">10</span>).Offset(<span class="number">0</span>).Find(&amp;foods)</span><br></pre></td></tr></table></figure><h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> total <span class="type">int64</span> = <span class="number">0</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT count(*) FROM `foods` </span></span><br><span class="line"><span class="comment">//è¿™é‡Œä¹Ÿéœ€è¦é€šè¿‡modelè®¾ç½®æ¨¡å‹ï¼Œè®©gormå¯ä»¥æå–æ¨¡å‹å¯¹åº”çš„è¡¨å</span></span><br><span class="line">db.Model(Food&#123;&#125;).Count(&amp;total)</span><br><span class="line">fmt.Println(total)</span><br></pre></td></tr></table></figure><h3 id="group-by-é€šå¸¸ç»“åˆ-è‡ªå·±æ–°å®šä¹‰ä¸€ä¸ªç»“æ„ä½“-scan"><a href="#group-by-é€šå¸¸ç»“åˆ-è‡ªå·±æ–°å®šä¹‰ä¸€ä¸ªç»“æ„ä½“-scan" class="headerlink" title="group by ( é€šå¸¸ç»“åˆ è‡ªå·±æ–°å®šä¹‰ä¸€ä¸ªç»“æ„ä½“+scan() )"></a>group by ( é€šå¸¸ç»“åˆ è‡ªå·±æ–°å®šä¹‰ä¸€ä¸ªç»“æ„ä½“+scan() )</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/ç»Ÿè®¡æ¯ä¸ªå•†å“åˆ†ç±»ä¸‹é¢æœ‰å¤šå°‘ä¸ªå•†å“</span><br><span class="line"><span class="comment">//å®šä¸€ä¸ªResultç»“æ„ä½“ç±»å‹ï¼Œç”¨æ¥ä¿å­˜æŸ¥è¯¢ç»“æœ</span></span><br><span class="line"><span class="keyword">type</span> Result <span class="keyword">struct</span> &#123;</span><br><span class="line">    Type  <span class="type">int</span></span><br><span class="line">    Total <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> results []Result</span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT type, count(*) as  total FROM `foods` GROUP BY type HAVING (total &gt; 0)</span></span><br><span class="line">db.Model(Food&#123;&#125;).Select(<span class="string">&quot;type, count(*) as  total&quot;</span>).Group(<span class="string">&quot;type&quot;</span>).Having(<span class="string">&quot;total &gt; 0&quot;</span>).Scan(&amp;results)</span><br><span class="line"></span><br><span class="line"><span class="comment">//scanç±»ä¼¼Findéƒ½æ˜¯ç”¨äºæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œç„¶åæŠŠæŸ¥è¯¢ç»“æœèµ‹å€¼ç»™ç»“æ„ä½“å˜é‡ï¼ŒåŒºåˆ«åœ¨äºscanä¸ä¼šä»ä¼ é€’è¿›æ¥çš„ç»“æ„ä½“å˜é‡æå–è¡¨å.</span></span><br><span class="line"><span class="comment">//è¿™é‡Œå› ä¸ºæˆ‘ä»¬é‡æ–°å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ç”¨äºä¿å­˜ç»“æœï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„ä½“å¹¶æ²¡æœ‰ç»‘å®šfoodsè¡¨ï¼Œæ‰€ä»¥è¿™é‡Œåªèƒ½ä½¿ç”¨scanæŸ¥è¯¢å‡½æ•°ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="ç›´æ¥æ‰§è¡Œsqlè¯­å¥"><a href="#ç›´æ¥æ‰§è¡Œsqlè¯­å¥" class="headerlink" title="ç›´æ¥æ‰§è¡Œsqlè¯­å¥"></a>ç›´æ¥æ‰§è¡Œsqlè¯­å¥</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sql := <span class="string">&quot;SELECT type, count(*) as  total FROM `foods` where create_time &gt; ? GROUP BY type HAVING (total &gt; 0)&quot;</span></span><br><span class="line"><span class="comment">//å› ä¸ºsqlè¯­å¥ä½¿ç”¨äº†ä¸€ä¸ªé—®å·(?)ä½œä¸ºç»‘å®šå‚æ•°, æ‰€ä»¥éœ€è¦ä¼ é€’ä¸€ä¸ªç»‘å®šå‚æ•°(Rawç¬¬äºŒä¸ªå‚æ•°).</span></span><br><span class="line"><span class="comment">//Rawå‡½æ•°æ”¯æŒç»‘å®šå¤šä¸ªå‚æ•°</span></span><br><span class="line">db.Raw(sql, <span class="string">&quot;2018-11-06 00:00:00&quot;</span>).Scan(&amp;results) <span class="comment">//ä¾æ—§scan</span></span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æ•°æ®"><a href="#æ›´æ–°æ•°æ®" class="headerlink" title="æ›´æ–°æ•°æ®"></a>æ›´æ–°æ•°æ®</h2><h3 id="save-å…ˆæ‹¿å‡ºæ¥ï¼Œæ”¹å­—æ®µï¼Œå†å¡å›å»"><a href="#save-å…ˆæ‹¿å‡ºæ¥ï¼Œæ”¹å­—æ®µï¼Œå†å¡å›å»" class="headerlink" title="save å…ˆæ‹¿å‡ºæ¥ï¼Œæ”¹å­—æ®µï¼Œå†å¡å›å»"></a>save å…ˆæ‹¿å‡ºæ¥ï¼Œæ”¹å­—æ®µï¼Œå†å¡å›å»</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (id = &#x27;2&#x27;) LIMIT 1</span></span><br><span class="line">db.Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">2</span>).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿®æ”¹foodæ¨¡å‹çš„å€¼</span></span><br><span class="line">food.Price = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `title` = &#x27;å¯ä¹&#x27;, `type` = &#x27;0&#x27;, `price` = &#x27;100&#x27;, `stock` = &#x27;26&#x27;, `create_time` = &#x27;2018-11-06 11:12:04&#x27;  WHERE `foods`.`id` = &#x27;2&#x27;</span></span><br><span class="line">db.Save(&amp;food)</span><br></pre></td></tr></table></figure><h3 id="update-ç›´æ¥æ”¹"><a href="#update-ç›´æ¥æ”¹" class="headerlink" title="update ç›´æ¥æ”¹"></a>update ç›´æ¥æ”¹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ›´æ–°foodæ¨¡å‹å¯¹åº”çš„è¡¨è®°å½•</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `price` = &#x27;25&#x27;  WHERE `foods`.`id` = &#x27;2&#x27;</span></span><br><span class="line">db.Model(&amp;food).Update(<span class="string">&quot;price&quot;</span>, <span class="number">25</span>)</span><br><span class="line"><span class="comment">//é€šè¿‡foodæ¨¡å‹çš„ä¸»é”®idçš„å€¼ä½œä¸ºwhereæ¡ä»¶ï¼Œæ›´æ–°priceå­—æ®µå€¼ã€‚ (foodé‡Œé¢æœ‰idå­—æ®µ)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸Šé¢çš„ä¾‹å­åªæ˜¯æ›´æ–°ä¸€æ¡è®°å½•ï¼Œå¦‚æœæˆ‘ä»¬è¦æ›´å…¨éƒ¨è®°å½•æ€ä¹ˆåŠï¼Ÿ</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `price` = &#x27;25&#x27;</span></span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Update(<span class="string">&quot;price&quot;</span>, <span class="number">25</span>)</span><br><span class="line"><span class="comment">//æ³¨æ„è¿™é‡Œçš„Modelå‚æ•°ï¼Œä½¿ç”¨çš„æ˜¯Food&#123;&#125;ï¼Œæ–°ç”Ÿæˆä¸€ä¸ªç©ºç™½çš„æ¨¡å‹å˜é‡ï¼Œæ²¡æœ‰ç»‘å®šä»»ä½•è®°å½•ã€‚</span></span><br><span class="line"><span class="comment">//å› ä¸ºFood&#123;&#125;çš„idä¸ºç©ºï¼Œgormåº“å°±ä¸ä¼šä»¥idä½œä¸ºæ¡ä»¶ï¼Œwhereè¯­å¥å°±æ˜¯ç©ºçš„</span></span><br><span class="line"><span class="comment">//æ ¹æ®è‡ªå®šä¹‰æ¡ä»¶æ›´æ–°è®°å½•ï¼Œè€Œä¸æ˜¯æ ¹æ®ä¸»é”®id</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `price` = &#x27;25&#x27;  WHERE (create_time &gt; &#x27;2018-11-06 20:00:00&#x27;) </span></span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Where(<span class="string">&quot;create_time &gt; ?&quot;</span>, <span class="string">&quot;2018-11-06 20:00:00&quot;</span>).Update(<span class="string">&quot;price&quot;</span>, <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ”¹å¤šä¸ªå­—æ®µï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é€šè¿‡ç»“æ„ä½“å˜é‡è®¾ç½®æ›´æ–°å­—æ®µ</span></span><br><span class="line">updataFood := Food&#123;</span><br><span class="line">Price:<span class="number">120</span>,</span><br><span class="line">Title:<span class="string">&quot;æŸ æª¬é›ªç¢§&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®foodæ¨¡å‹æ›´æ–°æ•°æ®åº“è®°å½•</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `price` = &#x27;120&#x27;, `title` = &#x27;æŸ æª¬é›ªç¢§&#x27;  WHERE `foods`.`id` = &#x27;2&#x27;</span></span><br><span class="line"><span class="comment">//Updatesä¼šå¿½ç•¥æ‰updataFoodç»“æ„ä½“å˜é‡çš„é›¶å€¼å­—æ®µ, æ‰€ä»¥ç”Ÿæˆçš„sqlè¯­å¥åªæœ‰priceå’Œtitleå­—æ®µã€‚</span></span><br><span class="line">db.Model(&amp;food).Updates(&amp;updataFood)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®è‡ªå®šä¹‰æ¡ä»¶æ›´æ–°è®°å½•ï¼Œè€Œä¸æ˜¯æ ¹æ®æ¨¡å‹id</span></span><br><span class="line">updataFood := Food&#123;</span><br><span class="line">Stock:<span class="number">120</span>,</span><br><span class="line">Title:<span class="string">&quot;æŸ æª¬é›ªç¢§&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®Whereæ¡ä»¶ï¼ŒModelå‚æ•°ç»‘å®šä¸€ä¸ªç©ºçš„æ¨¡å‹å˜é‡</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `stock` = &#x27;120&#x27;, `title` = &#x27;æŸ æª¬é›ªç¢§&#x27;  WHERE (price &gt; &#x27;10&#x27;) </span></span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Where(<span class="string">&quot;price &gt; ?&quot;</span>, <span class="number">10</span>).Updates(&amp;updataFood)</span><br></pre></td></tr></table></figure><p>æ€»ç»“modelçš„ä½œç”¨ï¼š</p><h4 id="åœºæ™¯1ï¼šé€šè¿‡æ¨¡å‹å®ä¾‹æ›´æ–°ï¼ˆå¸¦IDæ¡ä»¶ï¼‰"><a href="#åœºæ™¯1ï¼šé€šè¿‡æ¨¡å‹å®ä¾‹æ›´æ–°ï¼ˆå¸¦IDæ¡ä»¶ï¼‰" class="headerlink" title="åœºæ™¯1ï¼šé€šè¿‡æ¨¡å‹å®ä¾‹æ›´æ–°ï¼ˆå¸¦IDæ¡ä»¶ï¼‰"></a><strong>åœºæ™¯1ï¼šé€šè¿‡æ¨¡å‹å®ä¾‹æ›´æ–°ï¼ˆå¸¦IDæ¡ä»¶ï¼‰</strong></h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">food := Food&#123;ID: <span class="number">2</span>&#125; <span class="comment">// åŒ…å«IDçš„æ¨¡å‹å®ä¾‹</span></span><br><span class="line">updataFood := Food&#123;</span><br><span class="line">    Price: <span class="number">120</span>,</span><br><span class="line">    Title: <span class="string">&quot;æŸ æª¬é›ªç¢§&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">db.Model(&amp;food).Updates(&amp;updataFood)</span><br></pre></td></tr></table></figure><p><strong>ç”ŸæˆSQL</strong>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `foods` <span class="keyword">SET</span> `price`<span class="operator">=</span><span class="number">120</span>, `title`<span class="operator">=</span><span class="string">&#x27;æŸ æª¬é›ªç¢§&#x27;</span> <span class="keyword">WHERE</span> `id`<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li><code>Model(&amp;food)</code> ä¸­çš„ <code>food</code> <strong>å¿…é¡»åŒ…å«ä¸»é”®å­—æ®µ</strong>ï¼ˆå¦‚IDï¼‰ï¼Œå¦åˆ™å¯èƒ½å…¨è¡¨æ›´æ–°</li><li><code>Updates()</code> è‡ªåŠ¨å¿½ç•¥ç»“æ„ä½“é›¶å€¼å­—æ®µï¼ˆå¦‚ <code>0</code>&#x2F;<code>&quot;&quot;</code>&#x2F;<code>false</code>ï¼‰</li><li><strong>é£é™©</strong>ï¼šè‹¥ <code>food</code> æœªè®¾ç½®IDï¼Œä¼šå¯¼è‡´å…¨è¡¨æ›´æ–°ï¼ˆå±é™©ï¼ï¼‰</li></ul><h4 id="åœºæ™¯2ï¼šè‡ªå®šä¹‰æ¡ä»¶æ›´æ–°ï¼ˆç©ºæ¨¡å‹-WHEREï¼‰"><a href="#åœºæ™¯2ï¼šè‡ªå®šä¹‰æ¡ä»¶æ›´æ–°ï¼ˆç©ºæ¨¡å‹-WHEREï¼‰" class="headerlink" title="åœºæ™¯2ï¼šè‡ªå®šä¹‰æ¡ä»¶æ›´æ–°ï¼ˆç©ºæ¨¡å‹+WHEREï¼‰"></a><strong>åœºæ™¯2ï¼šè‡ªå®šä¹‰æ¡ä»¶æ›´æ–°ï¼ˆç©ºæ¨¡å‹+WHEREï¼‰</strong></h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.Model(&amp;Food&#123;&#125;).Where(<span class="string">&quot;price &gt; ?&quot;</span>, <span class="number">10</span>).Updates(Food&#123;</span><br><span class="line">    Stock: <span class="number">120</span>,</span><br><span class="line">    Title: <span class="string">&quot;æŸ æª¬é›ªç¢§&quot;</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>ç”ŸæˆSQL</strong>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `foods` <span class="keyword">SET</span> `stock`<span class="operator">=</span><span class="number">120</span>, `title`<span class="operator">=</span><span class="string">&#x27;æŸ æª¬é›ªç¢§&#x27;</span> <span class="keyword">WHERE</span> price <span class="operator">&gt;</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li><code>&amp;Food&#123;&#125;</code> æ˜¯ç©ºæ¨¡å‹å®ä¾‹ï¼Œä»…ç”¨äºæå–è¡¨å</li><li><strong>å®‰å…¨æœºåˆ¶</strong>ï¼šå¿…é¡»é…åˆ <code>Where()</code> ä½¿ç”¨ï¼Œé¿å…å…¨è¡¨æ›´æ–°</li><li>ä»ä¼šå¿½ç•¥é›¶å€¼å­—æ®µï¼ˆå¦‚ <code>Stock: 0</code> ä¸ä¼šè¢«æ›´æ–°ï¼‰</li></ul><h4 id="åœºæ™¯3ï¼šå¼ºåˆ¶æ›´æ–°é›¶å€¼ï¼ˆä½¿ç”¨mapï¼‰"><a href="#åœºæ™¯3ï¼šå¼ºåˆ¶æ›´æ–°é›¶å€¼ï¼ˆä½¿ç”¨mapï¼‰" class="headerlink" title="åœºæ™¯3ï¼šå¼ºåˆ¶æ›´æ–°é›¶å€¼ï¼ˆä½¿ç”¨mapï¼‰"></a><strong>åœºæ™¯3ï¼šå¼ºåˆ¶æ›´æ–°é›¶å€¼ï¼ˆä½¿ç”¨mapï¼‰</strong></h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data := <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">    <span class="string">&quot;stock&quot;</span>: <span class="number">0</span>,  <span class="comment">// é›¶å€¼ä¼šè¢«æ›´æ–°</span></span><br><span class="line">    <span class="string">&quot;price&quot;</span>: <span class="number">35</span>,</span><br><span class="line">&#125;</span><br><span class="line">db.Model(&amp;Food&#123;&#125;).Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">2</span>).Updates(data)</span><br></pre></td></tr></table></figure><p><strong>ç”ŸæˆSQL</strong>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `foods` <span class="keyword">SET</span> `price`<span class="operator">=</span><span class="number">35</span>, `stock`<span class="operator">=</span><span class="number">0</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>é€šè¿‡ <code>map</code> å¼ºåˆ¶æ›´æ–°æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬é›¶å€¼ï¼‰</li><li>æ›´çµæ´»çš„æ•°æ®ç»“æ„ï¼ˆæ”¯æŒæ··åˆç±»å‹å­—æ®µï¼‰</li><li>é¿å…ç»“æ„ä½“é›¶å€¼å¿½ç•¥é—®é¢˜</li></ul><h2 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">food := Food&#123;&#125;</span><br><span class="line"><span class="comment">//å…ˆæŸ¥è¯¢ä¸€æ¡è®°å½•, ä¿å­˜åœ¨æ¨¡å‹å˜é‡food</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: SELECT * FROM `foods`  WHERE (id = &#x27;2&#x27;) LIMIT 1</span></span><br><span class="line">db.Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">2</span>).Take(&amp;food)</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤foodå¯¹åº”çš„è®°å½•ï¼Œé€šè¿‡ä¸»é”®Idæ ‡è¯†è®°å½•</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äºï¼š DELETE from `foods` where id=2;</span></span><br><span class="line">db.Delete(&amp;food)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰ä»·äºï¼šDELETE from `foods` where (`type` = 5);</span></span><br><span class="line">db.Where(<span class="string">&quot;type = ?&quot;</span>, <span class="number">5</span>).Delete(&amp;Food&#123;&#125;)</span><br><span class="line"><span class="comment">//è¿™é‡ŒDeleteå‡½æ•°éœ€è¦ä¼ é€’ä¸€ä¸ªç©ºçš„æ¨¡å‹å˜é‡æŒ‡é’ˆï¼Œä¸»è¦ç”¨äºè·å–æ¨¡å‹å˜é‡ç»‘å®šçš„è¡¨åã€‚ ä¸èƒ½ä¼ é€’ä¸€ä¸ªéç©ºçš„æ¨¡å‹å˜é‡ï¼Œå¦åˆ™å°±å˜æˆåˆ é™¤æŒ‡å®šçš„æ¨¡å‹æ•°æ®ï¼Œè‡ªåŠ¨åœ¨whereè¯­å¥åŠ ä¸Šç±»ä¼¼id = 2è¿™æ ·çš„ä¸»é”®çº¦æŸæ¡ä»¶</span></span><br></pre></td></tr></table></figure><h2 id="äº‹åŠ¡å¤„ç†"><a href="#äº‹åŠ¡å¤„ç†" class="headerlink" title="äº‹åŠ¡å¤„ç†"></a>äº‹åŠ¡å¤„ç†</h2><h3 id="è‡ªåŠ¨äº‹åŠ¡"><a href="#è‡ªåŠ¨äº‹åŠ¡" class="headerlink" title="è‡ªåŠ¨äº‹åŠ¡"></a>è‡ªåŠ¨äº‹åŠ¡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">db.Transaction(<span class="function"><span class="keyword">func</span><span class="params">(tx *gorm.DB)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">  <span class="comment">// åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œä¸€äº› db æ“ä½œï¼ˆä»è¿™é‡Œå¼€å§‹ï¼Œåº”è¯¥ä½¿ç”¨ &#x27;tx&#x27; è€Œä¸æ˜¯ &#x27;db&#x27;ï¼‰</span></span><br><span class="line">  <span class="keyword">if</span> err := tx.Create(&amp;Animal&#123;Name: <span class="string">&quot;Giraffe&quot;</span>&#125;).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä»»ä½•é”™è¯¯éƒ½ä¼šå›æ»šäº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> err := tx.Create(&amp;Animal&#123;Name: <span class="string">&quot;Lion&quot;</span>&#125;).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å› nil æäº¤äº‹åŠ¡</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨äº‹åŠ¡"><a href="#æ‰‹åŠ¨äº‹åŠ¡" class="headerlink" title="æ‰‹åŠ¨äº‹åŠ¡"></a>æ‰‹åŠ¨äº‹åŠ¡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">tx := db.Begin()</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯txå˜é‡ï¼Œä¸æ˜¯dbã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åº“å­˜å‡ä¸€</span></span><br><span class="line"><span class="comment">//ç­‰ä»·äº: UPDATE `foods` SET `stock` = stock - 1  WHERE `foods`.`id` = &#x27;2&#x27; and stock &gt; 0</span></span><br><span class="line"><span class="comment">//RowsAffectedç”¨äºè¿”å›sqlæ‰§è¡Œåå½±å“çš„è¡Œæ•°</span></span><br><span class="line">rowsAffected := tx.Model(&amp;food).Where(<span class="string">&quot;stock &gt; 0&quot;</span>).Update(<span class="string">&quot;stock&quot;</span>, gorm.Expr(<span class="string">&quot;stock - 1&quot;</span>)).RowsAffected</span><br><span class="line"><span class="keyword">if</span> rowsAffected == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœæ›´æ–°åº“å­˜æ“ä½œï¼Œè¿”å›å½±å“è¡Œæ•°ä¸º0ï¼Œè¯´æ˜æ²¡æœ‰åº“å­˜äº†ï¼Œç»“æŸä¸‹å•æµç¨‹</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œå›æ»šä½œç”¨ä¸å¤§ï¼Œå› ä¸ºå‰é¢æ²¡æˆåŠŸæ‰§è¡Œä»€ä¹ˆæ•°æ®åº“æ›´æ–°æ“ä½œï¼Œä¹Ÿæ²¡ä»€ä¹ˆæ•°æ®éœ€è¦å›æ»šã€‚</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œå°±æ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œäº‹åŠ¡ä¸­å¯ä»¥æ‰§è¡Œå¤šä¸ªsqlè¯­å¥ï¼Œé”™è¯¯äº†å¯ä»¥å›æ»šäº‹åŠ¡</span></span><br><span class="line">    tx.Rollback()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">err := tx.Create(ä¿å­˜è®¢å•).Error</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿å­˜è®¢å•å¤±è´¥ï¼Œåˆ™å›æ»šäº‹åŠ¡</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    tx.Rollback()</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    tx.Commit()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…³è”æŸ¥è¯¢"><a href="#å…³è”æŸ¥è¯¢" class="headerlink" title="å…³è”æŸ¥è¯¢"></a>å…³è”æŸ¥è¯¢</h2><p>ä¸€å¯¹ä¸€å¯ä»¥åˆ†ä¸º <strong><code>Belongs To</code></strong> å’Œ <strong><code>Has One</code></strong></p><h3 id="Belongs-To"><a href="#Belongs-To" class="headerlink" title="Belongs  To"></a>Belongs  To</h3><p>é¡¾åæ€ä¹‰ï¼Œæ„ä¸º â€œå±äºâ€ </p><p>ä½¿ç”¨åœºæ™¯ï¼šå½“<strong>å­è¡¨å¿…é¡»å…³è”çˆ¶è¡¨</strong>ï¼Œå½“å­è¡¨æ²¡æœ‰çˆ¶è¡¨ï¼Œå­è¡¨å°±æ²¡æœ‰æ„ä¹‰ï¼ˆå¦‚ <code>Comment</code>å¿…é¡»å±äº <code>Post</code>ï¼‰</p><p>å®šä¹‰ç±»ä¼¼ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Profile <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name   <span class="type">string</span></span><br><span class="line">  UserID <span class="type">uint</span>  <span class="comment">// å¤–é”®å­˜å‚¨åœ¨ Profile è¡¨</span></span><br><span class="line">  User   User <span class="string">`gorm:&quot;foreignKey:UserID&quot;`</span>  <span class="comment">// Profile å±äº User ï¼Œä¸”å¿…é¡»å«æœ‰æ­¤å±æ€§ï¼ˆgromä¼šé»˜è®¤ä½¿ç”¨User çš„idå­—æ®µï¼‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Has-One"><a href="#Has-One" class="headerlink" title="Has One"></a>Has One</h3><p>æ‹¥æœ‰ï¼Œå’Œå±äºä¸åŒçš„æ˜¯ï¼Œhas oneæ˜¯çˆ¶è¡¨æ‹¥æœ‰å­è¡¨ï¼Œä½†ä¹Ÿå¯ä»¥ä¸æ‹¥æœ‰ï¼Œå› ä¸ºè¿™æ—¶å€™çˆ¶è¡¨ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name    <span class="type">string</span></span><br><span class="line">  Profile Profile <span class="string">`gorm:&quot;foreignKey:UserID&quot;`</span>  <span class="comment">// User æ‹¥æœ‰ä¸€ä¸ª Profile</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Profile <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name   <span class="type">string</span></span><br><span class="line">  UserID <span class="type">uint</span>  <span class="comment">// å¤–é”®ä»ç„¶åœ¨ Profile è¡¨ï¼Œä½†å…³ç³»æ–¹å‘ä¸åŒ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li><p>æ— è®ºæ˜¯ belongs to è¿˜æ˜¯ has oneï¼Œå¤–é”®éƒ½åœ¨å­è¡¨</p></li><li><p>belongs to å­è¡¨å«æœ‰çˆ¶è¡¨ç»“æ„ä½“ ï¼Œhas one çˆ¶è¡¨å«æœ‰å­è¡¨ç»“æ„ä½“</p></li><li><p>tagæ˜¯æ‰“åœ¨ç»“æ„ä½“ä¸Šçš„</p></li><li><p>ä½¿ç”¨åœºæ™¯ï¼šå½“è¡¨aå¯ä»¥åŒ…å«è¡¨bï¼Œä¸”bä¸ä¸€å®šè¦æœ‰ä¸€ä¸ªaçš„æ—¶å€™ï¼Œå¯ä»¥ç”¨has oneï¼Œå¦‚æœbå¿…é¡»å…³è”aï¼Œé‚£å°±è¦ç”¨belongs to</p></li></ol><h3 id="å…³è”å¤–é”®"><a href="#å…³è”å¤–é”®" class="headerlink" title="å…³è”å¤–é”®"></a>å…³è”å¤–é”®</h3><p><strong>ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªå®šä¹‰å¤–é”®ï¼Ÿ</strong></p><ul><li>å½“æƒ³ç”¨<strong>éIDå­—æ®µ</strong>ï¼ˆå¦‚ <code>UUID</code>ã€<code>Email</code>ã€<code>Refer</code>ï¼‰ä½œä¸ºå…³è”ä¾æ®æ—¶ã€‚</li><li>å½“æ•°æ®åº“è®¾è®¡<strong>ä¸å…è®¸ä½¿ç”¨é»˜è®¤å¤–é”®å‘½å</strong>æ—¶ã€‚</li><li>å½“éœ€è¦<strong>æ›´çµæ´»çš„å…³è”é€»è¾‘</strong>æ—¶</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//belongs to</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Refer <span class="type">string</span> <span class="comment">// è‡ªå®šä¹‰å…³è”å¤–é”®</span></span><br><span class="line">  Name  <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Profile <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name      <span class="type">string</span></span><br><span class="line">  User      User <span class="string">`gorm:&quot;foreignKey:UserRefer;references:Refer&quot;`</span> <span class="comment">// ä½¿ç”¨ Refer ä½œä¸ºå…³è”å¤–é”®</span></span><br><span class="line">  UserRefer <span class="type">string</span> <span class="comment">// å¤–é”®å­—æ®µ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//has one</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Refer <span class="type">string</span> <span class="comment">// è‡ªå®šä¹‰å…³è”å¤–é”®</span></span><br><span class="line">  Name  <span class="type">string</span></span><br><span class="line">  Profile Profile <span class="string">`gorm:&quot;foreignKey:UserRefer;references:Refer&quot;`</span> <span class="comment">// ä½¿ç”¨ Refer ä½œä¸ºå…³è”å¤–é”®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Profile <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Name      <span class="type">string</span></span><br><span class="line">  UserRefer <span class="type">string</span> <span class="comment">// å¤–é”®å­—æ®µ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢ä¸¾ä¾‹"><a href="#æŸ¥è¯¢ä¸¾ä¾‹" class="headerlink" title="æŸ¥è¯¢ä¸¾ä¾‹"></a>æŸ¥è¯¢ä¸¾ä¾‹</h3><ul><li>æƒ³æ ¹æ®å­è¡¨å­—æ®µæŸ¥è¯¢çˆ¶è¡¨ä¸­çš„æ•°æ®ï¼Œåªè¦çˆ¶è¡¨ï¼Œå­è¡¨å®šä¹‰å¥½äº†å¤–é”®ï¼Œå°±èƒ½åƒæŸ¥ä¸€å¼ è¡¨ä¸€æ ·ï¼Œç›´æ¥æŸ¥è¯¢</li><li>æƒ³è¦æ ¹æ®çˆ¶è¡¨å­—æ®µæŸ¥è¯¢å­è¡¨æ•°æ®ï¼Œå°±è¦modelä¼ å…¥ç©ºçˆ¶è¡¨æŒ‡é’ˆï¼Œè°ƒç”¨AssociationæŒ‡å®šå­è¡¨å­æ®µï¼Œç„¶åå†è°ƒç”¨quaryæ–¹æ³•</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">user := User&#123;&#125;</span><br><span class="line"><span class="comment">// æŸ¥è¯¢ç”¨æˆ·æ•°æ®</span></span><br><span class="line"><span class="comment">//è‡ªåŠ¨ç”Ÿæˆsqlï¼š SELECT * FROM `users`  WHERE (username = &#x27;tizi365&#x27;) LIMIT 1</span></span><br><span class="line">db.Where(<span class="string">&quot;username = ?&quot;</span>, <span class="string">&quot;tizi365&quot;</span>).First(&amp;user)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> card CreditCard</span><br><span class="line"><span class="comment">////è‡ªåŠ¨ç”ŸæˆSQLï¼š SELECT * FROM credit_cards WHERE user_id = 123; // 123 è‡ªåŠ¨ä»userçš„IDè¯»å–</span></span><br><span class="line"><span class="comment">// å…³è”æŸ¥è¯¢çš„ç»“æœä¼šå¡«å……åˆ°cardå˜é‡</span></span><br><span class="line">db.Model(&amp;user).Association(<span class="string">&quot;CreditCard&quot;</span>).Find(&amp;card)</span><br></pre></td></tr></table></figure><h2 id="Migrateå»ºè¡¨-æ“ä½œè¡¨"><a href="#Migrateå»ºè¡¨-æ“ä½œè¡¨" class="headerlink" title="Migrateå»ºè¡¨&#x2F;æ“ä½œè¡¨"></a>Migrateå»ºè¡¨&#x2F;æ“ä½œè¡¨</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®Userç»“æ„ä½“ï¼Œè‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„.</span></span><br><span class="line">db.AutoMigrate(&amp;User&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€æ¬¡åˆ›å»ºUserã€Productã€Orderä¸‰ä¸ªç»“æ„ä½“å¯¹åº”çš„è¡¨ç»“æ„</span></span><br><span class="line">db.AutoMigrate(&amp;User&#123;&#125;, &amp;Product&#123;&#125;, &amp;Order&#123;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ£€æµ‹Userç»“æ„ä½“å¯¹åº”çš„è¡¨æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">db.Migrator().HasTable(&amp;User&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æµ‹è¡¨åusersæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">db.Migrator().HasTable(<span class="string">&quot;users&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®Userç»“æ„ä½“å»ºè¡¨</span></span><br><span class="line">db.Migrator().CreateTable(&amp;User&#123;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤Userç»“æ„ä½“å¯¹åº”çš„è¡¨</span></span><br><span class="line">db.Migrator().DropTable(&amp;User&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤è¡¨åä¸ºusersçš„è¡¨</span></span><br><span class="line">db.Migrator().DropTable(<span class="string">&quot;users&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤Userç»“æ„ä½“å¯¹åº”è¡¨ä¸­çš„descriptionå­—æ®µ</span></span><br><span class="line">db.Migrator().DropColumn(&amp;User&#123;&#125;, <span class="string">&quot;Name&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
            <tag> mySql </tag>
            
            <tag> GORM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‹ç©¹day2-3</title>
      <link href="/2025/09/15/%E8%8B%8D%E7%A9%B9day2-3/"/>
      <url>/2025/09/15/%E8%8B%8D%E7%A9%B9day2-3/</url>
      
        <content type="html"><![CDATA[<h1 id="è‹ç©¹Day2-3"><a href="#è‹ç©¹Day2-3" class="headerlink" title="è‹ç©¹Day2-3"></a>è‹ç©¹Day2-3</h1><h2 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h2><p>åœ¨controlleræ¥å£æ–¹æ³•ä¸ŠåŠ ä¸Šæ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ¥å£å&quot;)</span></span><br></pre></td></tr></table></figure><h2 id="å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……-â€”â€”AOP-åå°„-æ³¨è§£-æšä¸¾"><a href="#å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……-â€”â€”AOP-åå°„-æ³¨è§£-æšä¸¾" class="headerlink" title="å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å…… â€”â€”AOP åå°„ æ³¨è§£ æšä¸¾"></a>å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å…… â€”â€”AOP åå°„ æ³¨è§£ æšä¸¾</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.aspect;</span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.enums.UpdateOrInsert;</span><br><span class="line"><span class="keyword">import</span> com.sky.interceptor.JwtTokenAdminInterceptor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.reflect.MethodSignature;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Parameter;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoFillAspect</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> JwtTokenAdminInterceptor jwtTokenAdminInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AutoFillAspect</span><span class="params">(JwtTokenAdminInterceptor jwtTokenAdminInterceptor)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jwtTokenAdminInterceptor = jwtTokenAdminInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠ½å–ï¼ˆå¯ä»¥ä¸æŠ½å–ï¼Œä½†ä»¥åçš„åˆ‡å…¥ç‚¹å°±è¦å†™å®Œæ•´ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointCut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰é€šçŸ¥çš„å…·ä½“å†…å®¹</span></span><br><span class="line">    <span class="meta">@Before(&quot;pointCut()&quot;)</span>  <span class="comment">//æŠ½å–ä¹‹åå°±èƒ½åœ¨å®šä¹‰åˆ‡å…¥ç‚¹çš„æ—¶å€™ç›´æ¥è¿™ä¹ˆå†™</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span>&#123;  <span class="comment">//è¿™é‡Œæ˜¯å…³é”®ï¼Œä¼ å…¥ä¸€ä¸ªè¿æ¥ç‚¹å¯¹è±¡ï¼Œè¿™ä¸ªè¿æ¥ç‚¹å¯¹è±¡è•´å«äº†è¢«æ‹¦æˆªæ–¹æ³•çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="comment">//è¦è·å–è¿™ä¸ªæ–¹æ³•çš„ç±»å‹</span></span><br><span class="line"></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();<span class="comment">//è·å–æ–¹æ³•ç­¾å,ç›´æ¥ç”¨å­æ¥å£æ¥æ”¶</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> signature.getMethod(); <span class="comment">//è·å¾—å…·ä½“çš„æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">AutoFill</span> <span class="variable">annotation</span> <span class="operator">=</span> method.getAnnotation(AutoFill.class); <span class="comment">//é€šè¿‡æ–¹æ³•å¯¹è±¡å¾—åˆ°æ–¹æ³•çš„æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span>(annotation == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> method.getName();</span><br><span class="line">            log.warn(<span class="string">&quot;    &quot;</span> +name + <span class="string">&quot;æ–¹æ³•ä¸Šæ²¡æœ‰è¿™ä¸ªæ³¨è§£&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">UpdateOrInsert</span> <span class="variable">updateOrInsert</span> <span class="operator">=</span> annotation.updateOrInsert(); <span class="comment">//é€šè¿‡æ³¨è§£çš„æšä¸¾å¾—åˆ°æ–¹æ³•çš„ç±»å‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¦è·å–è¿™ä¸ªæ–¹æ³•çš„å‚æ•°,ä¹Ÿè¦é€šè¿‡joinpointè·å¾—</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> args[<span class="number">0</span>]; <span class="comment">//çº¦å®šç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¼ å…¥çš„å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(updateOrInsert == UpdateOrInsert.INSERT)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method1</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setCreateTime&quot;</span>, LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method2</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setUpdateTime&quot;</span>,LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method3</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setCreateUser&quot;</span>,Long.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method4</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setUpdateUser&quot;</span>,Long.class);</span><br><span class="line"></span><br><span class="line">                method1.invoke(object,LocalDateTime.now());</span><br><span class="line">                method2.invoke(object,LocalDateTime.now());</span><br><span class="line">                method3.invoke(object, BaseContext.getCurrentId()); <span class="comment">//LocalThread</span></span><br><span class="line">                method4.invoke(object,BaseContext.getCurrentId());</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method2</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setUpdateTime&quot;</span>,LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method4</span> <span class="operator">=</span> object.getClass().getDeclaredMethod(<span class="string">&quot;setUpdateUser&quot;</span>,Long.class);</span><br><span class="line">                method2.invoke(object,LocalDateTime.now());</span><br><span class="line">                method4.invoke(object,BaseContext.getCurrentId());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AOP </tag>
            
            <tag> Java </tag>
            
            <tag> è‹ç©¹å¤–å– </tag>
            
            <tag> åå°„ </tag>
            
            <tag> æ³¨è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AOP</title>
      <link href="/2025/09/14/AOP/"/>
      <url>/2025/09/14/AOP/</url>
      
        <content type="html"><![CDATA[<h2 id="AOPåŸºç¡€"><a href="#AOPåŸºç¡€" class="headerlink" title="AOPåŸºç¡€"></a>AOPåŸºç¡€</h2><p>SpringAOPå®ç°æ­¥éª¤</p><p>å¯¼å…¥ä¾èµ–ï¼šåœ¨ pom.xml æ–‡ä»¶ä¸­å¯¼å…¥ AOP çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ç±»åä¸ŠåŠ @Aspectæ³¨è§£</p><p>åœ¨æ–¹æ³•åä¸ŠåŠ å…·ä½“AOPæ–¹æ³•æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//å½“å‰ç±»ä¸ºåˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecordTimeAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.itheima.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordTime</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//è®°å½•æ–¹æ³•æ‰§è¡Œå¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> pjp.proceed();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®°å½•æ–¹æ³•æ‰§è¡Œç»“æŸæ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</span></span><br><span class="line">        log.info(<span class="string">&quot;æ–¹æ³•æ‰§è¡Œè€—æ—¶: &#123;&#125;æ¯«ç§’&quot;</span>,end-begin);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒæ¦‚å¿µï¼š</p><ul><li><strong>è¿æ¥ç‚¹ï¼šJoinPoint</strong>ï¼Œå¯ä»¥è¢«AOPæ§åˆ¶çš„æ–¹æ³•ï¼ˆç±»ä¸ŠåŠ äº†@Aspectæ³¨è§£ï¼Œé‡Œé¢çš„æ–¹æ³•å°±éƒ½æ˜¯ï¼‰</li><li><strong>é€šçŸ¥ï¼šAdvice</strong>ï¼ŒæŒ‡å“ªäº›é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ï¼ˆæ–¹æ³•ä½“å†…å®¹ï¼‰</li><li><strong>åˆ‡å…¥ç‚¹ï¼šPointCut</strong>ï¼ŒåŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ï¼Œé€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨ ï¼ˆä¹Ÿå°±æ˜¯å…·ä½“çš„AOPæ–¹æ³•æ³¨è§£ï¼‰</li><li><strong>åˆ‡é¢ï¼šAspect</strong>ï¼Œæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ï¼ˆé€šçŸ¥+åˆ‡å…¥ç‚¹ï¼Œå³æ³¨è§£+æ–¹æ³•ï¼‰</li><li><strong>ç›®æ ‡å¯¹è±¡ï¼šTarget</strong>ï¼Œé€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡</li></ul><h2 id="AOPè¿›é˜¶"><a href="#AOPè¿›é˜¶" class="headerlink" title="AOPè¿›é˜¶"></a>AOPè¿›é˜¶</h2><h3 id="äº”ç§ç±»å‹ï¼š"><a href="#äº”ç§ç±»å‹ï¼š" class="headerlink" title="äº”ç§ç±»å‹ï¼š"></a>äº”ç§ç±»å‹ï¼š</h3><table><thead><tr><th><strong>Spring AOP é€šçŸ¥ç±»å‹</strong></th><th></th></tr></thead><tbody><tr><td>@Around</td><td>ç¯ç»•é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰ã€åéƒ½è¢«æ‰§è¡Œ</td></tr><tr><td>@Before</td><td>å‰ç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰è¢«æ‰§è¡Œ</td></tr><tr><td>@After</td><td>åç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</td></tr><tr><td>@AfterReturning</td><td>è¿”å›åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæœ‰å¼‚å¸¸ä¸ä¼šæ‰§è¡Œ</td></tr><tr><td>@AfterThrowing</td><td>å¼‚å¸¸åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åæ‰§è¡Œ</td></tr></tbody></table><h3 id="æŠ½å–ï¼š"><a href="#æŠ½å–ï¼š" class="headerlink" title="æŠ½å–ï¼š"></a>æŠ½å–ï¼š</h3><p>ç»™ä¸€ä¸ªå‡½æ•°åŠ ä¸Š@Pointcutæ³¨è§£ï¼Œå°±å¯ä»¥åœ¨åé¢å¤ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span>    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åé¢ç”¨çš„æ—¶å€™ï¼š</span></span><br><span class="line"><span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line"><span class="meta">@Around(&quot;pt()&quot;)</span></span><br></pre></td></tr></table></figure><p>å½“åˆ‡å…¥ç‚¹æ–¹æ³•ä½¿ç”¨ private ä¿®é¥°æ—¶ï¼Œä»…èƒ½åœ¨å½“å‰åˆ‡é¢ç±»ä¸­å¼•ç”¨è¯¥è¡¨è¾¾å¼ï¼Œ å½“å¤–éƒ¨å…¶ä»–åˆ‡é¢ç±»ä¸­ä¹Ÿè¦å¼•ç”¨å½“å‰ç±»ä¸­çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œå°±éœ€è¦ public, åˆ«çš„ç±»ç”¨ptçš„æ—¶å€™ï¼Œéœ€è¦ä¼ é€’å…¨ç±»å+æ–¹æ³•ï¼Œå¦‚ com.dhrjava.aspect.myAspect.pt()</p><h3 id="é€šçŸ¥é¡ºåº"><a href="#é€šçŸ¥é¡ºåº" class="headerlink" title="é€šçŸ¥é¡ºåº"></a>é€šçŸ¥é¡ºåº</h3><ul><li>ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„å…ˆæ‰§è¡Œ</li><li>ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„åæ‰§è¡Œ</li></ul><p>æƒ³æ”¹çš„è¯ï¼Œä½¿ç”¨Springæä¾›çš„ @Order æ³¨è§£</p><h3 id="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"><a href="#åˆ‡å…¥ç‚¹è¡¨è¾¾å¼" class="headerlink" title="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"></a>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</h3><h4 id="execution-â€¦â€¦-ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é…"><a href="#execution-â€¦â€¦-ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é…" class="headerlink" title="execution(â€¦â€¦)ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é…"></a>execution(â€¦â€¦)ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(è®¿é—®ä¿®é¥°ç¬¦?  è¿”å›å€¼  åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) <span class="keyword">throws</span> å¼‚å¸¸?)</span><br></pre></td></tr></table></figure><ol><li>å…¶ä¸­å¸¦<code>?</code>çš„è¡¨ç¤ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†</li></ol><ul><li>è®¿é—®ä¿®é¥°ç¬¦ï¼šå¯çœç•¥ï¼ˆæ¯”å¦‚: publicã€protectedï¼‰</li><li>åŒ…å.ç±»åï¼š å¯çœç•¥</li><li>throws å¼‚å¸¸ï¼šå¯çœç•¥ï¼ˆæ³¨æ„æ˜¯æ–¹æ³•ä¸Šå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸æ˜¯å®é™…æŠ›å‡ºçš„å¼‚å¸¸ï¼‰</li></ul><ol start="2"><li>å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹</li></ol><ul><li><code>*</code> ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€ä»»æ„ç±»å‹çš„ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šé…åŒ…ã€ç±»ã€æ–¹æ³•åçš„ä¸€éƒ¨åˆ†</li><li><code>..</code> ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„å±‚çº§çš„åŒ…ï¼Œæˆ–ä»»æ„ç±»å‹ã€ä»»æ„ä¸ªæ•°çš„å‚æ•°</li></ul><ol start="3"><li>æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ ä¸”ï¼ˆ&amp;&amp;ï¼‰ã€æˆ–ï¼ˆ||ï¼‰ã€éï¼ˆ!ï¼‰ æ¥ç»„åˆæ¯”è¾ƒå¤æ‚çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</li></ol><h4 id="annotation-â€¦â€¦-ï¼šæ ¹æ®æ³¨è§£åŒ¹é…"><a href="#annotation-â€¦â€¦-ï¼šæ ¹æ®æ³¨è§£åŒ¹é…" class="headerlink" title="@annotation(â€¦â€¦) ï¼šæ ¹æ®æ³¨è§£åŒ¹é…"></a>@annotation(â€¦â€¦) ï¼šæ ¹æ®æ³¨è§£åŒ¹é…</h4><ol><li>è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£</li><li>åœ¨æ–¹æ³•ä¸ŠåŠ ä¸Šè¿™ä¸ªæ³¨è§£</li><li>åœ¨åˆ‡å…¥ç‚¹ä¸­æ‰¾è¿™ä¸ªæ³¨è§£ï¼š@Before(â€œ@annotation(com.itheima.anno.LogOperation)â€)</li><li>ä¾æ—§å¯ä»¥ä½¿ç”¨é€»è¾‘è¡¨è¾¾å¼</li></ol>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AOP </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ThreadLocal</title>
      <link href="/2025/09/14/ThreadLocal/"/>
      <url>/2025/09/14/ThreadLocal/</url>
      
        <content type="html"><![CDATA[<ul><li><h3 id="ThreadLocal-æ·±åº¦è§£æ"><a href="#ThreadLocal-æ·±åº¦è§£æ" class="headerlink" title="ThreadLocal æ·±åº¦è§£æ"></a><strong>ThreadLocal æ·±åº¦è§£æ</strong></h3><h4 id="1-æ ¸å¿ƒæ¦‚å¿µ"><a href="#1-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="1. æ ¸å¿ƒæ¦‚å¿µ"></a><strong>1. æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œè§£å†³å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«å˜é‡çš„å†²çªé—®é¢˜ã€‚</li><li><strong>æœ¬è´¨</strong>ï¼šçº¿ç¨‹çº§åˆ«çš„å…¨å±€å˜é‡ï¼ˆçº¿ç¨‹éš”ç¦»çš„å…¨å±€å­˜å‚¨ï¼‰ã€‚</li></ul><h4 id="2-åº•å±‚åŸç†"><a href="#2-åº•å±‚åŸç†" class="headerlink" title="2. åº•å±‚åŸç†"></a><strong>2. åº•å±‚åŸç†</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocal</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">// å…³é”®ï¼šæ¯ä¸ªThreadå¯¹è±¡å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªThreadLocalMap</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(T value)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.currentThread();</span><br><span class="line">        <span class="type">ThreadLocalMap</span> <span class="variable">map</span> <span class="operator">=</span> t.threadLocals; <span class="comment">// è·å–çº¿ç¨‹ä¸“å±çš„Map</span></span><br><span class="line">        map.set(<span class="built_in">this</span>, value); <span class="comment">// ä»¥ThreadLocalå®ä¾‹ä¸ºkeyå­˜å‚¨å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å­˜å‚¨ç»“æ„ï¼š<ul><li>æ¯ä¸ª <code>Thread</code> å¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ª <code>ThreadLocalMap</code>ï¼ˆç±»ä¼¼HashMapä½†æ›´ç®€å•ï¼‰ã€‚</li><li>Keyï¼š<code>ThreadLocal</code> å®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰ï¼ŒValueï¼šçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚</li></ul></li></ul><h4 id="3-ä½¿ç”¨åœºæ™¯"><a href="#3-ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. ä½¿ç”¨åœºæ™¯"></a><strong>3. ä½¿ç”¨åœºæ™¯</strong></h4><table><thead><tr><th>åœºæ™¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®åº“è¿æ¥ç®¡ç†</strong></td><td>æ¯ä¸ªçº¿ç¨‹ç»´æŠ¤ç‹¬ç«‹çš„Connectionï¼ˆå¦‚Springçš„<code>TransactionSynchronizationManager</code>ï¼‰</td></tr><tr><td><strong>ç”¨æˆ·ä¼šè¯ä¿¡æ¯</strong></td><td>åœ¨Webåº”ç”¨ä¸­å­˜å‚¨å½“å‰è¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆå¦‚Spring Securityçš„<code>SecurityContextHolder</code>ï¼‰</td></tr><tr><td><strong>æ—¥æœŸæ ¼å¼åŒ–å·¥å…·</strong></td><td>é¿å…<code>SimpleDateFormat</code>çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜</td></tr></tbody></table><h4 id="4-ä½¿ç”¨ç¤ºä¾‹"><a href="#4-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="4. ä½¿ç”¨ç¤ºä¾‹"></a><strong>4. ä½¿ç”¨ç¤ºä¾‹</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å®šä¹‰ThreadLocalå˜é‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;User&gt; currentUser = ThreadLocal.withInitial(() -&gt; <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è®¾ç½®å½“å‰çº¿ç¨‹çš„å€¼</span></span><br><span class="line">currentUser.set(user); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è·å–å½“å‰çº¿ç¨‹çš„å€¼</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> currentUser.get();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. ä½¿ç”¨åå¿…é¡»æ¸…ç†ï¼é˜²æ­¢å†…å­˜æ³„æ¼</span></span><br><span class="line">currentUser.remove(); </span><br></pre></td></tr></table></figure><hr><h4 id="5-å†…å­˜æ³„æ¼é—®é¢˜"><a href="#5-å†…å­˜æ³„æ¼é—®é¢˜" class="headerlink" title="5. å†…å­˜æ³„æ¼é—®é¢˜"></a><strong>5. å†…å­˜æ³„æ¼é—®é¢˜</strong></h4><ul><li><p>åŸå› ï¼š</p><ul><li><code>ThreadLocalMap</code> çš„ Key æ˜¯å¼±å¼•ç”¨ï¼Œä½† Value æ˜¯å¼ºå¼•ç”¨ã€‚</li><li>çº¿ç¨‹æ± ä¸­çº¿ç¨‹é•¿æœŸå­˜æ´»æ—¶ï¼ŒValue å¯èƒ½æ— æ³•è¢«å›æ”¶ã€‚</li></ul></li><li><p>è§£å†³æ–¹æ¡ˆï¼š</p><ul><li><p>æ¯æ¬¡ä½¿ç”¨åè°ƒç”¨ <code>remove()</code> æ¸…ç†ã€‚</p></li><li><p>ä½¿ç”¨ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">try-finally</span><br></pre></td></tr></table></figure><p> ç¡®ä¿æ¸…ç†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    currentUser.set(user);</span><br><span class="line">    <span class="comment">// ä¸šåŠ¡é€»è¾‘...</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    currentUser.remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="6-ä¸synchronizedå¯¹æ¯”"><a href="#6-ä¸synchronizedå¯¹æ¯”" class="headerlink" title="6. ä¸synchronizedå¯¹æ¯”"></a><strong>6. ä¸synchronizedå¯¹æ¯”</strong></h4><table><thead><tr><th>ç‰¹æ€§</th><th>ThreadLocal</th><th>synchronized</th></tr></thead><tbody><tr><td><strong>ä½œç”¨èŒƒå›´</strong></td><td>çº¿ç¨‹éš”ç¦»</td><td>çº¿ç¨‹äº’æ–¥</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>æ— é”ï¼Œæ›´å¿«</td><td>æœ‰é”ç«äº‰ï¼Œå¯èƒ½é˜»å¡</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>çº¿ç¨‹é—´æ•°æ®éš”ç¦»</td><td>çº¿ç¨‹é—´åŒæ­¥æ§åˆ¶</td></tr></tbody></table><h4 id="7-ç›¸å…³é—®é¢˜"><a href="#7-ç›¸å…³é—®é¢˜" class="headerlink" title="7.ç›¸å…³é—®é¢˜"></a>7.<strong>ç›¸å…³é—®é¢˜</strong></h4><ul><li><strong>Q1ï¼šThreadLocalå¦‚ä½•å®ç°çº¿ç¨‹éš”ç¦»ï¼Ÿ</strong><br> Aï¼šæ¯ä¸ªThreadå†…éƒ¨ç»´æŠ¤ç‹¬ç«‹çš„ThreadLocalMapï¼Œä»¥ThreadLocalå®ä¾‹ä¸ºKeyå­˜å‚¨å€¼ã€‚</li><li><strong>Q2ï¼šä¸ºä»€ä¹ˆKeyç”¨å¼±å¼•ç”¨ï¼Ÿ</strong><br> Aï¼šé˜²æ­¢ThreadLocalå¯¹è±¡æ— æ³•è¢«å›æ”¶ï¼ˆä½†ä»éœ€æ‰‹åŠ¨<code>remove()</code>é¿å…Valueæ³„æ¼ï¼‰ã€‚</li><li><strong>Q3ï¼šSpringå¦‚ä½•ç”¨ThreadLocalç®¡ç†äº‹åŠ¡ï¼Ÿ</strong><br> Aï¼š<code>TransactionSynchronizationManager</code> ç”¨ThreadLocalä¿å­˜å½“å‰çº¿ç¨‹çš„æ•°æ®åº“è¿æ¥ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootåŸç†</title>
      <link href="/2025/09/14/SpringBoot%E5%8E%9F%E7%90%86/"/>
      <url>/2025/09/14/SpringBoot%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="é…ç½®ä¼˜å…ˆçº§"><a href="#é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="é…ç½®ä¼˜å…ˆçº§"></a>é…ç½®ä¼˜å…ˆçº§</h2><p><strong>äº”ç§é…ç½®æ–¹å¼</strong></p><ol><li>application.properties</li><li>application.yml</li><li>application.yaml</li><li>Javaç³»ç»Ÿå±æ€§é…ç½®  -Dkey&#x3D;value</li><li>å‘½ä»¤è¡Œå‚æ•°ï¼š â€“key&#x3D;value</li></ol><p>ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° &gt;  ç³»ç»Ÿå±æ€§å‚æ•° &gt; propertieså‚æ•° &gt; ymlå‚æ•° &gt; yamlå‚æ•°</p><p>å¯åŠ¨jaråŒ…æ—¶æŒ‡å®šJavaç³»ç»Ÿå±æ€§é…ç½®å’Œå‘½ä»¤è¡Œå‚æ•°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Dserver.port=9000 -jar XXXXX.jar --server.port=10010</span><br></pre></td></tr></table></figure><h2 id="Beançš„ç®¡ç†"><a href="#Beançš„ç®¡ç†" class="headerlink" title="Beançš„ç®¡ç†"></a>Beançš„ç®¡ç†</h2><h3 id="1-Beançš„ä½œç”¨åŸŸé…ç½®"><a href="#1-Beançš„ä½œç”¨åŸŸé…ç½®" class="headerlink" title="1. Beançš„ä½œç”¨åŸŸé…ç½®"></a>1. Beançš„ä½œç”¨åŸŸé…ç½®</h3><table><thead><tr><th>ä½œç”¨åŸŸ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>singleton</td><td>å®¹å™¨å†…åŒåç§°çš„beanåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆå•ä¾‹ï¼‰ï¼ˆé»˜è®¤ï¼‰</td></tr><tr><td>prototype</td><td>æ¯æ¬¡ä½¿ç”¨è¯¥beanæ—¶ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆéå•ä¾‹ï¼‰</td></tr><tr><td>request</td><td>æ¯ä¸ªè¯·æ±‚èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td></tr><tr><td>session</td><td>æ¯ä¸ªä¼šè¯èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td></tr><tr><td>application</td><td>æ¯ä¸ªåº”ç”¨èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td></tr></tbody></table><ul><li>IOCå®¹å™¨ä¸­çš„beané»˜è®¤ä½¿ç”¨çš„ä½œç”¨åŸŸï¼šsingleton (å•ä¾‹)</li><li>å®é™…å¼€å‘å½“ä¸­ï¼Œç»å¤§éƒ¨åˆ†çš„Beanæ˜¯å•ä¾‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç»å¤§éƒ¨åˆ†Beanä¸éœ€è¦é…ç½®scopeå±æ€§</li><li>é»˜è®¤singletonçš„beanï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶è¢«åˆ›å»ºï¼Œå¯ä»¥ä½¿ç”¨@Lazyæ³¨è§£æ¥å»¶è¿Ÿåˆå§‹åŒ–(å»¶è¿Ÿåˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶)</li></ul><h3 id="2-ç®¡ç†ç¬¬ä¸‰æ–¹Beanå¯¹è±¡"><a href="#2-ç®¡ç†ç¬¬ä¸‰æ–¹Beanå¯¹è±¡" class="headerlink" title="2.ç®¡ç†ç¬¬ä¸‰æ–¹Beanå¯¹è±¡"></a>2.ç®¡ç†ç¬¬ä¸‰æ–¹Beanå¯¹è±¡</h3><p>ç¬¬ä¸‰æ–¹Beanæ³¨å…¥çš„ä¸¤ç§æ–¹å¼ï¼šï¼ˆä½¿ç”¨ç¬¬äºŒç§ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼1ï¼šå¯åŠ¨ç±»å£°æ˜</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ThirdPartyBean <span class="title function_">bean</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼2ï¼šä¸“ç”¨é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThirdPartyConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ThirdPartyBean <span class="title function_">bean</span><span class="params">(Dependency dep)</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>é€šè¿‡<code>@Bean</code>æ³¨è§£çš„name æˆ– valueå±æ€§å¯ä»¥å£°æ˜beançš„åç§°ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤beançš„åç§°å°±æ˜¯æ–¹æ³•åã€‚</strong></li><li><strong>å¦‚æœç¬¬ä¸‰æ–¹beanéœ€è¦ä¾èµ–å…¶ä»–beanå¯¹è±¡ï¼Œç›´æ¥åœ¨beanå®šä¹‰æ–¹æ³•ä¸­è®¾ç½®å½¢å‚å³å¯ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…ã€‚</strong></li></ul><h2 id="SpringBootå·¥ä½œåŸç†"><a href="#SpringBootå·¥ä½œåŸç†" class="headerlink" title="SpringBootå·¥ä½œåŸç†"></a>SpringBootå·¥ä½œåŸç†</h2><p>ç®¡ç†ç¬¬ä¸‰æ–¹Beanå¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœè¯´è¿™ä¸ªåŒ…ï¼Œå®ƒä¸åœ¨SpringBootå¯åŠ¨ç±»åŒçº§ç›®å½•æˆ–å…¶å­åŒ…ä¸‹ï¼Œé‚£ä¹ˆå¦‚æœä¸é…ç½®componScanæ³¨è§£ï¼Œå°±æ‰«æä¸åˆ°ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸å»ºè®®ç»™ç¬¬ä¸‰æ–¹åŒ…é…ç½®è¿™ä¸ªæ‰«ææ³¨è§£</p><p>ç¬¬ä¸‰æ–¹åŒ…çš„Beanç®¡ç†å¸¸ç”¨æ–¹æ¡ˆï¼š</p><ol><li>åœ¨å¯åŠ¨ç±»ä¸­ï¼Œ@Import(æ™®é€šç±».class)</li><li>åœ¨å¯åŠ¨ç±»ä¸­ï¼Œ@Import(é…ç½®ç±».class)</li><li>åœ¨å¯åŠ¨ç±»ä¸­ï¼Œ@Import(ImportSelectoræ¥å£å®ç°ç±») æ¥å£å®ç°ç±»é‡å†™selectImports()æ–¹æ³•</li></ol><p>ä¸Šé¢ä¸‰ç§æ–¹æ³•çš„å…±åŒç‚¹ï¼Œå°±æ˜¯è¦å¯¹å¯åŠ¨ç±»è¿›è¡Œæ“ä½œï¼Œå…¶å®å†å°è£…ä¸€ä¸‹ï¼Œå°±åªéœ€è¦åœ¨å¯åŠ¨ç±»ä¸­åŠ å›ºå®šçš„æ³¨è§£å°±å¥½äº†</p><p>è‡ªå®šä¹‰ä¸€ä¸ªEnæ¥å£ï¼Œåœ¨æ¥å£ä¸ŠåŠ ä¸Šé¢ä¸‰ç§æ³¨è§£ä¸­çš„ä¸€ç§ï¼Œåœ¨å¯åŠ¨ç±»ä¸­ç›´æ¥åŠ è¿™ä¸ªè‡ªå®šä¹‰æ³¨è§£å°±è¡Œäº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Import(MyImportSelector.class)</span><span class="comment">//æŒ‡å®šè¦å¯¼å…¥å“ªäº›beanå¯¹è±¡æˆ–é…ç½®ç±»  </span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableHeaderConfig &#123; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h3><p>ç¬¬ä¸€å±‚ï¼š SpringBootå¯åŠ¨ç±»ä¸Šçš„æ³¨è§£ï¼š@SpringBootApplication</p><p>â€‹è¿™ä¸ªæ³¨è§£ä¸­æœ‰ä¸‰ä¸ªå…ƒæ³¨è§£ï¼š</p><ul><li>@SpringBootConfiguration</li><li>@EnableAutoConfiguration</li><li>@ComponentScan</li></ul><p>ç¬¬äºŒå±‚ï¼š</p><p>â€‹1. é¦–å…ˆçœ‹ @SpringBootConfiguration æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£ä¸­åŒ…å«ï¼šï¼ˆç¬¬ä¸‰å±‚ï¼‰@Configuration æ³¨è§£ ä¹Ÿå°±æ˜¯<strong>é…ç½®ç±»</strong>æ³¨è§£ï¼Œè¿™ä¹Ÿæ˜¯ å¯åŠ¨ç±»èƒ½ç›´æ¥æ³¨å…¥Beanå¯¹è±¡çš„åŸå› </p><p>â€‹2. ç„¶åæ˜¯ @EnableAutoConfiguration æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£åŒ…å« ï¼ˆç¬¬ä¸‰å±‚ï¼‰@Import æ³¨è§£ï¼Œå¯¼å…¥äº† <strong>ImportSelectoræ¥å£å®ç°ç±»</strong>ï¼Œé‡å†™äº†<strong>selectImports()<strong>æ–¹æ³• ï¼Œåœ¨æ–¹æ³•ä¸­è°ƒç”¨ <strong>getAutoConfigurationEntry()</strong> æ–¹æ³• ï¼Œæ­¤æ–¹æ³•å†è°ƒç”¨</strong>getCandidateConfigurations()</strong> æ–¹æ³•è·å–åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»çš„é›†åˆ</p><p>â€‹æœ€åº•å±‚ getCandidateConfigurations æ–¹æ³•çš„åŠŸèƒ½ï¼šè·å–æ‰€æœ‰åŸºäº </p><p>â€‹ META-INF&#x2F;spring&#x2F;org.springframework.boot.autoconfigure.AutoConfiguration.imports æ–‡ä»¶ä¸­é…ç½®ç±»çš„é›†åˆ</p><p>â€‹3. @ComponentScan è¿™ä¸ªä¸å¿…è¯´ï¼Œå°±æ˜¯å¯åŠ¨ç±»èƒ½å¤Ÿæ‰«æå½“å‰ç›®å½•åŠå­ç›®å½•ä¸­æ³¨è§£çš„åŠŸèƒ½</p><p>çŠ¶æ€æ³¨è§£ï¼šåœ¨è‡ªåŠ¨é…ç½®ç±»å£°æ˜beançš„æ—¶å€™ï¼Œé™¤äº†åœ¨æ–¹æ³•ä¸ŠåŠ äº†ä¸€ä¸ª@Beanæ³¨è§£ä»¥å¤–ï¼Œè¿˜ä¼šç»å¸¸ç”¨åˆ°ä¸€ä¸ªæ³¨è§£ï¼Œå°±æ˜¯ä»¥Conditionalå¼€å¤´çš„è¿™ä¸€ç±»çš„æ³¨è§£ã€‚ä»¥Conditionalå¼€å¤´çš„è¿™äº›æ³¨è§£éƒ½æ˜¯æ¡ä»¶è£…é…çš„æ³¨è§£</p><ul><li>@ConditionalOnClassï¼šåˆ¤æ–­ç¯å¢ƒä¸­æœ‰å¯¹åº”å­—èŠ‚ç æ–‡ä»¶ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li><li>@ConditionalOnMissingBeanï¼šåˆ¤æ–­ç¯å¢ƒä¸­æ²¡æœ‰å¯¹åº”çš„bean(ç±»å‹æˆ–åç§°)ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li><li>@ConditionalOnPropertyï¼šåˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æœ‰å¯¹åº”å±æ€§å’Œå€¼ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li></ul><h3 id="è‡ªå®šä¹‰starter"><a href="#è‡ªå®šä¹‰starter" class="headerlink" title="è‡ªå®šä¹‰starter"></a>è‡ªå®šä¹‰starter</h3><p><strong>ç›®æ ‡</strong>ï¼šå°è£…é˜¿é‡Œäº‘ OSS SDKï¼Œå®ç°å¼€ç®±å³ç”¨çš„ Starterï¼Œç”¨æˆ·åªéœ€å¼•å…¥ä¾èµ–å³å¯è‡ªåŠ¨æ³¨å…¥ <code>AliyunOSSOperator</code>ã€‚</p><h4 id="1-åˆ›å»º-Starter-æ¨¡å—ï¼ˆä¾èµ–ç®¡ç†ï¼‰"><a href="#1-åˆ›å»º-Starter-æ¨¡å—ï¼ˆä¾èµ–ç®¡ç†ï¼‰" class="headerlink" title="1. åˆ›å»º Starter æ¨¡å—ï¼ˆä¾èµ–ç®¡ç†ï¼‰"></a><strong>1. åˆ›å»º Starter æ¨¡å—ï¼ˆä¾èµ–ç®¡ç†ï¼‰</strong></h4><p><strong>æ¨¡å—å</strong>ï¼š<code>aliyun-oss-spring-boot-starter</code><br> â€‹<strong>ä½œç”¨</strong>â€‹ï¼šç»Ÿä¸€ç®¡ç†ä¾èµ–ï¼Œç”¨æˆ·åªéœ€å¼•å…¥æ­¤ Starterã€‚<br> â€‹<strong>å…³é”®æ­¥éª¤</strong>â€‹ï¼š</p><ol><li><p><strong>åˆå§‹åŒ– Maven é¡¹ç›®</strong></p><ul><li>é€‰æ‹© Spring Boot ç‰ˆæœ¬ï¼ˆå¦‚ 3.2.8ï¼‰ï¼Œä¸å‹¾é€‰ä»»ä½•ä¾èµ–ã€‚</li><li>åˆ é™¤æ— å…³æ–‡ä»¶ï¼ˆå¦‚ <code>src/main/java</code>ï¼‰ï¼Œä»…ä¿ç•™ <code>pom.xml</code>ã€‚</li></ul></li><li><p><strong>é…ç½® <code>pom.xml</code></strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥ autoconfigure æ¨¡å— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-oss-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="2-åˆ›å»º-Autoconfigure-æ¨¡å—ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰"><a href="#2-åˆ›å»º-Autoconfigure-æ¨¡å—ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰" class="headerlink" title="2. åˆ›å»º Autoconfigure æ¨¡å—ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰"></a><strong>2. åˆ›å»º Autoconfigure æ¨¡å—ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰</strong></h4><p><strong>æ¨¡å—å</strong>ï¼š<code>aliyun-oss-spring-boot-autoconfigure</code><br> â€‹<strong>ä½œç”¨</strong>â€‹ï¼šå®ç°è‡ªåŠ¨é…ç½®é€»è¾‘ï¼Œå®šä¹‰ Bean å’Œé…ç½®æ–‡ä»¶ã€‚</p><h5 id="2-1-å‡†å¤‡ä»£ç "><a href="#2-1-å‡†å¤‡ä»£ç " class="headerlink" title="2.1 å‡†å¤‡ä»£ç "></a><strong>2.1 å‡†å¤‡ä»£ç </strong></h5><ol><li><p><strong>æ‹·è´åŸæœ‰å·¥å…·ç±»</strong></p><ul><li>å°† <code>AliyunOSSOperator</code>ï¼ˆOSS æ“ä½œå·¥å…·ç±»ï¼‰å’Œ <code>AliyunOSSProperties</code>ï¼ˆé…ç½®ç±»ï¼‰å¤åˆ¶åˆ°æœ¬æ¨¡å—ã€‚</li><li>ç§»é™¤ <code>@Component</code>ã€<code>@Autowired</code>ï¼ˆå› ä¸º Starter éœ€æ‰‹åŠ¨ç®¡ç† Beanï¼‰ã€‚</li></ul></li><li><h5 id="æ”¹é€ -AliyunOSSOperator"><a href="#æ”¹é€ -AliyunOSSOperator" class="headerlink" title="æ”¹é€  AliyunOSSOperator"></a><strong>æ”¹é€  <code>AliyunOSSOperator</code></strong></h5><ul><li><p>æ·»åŠ æ„é€ å‡½æ•°ï¼Œæ¥æ”¶ AliyunOSSProperties</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliyunOSSOperator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AliyunOSSProperties properties;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¿…é¡»æä¾›æ„é€ å‡½æ•°ï¼ˆSpring ä¾èµ–æ³¨å…¥ç”¨ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AliyunOSSOperator</span><span class="params">(AliyunOSSProperties properties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.properties = properties;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…¶ä»–æ–¹æ³•ï¼ˆupload/listFiles/deleteFileç­‰ï¼‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><h5 id="æ”¹é€ -AliyunOSSProperties"><a href="#æ”¹é€ -AliyunOSSProperties" class="headerlink" title="æ”¹é€  AliyunOSSProperties"></a><strong>æ”¹é€  <code>AliyunOSSProperties</code></strong></h5><ul><li><p>æ·»åŠ   @ConfigurationProperties  ç»‘å®šé…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;aliyun.oss&quot;)</span> <span class="comment">// ç»‘å®š yml é…ç½®</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliyunOSSProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line">    <span class="comment">// getters/setters...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h5 id="2-2-å®šä¹‰è‡ªåŠ¨é…ç½®ç±»ï¼ˆç›¸æ¯”äºåŸæ¥çš„ç±»æ–°å¢çš„ï¼Œä¸€ä¸ªé…ç½®ç±»ï¼‰"><a href="#2-2-å®šä¹‰è‡ªåŠ¨é…ç½®ç±»ï¼ˆç›¸æ¯”äºåŸæ¥çš„ç±»æ–°å¢çš„ï¼Œä¸€ä¸ªé…ç½®ç±»ï¼‰" class="headerlink" title="2.2 å®šä¹‰è‡ªåŠ¨é…ç½®ç±»ï¼ˆç›¸æ¯”äºåŸæ¥çš„ç±»æ–°å¢çš„ï¼Œä¸€ä¸ªé…ç½®ç±»ï¼‰"></a><strong>2.2 å®šä¹‰è‡ªåŠ¨é…ç½®ç±»</strong>ï¼ˆç›¸æ¯”äºåŸæ¥çš„ç±»æ–°å¢çš„ï¼Œä¸€ä¸ªé…ç½®ç±»ï¼‰</h5><ol><li><h5 id="åˆ›å»º-AliyunOSSAutoConfiguration"><a href="#åˆ›å»º-AliyunOSSAutoConfiguration" class="headerlink" title="åˆ›å»º AliyunOSSAutoConfiguration"></a><strong>åˆ›å»º <code>AliyunOSSAutoConfiguration</code></strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(AliyunOSSProperties.class)</span> <span class="comment">// å¯ç”¨é…ç½®ç»‘å®š</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliyunOSSAutoConfiguration</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> AliyunOSSOperator <span class="title function_">aliyunOSSOperator</span><span class="params">(AliyunOSSProperties properties)</span> &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥é…ç½®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AliyunOSSOperator</span>(properties);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h5 id="æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»"><a href="#æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»" class="headerlink" title="æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»"></a><strong>æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»</strong></h5><p>resources&#x2F;META-INF&#x2F;spring&#x2F; ä¸‹åˆ›å»ºæ–‡ä»¶ï¼š</p><ul><li>æ–‡ä»¶åï¼šorg.springframework.boot.autoconfigure.AutoConfiguration.imports</li><li>å†…å®¹ ï¼šcom.aliyun.oss.AliyunOSSAutoConfiguration</li></ul></li></ol><h5 id="2-3-é…ç½®ä¾èµ–"><a href="#2-3-é…ç½®ä¾èµ–" class="headerlink" title="2.3 é…ç½®ä¾èµ–"></a><strong>2.3 é…ç½®ä¾èµ–</strong></h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot åŸºç¡€ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- é˜¿é‡Œäº‘ OSS SDK --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Lombokï¼ˆå¯é€‰ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-ç”¨æˆ·ä½¿ç”¨-Starter"><a href="#3-ç”¨æˆ·ä½¿ç”¨-Starter" class="headerlink" title="3. ç”¨æˆ·ä½¿ç”¨ Starter"></a><strong>3. ç”¨æˆ·ä½¿ç”¨ Starter</strong></h4><h5 id="3-1-å¼•å…¥ä¾èµ–"><a href="#3-1-å¼•å…¥ä¾èµ–" class="headerlink" title="3.1 å¼•å…¥ä¾èµ–"></a><strong>3.1 å¼•å…¥ä¾èµ–</strong></h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-oss-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="3-2-é…ç½®å‚æ•°ï¼ˆapplication-ymlï¼‰"><a href="#3-2-é…ç½®å‚æ•°ï¼ˆapplication-ymlï¼‰" class="headerlink" title="3.2 é…ç½®å‚æ•°ï¼ˆapplication.ymlï¼‰"></a><strong>3.2 é…ç½®å‚æ•°ï¼ˆ<code>application.yml</code>ï¼‰</strong></h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aliyun:</span></span><br><span class="line">  <span class="attr">oss:</span></span><br><span class="line">    <span class="attr">endpoint:</span> <span class="string">https://oss-cn-hangzhou.aliyuncs.com</span></span><br><span class="line">    <span class="attr">accessKeyId:</span> <span class="string">your-key-id</span></span><br><span class="line">    <span class="attr">accessKeySecret:</span> <span class="string">your-key-secret</span></span><br><span class="line">    <span class="attr">bucketName:</span> <span class="string">your-bucket</span></span><br></pre></td></tr></table></figure><h5 id="3-3-ç›´æ¥æ³¨å…¥ä½¿ç”¨"><a href="#3-3-ç›´æ¥æ³¨å…¥ä½¿ç”¨" class="headerlink" title="3.3 ç›´æ¥æ³¨å…¥ä½¿ç”¨"></a><strong>3.3 ç›´æ¥æ³¨å…¥ä½¿ç”¨</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AliyunOSSOperator ossOperator; <span class="comment">// è‡ªåŠ¨æ³¨å…¥</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">()</span> &#123;</span><br><span class="line">        ossOperator.upload(...); <span class="comment">// ç›´æ¥è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…³é”®é—®é¢˜è§£ç­”"><a href="#å…³é”®é—®é¢˜è§£ç­”" class="headerlink" title="å…³é”®é—®é¢˜è§£ç­”"></a>å…³é”®é—®é¢˜è§£ç­”</h4><h5 id="1-ä¸ºä»€ä¹ˆéœ€è¦æ„é€ å‡½æ•°ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦æ„é€ å‡½æ•°ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦æ„é€ å‡½æ•°ï¼Ÿ"></a><strong>1. ä¸ºä»€ä¹ˆéœ€è¦æ„é€ å‡½æ•°ï¼Ÿ</strong></h5><ul><li><strong>åŸå› </strong>ï¼šSpring æ— æ³•é€šè¿‡ <code>@Component</code> è‡ªåŠ¨å®ä¾‹åŒ–ç¬¬ä¸‰æ–¹ç±»ï¼Œéœ€æ‰‹åŠ¨åœ¨ <code>@Bean</code> æ–¹æ³•ä¸­æ„é€ å¯¹è±¡ã€‚</li><li><strong>è§£å†³</strong>ï¼šåœ¨ <code>AliyunOSSOperator</code> ä¸­æ˜¾å¼å®šä¹‰æ„é€ å‡½æ•°ï¼Œä¾› <code>AliyunOSSAutoConfiguration</code> è°ƒç”¨ã€‚</li></ul><h5 id="2-é…ç½®å¦‚ä½•ç”Ÿæ•ˆï¼Ÿ"><a href="#2-é…ç½®å¦‚ä½•ç”Ÿæ•ˆï¼Ÿ" class="headerlink" title="2. é…ç½®å¦‚ä½•ç”Ÿæ•ˆï¼Ÿ"></a><strong>2. é…ç½®å¦‚ä½•ç”Ÿæ•ˆï¼Ÿ</strong></h5><ul><li><code>@EnableConfigurationProperties</code> å°† <code>AliyunOSSProperties</code> æ³¨å†Œä¸º Beanã€‚</li><li><code>application.yml</code> ä¸­çš„é…ç½®é€šè¿‡ <code>@ConfigurationProperties</code> ç»‘å®šåˆ° <code>AliyunOSSProperties</code> å¯¹è±¡ã€‚</li></ul><h5 id="3-è‡ªåŠ¨é…ç½®è§¦å‘æ¡ä»¶"><a href="#3-è‡ªåŠ¨é…ç½®è§¦å‘æ¡ä»¶" class="headerlink" title="3. è‡ªåŠ¨é…ç½®è§¦å‘æ¡ä»¶"></a><strong>3. è‡ªåŠ¨é…ç½®è§¦å‘æ¡ä»¶</strong></h5><ul><li><code>AutoConfiguration.imports</code> æ–‡ä»¶å‘Šè¯‰ Spring Boot å¯åŠ¨æ—¶åŠ è½½ <code>AliyunOSSAutoConfiguration</code>ã€‚</li><li>ç”¨æˆ·æ— éœ€æ‰‹åŠ¨ <code>@Import</code> æˆ–æ‰«æåŒ…ã€‚</li></ul><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h4><ol><li>å¯¹äºäºŒè€…çš„ pom.xml :</li></ol><table><thead><tr><th align="center">æ¨¡å—</th><th align="center">Starterï¼ˆä¾èµ–å…¥å£ï¼‰</th><th align="center">Autoconfigureï¼ˆå®ç°é€»è¾‘ï¼‰</th></tr></thead><tbody><tr><td align="center"><strong>ä¾èµ–å†…å®¹</strong></td><td align="center">åªä¾èµ– <code>autoconfigure</code> æ¨¡å—</td><td align="center">ä¾èµ–å…·ä½“åŠŸèƒ½åŒ…ï¼ˆå¦‚é˜¿é‡Œäº‘SDKï¼‰</td></tr><tr><td align="center"><strong>æ–‡ä»¶å†…å®¹</strong></td><td align="center">ä»…ä¿ç•™ <code>pom.xml</code></td><td align="center">ä¿ç•™ <code>src/</code> + <code>pom.xml</code></td></tr><tr><td align="center"><strong>å¿…é¡»ä¿®æ”¹é¡¹</strong></td><td align="center">æ·»åŠ å¯¹ <code>autoconfigure</code> çš„ä¾èµ–</td><td align="center">æ·»åŠ é˜¿é‡Œäº‘OSS SDKç­‰å…·ä½“ä¾èµ–</td></tr></tbody></table><ol start="2"><li><p>æœ€éš¾ç†è§£çš„åœ°æ–¹ï¼š</p><p> **<code>AliyunOSSProperties</code>**ï¼š</p><ul><li>é€šè¿‡ <code>@EnableConfigurationProperties</code> ç›´æ¥åœ¨é…ç½®ç±»ä¸­æ³¨å†Œä¸º Bean</li></ul><p> **<code>AliyunOSSOperator</code>**ï¼š</p><ul><li>é€šè¿‡æ„é€ å‡½æ•°<strong>æ¥æ”¶å®¹å™¨ä¸­çš„ <code>AliyunOSSProperties</code> Bean</strong>ã€‚</li><li><strong>æ— éœ€æ‰‹åŠ¨åˆ›å»ºæˆ–æ³¨å…¥</strong>ï¼Œå®Œå…¨ç”± Spring ç®¡ç†ã€‚</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä¸­çš„ä¼šè¯ï¼Œè¿‡æ»¤ä¸æ‹¦æˆª</title>
      <link href="/2025/09/13/Java%E4%B8%AD%E7%9A%84%E4%BC%9A%E8%AF%9D%EF%BC%8C%E8%BF%87%E6%BB%A4%E4%B8%8E%E6%8B%A6%E6%88%AA/"/>
      <url>/2025/09/13/Java%E4%B8%AD%E7%9A%84%E4%BC%9A%E8%AF%9D%EF%BC%8C%E8%BF%87%E6%BB%A4%E4%B8%8E%E6%8B%A6%E6%88%AA/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼šè¯æŠ€æœ¯"><a href="#ä¼šè¯æŠ€æœ¯" class="headerlink" title="ä¼šè¯æŠ€æœ¯"></a>ä¼šè¯æŠ€æœ¯</h2><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p><strong>CookieæŠ€æœ¯æœ‰ä¸‰ä¸ªè‡ªåŠ¨ï¼š</strong></p><ul><li>æœåŠ¡å™¨ä¼š <strong>è‡ªåŠ¨</strong> çš„å°† cookie å“åº”ç»™æµè§ˆå™¨ã€‚</li><li>æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”å›æ¥çš„æ•°æ®ä¹‹åï¼Œä¼š <strong>è‡ªåŠ¨</strong> çš„å°† cookie å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ã€‚</li><li>åœ¨åç»­çš„è¯·æ±‚å½“ä¸­ï¼Œæµè§ˆå™¨ä¼š <strong>è‡ªåŠ¨</strong> çš„å°† cookie æºå¸¦åˆ°æœåŠ¡å™¨ç«¯ã€‚</li></ul><h3 id="Cookieçš„ä½¿ç”¨ï¼š"><a href="#Cookieçš„ä½¿ç”¨ï¼š" class="headerlink" title="Cookieçš„ä½¿ç”¨ï¼š"></a>Cookieçš„ä½¿ç”¨ï¼š</h3><ol><li><p>è®¾ç½®Cookie æœåŠ¡ç«¯ â€”â€”&gt; æµè§ˆå™¨ </p><p>å…³é”®ï¼š å½¢å‚åŒ…å« HttpServletResponse</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. è®¾ç½® Cookie</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/setCookie&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setCookie</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ª Cookie å¯¹è±¡</span></span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;user_token&quot;</span>, <span class="string">&quot;abc123&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¯é€‰ï¼šé…ç½® Cookie å±æ€§</span></span><br><span class="line">        cookie.setPath(<span class="string">&quot;/&quot;</span>);               <span class="comment">// ä½œç”¨è·¯å¾„ï¼ˆé»˜è®¤å½“å‰è·¯å¾„ï¼‰</span></span><br><span class="line">        cookie.setMaxAge(<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>);    <span class="comment">// æœ‰æ•ˆæœŸ 1 å¤©ï¼ˆå•ä½ï¼šç§’ï¼‰</span></span><br><span class="line">        cookie.setHttpOnly(<span class="literal">true</span>);          <span class="comment">// ç¦æ­¢ JS è®¿é—®ï¼ˆé˜² XSSï¼‰</span></span><br><span class="line">        cookie.setSecure(<span class="literal">false</span>);           <span class="comment">// é HTTPS æ—¶è®¾ä¸º falseï¼ˆæœ¬åœ°æµ‹è¯•ç”¨ï¼‰</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°† Cookie æ·»åŠ åˆ°å“åº”ä¸­</span></span><br><span class="line">        response.addCookie(cookie);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Cookie è®¾ç½®æˆåŠŸï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è¯»å–&#x2F;åˆ é™¤Cookie æµè§ˆå™¨â€”â€”&gt;æœåŠ¡ç«¯</p><p>ä¾æ—§ä½¿ç”¨ HttpServletRequestï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/readCookie2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">readCookie2</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    Cookie[] cookies = request.getCookies();</span><br><span class="line">    <span class="keyword">if</span> (cookies != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;user_token&quot;</span>.equals(cookie.getName())) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;è·å–åˆ°çš„ Cookie å€¼: &quot;</span> + cookie.getValue();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Cookie ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. åˆ é™¤ Cookie</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/deleteCookie&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">deleteCookie</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒåçš„ç©º Cookieï¼Œå¹¶è®¾ç½® MaxAge=0</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;user_token&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    cookie.setPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    cookie.setMaxAge(<span class="number">0</span>);  <span class="comment">// ç«‹å³è¿‡æœŸ</span></span><br><span class="line">        </span><br><span class="line">    response.addCookie(cookie);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Cookie å·²åˆ é™¤ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><ol><li><p>è®¾ç½®Sessionæ•°æ®</p><p>HttpServletRequest</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/setSession&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setSession</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰ Sessionï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºï¼‰</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å‘ Session ä¸­å­˜å‚¨æ•°æ®</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;Alice&quot;</span>);  </span><br><span class="line">        session.setAttribute(<span class="string">&quot;role&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Session æ•°æ®å·²è®¾ç½®ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è¯»å–Sessionæ•°æ®</p><p>ä¾æ—§HttpServletRequestï¼Œè¯»å†™ä¸åŒä¹‹å¤„ä»…ä¸º getAttribute å’Œ setAttribute</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/getSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getSession</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession(<span class="literal">false</span>); <span class="comment">// å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å› null</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (session == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Session ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">role</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;role&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> String.format(<span class="string">&quot;Session æ•°æ®: user=%s, role=%s&quot;</span>, user, role);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/invalidateSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">invalidateSession</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (session != <span class="literal">null</span>) &#123;</span><br><span class="line">        session.invalidate(); <span class="comment">// ç«‹å³é”€æ¯ Session </span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Session å·²é”€æ¯ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Session ä¸å­˜åœ¨ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="ä»¤ç‰Œ"><a href="#ä»¤ç‰Œ" class="headerlink" title="ä»¤ç‰Œ"></a>ä»¤ç‰Œ</h2><h3 id="ä¸‰éƒ¨åˆ†ç»„æˆ"><a href="#ä¸‰éƒ¨åˆ†ç»„æˆ" class="headerlink" title="ä¸‰éƒ¨åˆ†ç»„æˆ"></a>ä¸‰éƒ¨åˆ†ç»„æˆ</h3><ul><li>ç¬¬ä¸€éƒ¨åˆ†ï¼šHeader(å¤´ï¼‰ï¼Œ è®°å½•ä»¤ç‰Œç±»å‹ã€ç­¾åç®—æ³•ç­‰ã€‚ ä¾‹å¦‚ï¼š{â€œalgâ€:â€HS256â€,â€typeâ€:â€JWTâ€}</li><li>ç¬¬äºŒéƒ¨åˆ†ï¼šPayload(æœ‰æ•ˆè½½è·ï¼‰ï¼Œæºå¸¦ä¸€äº›è‡ªå®šä¹‰ä¿¡æ¯ã€é»˜è®¤ä¿¡æ¯ç­‰ã€‚ ä¾‹å¦‚ï¼š{â€œidâ€:â€1â€,â€usernameâ€:â€Tomâ€}</li><li>ç¬¬ä¸‰éƒ¨åˆ†ï¼šSignature(ç­¾åï¼‰ï¼Œé˜²æ­¢Tokenè¢«ç¯¡æ”¹ã€ç¡®ä¿å®‰å…¨æ€§ã€‚å°†headerã€payloadï¼Œå¹¶åŠ å…¥æŒ‡å®šç§˜é’¥ï¼Œé€šè¿‡æŒ‡å®šç­¾åç®—æ³•è®¡ç®—è€Œæ¥ã€‚</li></ul><h3 id="è‡ªå®šä¹‰JWTè·å–-è§£æç±»"><a href="#è‡ªå®šä¹‰JWTè·å–-è§£æç±»" class="headerlink" title="è‡ªå®šä¹‰JWTè·å–&#x2F;è§£æç±»"></a>è‡ªå®šä¹‰JWTè·å–&#x2F;è§£æç±»</h3><p>åŠ å¯†JWTçš„å››ä¸ªé“¾å¼è°ƒç”¨æ­¥éª¤ï¼š</p><ol><li>Jwts.builder().signWith(åŠ å¯†ç®—æ³•ï¼Œäººä¸ºç»™å‡ºåŠ å¯†å­—ç¬¦ä¸²)</li><li>â€‹                      .addClaims(ä¼ å…¥è¦åŠ å¯†çš„mapé›†åˆ)</li><li>â€‹                      .setExpiration(Dateå¯¹è±¡ï¼Œè§„å®šè¿‡æœŸæ—¶é—´)</li><li>â€‹                      .compact(); æœ€ç»ˆæ‰“åŒ…</li></ol><p>è§£å¯†çš„å››æ­¥é“¾å¼è°ƒç”¨ï¼š</p><ol><li><p>Jwts.parser()</p></li><li><p>â€‹       .setSigningKey(åŠ å¯†æ—¶æŒ‡å®šçš„åŠ å¯†å­—ç¬¦ä¸²)</p></li><li><p>â€‹       .parseClaimsJws(åŠ å¯†åçš„å­—ç¬¦ä¸²)</p></li><li><p>â€‹       .getBody()</p><p>â€”â€”&gt; ç”¨mapæ¥æ”¶</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">signKey</span> <span class="operator">=</span> <span class="string">&quot;SVRIRUlNQQ==&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Long</span> <span class="variable">expire</span> <span class="operator">=</span> <span class="number">43200000L</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">//ç”ŸæˆJWTä»¤ç‰Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateJwt</span><span class="params">(Map&lt;String,Object&gt; claims)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> Jwts.builder()</span><br><span class="line">                .addClaims(claims)</span><br><span class="line">                .signWith(SignatureAlgorithm.HS256, signKey)</span><br><span class="line">                .setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + expire))</span><br><span class="line">                .compact();</span><br><span class="line">        <span class="keyword">return</span> jwt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//è§£æJWTä»¤ç‰Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Claims <span class="title function_">parseJWT</span><span class="params">(String jwt)</span>&#123;</span><br><span class="line">        <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> Jwts.parser()</span><br><span class="line">                .setSigningKey(signKey)</span><br><span class="line">                .parseClaimsJws(jwt)</span><br><span class="line">                .getBody();</span><br><span class="line">        <span class="keyword">return</span> claims;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å„ç§ä¼šè¯æŠ€æœ¯çš„æ·±åº¦ç†è§£ï¼ˆæ ¸å¿ƒï¼‰"><a href="#å„ç§ä¼šè¯æŠ€æœ¯çš„æ·±åº¦ç†è§£ï¼ˆæ ¸å¿ƒï¼‰" class="headerlink" title="å„ç§ä¼šè¯æŠ€æœ¯çš„æ·±åº¦ç†è§£ï¼ˆæ ¸å¿ƒï¼‰"></a><strong>å„ç§ä¼šè¯æŠ€æœ¯çš„æ·±åº¦ç†è§£</strong>ï¼ˆæ ¸å¿ƒï¼‰</h2><p>Qï¼šCookieå’ŒSessionæœ¬è´¨ä¸Šçš„åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆ</p><p>Aï¼šä»å½¢æ€ä¸Šè®²ï¼ŒCookieå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå®¹å™¨ï¼ŒSessionæ–¹æ¡ˆæ˜¯ä¸€ç§å˜ç§Cookieï¼Œ</p><p>åŸæ¥çš„Cookieæ˜¯ç›´æ¥å­˜æ”¾é”®å€¼å¯¹æ•°æ®ï¼Œè¿™å¯¼è‡´æ•°æ®ä¼šç›´æ¥å­˜åœ¨æµè§ˆå™¨ç«¯ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸å®‰å…¨é—®é¢˜</p><p>è€ŒSessionæ–¹æ¡ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä½¿ç”¨Cookieï¼Œåªæ˜¯åœ¨Cookieä¸­åªå­˜äº†ä¸€ä¸ªSessionIdï¼ŒçœŸæ­£çš„ä¿¡æ¯éœ€è¦åˆ°æœåŠ¡ç«¯å‡­å€ŸIdå»å–</p><p>Qï¼šCookieå’ŒJwtæ–¹æ¡ˆçš„åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆï¼Œæ¢å¥è¯è¯´ï¼ŒCookieå’ŒJwtæ‰€ç”¨åˆ°çš„æ ¸å¿ƒå†…å®¹è½½ä½“â€œTokenâ€æœ‰å•¥åŒºåˆ«</p><p>Aï¼šCookieå’ŒTokenéƒ½æ˜¯Httpè¯·æ±‚å¤´ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œä¸åŒçš„æ˜¯ï¼Œ</p><p>Cookieæ˜¯ä¸€ç§å·²ç»è¢«å®šä¹‰å¥½çš„ï¼Œä¸ç®¡æ˜¯æµè§ˆå™¨ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼Œéƒ½æœ‰å¯¹å…¶ç›¸åº”çš„ä½¿ç”¨è§„èŒƒçš„ä¸€ä¸ªå­—æ®µ</p><p>Tokenæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å­—æ®µï¼ŒTokenåªæ˜¯çº¦å®šä¿—æˆçš„åå­—ï¼Œå¯ä»¥æ”¹æˆAuthï¼Œå¯ä»¥æ”¹æˆmyCookieï¼Œåªè¦å‰åç«¯çº¦å®šå¥½å°±è¡Œ</p><p>Tokenåœ¨Jwtä¸­çš„è§’è‰²ä½œç”¨ï¼Œæ—¢å¯ä»¥æ˜¯ä¼ é€’åŸæ¥å­˜åœ¨Cookieä¸­çš„å…·ä½“çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¨¡ä»¿Sessionæ–¹æ¡ˆä¼ é€’Idç”¨æ¥æ ‡è¯†ç”¨æˆ·ç­‰ï¼Œå› ä¸ºåæ­£éƒ½ä¼šè¢«åŠ å¯†</p><p>Qï¼šReddisæ–¹æ¡ˆç›¸æ¯”äºå…¶ä»–æ–¹æ¡ˆæœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»</p><p>Aï¼šRedisæ–¹æ¡ˆï¼Œæ˜¯æŠŠæ•°æ®å­˜æ”¾åˆ°Redisä¸­ï¼Œåœ¨ç”¨æˆ·ç™»å½•æ ¡éªŒçš„åœºæ™¯ä¸­ï¼Œå­˜æ”¾çš„å¯ä»¥æ˜¯æ•´ä¸ªç”¨æˆ·å¯¹è±¡ï¼ˆåŒ…å«ç”¨æˆ·çš„idï¼‰ï¼Œ</p><p>ä½¿ç”¨Redisæ–¹æ¡ˆä¹Ÿè¦ç”¨åˆ°è‡ªå®šä¹‰çš„Tokenï¼Œç”¨æ¥ä¼ é€’ç”¨æˆ·æ ‡è¯†ï¼Œç„¶åæ‹¿æ¥å½“ä½œkeyå»redisé‡Œé¢å–</p><p>A2ï¼šRedisæ–¹æ¡ˆå’ŒJwtæ–¹æ¡ˆè¿˜è§£å†³äº†åˆ†å¸ƒå¼å¤šTomcatæœåŠ¡å™¨ä¸‹ï¼ŒSessionæ–¹æ¡ˆç”±äºè‡ªå¸¦SessionIdåªèƒ½åœ¨åŒä¸€ä¸ªtomcatæœåŠ¡å™¨æµé€šè€Œäº§ç”Ÿçš„ä¸€ä¸ªé—®é¢˜ï¼š</p><p>ç”¨rediså®ç°ç™»å½•å’Œç”¨æˆ·ä¿¡æ¯çš„ä¼ é€’ï¼Œå’Œä½¿ç”¨jwtå®ç°ç™»å½•ä»¥åŠç”¨æˆ·ä¿¡æ¯ä¼ é€’ï¼Œéƒ½æ˜¯æœ¬è´¨ä¸Šé€šè¿‡è‡ªå®šä¹‰tokenæ¥è¿›è¡Œç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œè§£å†³äº†åŸºäºsessionæ—¶ï¼Œä½¿ç”¨è‡ªå¸¦çš„sessionidä½œä¸ºå”¯ä¸€æ ‡è¯†å¯¼è‡´å¤štomcatæœåŠ¡å™¨æ—¶çš„ä¸å…¼å®¹é—®é¢˜</p><h2 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h2><p><strong>Filterè¡¨ç¤ºè¿‡æ»¤å™¨ï¼Œæ˜¯ JavaWebä¸‰å¤§ç»„ä»¶(Servletã€Filterã€Listener)ä¹‹ä¸€</strong>ï¼Œä¹Ÿæ˜¯ç°åœ¨webå¼€å‘ä¸­å”¯ä¸€æœ‰ä¸€ä¸ªè¿˜åœ¨ç”¨çš„</p><h3 id="Filterçš„ä½¿ç”¨ï¼š"><a href="#Filterçš„ä½¿ç”¨ï¼š" class="headerlink" title="Filterçš„ä½¿ç”¨ï¼š"></a>Filterçš„ä½¿ç”¨ï¼š</h3><ul><li>ç¬¬1æ­¥ï¼Œå®šä¹‰è¿‡æ»¤å™¨ ï¼š1.å®šä¹‰ä¸€ä¸ªç±»ï¼Œå®ç° Filter æ¥å£ï¼Œå¹¶é‡å†™å…¶æ‰€æœ‰æ–¹æ³•ã€‚</li><li>ç¬¬2æ­¥ï¼Œé…ç½®è¿‡æ»¤å™¨ï¼šFilterç±»ä¸ŠåŠ  @WebFilter æ³¨è§£ï¼Œé…ç½®æ‹¦æˆªèµ„æºçš„è·¯å¾„ã€‚å¼•å¯¼ç±»ä¸ŠåŠ  @ServletComponentScan å¼€å¯Servletç»„ä»¶æ”¯æŒ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span>  <span class="comment">//2.1é…ç½®æ‹¦æˆªè·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;  <span class="comment">//1.å®šä¹‰ç±»ï¼Œå®ç°æ¥å£å¹¶é‡å†™æ–¹æ³•</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–æ–¹æ³•, webæœåŠ¡å™¨å¯åŠ¨, åˆ›å»ºFilterå®ä¾‹æ—¶è°ƒç”¨, åªè°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‹¦æˆªåˆ°è¯·æ±‚æ—¶,è°ƒç”¨è¯¥æ–¹æ³•,å¯ä»¥è°ƒç”¨å¤šæ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‹¦æˆªåˆ°äº†è¯·æ±‚...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é”€æ¯æ–¹æ³•, webæœåŠ¡å™¨å…³é—­æ—¶è°ƒç”¨, åªè°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚é¥è¿œçš„SpringBootå¯åŠ¨ç±»ä¸­ã€‚ã€‚ã€‚:</span></span><br><span class="line"><span class="meta">@ServletComponentScan</span> <span class="comment">//2.2å¼€å¯å¯¹Servletç»„ä»¶çš„æ”¯æŒ</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TliasManagementApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(TliasManagementApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250913154225970.png" alt="image-20250913154225970" style="zoom: 67%;" /><p>å…·ä½“å®ç°ï¼š</p><p>æ ¸å¿ƒæœ‰ä¸‰ç‚¹ï¼š</p><ol><li>æŠŠå‚æ•°ä¸­çš„ ServletRequest å’Œ ServletRequest å¼ºè½¬æˆHttpServletRequest å’Œ HttpServletResponseï¼Œä»requestä¸­è·å–è·¯å¾„ä¿¡æ¯ï¼Œtokenä¿¡æ¯</li><li>æ”¾è¡Œè°ƒç”¨chain.doFilteræ–¹æ³•ï¼Œå‚æ•°æ˜¯requestå’Œresponseï¼Œè¿™ä¿©æœ¬æ¥å°±æ˜¯è¦ä¼ çš„ï¼Œæ‰€ä»¥ç›¸å½“äºæ”¾è¡Œäº†</li><li>chain.deFilteræ”¾è¡Œä»¥åï¼Œä¼šç­‰ç›¸å…³æ‰€æœ‰æ–¹æ³•éƒ½æ‰§è¡Œå®Œï¼Œåœ¨å›åˆ°ä»–çš„ä¸‹ä¸€æ¡è¯­å¥è¿›è¡Œæ‰§è¡Œ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span>  <span class="comment">//è§„å®šæ‹¦æˆªè·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest req, ServletRequest resp, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) req;  <span class="comment">//ä¾æ—§HttpServletRequest</span></span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) resp;</span><br><span class="line">        <span class="comment">//1. è·å–è¯·æ±‚urlã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> request.getRequestURL().toString();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. åˆ¤æ–­è¯·æ±‚urlä¸­æ˜¯å¦åŒ…å«loginï¼Œå¦‚æœåŒ…å«ï¼Œè¯´æ˜æ˜¯ç™»å½•æ“ä½œï¼Œæ”¾è¡Œã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(url.contains(<span class="string">&quot;login&quot;</span>))&#123; <span class="comment">//ç™»å½•è¯·æ±‚</span></span><br><span class="line">            log.info(<span class="string">&quot;ç™»å½•è¯·æ±‚ , ç›´æ¥æ”¾è¡Œ&quot;</span>);</span><br><span class="line">            chain.doFilter(request, response);  <span class="comment">//æ”¾è¡Œ</span></span><br><span class="line">            log.info(<span class="string">&quot;ç™»é™†åçš„è¯­å¥&quot;</span>);<span class="comment">//è¿™ä¸ªä¹Ÿä¼šæ‰§è¡Œå®Œ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è·å–è¯·æ±‚å¤´ä¸­çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.hasLength(jwt))&#123; <span class="comment">//jwtä¸ºç©º</span></span><br><span class="line">            log.info(<span class="string">&quot;è·å–åˆ°jwtä»¤ç‰Œä¸ºç©º, è¿”å›é”™è¯¯ç»“æœ&quot;</span>);</span><br><span class="line">            response.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è§£ætokenï¼Œå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JwtUtils.parseJWT(jwt);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.info(<span class="string">&quot;è§£æä»¤ç‰Œå¤±è´¥, è¿”å›é”™è¯¯ç»“æœ&quot;</span>);</span><br><span class="line">            response.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6. æ”¾è¡Œã€‚</span></span><br><span class="line">        log.info(<span class="string">&quot;ä»¤ç‰Œåˆæ³•, æ”¾è¡Œ&quot;</span>);</span><br><span class="line">        chain.doFilter(request , response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>æ‹¦æˆªè·¯å¾„</th><th>urlPatternså€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>æ‹¦æˆªå…·ä½“è·¯å¾„</td><td>&#x2F;login</td><td>åªæœ‰è®¿é—® &#x2F;login è·¯å¾„æ—¶ï¼Œæ‰ä¼šè¢«æ‹¦æˆª</td></tr><tr><td>ç›®å½•æ‹¦æˆª</td><td>&#x2F;emps&#x2F;*</td><td>è®¿é—®&#x2F;empsä¸‹çš„æ‰€æœ‰èµ„æºï¼Œéƒ½ä¼šè¢«æ‹¦æˆª</td></tr><tr><td>æ‹¦æˆªæ‰€æœ‰</td><td>&#x2F;*</td><td>è®¿é—®æ‰€æœ‰èµ„æºï¼Œéƒ½ä¼šè¢«æ‹¦æˆª</td></tr></tbody></table><h3 id="è¿‡æ»¤å™¨é“¾"><a href="#è¿‡æ»¤å™¨é“¾" class="headerlink" title="è¿‡æ»¤å™¨é“¾"></a>è¿‡æ»¤å™¨é“¾</h3><p>è¿‡æ»¤å™¨é“¾ä¸Šè¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåºï¼šæ³¨è§£é…ç½®çš„Filterï¼Œä¼˜å…ˆçº§æ˜¯æŒ‰ç…§è¿‡æ»¤å™¨ç±»åï¼ˆå­—ç¬¦ä¸²ï¼‰çš„è‡ªç„¶æ’åºã€‚ æ¯”å¦‚ï¼š</p><p>AbcFilter DemoFilter</p><p>è¿™ä¸¤ä¸ªè¿‡æ»¤å™¨æ¥è¯´ï¼ŒAbcFilter ä¼šå…ˆæ‰§è¡Œï¼ŒDemoFilterä¼šåæ‰§è¡Œï¼Œè®¿é—®å®Œwebèµ„æºä¹‹åï¼Œè¿˜ä¼šå›åˆ°è¿‡æ»¤å™¨å½“ä¸­æ¥æ‰§è¡Œè¿‡æ»¤å™¨æ”¾è¡Œåçš„é€»è¾‘ï¼Œè€Œåœ¨æ‰§è¡Œæ”¾è¡Œåçš„é€»è¾‘çš„æ—¶å€™ï¼Œ<strong>é¡ºåºæ˜¯åç€çš„</strong></p><h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><p><strong>æ‹¦æˆªå™¨æ˜¯SpringBootæä¾›çš„</strong></p><h3 id="ä½¿ç”¨æ‹¦æˆªå™¨"><a href="#ä½¿ç”¨æ‹¦æˆªå™¨" class="headerlink" title="ä½¿ç”¨æ‹¦æˆªå™¨"></a>ä½¿ç”¨æ‹¦æˆªå™¨</h3><ol><li><p>å®šä¹‰æ‹¦æˆªå™¨  â€”â€”&gt;  å®ç°HandlerInterceptoræ¥å£ï¼Œå¹¶é‡å†™å…¶æ‰€æœ‰æ–¹æ³•</p></li><li><p>ä½¿ç”¨æ‹¦æˆªå™¨  â€”â€”&gt; åˆ›å»ºä¸€ä¸ªé…ç½®ç±»å®ç° WebMvcConfigurer æ¥å£ï¼Œå¹¶é‡å†™ addInterceptors æ–¹æ³•</p><p>åœ¨æ–¹æ³•ä¸­ï¼Œå°†æ‹¦æˆªå™¨å¯¹è±¡é€šè¿‡ addInterceptor æ–¹æ³• ä¼ å…¥ registry ï¼Œé“¾å¼è°ƒç”¨ addPathPatterns æ–¹æ³•æŒ‡å®šæ‹¦æˆªè·¯å¾„</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªå®šä¹‰æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">//ç›®æ ‡èµ„æºæ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œã€‚ è¿”å›trueï¼šæ”¾è¡Œ    è¿”å›falseï¼šä¸æ”¾è¡Œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//1. è·å–è¯·æ±‚urlã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> request.getRequestURL().toString();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. åˆ¤æ–­è¯·æ±‚urlä¸­æ˜¯å¦åŒ…å«loginï¼Œå¦‚æœåŒ…å«ï¼Œè¯´æ˜æ˜¯ç™»å½•æ“ä½œï¼Œæ”¾è¡Œã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(url.contains(<span class="string">&quot;login&quot;</span>))&#123; <span class="comment">//ç™»å½•è¯·æ±‚</span></span><br><span class="line">            log.info(<span class="string">&quot;ç™»å½•è¯·æ±‚ , ç›´æ¥æ”¾è¡Œ&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è·å–è¯·æ±‚å¤´ä¸­çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.hasLength(jwt))&#123; <span class="comment">//jwtä¸ºç©º</span></span><br><span class="line">            log.info(<span class="string">&quot;è·å–åˆ°jwtä»¤ç‰Œä¸ºç©º, è¿”å›é”™è¯¯ç»“æœ&quot;</span>);</span><br><span class="line">            response.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è§£ætokenï¼Œå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JwtUtils.parseJWT(jwt);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.info(<span class="string">&quot;è§£æä»¤ç‰Œå¤±è´¥, è¿”å›é”™è¯¯ç»“æœ&quot;</span>);</span><br><span class="line">            response.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6. æ”¾è¡Œã€‚</span></span><br><span class="line">        log.info(<span class="string">&quot;ä»¤ç‰Œåˆæ³•, æ”¾è¡Œ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//åŠ æ³¨è§£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DemoInterceptor demoInterceptor;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">       <span class="comment">//æ³¨å†Œè‡ªå®šä¹‰æ‹¦æˆªå™¨å¯¹è±¡</span></span><br><span class="line">        registry.addInterceptor(demoInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);<span class="comment">//è®¾ç½®æ‹¦æˆªå™¨æ‹¦æˆªçš„è¯·æ±‚è·¯å¾„ï¼ˆ /** è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹¦æˆªè·¯å¾„è‡ªå®šä¹‰ï¼šé€šè¿‡ addPathPatterns å’Œ excludePathPatterns æ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250913160713870.png" alt="image-20250913160713870"></p><p>æ‹¦æˆªå™¨æ‹¦æˆªè·¯å¾„ï¼š</p><table><thead><tr><th>æ‹¦æˆªè·¯å¾„</th><th>å«ä¹‰</th><th>ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>&#x2F;*</td><td>ä¸€çº§è·¯å¾„</td><td>èƒ½åŒ¹é…&#x2F;deptsï¼Œ&#x2F;empsï¼Œ&#x2F;loginï¼Œä¸èƒ½åŒ¹é… &#x2F;depts&#x2F;1</td></tr><tr><td>&#x2F;**</td><td>ä»»æ„çº§è·¯å¾„</td><td>èƒ½åŒ¹é…&#x2F;deptsï¼Œ&#x2F;depts&#x2F;1ï¼Œ&#x2F;depts&#x2F;1&#x2F;2</td></tr><tr><td>&#x2F;depts&#x2F;*</td><td>&#x2F;deptsä¸‹çš„ä¸€çº§è·¯å¾„</td><td>èƒ½åŒ¹é…&#x2F;depts&#x2F;1ï¼Œä¸èƒ½åŒ¹é…&#x2F;depts&#x2F;1&#x2F;2ï¼Œ&#x2F;depts</td></tr><tr><td>&#x2F;depts&#x2F;**</td><td>&#x2F;deptsä¸‹çš„ä»»æ„çº§è·¯å¾„</td><td>èƒ½åŒ¹é…&#x2F;deptsï¼Œ&#x2F;depts&#x2F;1ï¼Œ&#x2F;depts&#x2F;1&#x2F;2ï¼Œä¸èƒ½åŒ¹é…&#x2F;emps&#x2F;1</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250913160828177.png" alt="image-20250913160828177"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250913161009177.png" alt="image-20250913161009177"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåå°„å’ŒJavaåå°„å¼‚åŒç‚¹</title>
      <link href="/2025/09/11/Go%20&amp;%20Java%20%E5%8F%8D%E5%B0%84%E5%BC%82%E5%90%8C%E7%82%B9/"/>
      <url>/2025/09/11/Go%20&amp;%20Java%20%E5%8F%8D%E5%B0%84%E5%BC%82%E5%90%8C%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="Javaåå°„ï¼š"><a href="#Javaåå°„ï¼š" class="headerlink" title="Javaåå°„ï¼š"></a>Javaåå°„ï¼š</h2><p>ä¸‡ç‰©çš†å¯¹è±¡ï¼Œæ— è®ºæ˜¯ç±»ï¼Œæ–¹æ³•ï¼Œè¿˜æ˜¯å±æ€§éƒ½æœ‰è‡ªå·±çš„å¯¹è±¡ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//==========è·å–classå¯¹è±¡============----------------------------</span></span><br><span class="line"><span class="comment">//é€šè¿‡å…¨é™å®šå/ç±»å</span></span><br><span class="line">Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;com.dhrjava.refelctTestClass&quot;</span>);</span><br><span class="line">Class&lt;?&gt; clazz = String.class;</span><br><span class="line"><span class="comment">//é€šè¿‡å·²åˆå§‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">Class&lt;?&gt; clazz = str.getClass();</span><br><span class="line"><span class="comment">//=========ç°åœ¨å·²ç»æœ‰äº†clazzå¯¹è±¡=======-----------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//===========åˆ›å»ºå®ä¾‹=================----------------------------</span></span><br><span class="line"><span class="comment">//é€šè¿‡ Constructor</span></span><br><span class="line">Constructor&lt;?&gt; constructor = clazz.getDeclaredConstructor();</span><br><span class="line"><span class="type">Object</span> <span class="variable">obj2</span> <span class="operator">=</span> constructor.newInstance();</span><br><span class="line"><span class="comment">//å¸¦å‚æ•°</span></span><br><span class="line">Constructor&lt;?&gt; paramConstructor = clazz.getDeclaredConstructor(String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">obj3</span> <span class="operator">=</span> paramConstructor.newInstance(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="comment">//==========å®ä¾‹åˆ›å»ºå®Œæˆ===============------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//==========è·å–å­—æ®µå¹¶ä¿®æ”¹å€¼==================-----------------------</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(<span class="string">&quot;name&quot;</span>); <span class="comment">//ä¼ å…¥è¦æ”¹çš„å­—æ®µ</span></span><br><span class="line">filed.setAccessible(<span class="literal">true</span>);<span class="comment">//å•¥éƒ½èƒ½æ”¹ï¼Œçªç ´é™åˆ¶</span></span><br><span class="line">field.set(obj,<span class="string">&quot;Alice&quot;</span>);<span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥å®ä¾‹å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ›´æ”¹åçš„å†…å®¹ï¼Œæ— éœ€ä¼ å…¥è¦æ”¹ä»€ä¹ˆï¼Œå› ä¸ºè¦æ”¹ä»€ä¹ˆç”±fieldå¯¹è±¡å·²ç»è·å–</span></span><br><span class="line"><span class="comment">//=======================================---------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//==========æ–¹æ³•è°ƒç”¨===================------------------------------</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;sayHello&quot;</span>, String.class,Integer.class);</span><br><span class="line">method.setAccessible(<span class="literal">true</span>); <span class="comment">// å…è®¸è°ƒç”¨ç§æœ‰æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(obj, <span class="string">&quot;Alice&quot;</span>,<span class="number">18</span>); <span class="comment">// obj æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œåé¢æ˜¯å‚æ•°</span></span><br><span class="line"><span class="comment">//è°ƒç”¨é™æ€æ–¹æ³•</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">staticMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;staticMethodTest&quot;</span>,String.class,Book.class);</span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> (String )staticMethod.invoke(<span class="literal">null</span>,<span class="string">&quot;äºŒç­&quot;</span>,javaBook); <span class="comment">//å¦‚æœæœ‰è¿”å›å€¼ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œå› ä¸ºinvokeè¿”å›å€¼æ˜¯objectç±»å‹çš„</span></span><br></pre></td></tr></table></figure><h2 id="Golangåå°„ï¼š"><a href="#Golangåå°„ï¼š" class="headerlink" title="Golangåå°„ï¼š"></a>Golangåå°„ï¼š</h2><p>golangçš„ç‰¹ç‚¹æ˜¯æ‰å¹³åŒ–ï¼Œä»–çš„åå°„ä¸æ˜¯åƒjavaé‚£æ ·ï¼Œæ‰€æœ‰ç»§æ‰¿è‡ªobjectç±»ï¼Œçœ‹èµ·æ¥å±‚æ¬¡åˆ†æ˜ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡é’ˆå’Œä¸‡èƒ½æ¥å£åœ¨å¹³é¢ä¸Šæ“ä½œ</p><p>åœ¨ Go ä¸­ï¼Œåå°„ä¸»è¦é€šè¿‡ä¸¤ä¸ªæ ¸å¿ƒç±»å‹å®ç°ï¼š</p><ul><li><code>reflect.Type</code>ï¼šè¡¨ç¤ºç±»å‹ä¿¡æ¯</li><li><code>reflect.Value</code>ï¼šè¡¨ç¤ºå€¼ä¿¡æ¯</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ========== å®šä¹‰ç¤ºä¾‹ç»“æ„ä½“ ==============</span></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">Name    <span class="type">string</span> <span class="string">`json:&quot;name&quot; validate:&quot;required&quot;`</span></span><br><span class="line">Age     <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">Address <span class="type">string</span> <span class="string">`json:&quot;address,omitempty&quot;`</span></span><br><span class="line">private <span class="type">string</span> <span class="comment">// å°å†™å¼€å¤´çš„ç§æœ‰å­—æ®µ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æ„ä½“æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Person)</span></span> UpdateName(newName <span class="type">string</span>) &#123;</span><br><span class="line">p.Name = newName</span><br><span class="line">fmt.Printf(<span class="string">&quot;å§“åå·²æ›´æ–°ä¸º: %s\n&quot;</span>, newName)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span></span> Greet() <span class="type">string</span> &#123;</span><br><span class="line"><span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯%sï¼Œä»Šå¹´%då²&quot;</span>, p.Name, p.Age)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//===============================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 2. åå°„åŸºç¡€ï¼šè·å–ç±»å‹å’Œå€¼ä¿¡æ¯ ========</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">basicReflection</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// ç¤ºä¾‹å˜é‡</span></span><br><span class="line">str := <span class="string">&quot;Hello, Reflection!&quot;</span></span><br><span class="line">num := <span class="number">42</span></span><br><span class="line">person := Person&#123;Name: <span class="string">&quot;å¼ ä¸‰&quot;</span>, Age: <span class="number">30</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) è·å–ç±»å‹ä¿¡æ¯</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;å­—ç¬¦ä¸²ç±»å‹: %v\n&quot;</span>, reflect.TypeOf(str))</span><br><span class="line">fmt.Printf(<span class="string">&quot;æ•´æ•°ç±»å‹: %v\n&quot;</span>, reflect.TypeOf(num))</span><br><span class="line">fmt.Printf(<span class="string">&quot;ç»“æ„ä½“ç±»å‹: %v\n&quot;</span>, reflect.TypeOf(person))</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) è·å–å€¼ä¿¡æ¯</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;å­—ç¬¦ä¸²å€¼: %v\n&quot;</span>, reflect.ValueOf(str))</span><br><span class="line">fmt.Printf(<span class="string">&quot;æ•´æ•°å€¼: %v\n&quot;</span>, reflect.ValueOf(num))</span><br><span class="line">fmt.Printf(<span class="string">&quot;ç»“æ„ä½“å€¼: %v\n&quot;</span>, reflect.ValueOf(person))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 3. åå°„æ“ä½œç»“æ„ä½“ =====================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">structReflection</span><span class="params">(input <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">val := reflect.ValueOf(input)</span><br><span class="line">typ := reflect.TypeOf(input)</span><br><span class="line"><span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">if</span> val.Kind() == reflect.Ptr &#123;</span><br><span class="line">val = val.Elem() <span class="comment">// è·å–æŒ‡é’ˆæŒ‡å‘çš„å€¼</span></span><br><span class="line">typ = typ.Elem()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">if</span> val.Kind() != reflect.Struct &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;è¾“å…¥çš„ä¸æ˜¯ç»“æ„ä½“&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) è¯»å–ç»“æ„ä½“ä¿¡æ¯</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;ç»“æ„ä½“åç§°: %s\n&quot;</span>, typ.Name())</span><br><span class="line">fmt.Printf(<span class="string">&quot;å­—æ®µæ•°é‡: %d\n&quot;</span>, val.NumField())</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) éå†å­—æ®µ</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; val.NumField(); i++ &#123;</span><br><span class="line">field := typ.Field(i)</span><br><span class="line">fieldVal := val.Field(i)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;å­—æ®µ %d: %s\n&quot;</span>, i, field.Name)</span><br><span class="line">fmt.Printf(<span class="string">&quot;  ç±»å‹: %v\n&quot;</span>, field.Type)</span><br><span class="line">fmt.Printf(<span class="string">&quot;  æ ‡ç­¾: %v\n&quot;</span>, field.Tag)</span><br><span class="line">fmt.Printf(<span class="string">&quot;  å€¼: %v\n&quot;</span>, fieldVal.Interface())</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–jsonæ ‡ç­¾</span></span><br><span class="line"><span class="keyword">if</span> jsonTag := field.Tag.Get(<span class="string">&quot;json&quot;</span>); jsonTag != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;  jsonæ ‡ç­¾: %s\n&quot;</span>, jsonTag)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3) ä¿®æ”¹å­—æ®µå€¼</span></span><br><span class="line"><span class="keyword">if</span> val.CanAddr() &#123;</span><br><span class="line">nameField := val.FieldByName(<span class="string">&quot;Name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> nameField.IsValid() &amp;&amp; nameField.CanSet() &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;ä¿®æ”¹å‰Name: %v\n&quot;</span>, nameField.Interface())</span><br><span class="line">nameField.SetString(<span class="string">&quot;æå››&quot;</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;ä¿®æ”¹åName: %v\n&quot;</span>, nameField.Interface())</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æ— æ³•ä¿®æ”¹Nameå­—æ®µ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°è¯•ä¿®æ”¹ç§æœ‰å­—æ®µ (ä¼šå¤±è´¥)</span></span><br><span class="line">privateField := val.FieldByName(<span class="string">&quot;private&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> privateField.IsValid() &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æ‰¾åˆ°privateå­—æ®µ&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> privateField.CanSet() &#123;</span><br><span class="line">privateField.SetString(<span class="string">&quot;å°è¯•ä¿®æ”¹&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æ— æ³•ä¿®æ”¹privateå­—æ®µ(å› ä¸ºæ˜¯ç§æœ‰çš„)&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;å€¼ä¸å¯å¯»å€ï¼Œæ— æ³•ä¿®æ”¹å­—æ®µ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 4. åå°„è°ƒç”¨æ–¹æ³• ======================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">methodReflection</span><span class="params">(input <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">val := reflect.ValueOf(input)</span><br><span class="line">typ := reflect.TypeOf(input)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) è°ƒç”¨æ— å‚æ•°æ–¹æ³•</span></span><br><span class="line">myMethod := val.MethodByName(<span class="string">&quot;myMethod&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> myMethod.IsValid() &#123;</span><br><span class="line">results := greetMethod.Call(<span class="literal">nil</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(results) &gt; <span class="number">0</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æ–¹æ³•è¿”å›:&quot;</span>, results[<span class="number">0</span>].String())</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æœªæ‰¾åˆ°æ–¹æ³•&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">// (2) è°ƒç”¨å¸¦å‚æ•°æ–¹æ³•</span></span><br><span class="line">updateMethod := val.MethodByName(<span class="string">&quot;UpdateName&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> updateMethod.IsValid() &#123;</span><br><span class="line">args := []reflect.Value&#123;</span><br><span class="line">reflect.ValueOf(<span class="string">&quot;ç‹äº”&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line">updateMethod.Call(args)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;æœªæ‰¾åˆ°UpdateNameæ–¹æ³•&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å‡è®¾æœ‰ä¸¤ä¸ªå‚æ•°</span></span><br><span class="line">    method := val.MethodByName(<span class="string">&quot;UpdateInfo&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> !method.IsValid() &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;æœªæ‰¾åˆ°UpdateInfoæ–¹æ³•&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    args := []reflect.Value&#123;</span><br><span class="line">        reflect.ValueOf(<span class="string">&quot;æå››&quot;</span>),     <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šname</span></span><br><span class="line">        reflect.ValueOf(<span class="number">35</span>),       <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šage</span></span><br><span class="line">        reflect.ValueOf(<span class="string">&quot;ä¸Šæµ·&quot;</span>),     <span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šaddress</span></span><br><span class="line">    &#125; <span class="comment">//é€šè¿‡reflect.ValueOfä¼ å‚æ•°å€¼</span></span><br><span class="line">    results := method.Call(args)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">// (3) æŸ¥çœ‹æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; typ.NumMethod(); i++ &#123;</span><br><span class="line">method := typ.Method(i)</span><br><span class="line">fmt.Printf(<span class="string">&quot;æ–¹æ³• %d: %s\n&quot;</span>, i, method.Name)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==============================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 5. åå°„åˆ›å»ºå®ä¾‹ ===================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createInstance</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) è·å–ç±»å‹ä¿¡æ¯</span></span><br><span class="line">personType := reflect.TypeOf(Person&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) åˆ›å»ºæ–°å®ä¾‹</span></span><br><span class="line">newPersonVal := reflect.New(personType) <span class="comment">// è¿”å› *Person çš„ Value</span></span><br><span class="line">newPerson := newPersonVal.Interface().(*Person)</span><br><span class="line">fmt.Printf(<span class="string">&quot;æ–°å®ä¾‹é»˜è®¤å€¼: %+v\n&quot;</span>, *newPerson)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3) è®¾ç½®å­—æ®µå€¼</span></span><br><span class="line">elem := newPersonVal.Elem()</span><br><span class="line">nameField := elem.FieldByName(<span class="string">&quot;Name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> nameField.CanSet() &#123;</span><br><span class="line">nameField.SetString(<span class="string">&quot;èµµå…­&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">ageField := elem.FieldByName(<span class="string">&quot;Age&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> ageField.CanSet() &#123;</span><br><span class="line">ageField.SetInt(<span class="number">35</span>)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;è®¾ç½®åçš„å®ä¾‹: %+v\n&quot;</span>, *newPerson)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==============================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 6. åå°„å®é™…åº”ç”¨ ===================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">practicalApplications</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// (1) ç®€æ˜“å¯¹è±¡æ‹·è´</span></span><br><span class="line">fmt.Println(<span class="string">&quot;\n--- å¯¹è±¡æ‹·è´ ---&quot;</span>)</span><br><span class="line">src := Person&#123;Name: <span class="string">&quot;æºå¯¹è±¡&quot;</span>, Age: <span class="number">40</span>&#125;</span><br><span class="line"><span class="keyword">var</span> dst Person</span><br><span class="line"></span><br><span class="line">srcVal := reflect.ValueOf(&amp;src).Elem()</span><br><span class="line">dstVal := reflect.ValueOf(&amp;dst).Elem()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; srcVal.NumField(); i++ &#123;</span><br><span class="line">fieldName := srcVal.Type().Field(i).Name</span><br><span class="line">srcField := srcVal.FieldByName(fieldName)</span><br><span class="line">dstField := dstVal.FieldByName(fieldName)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> dstField.CanSet() &#123;</span><br><span class="line">dstField.Set(srcField)</span><br><span class="line">fmt.Printf(<span class="string">&quot;æ‹·è´å­—æ®µ %s: %v\n&quot;</span>, fieldName, srcField.Interface())</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;æ‹·è´ç»“æœ: %+v\n&quot;</span>, dst)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1. åå°„åŸºç¡€</span></span><br><span class="line">basicReflection()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ç»“æ„ä½“åå°„æ“ä½œ</span></span><br><span class="line">person := Person&#123;</span><br><span class="line">Name:    <span class="string">&quot;å¼ ä¸‰&quot;</span>,</span><br><span class="line">Age:     <span class="number">30</span>,</span><br><span class="line">Address: <span class="string">&quot;åŒ—äº¬&quot;</span>,</span><br><span class="line">private: <span class="string">&quot;ç§æœ‰æ•°æ®&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">structReflection(&amp;person) <span class="comment">// ä¼ å…¥æŒ‡é’ˆä»¥ä¾¿ä¿®æ”¹</span></span><br><span class="line">structReflection(person)  <span class="comment">// ä¼ å…¥å€¼(ä»…æŸ¥çœ‹)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ–¹æ³•åå°„è°ƒç”¨</span></span><br><span class="line">methodReflection(&amp;person)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. åå°„åˆ›å»ºå®ä¾‹</span></span><br><span class="line">createInstance()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. åå°„å®é™…åº”ç”¨</span></span><br><span class="line">practicalApplications()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*------------------------------</span></span><br><span class="line"><span class="comment">å…³é”®ç‚¹æ€»ç»“</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">æŒ‡é’ˆä¸éæŒ‡é’ˆï¼š</span></span><br><span class="line"><span class="comment">ä¿®æ”¹å€¼éœ€è¦ä¼ é€’æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">ä½¿ç”¨ Elem() è·å–æŒ‡é’ˆæŒ‡å‘çš„å€¼</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¯è®¾ç½®æ€§æ£€æŸ¥ï¼š</span></span><br><span class="line"><span class="comment">ä¿®æ”¹å‰å¿…é¡»æ£€æŸ¥ CanSet()</span></span><br><span class="line"><span class="comment">ç§æœ‰å­—æ®µæ— æ³•é€šè¿‡åå°„ä¿®æ”¹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">æ–¹æ³•è°ƒç”¨ï¼š</span></span><br><span class="line"><span class="comment">å‚æ•°éœ€è¦åŒ…è£…ä¸º []reflect.Value</span></span><br><span class="line"><span class="comment">è¿”å›å€¼ä¹Ÿæ˜¯ []reflect.Value</span></span><br><span class="line"><span class="comment">--------------------------------*/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç»¼åˆå¯¹æ¯”"><a href="#ç»¼åˆå¯¹æ¯”" class="headerlink" title="ç»¼åˆå¯¹æ¯”"></a>ç»¼åˆå¯¹æ¯”</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250912103742900.png" alt="image-20250912103742900"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goå’ŒJavaå¤šçº¿ç¨‹</title>
      <link href="/2025/09/07/Go%E5%92%8CJava%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2025/09/07/Go%E5%92%8CJava%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Java-ä¸-Go-å¹¶å‘ç¼–ç¨‹å¯¹æ¯”"><a href="#Java-ä¸-Go-å¹¶å‘ç¼–ç¨‹å¯¹æ¯”" class="headerlink" title="Java ä¸ Go å¹¶å‘ç¼–ç¨‹å¯¹æ¯”"></a>Java ä¸ Go å¹¶å‘ç¼–ç¨‹å¯¹æ¯”</h1><h2 id="1-å¹¶å‘æ¨¡å‹æ ¸å¿ƒç†å¿µ"><a href="#1-å¹¶å‘æ¨¡å‹æ ¸å¿ƒç†å¿µ" class="headerlink" title="1 å¹¶å‘æ¨¡å‹æ ¸å¿ƒç†å¿µ"></a>1 å¹¶å‘æ¨¡å‹æ ¸å¿ƒç†å¿µ</h2><p>Java å’Œ Go åœ¨å¹¶å‘ç¼–ç¨‹ä¸Šé‡‡ç”¨äº†æˆªç„¶ä¸åŒçš„å“²å­¦å’Œå®ç°æ¨¡å‹ã€‚</p><p><strong>Java</strong> é‡‡ç”¨<strong>å…±äº«å†…å­˜æ¨¡å‹</strong>ã€‚å…¶å¹¶å‘åŸºäºæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆå†…æ ¸çº¿ç¨‹ï¼‰ï¼Œä½ ç¼–å†™çš„æ¯ä¸ª <code>Thread</code> éƒ½ç›´æ¥å¯¹åº”ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹å†…å­˜ç©ºé—´ï¼Œè¿™ä½¿å¾—æ•°æ®å…±äº«ç›´æ¥ï¼Œä½†ä¹Ÿå¸¦æ¥äº†å¤æ‚çš„<strong>åŒæ­¥é—®é¢˜</strong>ã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡è¯»å†™å…±äº«å˜é‡ï¼Œå¹¶ä½¿ç”¨é”ï¼ˆå¦‚ <code>synchronized</code>ï¼‰æˆ–å…¶ä»–åŒæ­¥æœºåˆ¶ï¼ˆå¦‚ <code>wait()/notify()</code>ï¼‰æ¥åè°ƒè®¿é—®ã€é¿å…æ•°æ®ç«äº‰ï¼ŒJava çš„çº¿ç¨‹æ˜¯<strong>æŠ¢å å¼</strong>çš„ï¼Œç”±æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œè°ƒåº¦ï¼Œè¿™å¯èƒ½å¯¼è‡´è°ƒåº¦å¼€é”€è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯åœ¨çº¿ç¨‹æ•°é‡å¾ˆå¤šæ—¶ã€‚</p><p><strong>Go</strong> åˆ™æ¨å´‡ <strong>â€œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜â€</strong> è€Œéâ€œé€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡â€ã€‚å…¶æ ¸å¿ƒæ˜¯ <strong>goroutine</strong>ï¼Œè¿™æ˜¯ä¸€ç§ç”± Go è¿è¡Œæ—¶ç®¡ç†çš„<strong>è½»é‡çº§çº¿ç¨‹</strong>ï¼ˆåç¨‹ï¼‰ã€‚å¤§é‡ goroutine å¯ä»¥åœ¨å°‘é‡æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šé«˜æ•ˆå¤ç”¨ã€‚Go è¿è¡Œæ—¶è°ƒåº¦å™¨é‡‡ç”¨ <strong>GPM æ¨¡å‹</strong>ï¼ˆGoroutine, Processor, Machineï¼‰ï¼Œåœ¨ç”¨æˆ·æ€è¿›è¡Œåä½œå¼è°ƒåº¦ï¼Œè°ƒåº¦å¼€é”€æä½ã€‚goroutine é—´çš„é€šä¿¡é¦–é€‰**é€šé“ (channel)**ï¼Œå®ƒæ˜¯ä¸€ç§ç±»å‹å®‰å…¨çš„é˜Ÿåˆ—ï¼Œç”¨äºåœ¨ä¸åŒçš„ goroutine ä¹‹é—´å®‰å…¨åœ°ä¼ é€’æ•°æ®å’ŒåŒæ­¥æ‰§è¡Œã€‚è™½ç„¶ Go ä¹Ÿæä¾›äº†ä¼ ç»Ÿçš„åŒæ­¥åŸè¯­ï¼ˆå¦‚ <code>sync.Mutex</code>ï¼‰ï¼Œä½†æ›´é¼“åŠ±ä½¿ç”¨ channel æ¥è§£è€¦å¹¶å‘æ“ä½œã€‚</p><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">Java</th><th align="left">Go</th></tr></thead><tbody><tr><td align="left"><strong>å¹¶å‘å•å…ƒ</strong></td><td align="left">çº¿ç¨‹ (Thread), é‡é‡çº§</td><td align="left">åç¨‹ (Goroutine), è½»é‡çº§</td></tr><tr><td align="left"><strong>åˆ›å»ºæ–¹å¼</strong></td><td align="left">ç»§æ‰¿ <code>Thread</code> ç±»æˆ–å®ç° <code>Runnable</code>&#x2F;<code>Callable</code> æ¥å£</td><td align="left"><code>go</code> å…³é”®å­—</td></tr><tr><td align="left"><strong>è°ƒåº¦æœºåˆ¶</strong></td><td align="left">æ“ä½œç³»ç»Ÿå†…æ ¸æŠ¢å å¼è°ƒåº¦</td><td align="left">Go è¿è¡Œæ—¶åä½œå¼è°ƒåº¦ (GPM æ¨¡å‹)</td></tr><tr><td align="left"><strong>å†…å­˜å¼€é”€</strong></td><td align="left">è¾ƒå¤§ (é»˜è®¤çº¦ 1MB&#x2F;çº¿ç¨‹)</td><td align="left">æå° (åˆå§‹çº¦ 2KB&#x2F;goroutine)</td></tr><tr><td align="left"><strong>é€šä¿¡æœºåˆ¶</strong></td><td align="left">ä¸»è¦é€šè¿‡<strong>å…±äº«å†…å­˜</strong>ï¼Œä½¿ç”¨é”åŒæ­¥ (<code>synchronized</code>, <code>Lock</code>)</td><td align="left">ä¸»è¦é€šè¿‡<strong>é€šé“ (Channel)</strong></td></tr><tr><td align="left"><strong>è®¾è®¡å“²å­¦</strong></td><td align="left">é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡</td><td align="left">é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜</td></tr><tr><td align="left"><strong>ä¼˜åŠ¿åœºæ™¯</strong></td><td align="left">CPU å¯†é›†å‹ä»»åŠ¡ã€å¤æ‚çš„ä¼ä¸šçº§åº”ç”¨</td><td align="left">I&#x2F;O å¯†é›†å‹ä»»åŠ¡ã€é«˜å¹¶å‘ç½‘ç»œæœåŠ¡</td></tr></tbody></table><h2 id="2-å¹¶å‘å•å…ƒçš„åˆ›å»ºä¸ç®¡ç†"><a href="#2-å¹¶å‘å•å…ƒçš„åˆ›å»ºä¸ç®¡ç†" class="headerlink" title="2 å¹¶å‘å•å…ƒçš„åˆ›å»ºä¸ç®¡ç†"></a>2 å¹¶å‘å•å…ƒçš„åˆ›å»ºä¸ç®¡ç†</h2><h3 id="2-1-Java-çº¿ç¨‹åˆ›å»ºä¸ç®¡ç†"><a href="#2-1-Java-çº¿ç¨‹åˆ›å»ºä¸ç®¡ç†" class="headerlink" title="2.1 Java çº¿ç¨‹åˆ›å»ºä¸ç®¡ç†"></a>2.1 Java çº¿ç¨‹åˆ›å»ºä¸ç®¡ç†</h3><p>Java ä¸­çº¿ç¨‹æ˜¯ç›¸å¯¹é‡é‡çº§çš„èµ„æºï¼Œç›´æ¥ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ã€‚</p><ul><li><p><strong>åˆ›å»ºæ–¹å¼</strong>ï¼š</p><p>ç»§æ‰¿ <code>Thread</code> ç±»ï¼Œé‡å†™ run()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Thread running&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">MyThread</span>().start();</span><br></pre></td></tr></table></figure><p>å®ç° <code>Runnable</code> æ¥å£ï¼ˆæ›´æ¨èï¼‰ï¼šé¿å…ç»§æ‰¿çš„å±€é™æ€§ï¼Œæ›´çµæ´»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Runnable running&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyRunnable</span>());</span><br><span class="line">t.start();</span><br></pre></td></tr></table></figure><p>å®ç° <code>Callable</code> æ¥å£ï¼šå¯ä»¥è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ï¼Œé€šå¸¸ä¸FutureTaskå’Œçº¿ç¨‹æ± ç»“åˆä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Callable&lt;String&gt; task = () -&gt; &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Task Done&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line">FutureTask&lt;String&gt; future = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(task);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(future).start();</span><br><span class="line">System.out.println(future.get()); <span class="comment">// è·å–è¿”å›å€¼</span></span><br></pre></td></tr></table></figure><p>**çº¿ç¨‹æ±  (ThreadPool)**ï¼šä¸ºå‡å°‘é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ï¼ŒJava æä¾›äº†å¼ºå¤§çš„çº¿ç¨‹æ± æ”¯æŒ (<code>java.util.concurrent.ExecutorService</code>)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šåˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± </span></span><br><span class="line"><span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">4</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    executor.submit(() -&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task executed by &quot;</span> + Thread.currentThread().getName());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">executor.shutdown();</span><br></pre></td></tr></table></figure><p><strong>æ ¸å¿ƒå‚æ•°</strong>ï¼š</p><ul><li><code>corePoolSize</code>: æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚</li><li><code>maximumPoolSize</code>: æœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li><code>workQueue</code>: ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå¦‚ <code>ArrayBlockingQueue</code>, <code>LinkedBlockingQueue</code>ï¼‰ã€‚</li><li><code>RejectedExecutionHandler</code>: æ‹’ç»ç­–ç•¥ï¼ˆå¦‚ <code>AbortPolicy</code> æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚</li></ul></li></ul><h3 id="2-2-Go-Goroutine-åˆ›å»ºä¸ç®¡ç†"><a href="#2-2-Go-Goroutine-åˆ›å»ºä¸ç®¡ç†" class="headerlink" title="2.2 Go Goroutine åˆ›å»ºä¸ç®¡ç†"></a>2.2 Go Goroutine åˆ›å»ºä¸ç®¡ç†</h3><p>Goroutine æ˜¯ Go çš„è½»é‡çº§å¹¶å‘å•å…ƒï¼Œç”± Go è¿è¡Œæ—¶è°ƒåº¦ï¼Œå¼€é”€æå°ã€‚</p><ul><li><p><strong>åˆ›å»ºæ–¹å¼</strong>ï¼šä½¿ç”¨ <code>go</code> å…³é”®å­—åè·Ÿå‡½æ•°è°ƒç”¨ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello from Goroutine!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">go</span> sayHello() <span class="comment">// å¯åŠ¨ä¸€ä¸ª goroutine</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello from Main!&quot;</span>)</span><br><span class="line">    time.Sleep(time.Second) <span class="comment">// é˜²æ­¢ä¸» goroutine é€€å‡ºå¤ªå¿«</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ç­‰å¾… Goroutine å®Œæˆ</strong>ï¼šå¸¸ç”¨ <code>sync.WaitGroup</code> æ¥åŒæ­¥ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">        wg.Add(<span class="number">1</span>) <span class="comment">// å¢åŠ è®¡æ•°å™¨</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">defer</span> wg.Done() <span class="comment">// å®Œæˆåè®¡æ•°å™¨å‡1</span></span><br><span class="line">            fmt.Printf(<span class="string">&quot;Goroutine %d done\n&quot;</span>, id)</span><br><span class="line">        &#125;(i)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    wg.Wait() <span class="comment">// é˜»å¡ç›´åˆ°æ‰€æœ‰ goroutine å®Œæˆ</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;All goroutines finished.&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-é€šä¿¡ä¸åŒæ­¥æœºåˆ¶"><a href="#3-é€šä¿¡ä¸åŒæ­¥æœºåˆ¶" class="headerlink" title="3 é€šä¿¡ä¸åŒæ­¥æœºåˆ¶"></a>3 é€šä¿¡ä¸åŒæ­¥æœºåˆ¶</h2><h3 id="3-1-Java-çš„å…±äº«å†…å­˜ä¸é”"><a href="#3-1-Java-çš„å…±äº«å†…å­˜ä¸é”" class="headerlink" title="3.1 Java çš„å…±äº«å†…å­˜ä¸é”"></a>3.1 Java çš„å…±äº«å†…å­˜ä¸é”</h3><p>Java çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œå› æ­¤åŒæ­¥æ˜¯å…³é”®ã€‚</p><ul><li><p><strong>synchronized å…³é”®å­—</strong>ï¼šç”¨äºä¿®é¥°æ–¹æ³•æˆ–ä»£ç å—ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span> &#123;</span><br><span class="line">    counter++; <span class="comment">// åŒæ­¥æ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(<span class="built_in">this</span>) &#123; <span class="comment">// åŒæ­¥ä»£ç å—</span></span><br><span class="line">        <span class="comment">// ... </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-2-Go-çš„-Channel-ä¸-Select"><a href="#3-2-Go-çš„-Channel-ä¸-Select" class="headerlink" title="3.2 Go çš„ Channel ä¸ Select"></a>3.2 Go çš„ Channel ä¸ Select</h3><p>Go æ¨èé€šè¿‡ Channel åœ¨ Goroutine é—´è¿›è¡Œé€šä¿¡å’ŒåŒæ­¥ã€‚</p><ul><li><p>**Channel (é€šé“)**ï¼šæ˜¯ä¸€ç§ç±»å‹åŒ–çš„ç®¡é“ï¼Œç”¨äºåœ¨ä¸åŒçš„ Goroutine ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªä¼ é€’ int çš„æ— ç¼“å†² channel</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        ch &lt;- <span class="number">42</span> <span class="comment">// å‘ channel å‘é€æ•°æ®</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    value := &lt;-ch <span class="comment">// ä» channel æ¥æ”¶æ•°æ®</span></span><br><span class="line">    fmt.Println(value) <span class="comment">// è¾“å‡º: 42</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>æ— ç¼“å†² Channel</strong>ï¼šå‘é€å’Œæ¥æ”¶ä¼šé˜»å¡ï¼Œç›´åˆ°å¦ä¸€æ–¹å‡†å¤‡å¥½ï¼Œæ˜¯å¼ºåŒæ­¥çš„ã€‚</li><li><strong>æœ‰ç¼“å†² Channel</strong>ï¼š<code>make(chan int, size)</code>ï¼Œåªæœ‰åœ¨ç¼“å†²åŒºæ»¡æˆ–ç©ºæ—¶æ‰ä¼šé˜»å¡ã€‚</li></ul></li><li><p><strong>Select è¯­å¥</strong>ï¼šç”¨äºåŒæ—¶å¤„ç†å¤šä¸ª Channelï¼Œç±»ä¼¼äº <code>switch</code> ä½†ä¸“ä¸º Channel è®¾è®¡ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> msg1 := &lt;-ch1:</span><br><span class="line">    fmt.Println(<span class="string">&quot;Received&quot;</span>, msg1)</span><br><span class="line"><span class="keyword">case</span> msg2 := &lt;-ch2:</span><br><span class="line">    fmt.Println(<span class="string">&quot;Received&quot;</span>, msg2)</span><br><span class="line"><span class="keyword">case</span> ch3 &lt;- <span class="number">3</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;Sent 3&quot;</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;No communication&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä¼ ç»Ÿçš„åŒæ­¥åŸè¯­</strong>ï¼šGo ä¹Ÿåœ¨ <code>sync</code> åŒ…ä¸­æä¾›äº† <code>Mutex</code>, <code>RWMutex</code>, <code>Once</code> ç­‰ï¼Œç”¨äºæ›´å¤æ‚çš„åœºæ™¯æˆ–æ€§èƒ½å…³é”®å¤„ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> counter <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> mu sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">increment</span><span class="params">()</span></span> &#123;</span><br><span class="line">    mu.Lock()</span><br><span class="line">    <span class="keyword">defer</span> mu.Unlock() <span class="comment">// ä½¿ç”¨ defer ç¡®ä¿è§£é”</span></span><br><span class="line">    counter++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="4-ä½¿ç”¨ä¹ æƒ¯ä¸æ³¨æ„äº‹é¡¹"><a href="#4-ä½¿ç”¨ä¹ æƒ¯ä¸æ³¨æ„äº‹é¡¹" class="headerlink" title="4 ä½¿ç”¨ä¹ æƒ¯ä¸æ³¨æ„äº‹é¡¹"></a>4 ä½¿ç”¨ä¹ æƒ¯ä¸æ³¨æ„äº‹é¡¹</h2><h3 id="4-1-Java-å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹"><a href="#4-1-Java-å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹" class="headerlink" title="4.1 Java å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹"></a>4.1 Java å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹</h3><ul><li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šå§‹ç»ˆæ³¨æ„å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚ä¼˜å…ˆä½¿ç”¨çº¿ç¨‹å®‰å…¨é›†åˆï¼ˆå¦‚ <code>ConcurrentHashMap</code>ï¼‰ã€‚</li><li><strong>é¿å…æ­»é”</strong>ï¼šç¡®ä¿é”çš„è·å–é¡ºåºä¸€è‡´ï¼Œè€ƒè™‘ä½¿ç”¨å®šæ—¶é”å°è¯•ï¼ˆ<code>tryLock</code>ï¼‰ã€‚</li><li>æ€§èƒ½è€ƒé‡<ul><li>çº¿ç¨‹åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§ï¼Œ<strong>åŠ¡å¿…ä½¿ç”¨çº¿ç¨‹æ± </strong>ã€‚</li><li>é”ç«äº‰ä¼šä¸¥é‡é™ä½æ€§èƒ½ï¼Œå°½é‡å‡å°‘ä¸´ç•ŒåŒºèŒƒå›´ã€‚</li></ul></li><li><strong>å¤æ‚æ€§é—®é¢˜</strong>ï¼šå¤šçº¿ç¨‹ä»£ç éš¾ä»¥ç¼–å†™ã€è°ƒè¯•å’Œç»´æŠ¤ã€‚å……åˆ†åˆ©ç”¨ <code>java.util.concurrent</code> åŒ…ä¸­çš„é«˜çº§å·¥å…·ï¼ˆå¦‚ <code>CountDownLatch</code>, <code>CyclicBarrier</code>, <code>Semaphore</code>ï¼‰ã€‚</li></ul><h3 id="4-2-Go-å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹"><a href="#4-2-Go-å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹" class="headerlink" title="4.2 Go å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹"></a>4.2 Go å¹¶å‘ç¼–ç¨‹æ³¨æ„äº‹é¡¹</h3><ul><li><p>Channel ä½¿ç”¨åŸåˆ™ï¼š</p><ul><li><strong>å…³é—­ Channel</strong>ï¼šç”±å‘é€æ–¹å…³é—­ Channelï¼Œæ¥æ”¶æ–¹å¯é€šè¿‡ <code>val, ok := &lt;-ch</code> åˆ¤æ–­æ˜¯å¦å…³é—­ã€‚</li><li><strong>é¿å…æ³„éœ²</strong>ï¼šä¸ä½¿ç”¨çš„ Goroutine è¦ç¡®ä¿èƒ½æ­£å¸¸ç»“æŸï¼Œé˜²æ­¢å†…å­˜æ³„éœ²ã€‚</li></ul></li><li><p>Goroutine æ³„æ¼</p><p>ï¼šå¦‚æœ Goroutine å¯åŠ¨åæ°¸è¿œé˜»å¡ï¼ˆå¦‚åœ¨ä¸€ä¸ªå†æ— äººå‘é€çš„ Channel ä¸Šç­‰å¾…ï¼‰ï¼Œä¼šå¯¼è‡´æ³„æ¼ã€‚ä½¿ç”¨ context.Context æ¥å®ç°å–æ¶ˆå’Œè¶…æ—¶æœºåˆ¶</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ctx, cancel := context.WithTimeout(context.Background(), <span class="number">2</span>*time.Second)</span><br><span class="line"><span class="keyword">defer</span> cancel()</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">5</span> * time.Second): <span class="comment">//5ç§’è¶…æ—¶</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;Work done&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">    fmt.Println(<span class="string">&quot;Cancelled or timeout:&quot;</span>, ctx.Err()) <span class="comment">//ä¸¤ç§’è¶…æ—¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="contextå’ŒAfteråŒºåˆ«ï¼š"><a href="#contextå’ŒAfteråŒºåˆ«ï¼š" class="headerlink" title="contextå’ŒAfteråŒºåˆ«ï¼š"></a><strong>contextå’ŒAfteråŒºåˆ«</strong>ï¼š</h4><p>contextæ˜¯ä»å¼€å§‹åˆ›å»ºçš„æ—¶å€™å¼€å§‹è®¡æ—¶çš„ï¼ŒAfteræ˜¯ä»è°ƒç”¨çš„é‚£ä¸€åˆ»å¼€å§‹è®¡æ—¶çš„</p><p>contextå¯ä»¥æ‰‹åŠ¨cancel()å–æ¶ˆ</p><p>contextçˆ¶å–æ¶ˆï¼Œå­ä¹Ÿä¼šå–æ¶ˆ</p><h4 id="çˆ¶å­contextï¼š"><a href="#çˆ¶å­contextï¼š" class="headerlink" title="çˆ¶å­contextï¼š"></a><strong>çˆ¶å­contextï¼š</strong></h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// çˆ¶ Contextï¼š3ç§’è¶…æ—¶</span></span><br><span class="line">    parentCtx, cancel := context.WithTimeout(context.Background(), <span class="number">3</span>*time.Second)</span><br><span class="line">    <span class="keyword">defer</span> cancel()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­ Contextï¼š5ç§’è¶…æ—¶ï¼ˆå®é™…å—çˆ¶ Context çº¦æŸï¼Œæœ€å¤š3ç§’ï¼‰</span></span><br><span class="line">    childCtx := context.WithTimeout(parentCtx, <span class="number">5</span>*time.Second)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯åŠ¨å­ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(ctx context.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">            fmt.Println(<span class="string">&quot;å­ä»»åŠ¡è¢«å–æ¶ˆ:&quot;</span>, ctx.Err()) <span class="comment">// å®é™…ç”±çˆ¶ Context è§¦å‘</span></span><br><span class="line">        <span class="keyword">case</span> &lt;-time.After(<span class="number">4</span> * time.Second):</span><br><span class="line">            fmt.Println(<span class="string">&quot;å­ä»»åŠ¡å®Œæˆ&quot;</span>) <span class="comment">// ä¸ä¼šæ‰§è¡Œï¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;(childCtx)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…çˆ¶ Context è¶…æ—¶</span></span><br><span class="line">    &lt;-parentCtx.Done()</span><br><span class="line">    fmt.Println(<span class="string">&quot;çˆ¶ä»»åŠ¡è¶…æ—¶&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">åœºæ™¯</th><th align="center">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="center"><strong>å¾®æœåŠ¡è°ƒç”¨é“¾</strong></td><td align="center">A æœåŠ¡è°ƒç”¨ B æœåŠ¡æ—¶ï¼Œä¼ é€’çˆ¶ Context ç¡®ä¿ç»Ÿä¸€è¶…æ—¶å’Œå–æ¶ˆã€‚</td></tr><tr><td align="center"><strong>HTTP è¯·æ±‚åµŒå¥—</strong></td><td align="center">ä¸»è¯·æ±‚è®¾ç½®è¶…æ—¶ï¼Œå­è¯·æ±‚ï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ç»§æ‰¿è¯¥è¶…æ—¶ã€‚</td></tr><tr><td align="center"><strong>è·¨ Goroutine ä»»åŠ¡</strong></td><td align="center">ä¸»ä»»åŠ¡å–æ¶ˆæ—¶ï¼Œè‡ªåŠ¨ç»ˆæ­¢æ‰€æœ‰å…³è”çš„å­ä»»åŠ¡ã€‚</td></tr><tr><td align="center"><strong>é“¾è·¯è¿½è¸ª</strong></td><td align="center">åœ¨çˆ¶ Context ä¸­å­˜å‚¨ TraceIDï¼Œå­ Context è‡ªåŠ¨ç»§æ‰¿ã€‚</td></tr></tbody></table></li><li><p>å¾ªç¯å˜é‡æ•è·ï¼šåœ¨å¾ªç¯ä¸­å¯åŠ¨ Goroutine æ—¶ï¼ŒåŠ¡å¿…å°†å¾ªç¯å˜é‡ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦åˆ™æ‰€æœ‰ Goroutine å¯èƒ½ä¼šå…±äº«åŒä¸€ä¸ªï¼ˆæœ€ç»ˆï¼‰å˜é‡å€¼ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ç¤ºèŒƒ</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(i) <span class="comment">// å¾ˆå¯èƒ½å…¨éƒ¨æ‰“å°5</span></span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®åšæ³•</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">        fmt.Println(id)</span><br><span class="line">    &#125;(i) <span class="comment">// å°† i ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä¸è¦è¿‡åº¦ä½¿ç”¨ Goroutine</strong>ï¼šè™½ç„¶è½»é‡ï¼Œä½†å¹¶éæ— é™ã€‚æ§åˆ¶å¹¶å‘æ•°é‡ï¼ˆä¾‹å¦‚ä½¿ç”¨å¸¦ç¼“å†²çš„ Channel ä½œä¸ºä¿¡å·é‡æˆ– worker poolï¼‰ã€‚</p></li></ul><h2 id="5-æ€§èƒ½ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯"><a href="#5-æ€§èƒ½ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯" class="headerlink" title="5 æ€§èƒ½ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯"></a>5 æ€§èƒ½ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯</h2><table><thead><tr><th align="left">æ–¹é¢</th><th align="left">Java</th><th align="left">Go</th></tr></thead><tbody><tr><td align="left"><strong>å¯åŠ¨é€Ÿåº¦</strong></td><td align="left">è¾ƒæ…¢ï¼ˆéœ€ JVM å¯åŠ¨ã€ç±»åŠ è½½ï¼‰</td><td align="left"><strong>æå¿«</strong>ï¼ˆé™æ€ç¼–è¯‘ï¼Œç›´æ¥è¿è¡Œï¼‰</td></tr><tr><td align="left"><strong>å†…å­˜å ç”¨</strong></td><td align="left">è¾ƒé«˜ï¼ˆçº¿ç¨‹é»˜è®¤æ ˆå¤§å° ~1MBï¼‰</td><td align="left"><strong>æä½</strong>ï¼ˆGoroutine åˆå§‹æ ˆ ~2KBï¼‰</td></tr><tr><td align="left"><strong>é«˜å¹¶å‘è¡¨ç°</strong></td><td align="left">çº¿ç¨‹æ•°å¤šæ—¶ï¼Œåˆ›å»ºã€åˆ‡æ¢å¼€é”€å¤§ï¼Œæ€§èƒ½ä¸‹é™</td><td align="left"><strong>ä¼˜åŠ¿æ˜æ˜¾</strong>ï¼Œå¯è½»æ¾åˆ›å»ºæ•°åä¸‡ Goroutine</td></tr><tr><td align="left"><strong>GC å½±å“</strong></td><td align="left">GC æŠ€æœ¯æˆç†Ÿï¼ˆG1, ZGCï¼‰ï¼Œä½† Full GC å¯èƒ½å¼•å‘ STW</td><td align="left">GC ä¼˜åŒ–è‰¯å¥½ï¼ˆå¹¶å‘ GCï¼‰ï¼ŒSTW æ—¶é—´çŸ­</td></tr><tr><td align="left"><strong>å…¸å‹åº”ç”¨åœºæ™¯</strong></td><td align="left">CPU å¯†é›†å‹è®¡ç®—ã€å¤æ‚ä¸šåŠ¡é€»è¾‘çš„å¤§å‹ä¼ä¸šåº”ç”¨</td><td align="left"><strong>é«˜å¹¶å‘ç½‘ç»œæœåŠ¡</strong>ã€API ç½‘å…³ã€å¾®æœåŠ¡ã€åˆ†å¸ƒå¼ç³»ç»Ÿ</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAåŸºç¡€</title>
      <link href="/2025/05/30/JAVA/"/>
      <url>/2025/05/30/JAVA/</url>
      
        <content type="html"><![CDATA[<h5 id="class-å’Œ-æ•°ç»„-åœ¨å†…å­˜ä¸Šçš„ç›¸ä¼¼æ€§"><a href="#class-å’Œ-æ•°ç»„-åœ¨å†…å­˜ä¸Šçš„ç›¸ä¼¼æ€§" class="headerlink" title="class å’Œ æ•°ç»„ åœ¨å†…å­˜ä¸Šçš„ç›¸ä¼¼æ€§"></a>class å’Œ æ•°ç»„ åœ¨å†…å­˜ä¸Šçš„ç›¸ä¼¼æ€§</h5><p>ç±»å’Œæ•°ç»„çš„ å ï¼Œå‡ä¿å­˜çš„æ˜¯åœ°å€å€¼</p><p>å³ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">myclass</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> num;</span><br><span class="line">string str;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">change</span><span class="params">(<span class="type">int</span> a ,string s)</span></span><br><span class="line">&#123;</span><br><span class="line">a = a+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">...mian...()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">myclass</span> <span class="variable">class01</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">myclass</span>();</span><br><span class="line">    <span class="type">myclass</span> <span class="variable">class02</span> <span class="operator">=</span> class01;<span class="comment">//è¿™ä¸€æ­¥æŠŠclass01çš„åœ°å€å€¼èµ‹å€¼ç»™äº†class02ï¼Œä»–ä»¬ä¸¤ä¸ªç°åœ¨æŒ‡å‘åŒä¸€ç‰‡å†…å­˜ç©ºé—´</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«"><a href="#æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«" class="headerlink" title="æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«"></a>æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«</h5><ul><li><p>åˆå§‹åŒ–å€¼ä¸åŒï¼š</p><p>æˆå‘˜å˜é‡æœ‰åˆå§‹å€¼ï¼Œå±€éƒ¨å˜é‡æ²¡æœ‰</p></li><li><p>å†…å­˜ä½ç½®ä¸åŒï¼š</p><p>æˆå‘˜å˜é‡åœ¨å †ä¸­ï¼ˆæœ¬è´¨æ˜¯è·Ÿç€å¯¹è±¡èµ°ï¼‰ï¼Œå±€éƒ¨å˜é‡åœ¨æ ˆä¸­ï¼ˆæœ¬è´¨æ˜¯è·Ÿç€æ–¹æ³•èµ°ï¼‰</p></li><li><p>ç”Ÿå‘½å‘¨æœŸä¸åŒï¼š</p><p>æˆå‘˜å˜é‡è·Ÿç€å¯¹è±¡èµ°ï¼Œéšç€å¯¹è±¡çš„äº§ç”Ÿè€Œäº§ç”Ÿï¼Œéšç€å¯¹è±¡çš„æ¶ˆäº¡è€Œæ¶ˆäº¡</p><p>å±€éƒ¨å˜é‡è·Ÿç€æ–¹æ³•èµ°ï¼Œéšç€æ–¹æ³•çš„è°ƒç”¨è€Œäº§ç”Ÿï¼Œéšç€æ–¹æ³•ç»“æŸè€Œæ¶ˆäº¡</p></li></ul><h5 id="thiså…³é”®å­—â€”â€”-åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡"><a href="#thiså…³é”®å­—â€”â€”-åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡" class="headerlink" title="thiså…³é”®å­—â€”â€”&gt;åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡"></a>thiså…³é”®å­—â€”â€”&gt;åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡</h5><ul><li>å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡é‡åæ—¶ï¼Œéµå¾ªâ€œå°±è¿‘åŸåˆ™â€</li><li>å¦‚æœå°±æƒ³ç”¨æˆå‘˜å˜é‡ï¼Œé‚£å°±ç”¨ this.å˜é‡å æ¥å¼•ç”¨æˆå‘˜å˜é‡</li></ul><p>å¯¹è±¡ä¹‹é—´å¦‚ä½•åŒºåˆ†ï¼Ÿ</p><ul><li>å“ªä¸ªå¯¹è±¡è°ƒç”¨çš„æ–¹æ³•ï¼Œthiså°±æŒ‡å‘å“ªä¸ªå¯¹è±¡</li></ul><h5 id="å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè¦å…ˆnew"><a href="#å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè¦å…ˆnew" class="headerlink" title="å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè¦å…ˆnew"></a>å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè¦å…ˆnew</h5><p>ï¼ˆä»€ä¹ˆæ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼šé™¤äº†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œéƒ½æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyData</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line">string s;</span><br><span class="line"><span class="keyword">static</span> <span class="type">float</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//========== å…¶ä»–ä½œç”¨åŸŸ=========</span></span><br><span class="line"></span><br><span class="line"><span class="type">string</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;666&quot;</span>;    <span class="comment">//æ­£å¸¸èµ‹å€¼</span></span><br><span class="line"><span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> string b.length; <span class="comment">//æŠ¥é”™ï¼Œç©ºæŒ‡é’ˆï¼Œæ ¹æœ¬åŸå› æ˜¯æ²¡æœ‰åˆå§‹åŒ–stringç±»å‹å…·ä½“æ˜¯ä»€ä¹ˆï¼Œè€Œç›´æ¥æ“ä½œä»–çš„æˆå‘˜å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒç†ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="type">MyData</span> <span class="variable">mydata</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyData</span>();</span><br><span class="line">mydata.a = <span class="number">1</span>;      <span class="comment">//æ­£å¸¸ï¼Œå…ˆnewäº†ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åæ“ä½œä»–çš„æˆå‘˜å˜é‡</span></span><br><span class="line"></span><br><span class="line">MyData mydata_error.a = <span class="number">2</span>; <span class="comment">//ç©ºæŒ‡é’ˆï¼Œå› ä¸ºè¿mydata_errorå¯¹è±¡éƒ½è¿˜æ²¡åˆ›å»ºï¼Œå°±ç›´æ¥æ“ä½œä»–çš„æˆå‘˜å˜é‡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½†æ˜¯ï¼Œstaticçš„å˜é‡å¯ä»¥ç›´æ¥é€šè¿‡ ç±»å è®¿é—®ï¼Œï¼ˆä¸æ˜¯å¯¹è±¡åï¼‰</span></span><br><span class="line"></span><br><span class="line">MyData.c = <span class="string">&quot;æˆ‘æ˜¯é™æ€å˜é‡&quot;</span>; <span class="comment">//æ­£å¸¸</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="javabeanåœ¨ä¸šåŠ¡å¤„ç†ä¸­çš„ä½œç”¨"><a href="#javabeanåœ¨ä¸šåŠ¡å¤„ç†ä¸­çš„ä½œç”¨" class="headerlink" title="javabeanåœ¨ä¸šåŠ¡å¤„ç†ä¸­çš„ä½œç”¨"></a>javabeanåœ¨ä¸šåŠ¡å¤„ç†ä¸­çš„ä½œç”¨</h5><p><strong>javabeanä¸è¡¨çš„å¯¹åº”å…³ç³»</strong>ï¼š</p><p>ç±»åâ€”â€”&gt;è¡¨å</p><p>å„ä¸ªå®ä¾‹åŒ–å¯¹è±¡â€”â€”&gt;æ¯ä¸€è¡Œ</p><p>æˆå‘˜å˜é‡â€”â€”&gt;æ¯ä¸€åˆ—çš„åˆ—å¤´ï¼ˆä¹Ÿå°±æ˜¯å¯¹åº”çš„å‚æ•°ï¼‰</p><ul><li>æ·»åŠ åŠŸèƒ½ï¼š</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250403200744494.png" alt="image-20250403200744494"></p><ul><li>æŸ¥è¯¢åŠŸèƒ½ï¼š<br><img src="C:\Users\EdwardNygma\AppData\Roaming\Typora\typora-user-images\image-20250403201600516.png" alt="image-20250403201600516"></li></ul><p>æ ‡å‡†javabeanç”Ÿæˆå¿«æ·é”®ï¼šalt + insert</p><h5 id="javaä¸­ï¼Œstaticçš„ç”¨æ³•"><a href="#javaä¸­ï¼Œstaticçš„ç”¨æ³•" class="headerlink" title="javaä¸­ï¼Œstaticçš„ç”¨æ³•"></a>javaä¸­ï¼Œstaticçš„ç”¨æ³•</h5><p><strong>é™æ€æˆå‘˜éšç€ç±»çš„è°ƒç”¨è€Œäº§ç”Ÿï¼Œéé™æ€æˆå‘˜éšç€å¯¹è±¡çš„äº§ç”Ÿè€Œäº§ç”Ÿ</strong></p><p>å› æ­¤æ³¨æ„å››ç§è¾¨æï¼š</p><ul><li><p>åœ¨é™æ€æˆå‘˜ä¸­èƒ½ç›´æ¥è®¿é—®éé™æ€æˆå‘˜å—ï¼š</p><p>ä¸èƒ½ï¼Œæƒ³åœ¨é™æ€æˆå‘˜ä¸­è®¿é—®éé™æ€æˆå‘˜ï¼Œè¦å…ˆnewå¯¹è±¡<br>egï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argsï¼‰&#123;</span></span><br><span class="line"><span class="params">        test01()</span>;   <span class="comment">//â€”â€”â€”â€”â€”â€”&gt;å¯è¡Œï¼Œé™æ€è°ƒç”¨é™æ€</span></span><br><span class="line">        test02();   <span class="comment">//â€”â€”â€”â€”â€”â€”&gt;ä¸å¯è¡Œï¼Œé™æ€ä¸èƒ½ç›´æ¥è°ƒç”¨éé™æ€ï¼Œå› ä¸ºé™æ€æˆå‘˜æ¯”éé™æ€å…ˆäº§ç”Ÿ</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//===æ­£ç¡®è°ƒç”¨ï¼š========        </span></span><br><span class="line">        <span class="type">Demo</span> <span class="variable">mydemo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line">        mydemo.test02();</span><br><span class="line">        <span class="comment">//====================</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line">        sout(<span class="string">&quot;æˆ‘æ˜¯é™æ€æˆå‘˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span>&#123;</span><br><span class="line">        sout(<span class="string">&quot;æˆ‘æ˜¯éé™æ€æˆå‘˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure></li><li><p>åœ¨éé™æ€æ–¹æ³•ä¸­èƒ½ç›´æ¥è®¿é—®é™æ€æˆå‘˜å—ï¼š</p><p>å¯ä»¥ï¼ŒåŒç±»ä¸‹çš„è¯ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼Œä¸åŒç±»çš„è¯ï¼Œé€šè¿‡ç±»åè°ƒç”¨ï¼ˆä¹Ÿå°±æ˜¯é™æ€æ–¹æ³•è·Ÿç€ç±»èµ°ï¼Œä¸è·Ÿç€å¯¹è±¡èµ°ï¼‰</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸ç®¡æ˜¯ä¸æ˜¯åŒç±»ï¼Œç›´æ¥ç±»åè°ƒç”¨</p></li><li><p>åœ¨é™æ€æ–¹æ³•ä¸­èƒ½ç›´æ¥è°ƒç”¨é™æ€æˆå‘˜å—ï¼š</p><p>å¯ä»¥ï¼ŒåŒä¸Š</p></li><li><p>åœ¨éé™æ€æ–¹æ³•ä¸­èƒ½ç›´æ¥è°ƒç”¨éé™æ€æˆå‘˜å—ï¼Ÿ</p><p>å¯ä»¥ï¼ŒåŒç±»ä¸‹å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥newå¯¹è±¡è°ƒç”¨ï¼Œä¸åŒç±»ä¸‹éœ€è¦newå¯¹è±¡è°ƒç”¨</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸ç®¡æ˜¯å¦åŒç±»ï¼Œéƒ½é€šè¿‡newå¯¹è±¡è°ƒç”¨</p></li></ul><p><strong>æ€»ç»“ï¼š</strong></p><p>1.ä¸ç®¡åœ¨ä¸åœ¨åŒä¸€ä¸ªç±»ä¸­,éé™æ€æˆå‘˜éƒ½å¯ä»¥newå¯¹è±¡è°ƒç”¨</p><p>2.ä¸ç®¡åœ¨ä¸åœ¨åŒä¸€ä¸ªç±»ä¸­,é™æ€æˆå‘˜éƒ½å¯ä»¥ç±»åè°ƒç”¨</p><h5 id="å¯å˜å‚æ•°"><a href="#å¯å˜å‚æ•°" class="headerlink" title="å¯å˜å‚æ•°"></a>å¯å˜å‚æ•°</h5><p>å¯å˜å‚æ•°æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„,ç”¨äºä¼ é€’ç±»å‹å·²çŸ¥ä½†æ•°é‡æœªçŸ¥çš„æ•°æ®ç±»å‹</p><p>å½¢å¼ï¼š</p><p>æ•°æ®ç±»å‹â€¦å˜é‡åï¼Œå¦‚ intâ€¦nums  Stringâ€¦kids</p><p><strong>è¿˜æœ‰ï¼Œå¯å˜å‚æ•°å¿…é¡»ä½äºä¼ å‚çš„æœ€åé¢ä½ç½®</strong></p><h5 id="å¯¹è±¡æ•°ç»„"><a href="#å¯¹è±¡æ•°ç»„" class="headerlink" title="å¯¹è±¡æ•°ç»„"></a>å¯¹è±¡æ•°ç»„</h5><p>å°±æ˜¯æ•°ç»„çš„å…ƒç´ æ˜¯å¯¹è±¡ï¼Œç±»å¦‚</p><p>intæ•°ç»„ï¼šint[] arr_int &#x3D; new int[3]</p><p>Personæ•°ç»„ï¼š Person arr_person &#x3D; new Person[3]</p><h5 id="ä¸€äº›æ“ä½œ"><a href="#ä¸€äº›æ“ä½œ" class="headerlink" title="ä¸€äº›æ“ä½œ"></a>ä¸€äº›æ“ä½œ</h5><ul><li><p>å…ˆè°ƒç”¨æ–¹æ³•å†ç”Ÿæˆï¼š</p><p>alt+å›è½¦</p></li><li><p>å°†ä¸€æ®µä»£ç æŠ½å–åˆ°ä¸€ä¸ªæ–¹æ³•ï¼š</p><p>ctrl+alt+m</p></li></ul><h5 id="æœ‰å…³ç»§æ‰¿ï¼š"><a href="#æœ‰å…³ç»§æ‰¿ï¼š" class="headerlink" title="æœ‰å…³ç»§æ‰¿ï¼š"></a>æœ‰å…³ç»§æ‰¿ï¼š</h5><h6 id="å­ç±»å¯ä»¥ç»§æ‰¿ä»€ä¹ˆ"><a href="#å­ç±»å¯ä»¥ç»§æ‰¿ä»€ä¹ˆ" class="headerlink" title="å­ç±»å¯ä»¥ç»§æ‰¿ä»€ä¹ˆ"></a><strong>å­ç±»å¯ä»¥ç»§æ‰¿ä»€ä¹ˆ</strong></h6><p>  a.å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»ä¸­ç§æœ‰å’Œéç§æœ‰æˆå‘˜,ä½†æ˜¯ä¸èƒ½ä½¿ç”¨çˆ¶ç±»ä¸­ç§æœ‰æˆå‘˜</p><p>  b.æ„é€ æ–¹æ³•ä¸èƒ½ç»§æ‰¿</p><h6 id="æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•å„è‡ªçš„è®¿é—®ç‰¹ç‚¹ï¼ˆåŒæ ·é€‚ç”¨äºå¤šæ€ï¼‰"><a href="#æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•å„è‡ªçš„è®¿é—®ç‰¹ç‚¹ï¼ˆåŒæ ·é€‚ç”¨äºå¤šæ€ï¼‰" class="headerlink" title="æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•å„è‡ªçš„è®¿é—®ç‰¹ç‚¹ï¼ˆåŒæ ·é€‚ç”¨äºå¤šæ€ï¼‰"></a><strong>æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•å„è‡ªçš„è®¿é—®ç‰¹ç‚¹</strong>ï¼ˆåŒæ ·é€‚ç”¨äºå¤šæ€ï¼‰</h6><ul><li><p>æˆå‘˜å˜é‡ï¼šçœ‹ç­‰å·å·¦è¾¹ï¼Œå·¦è¾¹æ˜¯è°å°±ç”¨è°çš„æˆå‘˜å˜é‡ï¼Œæ¯”å¦‚å¦‚æœç­‰å·å·¦è¾¹æ˜¯å­ç±»ï¼Œä¸”æ²¡æœ‰ï¼Œå†å»æ‰¾çˆ¶ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">fu</span> &#123;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">zi</span> <span class="keyword">extends</span> <span class="title class_">fu</span>&#123;</span><br><span class="line">    <span class="type">int</span> num;  <span class="comment">//ä¹Ÿå«numï¼Œä¸¤è€…é‡å</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">    <span class="type">fu</span> <span class="variable">fu_</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">fu</span>();</span><br><span class="line">    <span class="type">zi</span> <span class="variable">zi_</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">zi</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    sout(fu.num)  â€”â€”&gt;çˆ¶ç±»çš„num</span></span><br><span class="line"><span class="comment">    sout(zi.num)â€”â€”&gt;å­ç±»çš„num</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¤šæ€ï¼š</span></span><br><span class="line">    <span class="type">fu</span> <span class="variable">fu_2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">zi</span>();</span><br><span class="line"> <span class="comment">// sout(fu_2.num)â€”â€”&gt;å­ç±»çš„numï¼Œå› ä¸ºç»§æ‰¿ä¸­çš„æˆå‘˜å˜é‡çœ‹ç­‰å·å·¦è¾¹</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æˆå‘˜æ–¹æ³•ï¼šä¸æˆå‘˜å˜é‡ç›¸åï¼Œä»–çœ‹ç­‰å·å³è¾¹newçš„æ˜¯è°ï¼Œä¸åšå±•ç¤º</p></li></ul><h6 id="æ–¹æ³•çš„é‡å†™"><a href="#æ–¹æ³•çš„é‡å†™" class="headerlink" title="æ–¹æ³•çš„é‡å†™"></a><strong>æ–¹æ³•çš„é‡å†™</strong></h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.æ¦‚è¿°:å­ç±»ä¸­æœ‰ä¸€ä¸ªå’Œçˆ¶ç±»æ–¹æ³•åä»¥åŠå‚æ•°åˆ—è¡¨ç›¸åŒçš„æ–¹æ³•</span><br><span class="line">2.å‰æ:ç»§æ‰¿</span><br><span class="line">3.è®¿é—®:çœ‹newçš„æ˜¯è°,å…ˆè°ƒç”¨è°ä¸­çš„,å¦‚æœnewçš„æ˜¯å­ç±»,è°ƒç”¨è°ƒç”¨å­ç±»é‡å†™çš„æ–¹æ³•,å­ç±»æ²¡æœ‰,æ‰¾çˆ¶ç±»</span><br><span class="line">4.æ£€æµ‹æ˜¯å¦ä¸ºé‡å†™æ–¹æ³•:åœ¨è¯¥æ–¹æ³•ä¸Šå†™</span><br><span class="line">  @Override  </span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ä¹‹å,æƒé™å¿…é¡»è¦ä¿è¯å¤§äºç­‰äºçˆ¶ç±»æƒé™(æƒé™æŒ‡çš„æ˜¯è®¿é—®æƒé™)</span><br><span class="line">  <span class="keyword">public</span> -&gt; <span class="keyword">protected</span> -&gt; é»˜è®¤ -&gt; <span class="keyword">private</span></span><br><span class="line"><span class="number">2.</span>å­ç±»æ–¹æ³•é‡å†™çˆ¶ç±»æ–¹æ³•,æ–¹æ³•åå’Œå‚æ•°åˆ—è¡¨è¦ä¸€æ · <span class="comment">//å’Œé‡è½½è¦æ±‚å‚æ•°åˆ—è¡¨ä¸åŒä¸ä¸€æ ·ï¼Œè¿™ä¸ªè¦æ±‚ä¸€æ ·</span></span><br><span class="line"><span class="number">3.</span>ç§æœ‰æ–¹æ³•ä¸èƒ½è¢«é‡å†™,æ„é€ æ–¹æ³•ä¸èƒ½è¢«é‡å†™,é™æ€æ–¹æ³•ä¸èƒ½è¢«é‡å†™</span><br><span class="line"><span class="number">4.</span>å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ä¹‹å,è¿”å›å€¼ç±»å‹åº”è¯¥æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›å€¼ç±»å‹çš„å­ç±»ç±»å‹  <span class="comment">//æ„æ€å°±æ˜¯ï¼Œå­ç±»çš„è¿”å›å€¼å¦‚æœæ˜¯ä¸€ä¸ªç±»çš„è¯ï¼Œé‚£è¿™ä¸ªç±»å¿…é¡»æ˜¯çˆ¶ç±»è¿”å›å€¼çš„é‚£ä¸ªç±»çš„å­ç±»</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure><h6 id="superå’Œthis"><a href="#superå’Œthis" class="headerlink" title="superå’Œthis"></a><strong>superå’Œthis</strong></h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.æ³¨æ„:newå­ç±»å¯¹è±¡æ—¶,ä¼šå…ˆåˆå§‹åŒ–çˆ¶ç±»(å…ˆèµ°çˆ¶ç±»æ— å‚æ„é€ æ–¹æ³•)</span><br><span class="line">2.åŸå› :</span><br><span class="line">  æ¯ä¸ªæ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ,é»˜è®¤éƒ½ä¼šæœ‰ä¸€ä¸ªsuper(),ä¸å†™jvmè‡ªåŠ¨æä¾›ä¸€ä¸ª</span><br><span class="line">  super()ä»£è¡¨çš„æ˜¯çˆ¶ç±»æ— å‚æ„é€   </span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå­å¿…æœ‰çˆ¶ï¼Œè°ƒç”¨å­ç±»ï¼Œå¦‚æœä¸ <strong>æ˜¾ç¤ºä½¿ç”¨superï¼ˆæœ‰å‚ï¼‰çš„è¯</strong> çˆ¶ç±»ä¸€å®šä¼šé»˜è®¤èµ°ä¸€æ¬¡æ— å‚æ„é€ </p><p>superçš„ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ¦‚è¿°:ä»£è¡¨çš„æ˜¯çˆ¶ç±»å¼•ç”¨</span><br><span class="line"><span class="number">2.</span>ä½œç”¨:å¯ä»¥è°ƒç”¨çˆ¶ç±»ä¸­çš„æˆå‘˜</span><br><span class="line"><span class="number">3.</span>ä½¿ç”¨:</span><br><span class="line">  a.è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•-&gt; åœ¨å­ç±»ä¸­çš„æ„é€ ä¸­å†™</span><br><span class="line">    <span class="built_in">super</span>() -&gt; è°ƒç”¨çˆ¶ç±»æ— å‚æ„é€ </span><br><span class="line">    <span class="built_in">super</span>(å®å‚)  -&gt; è°ƒç”¨çˆ¶ç±»æœ‰å‚æ„é€ </span><br><span class="line">      </span><br><span class="line">  b.è°ƒç”¨çˆ¶ç±»æˆå‘˜å˜é‡:</span><br><span class="line">    <span class="built_in">super</span>.æˆå‘˜å˜é‡å</span><br><span class="line">        </span><br><span class="line">  c.è°ƒç”¨çˆ¶ç±»æˆå‘˜æ–¹æ³•:</span><br><span class="line">    <span class="built_in">super</span>.æˆå‘˜æ–¹æ³•å(å®å‚)</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="built_in">this</span>æ¦‚è¿°:ä»£è¡¨çš„æ˜¯å½“å‰å¯¹è±¡(å“ªä¸ªå¯¹è±¡è°ƒç”¨çš„<span class="built_in">this</span>æ‰€åœ¨çš„æ–¹æ³•,<span class="built_in">this</span>å°±ä»£è¡¨å“ªä¸ªå¯¹è±¡)</span><br><span class="line"><span class="number">2.</span>ä½œç”¨:</span><br><span class="line">  a.åŒºåˆ†é‡åçš„æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡</span><br><span class="line">  b.è°ƒç”¨å½“å‰å¯¹è±¡ä¸­çš„æˆå‘˜</span><br><span class="line"><span class="number">3.</span>ä½¿ç”¨:</span><br><span class="line">  a.è°ƒç”¨å½“å‰å¯¹è±¡çš„æ„é€ :åœ¨æ„é€ ä¸­å†™</span><br><span class="line">    <span class="built_in">this</span>():è°ƒç”¨å½“å‰å¯¹è±¡çš„æ— å‚æ„é€ </span><br><span class="line">    <span class="built_in">this</span>(å®å‚):è°ƒç”¨å½“å‰å¯¹è±¡çš„æœ‰å‚æ„é€ </span><br><span class="line">  b.è°ƒç”¨å½“å‰å¯¹è±¡çš„æˆå‘˜å˜é‡:</span><br><span class="line">    <span class="built_in">this</span>.æˆå‘˜å˜é‡å</span><br><span class="line">  c.è°ƒç”¨å½“å‰å¯¹è±¡çš„æˆå‘˜æ–¹æ³•:</span><br><span class="line">    <span class="built_in">this</span>.æˆå‘˜æ–¹æ³•å(å®å‚)</span><br><span class="line"><span class="number">4.</span>æ³¨æ„:</span><br><span class="line">  ä¸ç®¡æ˜¯<span class="built_in">super</span>è¿˜æ˜¯<span class="built_in">this</span>,åªè¦åœ¨æ„é€ ä¸­ä½¿ç”¨,éƒ½å¿…é¡»åœ¨ç¬¬ä¸€è¡Œ,æ‰€ä»¥äºŒè€…ä¸èƒ½åŒæ—¶æ‰‹å†™å‡ºæ¥</span><br></pre></td></tr></table></figure><p>super å’Œ this ä¸èƒ½åŒæ—¶å‡ºç°ï¼Œå› ä¸ºä¸¤ä¸ªéƒ½è¦åœ¨ç¬¬ä¸€è¡Œ</p><h6 id="ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š"><a href="#ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š" class="headerlink" title="ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š"></a>ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š</h6><p><strong>åªèƒ½å•ç»§æ‰¿ï¼Œä¸èƒ½å¤šç»§æ‰¿</strong></p><p>æƒ³ç»™privateèµ‹å€¼æˆ–è¯»å–ï¼Œé‚£å°±è¦ç”¨åˆ°éç§æœ‰çš„æ–¹æ³•ï¼Œgetsetä¹Ÿå¥½ï¼Œæ„é€ æ–¹æ³•ä¹Ÿè¡Œ</p><h5 id="æŠ½è±¡ï¼š"><a href="#æŠ½è±¡ï¼š" class="headerlink" title="æŠ½è±¡ï¼š"></a>æŠ½è±¡ï¼š</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250411215743850.png" alt="image-20250411215743850"></p><p>æŠ½è±¡çš„çœŸæ­£æ„ä¹‰ï¼š</p><ul><li>å¯ä»¥å°†æŠ½è±¡ç±»çœ‹æˆæ˜¯ä¸€ç±»äº‹ç‰©çš„æ ‡å‡†,è¦æ±‚åªè¦æ˜¯å±äºè¿™ä¸€ç±»çš„,éƒ½å¿…é¡»è¦æ‹¥æœ‰æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•,å¿…é¡»è¦ç»™æˆ‘å®ç°</li><li>æ€ä¹ˆè¯æ˜æ‹¥æœ‰äº†,æ€ä¹ˆè¯æ˜å®ç°äº†å‘¢?-&gt; é‡å†™</li></ul><h5 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ¥å£:æ˜¯ä¸€ä¸ªå¼•ç”¨æ•°æ®ç±»å‹,æ˜¯ä¸€ç§æ ‡å‡†,è§„åˆ™</span><br><span class="line"><span class="number">2.</span>å…³é”®å­—:</span><br><span class="line">   a.interface æ¥å£</span><br><span class="line">      <span class="keyword">public</span> interface æ¥å£å&#123;&#125;</span><br><span class="line">   </span><br><span class="line">  b.implements å®ç°</span><br><span class="line">      å®ç°ç±» implements æ¥å£å&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>æ¥å£ä¸­å¯ä»¥å®šä¹‰çš„æˆå‘˜:</span><br><span class="line">   </span><br><span class="line">   a.jdk7ä»¥åŠä¹‹å‰:</span><br><span class="line">     æŠ½è±¡æ–¹æ³•: <span class="keyword">public</span> <span class="keyword">abstract</span>  -&gt; å³ä½¿ä¸å†™<span class="keyword">public</span> <span class="keyword">abstract</span>,é»˜è®¤ä¹Ÿæœ‰</span><br><span class="line">     æˆå‘˜å˜é‡:<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> æ•°æ®ç±»å‹ å˜é‡å = å€¼-&gt; å³ä½¿ä¸å†™<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span>,é»˜è®¤ä¹Ÿæœ‰</span><br><span class="line">                    <span class="keyword">final</span>æ˜¯æœ€ç»ˆçš„,è¢«<span class="keyword">final</span>ä¿®é¥°çš„å˜é‡ä¸èƒ½äºŒæ¬¡èµ‹å€¼,æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å°†<span class="keyword">final</span>ä¿®é¥°çš„å˜é‡è§†ä¸ºå¸¸é‡</span><br><span class="line"></span><br><span class="line">   b.jdk8:</span><br><span class="line">      é»˜è®¤æ–¹æ³•:<span class="keyword">public</span> <span class="keyword">default</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚)&#123;&#125;</span><br><span class="line">      é™æ€æ–¹æ³•:<span class="keyword">public</span> <span class="keyword">static</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚)&#123;&#125;</span><br><span class="line"></span><br><span class="line">   c.jdk9å¼€å§‹:</span><br><span class="line">     ç§æœ‰æ–¹æ³•:</span><br><span class="line">        <span class="keyword">private</span>çš„æ–¹æ³•</span><br></pre></td></tr></table></figure><h6 id="æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼š"><a href="#æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼š" class="headerlink" title="æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼š"></a>æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>å®šä¹‰æ ¼å¼:</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚);</span><br><span class="line"><span class="number">2.</span>æ³¨æ„:</span><br><span class="line">  ä¸å†™<span class="keyword">public</span> <span class="keyword">abstract</span> é»˜è®¤ä¹Ÿæœ‰</span><br><span class="line"><span class="number">3.</span>ä½¿ç”¨:</span><br><span class="line">  a.å®šä¹‰å®ç°ç±»,å®ç°æ¥å£</span><br><span class="line">  b.é‡å†™æŠ½è±¡æ–¹æ³•</span><br><span class="line">  c.åˆ›å»ºå®ç°ç±»å¯¹è±¡,è°ƒç”¨é‡å†™çš„æ–¹æ³•</span><br></pre></td></tr></table></figure><h6 id="æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼šï¼ˆè¦æ˜¾ç¤ºdefaultï¼‰"><a href="#æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼šï¼ˆè¦æ˜¾ç¤ºdefaultï¼‰" class="headerlink" title="æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼šï¼ˆè¦æ˜¾ç¤ºdefaultï¼‰"></a>æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼šï¼ˆè¦æ˜¾ç¤ºdefaultï¼‰</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ ¼å¼:</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">default</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚)&#123;</span><br><span class="line">      æ–¹æ³•ä½“</span><br><span class="line">      <span class="keyword">return</span> ç»“æœ</span><br><span class="line">  &#125;</span><br><span class="line"><span class="number">2.</span>ä½¿ç”¨:</span><br><span class="line">  a.å®šä¹‰å®ç°ç±»,å®ç°æ¥å£</span><br><span class="line">  b.é»˜è®¤æ–¹æ³•å¯é‡å†™,å¯ä¸é‡å†™</span><br><span class="line">  c.åˆ›å»ºå®ç°ç±»å¯¹è±¡,è°ƒç”¨é»˜è®¤æ–¹æ³• </span><br></pre></td></tr></table></figure><p>æ¥å£ä¸­çš„é™æ€æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>å®šä¹‰æ ¼å¼:</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚)&#123;</span><br><span class="line">      æ–¹æ³•ä½“</span><br><span class="line">      <span class="keyword">return</span> ç»“æœ</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>ä½¿ç”¨:</span><br><span class="line">  æ¥å£åç›´æ¥è°ƒç”¨</span><br></pre></td></tr></table></figure><p><strong>é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•çš„ä½œç”¨</strong>ï¼šé»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³• -&gt; å¯ä»¥ä½œä¸ºä¸´æ—¶åŠ çš„ä¸€ä¸ªå°åŠŸèƒ½æ¥ä½¿ç”¨</p><h6 id="æ¥å£ä¸­çš„æˆå‘˜å˜é‡"><a href="#æ¥å£ä¸­çš„æˆå‘˜å˜é‡" class="headerlink" title="æ¥å£ä¸­çš„æˆå‘˜å˜é‡"></a>æ¥å£ä¸­çš„æˆå‘˜å˜é‡</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ ¼å¼:</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> æ•°æ®ç±»å‹ å˜é‡å = å€¼</span><br><span class="line"><span class="number">2.</span>ç›¸å…³çŸ¥è¯†ç‚¹:<span class="keyword">final</span></span><br><span class="line">  <span class="keyword">final</span>ä»£è¡¨æœ€ç»ˆçš„,è¢«å®ƒä¿®é¥°çš„å˜é‡,ä¸èƒ½äºŒæ¬¡èµ‹å€¼,å¯ä»¥è§†ä¸ºå¸¸é‡</span><br><span class="line"><span class="number">3.</span>ç‰¹ç‚¹:</span><br><span class="line">  ä¸å†™<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> é»˜è®¤ä¹Ÿæœ‰</span><br><span class="line"><span class="number">4.</span>ä½¿ç”¨:</span><br><span class="line">  æ¥å£åç›´æ¥è°ƒç”¨</span><br><span class="line"><span class="number">5.</span>æ³¨æ„:</span><br><span class="line">  a.è¢«<span class="keyword">static</span> <span class="keyword">final</span>ä¿®é¥°çš„æˆå‘˜å˜é‡éœ€è¦æ‰‹åŠ¨èµ‹å€¼</span><br><span class="line">  b.ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä¼šå°†<span class="keyword">static</span> <span class="keyword">final</span>ä¿®é¥°çš„æˆå‘˜å˜é‡åå¤§å†™</span><br></pre></td></tr></table></figure><h6 id="æ€»ç»“ä¸€ä¸‹æ¥å£çš„æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•"><a href="#æ€»ç»“ä¸€ä¸‹æ¥å£çš„æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•" class="headerlink" title="æ€»ç»“ä¸€ä¸‹æ¥å£çš„æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•"></a>æ€»ç»“ä¸€ä¸‹æ¥å£çš„æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•</h6><p>ç»§æ‰¿ä¹Ÿå¥½,å®ç°æ¥å£ä¹Ÿç½¢,åªè¦æ˜¯çˆ¶ç±»ä¸­æˆ–è€…æ¥å£çš„æŠ½è±¡æ–¹æ³•,å­ç±»æˆ–è€…å®ç°ç±»éƒ½è¦é‡å†™</p><p>æ¥å£ä¸­çš„æˆå‘˜å˜é‡ï¼špublic static finalï¼Œç›´æ¥é€šè¿‡æ¥å£åè°ƒç”¨</p><p>æ¥å£ä¸­çš„é™æ€æ–¹æ³•ï¼špublic static method()ï¼Œç›´æ¥é€šè¿‡æ¥å£åè°ƒç”¨</p><p>æ¥å£ä¸­çš„ é»˜è®¤æ–¹æ³• å’Œ æŠ½è±¡æ–¹æ³•ï¼šä¸å†™å‰ç¼€é»˜è®¤æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ˜¾å¼public default,æ˜¯é»˜è®¤æ–¹æ³•ï¼ŒäºŒè€…ï¼ŒæŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨å®ç°ç±»ä¸­é‡å†™ï¼Œç„¶åé€šè¿‡newå®ç°ç±»æ¥è°ƒç”¨ï¼Œdefaultæ–¹æ³•å¯é‡ç°å¯ä¸é‡å†™ï¼Œä½†ä¹Ÿè¦é€šè¿‡newå®ç°ç±»æ¥è°ƒç”¨</p><p><strong>æ³¨æ„ï¼Œå¤šä¸ªæ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•æˆ–é»˜è®¤æ–¹æ³•é‡åï¼Œå®ç°ç±»éƒ½è¦é‡å†™ä¸€æ¬¡æŠ½è±¡æ–¹æ³•æˆ–é»˜è®¤æ–¹æ³•</strong></p><h6 id="æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ï¼š"><a href="#æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ï¼š" class="headerlink" title="æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ï¼š"></a>æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç›¸åŒç‚¹:</span><br><span class="line">  a.éƒ½ä½äºç»§æ‰¿ä½“ç³»çš„é¡¶ç«¯,ç”¨äºè¢«å…¶ä»–ç±»å®ç°æˆ–è€…ç»§æ‰¿</span><br><span class="line">  b.éƒ½ä¸èƒ½<span class="keyword">new</span></span><br><span class="line">  <span class="title class_">c</span>.éƒ½åŒ…å«æŠ½è±¡æ–¹æ³•,å…¶å­ç±»æˆ–è€…å®ç°ç±»éƒ½å¿…é¡»é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•</span><br><span class="line">      </span><br><span class="line">ä¸åŒç‚¹:</span><br><span class="line">  a.æŠ½è±¡ç±»:ä¸€èˆ¬ä½œä¸ºçˆ¶ç±»ä½¿ç”¨,å¯ä»¥æœ‰æˆå‘˜å˜é‡,æ„é€ ,æˆå‘˜æ–¹æ³•,æŠ½è±¡æ–¹æ³•ç­‰</span><br><span class="line">  b.æ¥å£:æˆå‘˜å•ä¸€,ä¸€èˆ¬æŠ½å–æ¥å£,æŠ½å–çš„éƒ½æ˜¯æ–¹æ³•,è§†ä¸ºåŠŸèƒ½çš„å¤§é›†åˆ</span><br><span class="line">  c.ç±»ä¸èƒ½å¤šç»§æ‰¿,ä½†æ˜¯æ¥å£å¯ä»¥</span><br></pre></td></tr></table></figure><h5 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h5><h6 id="å¤šæ€çš„è¡¨è¾¾æ–¹å¼ï¼š"><a href="#å¤šæ€çš„è¡¨è¾¾æ–¹å¼ï¼š" class="headerlink" title="å¤šæ€çš„è¡¨è¾¾æ–¹å¼ï¼š"></a>å¤šæ€çš„è¡¨è¾¾æ–¹å¼ï¼š</h6><p>Fu fu &#x3D; new Zi();</p><p>ä¹Ÿå°±æ˜¯ï¼š<strong>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</strong></p><p>å¤šæ€çš„ç›¸å…³ä½¿ç”¨è¯´æ˜ï¼š</p><ul><li><p>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡åï¼Œè¿™ä¸ªå¼•ç”¨ä¸èƒ½è°ƒç”¨å­ç±»çš„ç‰¹æœ‰åŠŸèƒ½ï¼ˆä¹Ÿå°±æ˜¯ä¸æ˜¯é‡å†™çš„çˆ¶ç±»ä¸­çš„åŠŸèƒ½ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼Šç«¯</p></li><li><p>ç”±äºå¤šæ€æ˜¯çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œç›¸å½“äº ä¸€ä¸ªå¤§çš„æ•°æ®ç±»å‹æ¥å—äº†ä¸€ä¸ªå°çš„æ•°æ®ç±»å‹çš„èµ‹å€¼ ï¼Œå¦‚ double x &#x3D; 10ï¼Œå› æ­¤ï¼Œå®ƒå…·æœ‰å¾ˆå¼ºçš„ <strong>å…¼å®¹æ€§</strong> ï¼Œä»–èƒ½å¤Ÿå…¼å®¹æ¯”è‡ªå·±å°çš„æ•°æ®ç±»å‹ä¼ æ¥çš„èµ‹å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªFu fu å¯ä»¥éšä¾¿è¢«è‡ªå·±çš„å­ç±»ç»™èµ‹å€¼ï¼Œæ— è®ºæ˜¯new zi1(); è¿˜æ˜¯ new zi2()ï¼›</p><p><strong>å› æ­¤ï¼Œå¤šæ€å¸¸ç”¨äºæ‰§è¡Œæ–¹æ³•çš„å½¢å‚ä¸­</strong></p></li><li><p>å¤šæ€ä¸‹ï¼Œæˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•çš„è®¿é—®ç‰¹ç‚¹ï¼šæˆå‘˜å˜é‡çœ‹å·¦è¾¹ï¼Œä¸€èˆ¬æ˜¯çˆ¶ç±»çš„ï¼Œæˆå‘˜æ–¹æ³•çœ‹å³è¾¹ï¼Œä¸€èˆ¬æ˜¯å­ç±»çš„ï¼Œè¿˜æœ‰å°±æ˜¯å¤šæ€ä¸€èˆ¬æ˜¯ç”¨æ¥ç©æ–¹æ³•çš„ï¼Œå› æ­¤å¤§å¤šéƒ½åªç”¨æˆå‘˜æ–¹æ³•å³å¯</p></li></ul><h6 id="å¤šæ€ä¸­çš„å‘ä¸‹è½¬å‹ï¼š"><a href="#å¤šæ€ä¸­çš„å‘ä¸‹è½¬å‹ï¼š" class="headerlink" title="å¤šæ€ä¸­çš„å‘ä¸‹è½¬å‹ï¼š"></a>å¤šæ€ä¸­çš„å‘ä¸‹è½¬å‹ï¼š</h6><p>ç±»ä¼¼äºå¼ºè½¬ï¼Œå°†å¤§ç±»å‹å¼ºåˆ¶è½¬æ¢æˆå°ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¾‹å¦‚ï¼ŒAnimal animalæ˜¯çˆ¶ç±»ï¼ŒDog dogæ˜¯å­ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è½¬å‹è¯­å¥ï¼š</span></span><br><span class="line"><span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) animal;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//ä½†æ˜¯æ³¨æ„ï¼Œå‘ä¸‹è½¬å‹ä»¥åï¼ŒåŸæ¥çš„æ–¹æ³•ä¸­å¯èƒ½ä¼šå­˜åœ¨ç±»å‹è½¬æ¢å¼‚å¸¸ï¼ŒåŸå› æ˜¯ï¼Œä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœé›†åˆäº†å¾ˆå¤šå­ç±»çš„ç‰¹æœ‰æ–¹æ³•ï¼Œè½¬æˆä¸€ç§ä»¥åï¼Œå°±ä¼šå’Œå…¶ä»–çš„å­ç±»æ–¹æ³•èµ·å†²çª</span></span><br><span class="line"><span class="comment">//è§£å†³åŠæ³•ï¼š å¯¹è±¡å instanceof ç±»å‹ -&gt; åˆ¤æ–­çš„æ˜¯å…³é”®å­—å‰é¢çš„å¯¹è±¡æ˜¯å¦ç¬¦åˆå…³é”®å­—åé¢çš„ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (animal <span class="keyword">instanceof</span> Cat)&#123;</span><br><span class="line">            <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> (Cat) animal;</span><br><span class="line">            cat.eat();</span><br><span class="line">            cat.catchMouse();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h5 id="æƒé™ä¿®é¥°ç¬¦"><a href="#æƒé™ä¿®é¥°ç¬¦" class="headerlink" title="æƒé™ä¿®é¥°ç¬¦"></a>æƒé™ä¿®é¥°ç¬¦</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250418191139231.png" alt="image-20250418191139231"></p><h5 id="finalå…³é”®å­—"><a href="#finalå…³é”®å­—" class="headerlink" title="finalå…³é”®å­—"></a>finalå…³é”®å­—</h5><h6 id="finalå…³é”®å­—å¯ä»¥ä¿®é¥°çš„å†…å®¹"><a href="#finalå…³é”®å­—å¯ä»¥ä¿®é¥°çš„å†…å®¹" class="headerlink" title="finalå…³é”®å­—å¯ä»¥ä¿®é¥°çš„å†…å®¹:"></a>finalå…³é”®å­—å¯ä»¥ä¿®é¥°çš„å†…å®¹:</h6><p>ç±»ï¼šä¸èƒ½è¢«ç»§æ‰¿</p><p>æ–¹æ³•ï¼šä¸èƒ½è¢«é‡å†™</p><p>å±€éƒ¨å˜é‡ï¼šå€¼ä¸èƒ½è¢«æ”¹å˜</p><p>æˆå‘˜å˜é‡ï¼š<strong>éœ€è¦æ‰‹åŠ¨èµ‹å€¼</strong>ï¼Œä¸”ä¸èƒ½äºŒæ¬¡èµ‹å€¼</p><p>å¯¹è±¡ï¼šå¯¹è±¡çš„å±æ€§å€¼å¯ä»¥æ”¹å˜ï¼Œä½†æ˜¯å¯¹è±¡çš„åœ°å€å€¼ä¸èƒ½æ”¹å˜</p><h5 id="ä»£ç å—ï¼š"><a href="#ä»£ç å—ï¼š" class="headerlink" title="ä»£ç å—ï¼š"></a>ä»£ç å—ï¼š</h5><p><strong>æ„é€ ä»£ç å—</strong>ï¼šæ‰§è¡Œç‰¹ç‚¹:ä¼˜å…ˆäºæ„é€ æ–¹æ³•æ‰§è¡Œ,æ¯newä¸€æ¬¡,å°±ä¼šæ‰§è¡Œä¸€æ¬¡</p><p>é™æ€ä»£ç å—ï¼šæ‰§è¡Œç‰¹ç‚¹ï¼šä¼˜äºæ„é€ æ–¹æ³•å’Œæ„é€ ä»£ç å—æ‰§è¡Œï¼Œä¸”åªæ‰§è¡Œä¸€æ¬¡</p><p>å¦‚æœæƒ³è®©ä¸€äº›æ•°æ®æœ€å…ˆåˆå§‹åŒ–,è€Œä¸”åªéœ€è¦åˆå§‹åŒ–ä¸€æ¬¡,å°±å¯ä»¥å°†è¿™äº›æ•°æ®æ”¾åˆ°é™æ€ä»£ç å—ä¸­</p><p>æ¯”å¦‚åˆå§‹åŒ–æ•°æ®åº“çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡éƒ½è¦æ³¨å†Œé©±åŠ¨ï¼Œåˆå§‹åŒ–æ“ä½œæ•°æ®åº“çš„åœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç å•¥çš„ï¼Œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› æ­¤æ”¾åˆ°ä¸€ä¸ªé™æ€ä»£ç å—ä¸­åªåˆå§‹åŒ–ä¸€æ¬¡å³å¯</p><h5 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h5><p>å†…éƒ¨ç±»çš„åˆ†ç±»ï¼š</p><p>æˆå‘˜å†…éƒ¨ç±»ï¼š</p><ul><li>é™æ€å†…éƒ¨ç±»</li><li>éé™æ€å†…éƒ¨ç±»</li></ul><p>å±€éƒ¨å†…éƒ¨ç±»</p><p><strong>åŒ¿åå†…éƒ¨ç±»</strong></p><h6 id="é™æ€å†…éƒ¨ç±»"><a href="#é™æ€å†…éƒ¨ç±»" class="headerlink" title="é™æ€å†…éƒ¨ç±»"></a>é™æ€å†…éƒ¨ç±»</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ ¼å¼:ç›´æ¥åœ¨å®šä¹‰å†…éƒ¨ç±»çš„æ—¶å€™åŠ ä¸Š<span class="keyword">static</span>å…³é”®å­—</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">      <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line">          </span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>æ³¨æ„:</span><br><span class="line">  a.å†…éƒ¨ç±»å¯ä»¥å®šä¹‰å±æ€§,æ–¹æ³•,æ„é€ ç­‰</span><br><span class="line">  b.é™æ€å†…éƒ¨ç±»å¯ä»¥è¢«<span class="keyword">final</span>æˆ–è€…<span class="keyword">abstract</span>ä¿®é¥°</span><br><span class="line">    è¢«<span class="keyword">final</span>ä¿®é¥°ä¹‹å,ä¸èƒ½è¢«ç»§æ‰¿</span><br><span class="line">    è¢«<span class="keyword">abstract</span>ä¿®é¥°ä¹‹å,ä¸èƒ½<span class="keyword">new</span></span><br><span class="line">  <span class="title class_">c</span>.é™æ€å†…éƒ¨ç±»ä¸èƒ½è°ƒç”¨å¤–éƒ¨çš„éé™æ€æˆå‘˜</span><br><span class="line">  d.å†…éƒ¨ç±»è¿˜å¯ä»¥è¢«å››ç§æƒé™ä¿®é¥°ç¬¦ä¿®é¥°</span><br><span class="line">      </span><br><span class="line"><span class="number">3.</span>è°ƒç”¨é™æ€å†…éƒ¨ç±»æˆå‘˜:</span><br><span class="line">  å¤–éƒ¨ç±».å†…éƒ¨ç±» å¯¹è±¡å = <span class="keyword">new</span> å¤–éƒ¨ç±».å†…éƒ¨ç±»()</span><br></pre></td></tr></table></figure><h6 id="éé™æ€å†…éƒ¨ç±»ï¼š"><a href="#éé™æ€å†…éƒ¨ç±»ï¼š" class="headerlink" title="éé™æ€å†…éƒ¨ç±»ï¼š"></a>éé™æ€å†…éƒ¨ç±»ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ ¼å¼:ç›´æ¥åœ¨å®šä¹‰å†…éƒ¨ç±»çš„æ—¶å€™åŠ ä¸Š<span class="keyword">static</span>å…³é”®å­—</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">      <span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line">          </span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>æ³¨æ„:</span><br><span class="line">  a.å†…éƒ¨ç±»å¯ä»¥å®šä¹‰å±æ€§,æ–¹æ³•,æ„é€ ç­‰</span><br><span class="line">  b.é™æ€å†…éƒ¨ç±»å¯ä»¥è¢«<span class="keyword">final</span>æˆ–è€…<span class="keyword">abstract</span>ä¿®é¥°</span><br><span class="line">    è¢«<span class="keyword">final</span>ä¿®é¥°ä¹‹å,ä¸èƒ½è¢«ç»§æ‰¿</span><br><span class="line">    è¢«<span class="keyword">abstract</span>ä¿®é¥°ä¹‹å,ä¸èƒ½<span class="keyword">new</span></span><br><span class="line">  <span class="title class_">c</span>.é™æ€å†…éƒ¨ç±»ä¸èƒ½è°ƒç”¨å¤–éƒ¨çš„éé™æ€æˆå‘˜</span><br><span class="line">  d.å†…éƒ¨ç±»è¿˜å¯ä»¥è¢«å››ç§æƒé™ä¿®é¥°ç¬¦ä¿®é¥°</span><br><span class="line">      </span><br><span class="line"><span class="number">3.</span>è°ƒç”¨éé™æ€å†…éƒ¨ç±»æˆå‘˜:</span><br><span class="line">  å¤–éƒ¨ç±».å†…éƒ¨ç±» å¯¹è±¡å = <span class="keyword">new</span> å¤–éƒ¨ç±»().new å†…éƒ¨ç±»()</span><br></pre></td></tr></table></figure><p><strong>å¤–éƒ¨ç±»ä¸å†…éƒ¨ç±»çš„æˆå‘˜å˜é‡ä»¥åŠå†…éƒ¨ç±»çš„å±€éƒ¨å˜é‡é‡å</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;é‡‘è²&quot;</span>;</span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Heart</span>&#123;</span><br><span class="line">     <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;å¤§éƒ&quot;</span>;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">(String name)</span>&#123;</span><br><span class="line">         System.out.println(name);<span class="comment">//å†…éƒ¨ç±»çš„å±€éƒ¨å˜é‡</span></span><br><span class="line">         System.out.println(<span class="built_in">this</span>.name);<span class="comment">//å†…éƒ¨ç±»çš„æˆå‘˜å˜é‡</span></span><br><span class="line">         System.out.println(Student.<span class="built_in">this</span>.name);<span class="comment">//å¤–éƒ¨ç±»çš„æˆå‘˜å˜é‡</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     Student.<span class="type">Heart</span> <span class="variable">heart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>().<span class="keyword">new</span> <span class="title class_">Heart</span>();</span><br><span class="line">     heart.display(<span class="string">&quot;æ¶›å“¥&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å†…éƒ¨ç±»ä¸­ï¼Œå˜é‡å‰æ²¡æœ‰ä»»ä½•ä¿®é¥°ï¼Œæ˜¯å±€éƒ¨å˜é‡</p><p>æœ‰ this. ä¿®é¥°ï¼Œæ˜¯å†…éƒ¨æˆå‘˜å˜é‡</p><p>æœ‰ <strong>å¤–éƒ¨ç±»å.this. ä¿®é¥°</strong>ï¼Œæ˜¯å¤–éƒ¨ç±»çš„æˆå‘˜å˜é‡</p><h4 id="8-15æ›´æ–°"><a href="#8-15æ›´æ–°" class="headerlink" title="8_15æ›´æ–°"></a>8_15æ›´æ–°</h4><h5 id="API"><a href="#API" class="headerlink" title="API"></a>API</h5><h6 id="String"><a href="#String" class="headerlink" title="String"></a>String</h6><p><strong>æ‰€æœ‰å­—ç¬¦ä¸²ç±»å‹çš„çš„â€œå˜é‡â€ï¼Œå¸¸é‡ï¼Œéƒ½æ˜¯Stringçš„å®ç°ç±»å¯¹è±¡</strong></p><p><strong>å­—ç¬¦ä¸²ç±»å‹æœ¬è´¨ä¸Šæ˜¯å¸¸é‡ï¼Œä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½æ”¹å˜ï¼Œå¯¹å­—ç¬¦ä¸²ä¿®æ”¹çš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯åˆ›å»ºæ–°å¯¹è±¡çš„è¿‡ç¨‹</strong></p><p><strong>å­—ç¬¦ä¸²å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å¯ä»¥å…±äº«ï¼Œå·²ç»å®šä¹‰äº†ä¸€ä¸ªs1ï¼Œå¦‚æœs2å’Œs1å†…å®¹ä¸€æ ·ï¼Œé‚£ä¹ˆå®šä¹‰s2å°±ä¼šå¤ç”¨s1</strong></p><p><strong>å®ç°åŸç†</strong>ï¼š</p><p>Stringçš„å®ç°åŸç†åˆ†ä¸ºjdk8ä¹‹å‰å’Œä¹‹å</p><p>ä¹‹å‰ï¼š private final char[] value</p><p>ä¹‹åï¼š private final bytes[] value </p><p>ç”±charå˜æˆbytesï¼Œå†…å­˜å ç”¨ä»2ä¸ªå­—èŠ‚åˆ°1ä¸ªå­—èŠ‚ â€”â€”&gt;èŠ‚çœå†…å­˜</p><p><strong>Stringé¢è¯•é¢˜</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04String</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(s1==s2);<span class="comment">//true</span></span><br><span class="line">        System.out.println(s1==s3);<span class="comment">//false</span></span><br><span class="line">        System.out.println(s2==s3);<span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å­—ç¬¦ä¸²å¸¸é‡æ± å¯ä»¥é¿å…é‡å¤åˆ›å»ºç›¸åŒå­—ç¬¦ä¸²</span><br><span class="line">==æ¯”è¾ƒçš„æ˜¯å¯¹è±¡å¼•ç”¨åœ°å€ï¼Œä¸æ˜¯å†…å®¹</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">String</span>()æ€»æ˜¯åˆ›å»ºæ–°å¯¹è±¡ï¼Œå³ä½¿å†…å®¹ç›¸åŒ</span><br><span class="line">å¦‚æœè¦æ¯”è¾ƒå†…å®¹ï¼Œåº”è¯¥ä½¿ç”¨equals()æ–¹æ³•è€Œä¸æ˜¯==</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05String</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;world&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>+<span class="string">&quot;world&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s5</span> <span class="operator">=</span> s1+<span class="string">&quot;world&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s6</span> <span class="operator">=</span> s1+s2;</span><br><span class="line"></span><br><span class="line">        System.out.println(s3==s4);<span class="comment">//true</span></span><br><span class="line">        System.out.println(s3==s5);<span class="comment">//false</span></span><br><span class="line">        System.out.println(s3==s6);<span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>å­—ç¬¦ä¸²æ‹¼æ¥,å¦‚æœç­‰å·å³è¾¹æ˜¯å­—ç¬¦ä¸²å­—é¢å€¼æ‹¼æ¥,ä¸ä¼šäº§ç”Ÿæ–°å¯¹è±¡</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>å­—ç¬¦ä¸²æ‹¼æ¥,å¦‚æœç­‰å·å³è¾¹æœ‰å˜é‡å‚æ•°æ‹¼æ¥,ä¼šäº§ç”Ÿæ–°å­—ç¬¦ä¸²å¯¹è±¡</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>String æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(String s)</span> -&gt; æ¯”è¾ƒå­—ç¬¦ä¸²å†…å®¹</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">equalsIgnoreCase</span><span class="params">(String s)</span> -&gt; æ¯”è¾ƒå­—ç¬¦ä¸²å†…å®¹,å¿½ç•¥å¤§å°å†™    </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">length</span><span class="params">()</span></span><br><span class="line">String <span class="title function_">concat</span><span class="params">(String s)</span> å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿”å›æ–°ä¸²</span><br><span class="line"><span class="type">char</span> <span class="title function_">charAt</span><span class="params">(<span class="type">int</span> index)</span> è·å–å¯¹åº”çš„å­—ç¬¦</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span> <span class="params">(String s)</span> è¿”å›ç¬¬ä¸€æ¬¡så­—ä¸²åœ¨å¤§ä¸²ä¸­å‡ºç°çš„ç´¢å¼•ä½ç½®</span><br><span class="line">String <span class="title function_">subString</span> <span class="params">(<span class="type">int</span> beginIdex)</span> æˆªå–å­—ç¬¦ä¸² ä»æŒ‡å®šçš„æ‰€ç”¨å¼€å§‹</span><br><span class="line">String <span class="title function_">subString</span> <span class="params">(<span class="type">int</span> begin,<span class="type">int</span> end)</span> æˆªå–å­—ç¬¦ä¸²ï¼Œå«å¤´ä¸å«å°¾</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="type">char</span>[] toCharArray() å°†å­—ç¬¦ä¸²è½¬æˆ<span class="type">char</span>æ•°ç»„</span><br><span class="line"><span class="type">byte</span>[] getBytes() å°†å­—ç¬¦ä¸²è½¬æˆ<span class="type">byte</span>æ•°ç»„</span><br><span class="line"><span class="type">byte</span>[] getBytes(String charsetname) æ ¹æ®ç»™å®šçš„ç¼–ç æ ¼å¼è½¬æ¢</span><br><span class="line">    </span><br><span class="line">String[] split (String regex) regexæ˜¯æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">    </span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(String s)</span> -&gt; åˆ¤æ–­è€ä¸²å„¿ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„ä¸²å„¿</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">endsWith</span><span class="params">(String s)</span> -&gt; åˆ¤æ–­è€ä¸²å„¿æ˜¯å¦ä»¥æŒ‡å®šçš„ä¸²å„¿ç»“å°¾</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">startsWith</span><span class="params">(String s)</span> -&gt; åˆ¤æ–­è€ä¸²å„¿æ˜¯å¦ä»¥æŒ‡å®šçš„ä¸²å„¿å¼€å¤´</span><br><span class="line">String <span class="title function_">toLowerCase</span><span class="params">()</span>-&gt; å°†å­—æ¯è½¬æˆå°å†™</span><br><span class="line">String <span class="title function_">toUpperCase</span><span class="params">()</span> -&gt; å°†å­—æ¯è½¬æˆå¤§å†™</span><br><span class="line">String <span class="title function_">trim</span><span class="params">()</span> -&gt; å»æ‰å­—ç¬¦ä¸²ä¸¤ç«¯ç©ºæ ¼</span><br></pre></td></tr></table></figure><p><strong>StringBulider</strong></p><p>StringBulider æ˜¯å¯å˜çš„ï¼Œç›¸æ¯”äºStringçš„ä¸å¯å˜ï¼Œæ¯æ¬¡æ“ä½œéƒ½è¦æ–°å»ºå¯¹è±¡ï¼ŒStringBuliderå¯ä»¥ç›´æ¥ä¿®æ”¹</p><p>StringBulideræ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">StringBulider <span class="title function_">append</span><span class="params">(ä»»æ„ç±»å‹çš„æ•°æ®)</span> å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿”å›çš„æ˜¯StringBuliderè‡ªå·±</span><br><span class="line">StringBulider <span class="title function_">reverse</span><span class="params">()</span> å­—ç¬¦ä¸²åè½¬ï¼Œè¿”å›çš„æ˜¯StringBuliderè‡ªå·±</span><br><span class="line">String <span class="title function_">toString</span><span class="params">()</span> è¿”å›å°†è‡ªå·±è½¬ä¸ºStringç±»å‹åçš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><p>StringBulider vs StringBuffer</p><p>builderæ•ˆç‡é«˜ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œbufferæ¯”builderæ…¢ï¼Œçº¿ç¨‹å®‰å…¨</p><h6 id="å…¶ä»–api"><a href="#å…¶ä»–api" class="headerlink" title="å…¶ä»–api"></a>å…¶ä»–api</h6><p><strong>Math</strong>å·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="title function_">abs</span><span class="params">(<span class="type">int</span> a)</span> -&gt; æ±‚å‚æ•°çš„ç»å¯¹å€¼</span><br><span class="line"><span class="keyword">static</span> <span class="type">double</span> <span class="title function_">ceil</span><span class="params">(<span class="type">double</span> a)</span> -&gt; å‘ä¸Šå–æ•´</span><br><span class="line"><span class="keyword">static</span> <span class="type">double</span> <span class="title function_">floor</span><span class="params">(<span class="type">double</span> a)</span> -&gt;å‘ä¸‹å–æ•´</span><br><span class="line"><span class="keyword">static</span> <span class="type">long</span> <span class="title function_">round</span><span class="params">(<span class="type">double</span> a)</span>  -&gt; å››èˆäº”å…¥</span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="title function_">max</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> -&gt;æ±‚ä¸¤ä¸ªæ•°ä¹‹é—´çš„è¾ƒå¤§å€¼ </span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="title function_">min</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> -&gt;æ±‚ä¸¤ä¸ªæ•°ä¹‹é—´çš„è¾ƒå°å€¼</span><br></pre></td></tr></table></figure><p><strong>BigInteger</strong>å¤§æ•° <strong>BigDecimal</strong>å¤§å°æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ :</span><br><span class="line">  BigInteger(String val) -&gt; å‚æ•°çš„æ ¼å¼å¿…é¡»æ˜¯æ•°å­—å½¢å¼</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  BigInteger <span class="title function_">add</span><span class="params">(BigInteger val)</span>  è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> + val) çš„ BigInteger</span><br><span class="line">  BigInteger <span class="title function_">subtract</span><span class="params">(BigInteger val)</span> è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> - val) çš„ BigInteger</span><br><span class="line">  BigInteger <span class="title function_">multiply</span><span class="params">(BigInteger val)</span>  è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> * val) çš„ BigInteger</span><br><span class="line">  BigInteger <span class="title function_">divide</span><span class="params">(BigInteger val)</span>    è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> / val) çš„ BigInteger  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">æ„é€ æ–¹æ³•:</span><br><span class="line">  BigDecimal(String val)  -&gt; valå¿…é¡»è¦æ˜¯æ•°å­—å½¢å¼</span><br><span class="line">      </span><br><span class="line">å¸¸ç”¨æ–¹æ³•:</span><br><span class="line">  <span class="keyword">static</span> BigDecimal <span class="title function_">valueOf</span><span class="params">(<span class="type">double</span> val)</span>  -&gt; æ­¤æ–¹æ³•åˆå§‹åŒ–å°æ•°æ—¶å¯ä»¥ä¼ å…¥<span class="type">double</span>å‹æ•°æ®</span><br><span class="line">  BigDecimal <span class="title function_">add</span><span class="params">(BigDecimal val)</span>  è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> + val) çš„ BigDecimal</span><br><span class="line">  BigDecimal <span class="title function_">subtract</span><span class="params">(BigDecimal val)</span> è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> - val) çš„ BigDecimal</span><br><span class="line">  BigDecimal <span class="title function_">multiply</span><span class="params">(BigDecimal val)</span>  è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> * val) çš„ BigDecimal</span><br><span class="line">  BigDecimal <span class="title function_">divide</span><span class="params">(BigDecimal val)</span>    è¿”å›å…¶å€¼ä¸º (<span class="built_in">this</span> / val) çš„ BigDecimal </span><br><span class="line">  BigDecimal <span class="title function_">divide</span><span class="params">(BigDecimal divisor, <span class="type">int</span> scale, <span class="type">int</span> roundingMode)</span>  </span><br><span class="line">                    divisor:é™¤å·åé¢çš„é‚£ä¸ªæ•°</span><br><span class="line">                    scale:æŒ‡å®šä¿ç•™å‡ ä½å°æ•°</span><br><span class="line">                    roundingMode:å–èˆæ–¹å¼</span><br><span class="line">                                 <span class="keyword">static</span> <span class="type">int</span> ROUND_UP -&gt; å‘ä¸ŠåŠ <span class="number">1</span></span><br><span class="line">                                 <span class="keyword">static</span> <span class="type">int</span> ROUND_DOWN -&gt; ç›´æ¥èˆå»</span><br><span class="line">                                 <span class="keyword">static</span> <span class="type">int</span> ROUND_HALF_UP -&gt; å››èˆäº”å…¥</span><br></pre></td></tr></table></figure><p><strong>Date</strong> æ—¥æœŸç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ„é€ :</span><br><span class="line">  Date() -&gt; è·å–å½“å‰ç³»ç»Ÿæ—¶é—´</span><br><span class="line">  Date(<span class="type">long</span> time) -&gt; è·å–æŒ‡å®šæ—¶é—´,ä¼ é€’æ¯«ç§’å€¼ -&gt; ä»æ—¶é—´åŸç‚¹å¼€å§‹ç®—   æ¯”å¦‚ä¼ é€’<span class="number">1000l</span>ï¼Œå°±æ˜¯åŸç‚¹å<span class="number">1</span>ç§’</span><br><span class="line">      </span><br><span class="line"><span class="number">2.</span>æ–¹æ³•ï¼š</span><br><span class="line">  setTimeå’ŒgetTime</span><br></pre></td></tr></table></figure><p><strong>Calendar</strong> æ—¥å†ç±»</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815080312300.png" alt="image-20250815080312300"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å¸¸ç”¨æ–¹æ³•:</span><br><span class="line">  <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> field)</span> -&gt;è¿”å›ç»™å®šæ—¥å†å­—æ®µçš„å€¼</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> field, <span class="type">int</span> value)</span>  :å°†ç»™å®šçš„æ—¥å†å­—æ®µè®¾ç½®ä¸ºæŒ‡å®šçš„å€¼</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> field, <span class="type">int</span> amount)</span> :æ ¹æ®æ—¥å†çš„è§„åˆ™,ä¸ºç»™å®šçš„æ—¥å†å­—æ®µæ·»åŠ æˆ–è€…å‡å»æŒ‡å®šçš„æ—¶é—´é‡</span><br><span class="line">  Date <span class="title function_">getTime</span><span class="params">()</span>:å°†Calendarè½¬æˆDateå¯¹è±¡</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> date)</span> -&gt; ç›´æ¥è®¾ç½®å¹´æœˆæ—¥</span><br></pre></td></tr></table></figure><p><strong>SimpleDateFormat</strong>æ—¥æœŸæ ¼å¼åŒ–ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ¦‚è¿°:æ—¥æœŸæ ¼å¼åŒ–ç±»</span><br><span class="line"><span class="number">2.</span>æ„é€ :</span><br><span class="line">  SimpleDateFormat(String pattern)</span><br><span class="line"><span class="number">3.</span>patternä»£è¡¨å•¥:ä»£è¡¨çš„æ˜¯æˆ‘ä»¬è‡ªå·±æŒ‡å®šçš„æ—¥æœŸæ ¼å¼</span><br><span class="line">  å­—æ¯ä¸èƒ½æ”¹å˜,ä½†æ˜¯ä¸­é—´çš„è¿æ¥ç¬¦æˆ‘ä»¬å¯ä»¥æ”¹å˜ </span><br><span class="line">  </span><br><span class="line">  yyyy-MM-dd HH:mm:ss  </span><br><span class="line"></span><br><span class="line">å¸¸ç”¨æ–¹æ³•ï¼š</span><br><span class="line"><span class="number">1.</span>String <span class="title function_">format</span><span class="params">(Date date)</span> -&gt; å°†Dateå¯¹è±¡æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼è½¬æˆString </span><br><span class="line"><span class="number">2.</span>Date <span class="title function_">parse</span><span class="params">(String source)</span>-&gt; å°†ç¬¦åˆæ—¥æœŸæ ¼å¼çš„å­—ç¬¦ä¸²è½¬æˆDateå¯¹è±¡      </span><br></pre></td></tr></table></figure><p><strong>JDK8æ–°æ—¥æœŸç±»</strong></p><p>LocalDate  LocalDateTimeå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ¦‚è¿°:LocalDateæ˜¯ä¸€ä¸ªä¸å¯å˜çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ï¼Œè¡¨ç¤ºæ—¥æœŸï¼Œé€šå¸¸è¢«è§†ä¸ºå¹´æœˆæ—¥</span><br><span class="line"><span class="number">2.</span>è·å–:</span><br><span class="line">  <span class="keyword">static</span> LocalDate <span class="title function_">now</span><span class="params">()</span>  -&gt; åˆ›å»ºLocalDateå¯¹è±¡</span><br><span class="line">  <span class="keyword">static</span> LocalDate <span class="title function_">of</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> dayOfMonth)</span>  -&gt; åˆ›å»ºLocalDateå¯¹è±¡,è®¾ç½®å¹´æœˆæ—¥   </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="number">1.</span>LocalDateTimeæ¦‚è¿°:LocalDateTimeæ˜¯ä¸€ä¸ªä¸å¯å˜çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ï¼Œä»£è¡¨æ—¥æœŸæ—¶é—´ï¼Œé€šå¸¸è¢«è§†ä¸ºå¹´ - æœˆ - æ—¥ - æ—¶ - åˆ† - ç§’ã€‚</span><br><span class="line"><span class="number">2.</span>è·å–:</span><br><span class="line"><span class="keyword">static</span> LocalDateTime <span class="title function_">now</span><span class="params">()</span>  åˆ›å»ºLocalDateTimeå¯¹è±¡</span><br><span class="line"><span class="keyword">static</span> LocalDateTime <span class="title function_">of</span><span class="params">(<span class="type">int</span> year, Month month, <span class="type">int</span> dayOfMonth, <span class="type">int</span> hour, <span class="type">int</span> minute, <span class="type">int</span> second)</span> åˆ›å»ºLocalDateTimeå¯¹è±¡,è®¾ç½®å¹´æœˆæ—¥æ—¶åˆ†ç§’</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">ä»LocalDate å’Œ LocalDateTimeä¸­è·å–æŒ‡å®šå­—æ®µçš„æ–¹æ³•ï¼š</span><br><span class="line"><span class="type">int</span> <span class="title function_">getYear</span><span class="params">()</span>-&gt;è·å–å¹´ä»½</span><br><span class="line"><span class="type">int</span> <span class="title function_">getMonthValue</span><span class="params">()</span>-&gt;è·å–æœˆä»½</span><br><span class="line"><span class="type">int</span> <span class="title function_">getDayOfMonth</span><span class="params">()</span>-&gt;è·å–æœˆä¸­çš„ç¬¬å‡ å¤©</span><br><span class="line">è®¾ç½®å„ä¸ªå­—æ®µçš„æ–¹æ³•ï¼š</span><br><span class="line">LocalDate <span class="title function_">withYear</span><span class="params">(<span class="type">int</span> year)</span>:è®¾ç½®å¹´ä»½</span><br><span class="line">LocalDate <span class="title function_">withMonth</span><span class="params">(<span class="type">int</span> month)</span>:è®¾ç½®æœˆä»½</span><br><span class="line">LocalDate <span class="title function_">withDayOfMonth</span><span class="params">(<span class="type">int</span> day)</span>:è®¾ç½®æœˆä¸­çš„å¤©æ•°</span><br><span class="line">    </span><br><span class="line">æ—¥æœŸå­—æ®µåç§»(ç”¨æ–°çš„å¯¹è±¡å»æ¥æ”¶)ï¼š</span><br><span class="line">è®¾ç½®æ—¥æœŸå­—æ®µçš„åç§»é‡,æ–¹æ³•åpluså¼€å¤´,å‘ååç§»</span><br><span class="line">è®¾ç½®æ—¥æœŸå­—æ®µçš„åç§»é‡,æ–¹æ³•åminuså¼€å¤´,å‘å‰åç§»</span><br><span class="line">    eg: <span class="type">LocalDate</span> <span class="variable">myLD</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LocalDate</span>();</span><br><span class="line">æƒ³è¦åœ¨è¿™ä¸ªldå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œå¾€å‰åç§»ä¸€å¹´ï¼Œå°±è°ƒç”¨æ–¹æ³•minusYearsï¼š</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">myMinusLD</span> <span class="operator">=</span> myLD.minusYears(<span class="number">1L</span>);    </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Periodå’ŒDurationç±»</p><p>è¿™ä¸¤è€…éƒ½æ˜¯è®¡ç®—æ—¶é—´å·®çš„ï¼Œperiodæ“ä½œçš„æ˜¯LocalDateå¯¹è±¡ï¼Œå¹´æœˆæ—¥åˆ†åˆ«è®¡ç®—ï¼ŒDurationæ“ä½œçš„æ˜¯LocalDate å’ŒLocalDateTimeå¯¹è±¡ï¼Œæ˜¯è·å–æ€»å¤©&#x2F;æ—¶&#x2F;åˆ†&#x2F;ç§’å·®å€¼çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Period <span class="title function_">between</span><span class="params">(LocalDate d1,LocalDate d2)</span>:è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å€¼</span><br><span class="line"></span><br><span class="line">getYears()-&gt;è·å–ç›¸å·®çš„å¹´</span><br><span class="line">getMonths()-&gt;è·å–ç›¸å·®çš„æœˆ</span><br><span class="line">getDays()-&gt;è·å–ç›¸å·®çš„å¤©</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Duration <span class="title function_">between</span><span class="params">(Temporal startInclusive, Temporal endExclusive)</span>  -&gt; è®¡ç®—æ—¶é—´å·®</span><br><span class="line">Temporal : æ˜¯ä¸€ä¸ªæ¥å£</span><br><span class="line">  å®ç°ç±»:LocalDate LocalDateTime</span><br><span class="line">      </span><br><span class="line">å‚æ•°éœ€è¦ä¼ é€’ Temporal çš„å®ç°ç±»å¯¹è±¡, æ³¨æ„è¦ä¼ é€’LocalDateTime</span><br><span class="line">  å› ä¸ºDurationè®¡ç®—ç²¾ç¡®æ—¶é—´åå·®,æ‰€ä»¥éœ€è¦ä¼ é€’èƒ½æ“ä½œç²¾ç¡®æ—¶é—´çš„ LocalDateTime</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">åˆ©ç”¨Dutationè·å–ç›¸å·®çš„æ—¶åˆ†ç§’ -&gt; toå¼€å¤´</span><br><span class="line">  toDays() :è·å–ç›¸å·®å¤©æ•°</span><br><span class="line">  toHours(): è·å–ç›¸å·®å°æ—¶</span><br><span class="line">  toMinutes():è·å–ç›¸å·®åˆ†é’Ÿ</span><br><span class="line">  toMillis():è·å–ç›¸å·®ç§’(æ¯«ç§’)</span><br></pre></td></tr></table></figure><p>DateTimeFormatteræ—¥æœŸæ ¼å¼åŒ–ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>è·å–:</span><br><span class="line">  <span class="keyword">static</span> DateTimeFormatter <span class="title function_">ofPattern</span><span class="params">(String pattern)</span>   -&gt; è·å–å¯¹è±¡,æŒ‡å®šæ ¼å¼</span><br><span class="line"><span class="number">2.</span>æ–¹æ³•:</span><br><span class="line">  String <span class="title function_">format</span><span class="params">(TemporalAccessor temporal)</span>-&gt; å°†æ—¥æœŸå¯¹è±¡æŒ‰ç…§æŒ‡å®šçš„è§„åˆ™è½¬æˆString </span><br><span class="line">                TemporalAccessor:æ¥å£,å­æ¥å£æœ‰Temporal</span><br><span class="line">                Temporalçš„å®ç°ç±»:LocalDate LocalDateTime    </span><br><span class="line">                    </span><br><span class="line">  TemporalAccessor <span class="title function_">parse</span><span class="params">(CharSequence text)</span>-&gt; å°†ç¬¦åˆè§„åˆ™çš„å­—ç¬¦ä¸²è½¬æˆæ—¥æœŸå¯¹è±¡ </span><br><span class="line">                   å¦‚æœæƒ³å°†TemporalAccessorè½¬æˆæˆ‘ä»¬å¸¸è§çš„LocalDateTimeæ—¥æœŸå¯¹è±¡,å°±éœ€è¦ç”¨åˆ°LocalDateTimeä¸­çš„é™æ€æ–¹æ³•:</span><br><span class="line">                   <span class="keyword">static</span> LocalDateTime <span class="title function_">from</span><span class="params">(TemporalAccessor temporal)</span>  </span><br></pre></td></tr></table></figure><p>Systemç±»ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815082633405.png" alt="image-20250815082633405"></p><p>Arrayså·¥å…·ç±»ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815082817290.png" alt="image-20250815082817290"></p><h5 id="Callableä¸çº¿ç¨‹æ± "><a href="#Callableä¸çº¿ç¨‹æ± " class="headerlink" title="Callableä¸çº¿ç¨‹æ± "></a>Callableä¸çº¿ç¨‹æ± </h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815084012847.png" alt="image-20250815084012847"></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>1.è‡ªå®šä¹‰ç±»å®ç°callabeæ¥å£ï¼Œé‡å†™callæ–¹æ³•ï¼Œå…¶ä¸­callæ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯callableæ¥å£åº”ç”¨æ—¶æŒ‡å®šçš„æ³›å‹</p><p>2.åˆ›å»ºçº¿ç¨‹æ± å¯¹è±¡ï¼Œå°†è‡ªå®šä¹‰ç±»newçš„å¯¹è±¡submitåˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¹¶ç”¨futureå¯¹è±¡æ¥æ”¶submitæ–¹æ³•çš„è¿”å›å€¼</p><p>3.å¯¹futureå¯¹è±¡æ‰§è¡Œgetæ–¹æ³•ï¼Œå¯ä»¥è·å¾—callæ–¹æ³•çš„è¿”å›å€¼</p><h5 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h5><h6 id="åŸç”Ÿåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼"><a href="#åŸç”Ÿåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼" class="headerlink" title="åŸç”Ÿåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼"></a>åŸç”Ÿåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815215632996.png" alt="image-20250815215632996"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815215653650.png" alt="image-20250815215653650"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹å·¥å‚å¯¹è±¡ï¼Œé‡å†™newThreadæ–¹æ³•ï¼Œå¯ä»¥è‡ªè¡Œå¯¹çº¿ç¨‹è¿›è¡Œä¸€äº›è®¾ç½®</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myThreadFactory</span> <span class="keyword">implements</span> <span class="title class_">ThreadFactory</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">i</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">1</span>); <span class="comment">//åˆ›å»ºåŸå­è®¡æ•°å™¨ï¼Œè¿™ä¸œè¥¿æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œçº¿ç¨‹å®‰å…¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(Runnable r)</span>&#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(r);</span><br><span class="line">        Thread.setName(<span class="string">&quot;çº¿ç¨‹&quot;</span>+i.getAndIncrement()+<span class="string">&quot;å·&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> thread;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¼–å†™ä¸€ä¸ªä»»åŠ¡ï¼Œé€šè¿‡è‡ªå®šä¹‰ç±»å®ç°runnableæ¥å£å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.plintln(Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨mainæ–¹æ³•ä¸­ä½¿ç”¨çº¿ç¨‹æ± </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸‰ä¸ªä»»åŠ¡</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">task1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">    <span class="type">Task</span> <span class="variable">task2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">    <span class="type">Task</span> <span class="variable">task3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆ›å»ºçº¿ç¨‹æ± å¯¹è±¡</span></span><br><span class="line">    <span class="type">ThreadPoolExecutor</span> <span class="variable">mytpe</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">10</span>,<span class="number">25</span>,<span class="number">10L</span>,</span><br><span class="line">                                                      TimeUnit.SECONDS,</span><br><span class="line">                                                      <span class="keyword">new</span> <span class="title class_">LinkdBlockingQueue</span>&lt;&gt;(),</span><br><span class="line">                                                      <span class="keyword">new</span> <span class="title class_">myThreadFactory</span>(),</span><br><span class="line">                                                      <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());</span><br><span class="line">    mytpe.execute(task1);</span><br><span class="line">    mytpe.execute(task2);</span><br><span class="line">    mytpe.execute(task3);    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å…³é—­çº¿ç¨‹æ± </span></span><br><span class="line">    mytpe.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å„ä¸ªå‚æ•°è¯¦è§£ï¼š</p><p>10ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°é‡</p><p>25ï¼šæœ€å¤§çº¿ç¨‹æ•°é‡</p><p>10Lï¼šç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</p><p>new LinkdBlockingQueue&lt;&gt;()ï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œè¿™é‡Œä½¿ç”¨é˜»å¡é“¾å¼é˜Ÿåˆ—ï¼Œè¿˜æœ‰é˜»å¡æ•°ç»„é˜Ÿåˆ—</p><p>new myThreadFactory()ï¼šçº¿ç¨‹å·¥å‚</p><p>new ThreadPoolExecutor.AbortPolicy()ï¼šæ‹’ç»ä»»åŠ¡ç­–ç•¥ï¼Œè¿™é‡Œæ˜¯é»˜è®¤çš„ç­–ç•¥</p><h6 id="ä¸‰ç§ä¸æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ï¼š"><a href="#ä¸‰ç§ä¸æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ï¼š" class="headerlink" title="ä¸‰ç§ä¸æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ï¼š"></a>ä¸‰ç§ä¸æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼ï¼š</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815221805670.png" alt="image-20250815221805670"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815221914018.png" alt="image-20250815221914018"></p><p>åŸå› å°±æ˜¯ä»–ä»¬çš„ä»»åŠ¡é˜Ÿåˆ—å­˜åœ¨æº¢å‡ºé£é™©</p><h6 id="æäº¤ä»»åŠ¡çš„ä¸¤ç§æ–¹å¼ï¼Œexecuteå’Œsubmit"><a href="#æäº¤ä»»åŠ¡çš„ä¸¤ç§æ–¹å¼ï¼Œexecuteå’Œsubmit" class="headerlink" title="æäº¤ä»»åŠ¡çš„ä¸¤ç§æ–¹å¼ï¼Œexecuteå’Œsubmit"></a>æäº¤ä»»åŠ¡çš„ä¸¤ç§æ–¹å¼ï¼Œexecuteå’Œsubmit</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815222203241.png" alt="image-20250815222203241"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815222219082.png" alt="image-20250815222219082"></p><h6 id="futureå¯¹è±¡ä¸­çš„getæ–¹æ³•"><a href="#futureå¯¹è±¡ä¸­çš„getæ–¹æ³•" class="headerlink" title="futureå¯¹è±¡ä¸­çš„getæ–¹æ³•:"></a>futureå¯¹è±¡ä¸­çš„getæ–¹æ³•:</h6><p>futureå¯¹è±¡ä¸­çš„getæ–¹æ³•ä½œç”¨æ˜¯è·å–callçš„returnçš„ç»“æœ</p><p><strong>é»˜è®¤æ˜¯é˜»å¡çš„</strong></p><p>å¦‚æœæƒ³ç»™è¿™ä¸ªgetè®¾å®šä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå°±åœ¨geté‡Œé¢ä¼ å…¥å‚æ•°å³å¯ï¼Œå¦‚ future.get(1, TimeUnit.SECONDS);</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815222601775.png" alt="image-20250815222601775"></p><h6 id="futureå¯¹è±¡ä¸­çš„cancelæ–¹æ³•ï¼š"><a href="#futureå¯¹è±¡ä¸­çš„cancelæ–¹æ³•ï¼š" class="headerlink" title="futureå¯¹è±¡ä¸­çš„cancelæ–¹æ³•ï¼š"></a>futureå¯¹è±¡ä¸­çš„cancelæ–¹æ³•ï¼š</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815222656651.png" alt="image-20250815222656651"></p><p>æœªæ‰§è¡Œçš„ä»»åŠ¡ï¼Œè°ƒç”¨cancelæ–¹æ³•ï¼Œä¼ é€’çš„å‚æ•°trueå’Œfalseæ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼Œå› ä¸ºæ ¹æœ¬ç”¨ä¸åˆ°ï¼Œç»“æœæ˜¯èƒ½å–æ¶ˆä»»åŠ¡</p><p>æ­£åœ¨æ‰§è¡Œä¸­çš„ä»»åŠ¡ï¼Œ</p><p>â€‹1.ä¼ é€’trueä»£è¡¨å¯ä»¥ç›¸åº”ä¸­æ–­çº¿ç¨‹æŒ‡ä»¤ï¼ˆç›¸å½“äºæ‰“å¼€äº†ä¸­æ–­çº¿ç¨‹æŒ‡ä»¤çš„è·å–æƒï¼‰ï¼Œè¿™æ—¶å€™ç¨‹åºå¯ä»¥æ ¹æ®ä¸­æ–­çº¿ç¨‹æŒ‡ä»¤æ¥åšå‡ºç›¸åº”è¡Œä¸ºï¼ˆå¦‚æœä¸æ‰‹åŠ¨æ ¹æ®æŒ‡ä»¤åšå‡ºåŠ¨ä½œï¼Œé‚£å’Œfalseæ²¡åŒºåˆ«ï¼‰</p><p>â€‹2.ä¼ é€’falseï¼Œä»£è¡¨æ²¡æœ‰ä»€ä¹ˆä½¿ç”¨æƒï¼Œå½“å‰ä»»åŠ¡ä¼šç»§ç»­æ‰§è¡Œå®Œ</p><p>å·²å®Œæˆçš„ä»»åŠ¡ï¼Œæ— æ³•å–æ¶ˆ</p><p><strong>quastionï¼šæ—¢ç„¶falseçš„æ—¶å€™ï¼Œç¨‹åºè¿˜æ˜¯æ‰§è¡Œå®Œäº†ï¼Œé‚£æ ‡è®°æœ‰å•¥æ„ä¹‰ï¼Ÿ</strong></p><p>ç­”ï¼š<strong>ä»…ä½œé€»è¾‘æ ‡è®°</strong></p><h6 id="ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼š"><a href="#ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼š" class="headerlink" title="ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼š"></a>ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼š</h6><p><img src="C:\Users\EdwardNygma\AppData\Roaming\Typora\typora-user-images\image-20250815224437313.png" alt="image-20250815224437313"></p><h6 id="shutdown-shutdownNowæ–¹æ³•ï¼š"><a href="#shutdown-shutdownNowæ–¹æ³•ï¼š" class="headerlink" title="shutdown&amp;&amp;shutdownNowæ–¹æ³•ï¼š"></a>shutdown&amp;&amp;shutdownNowæ–¹æ³•ï¼š</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815224705096.png" alt="image-20250815224705096"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815225022596.png" alt="image-20250815225022596"></p><h6 id="çº¿ç¨‹æ± çŠ¶æ€"><a href="#çº¿ç¨‹æ± çŠ¶æ€" class="headerlink" title="çº¿ç¨‹æ± çŠ¶æ€"></a>çº¿ç¨‹æ± çŠ¶æ€</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815225301231.png" alt="image-20250815225301231"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815225310827.png" alt="image-20250815225310827"></p><h6 id="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹"><a href="#çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹" class="headerlink" title="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹"></a>çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815233301354.png" alt="image-20250815233301354"></p><h6 id="çº¿ç¨‹æ± æ‰¹é‡æ‰§è¡Œ"><a href="#çº¿ç¨‹æ± æ‰¹é‡æ‰§è¡Œ" class="headerlink" title="çº¿ç¨‹æ± æ‰¹é‡æ‰§è¡Œ"></a>çº¿ç¨‹æ± æ‰¹é‡æ‰§è¡Œ</h6><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815234043731.png" alt="image-20250815234043731"></p><h5 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815234851152.png" alt="image-20250815234851152"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250815234950023.png" alt="image-20250815234950023"></p><h5 id="IOæµ"><a href="#IOæµ" class="headerlink" title="IOæµ"></a>IOæµ</h5><h6 id="Fileç±»"><a href="#Fileç±»" class="headerlink" title="Fileç±»"></a>Fileç±»</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä¸¤ä¸ªæ“ä½œç¬¦å¸¸é‡ï¼š</span><br><span class="line"><span class="keyword">static</span> String pathSeparator:ä¸ç³»ç»Ÿæœ‰å…³çš„è·¯å¾„åˆ†éš”ç¬¦ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå®ƒè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><br><span class="line"><span class="keyword">static</span> String separator:ä¸ç³»ç»Ÿæœ‰å…³çš„é»˜è®¤åç§°åˆ†éš”ç¬¦ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå®ƒè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>Fileçš„æ„é€ æ–¹æ³•ï¼š</span><br><span class="line">File(String parent, String child) æ ¹æ®æ‰€å¡«å†™çš„è·¯å¾„åˆ›å»ºFileå¯¹è±¡</span><br><span class="line">     parent:çˆ¶è·¯å¾„</span><br><span class="line">     child:å­è·¯å¾„</span><br><span class="line">File(File parent, String child)  æ ¹æ®æ‰€å¡«å†™çš„è·¯å¾„åˆ›å»ºFileå¯¹è±¡</span><br><span class="line">     parent:çˆ¶è·¯å¾„,æ˜¯ä¸€ä¸ªFileå¯¹è±¡</span><br><span class="line">     child:å­è·¯å¾„</span><br><span class="line">File(String pathname)  æ ¹æ®æ‰€å¡«å†™çš„è·¯å¾„åˆ›å»ºFileå¯¹è±¡</span><br><span class="line">     pathname:ç›´æ¥æŒ‡å®šè·¯å¾„   </span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line"><span class="number">3.</span>Fileçš„è·å–æ–¹æ³•ï¼š</span><br><span class="line">String <span class="title function_">getAbsolutePath</span><span class="params">()</span> -&gt; è·å–Fileçš„ç»å¯¹è·¯å¾„-&gt;å¸¦ç›˜ç¬¦çš„è·¯å¾„</span><br><span class="line">String <span class="title function_">getPath</span><span class="params">()</span> -&gt;è·å–çš„æ˜¯å°è£…è·¯å¾„-&gt;<span class="keyword">new</span> <span class="title class_">File</span>å¯¹è±¡çš„æ—¶å€™å†™çš„å•¥è·¯å¾„,è·å–çš„å°±æ˜¯å•¥è·¯å¾„</span><br><span class="line">String <span class="title function_">getName</span><span class="params">()</span>  -&gt; è·å–çš„æ˜¯æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹åç§°</span><br><span class="line"><span class="type">long</span> <span class="title function_">length</span><span class="params">()</span> -&gt; è·å–çš„æ˜¯æ–‡ä»¶çš„é•¿åº¦ -&gt; æ–‡ä»¶çš„å­—èŠ‚æ•°   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>Fileçš„åˆ›å»º/åˆ é™¤æ–¹æ³•ï¼š</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">createNewFile</span><span class="params">()</span>  -&gt; åˆ›å»ºæ–‡ä»¶</span><br><span class="line">        å¦‚æœè¦åˆ›å»ºçš„æ–‡ä»¶ä¹‹å‰æœ‰,åˆ›å»ºå¤±è´¥,è¿”å›<span class="literal">false</span></span><br><span class="line">        å¦‚æœè¦åˆ›å»ºçš„æ–‡ä»¶ä¹‹å‰æ²¡æœ‰,åˆ›å»ºæˆåŠŸ,è¿”å›<span class="literal">true</span></span><br><span class="line">    </span><br><span class="line"><span class="type">boolean</span> <span class="title function_">mkdirs</span><span class="params">()</span> -&gt; åˆ›å»ºæ–‡ä»¶å¤¹(ç›®å½•)æ—¢å¯ä»¥åˆ›å»ºå¤šçº§æ–‡ä»¶å¤¹,è¿˜å¯ä»¥åˆ›å»ºå•çº§æ–‡ä»¶å¤¹</span><br><span class="line">        å¦‚æœè¦åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¹‹å‰æœ‰,åˆ›å»ºå¤±è´¥,è¿”å›<span class="literal">false</span></span><br><span class="line">        å¦‚æœè¦åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¹‹å‰æ²¡æœ‰,åˆ›å»ºæˆåŠŸ,è¿”å›<span class="literal">true</span></span><br><span class="line">        </span><br><span class="line"><span class="type">boolean</span> <span class="title function_">delete</span><span class="params">()</span>-&gt;åˆ é™¤æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹</span><br><span class="line">æ³¨æ„:</span><br><span class="line">  <span class="number">1.</span>å¦‚æœåˆ é™¤æ–‡ä»¶,ä¸èµ°å›æ”¶ç«™</span><br><span class="line">  <span class="number">2.</span>å¦‚æœåˆ é™¤æ–‡ä»¶å¤¹,å¿…é¡»æ˜¯ç©ºæ–‡ä»¶å¤¹,è€Œä¸”ä¹Ÿä¸èµ°å›æ”¶ç«™          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>Fileçš„åˆ¤æ–­æ–¹æ³•</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isDirectory</span><span class="params">()</span> -&gt; åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹ </span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isFile</span><span class="params">()</span>  -&gt; åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">exists</span><span class="params">()</span>  -&gt; åˆ¤æ–­æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>Fileçš„éå†æ–¹æ³•</span><br><span class="line">String[] list() -&gt; éå†æŒ‡å®šçš„æ–‡ä»¶å¤¹,è¿”å›çš„æ˜¯Stringæ•°ç»„ </span><br><span class="line">File[] listFiles()-&gt; éå†æŒ‡å®šçš„æ–‡ä»¶å¤¹,è¿”å›çš„æ˜¯Fileæ•°ç»„ -&gt;è¿™ä¸ªæ¨èä½¿ç”¨</span><br><span class="line">    </span><br><span class="line">ç»†èŠ‚:listFilesæ–¹æ³•åº•å±‚è¿˜æ˜¯listæ–¹æ³•</span><br><span class="line">     è°ƒç”¨listæ–¹æ³•,éå†æ–‡ä»¶å¤¹,è¿”å›ä¸€ä¸ªStirngæ•°ç»„,éå†æ•°ç»„,å°†æ•°ç»„ä¸­çš„å†…å®¹ä¸€ä¸ªä¸€ä¸ªå°è£…åˆ°Fileå¯¹è±¡ä¸­,ç„¶åå†å°†Fileå¯¹è±¡æ”¾åˆ°Fileæ•°ç»„ä¸­</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="å­—èŠ‚å­—ç¬¦æµ"><a href="#å­—èŠ‚å­—ç¬¦æµ" class="headerlink" title="å­—èŠ‚å­—ç¬¦æµ"></a>å­—èŠ‚å­—ç¬¦æµ</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">å­—èŠ‚æµ:ä¸‡èƒ½æµ,ä¸€åˆ‡çš†å­—èŠ‚</span><br><span class="line">      å­—èŠ‚è¾“å‡ºæµ:  OutputStream æŠ½è±¡ç±»</span><br><span class="line">      å­—èŠ‚è¾“å…¥æµ:  InputStream æŠ½è±¡ç±»</span><br><span class="line">          </span><br><span class="line">å­—ç¬¦æµ:ä¸“é—¨æ“ä½œæ–‡æœ¬æ–‡æ¡£</span><br><span class="line">      å­—ç¬¦è¾“å‡ºæµ:Writer æŠ½è±¡ç±»</span><br><span class="line">      å­—ç¬¦è¾“å…¥æµ:Reader æŠ½è±¡ç±»</span><br><span class="line">      </span><br><span class="line"><span class="number">1.</span>OutputStreamï¼š</span><br><span class="line">æ„é€ ï¼ˆä½¿ç”¨çš„æ˜¯å®ç°ç±»FileOutputStreamï¼‰:</span><br><span class="line">   FileOutputStream(File file) </span><br><span class="line">   FileOutputStream(String name)</span><br><span class="line">   </span><br><span class="line">ç‰¹ç‚¹:</span><br><span class="line">   a.æŒ‡å®šçš„æ–‡ä»¶å¦‚æœæ²¡æœ‰,è¾“å‡ºæµä¼šè‡ªåŠ¨åˆ›å»º</span><br><span class="line">   b.æ¯æ‰§è¡Œä¸€æ¬¡,é»˜è®¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶,è¦†ç›–è€æ–‡ä»¶ </span><br><span class="line"></span><br><span class="line">æ–¹æ³•:</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> b)</span>  ä¸€æ¬¡å†™ä¸€ä¸ªå­—èŠ‚</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">byte</span>[] b)</span>  ä¸€æ¬¡å†™ä¸€ä¸ªå­—èŠ‚æ•°ç»„</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">byte</span>[] b, <span class="type">int</span> off, <span class="type">int</span> len)</span>  ä¸€æ¬¡å†™ä¸€ä¸ªå­—èŠ‚æ•°ç»„ä¸€éƒ¨åˆ† </span><br><span class="line">             b:å†™çš„æ•°ç»„</span><br><span class="line">             off:ä»æ•°ç»„çš„å“ªä¸ªç´¢å¼•å¼€å§‹å†™</span><br><span class="line">             len:å†™å¤šå°‘ä¸ª</span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>  -&gt; å…³é—­èµ„æº </span><br><span class="line"></span><br><span class="line">å­—èŠ‚æµçš„ç»­å†™è¿½åŠ :</span><br><span class="line">  FileOutputStream(String name, <span class="type">boolean</span> append) </span><br><span class="line">                   append:<span class="literal">true</span> -&gt; ä¼šå®ç°ç»­å†™è¿½åŠ ,æ–‡ä»¶ä¸è¦†ç›–äº†</span><br><span class="line">                   </span><br><span class="line">                   </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>InputStream</span><br><span class="line">æ„é€ :ï¼ˆä½¿ç”¨çš„æ˜¯å®ç°ç±»FileInputStreamï¼‰</span><br><span class="line">  FileInputStream(File file)</span><br><span class="line">  FileInputStream(String path)  </span><br><span class="line"></span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">()</span>   ä¸€æ¬¡è¯»ä¸€ä¸ªå­—èŠ‚,è¿”å›çš„æ˜¯è¯»å–çš„å­—èŠ‚</span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">byte</span>[] b)</span>  ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°ç»„,è¿”å›çš„æ˜¯è¯»å–çš„å­—èŠ‚ä¸ªæ•°</span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">byte</span>[] b, <span class="type">int</span> off, <span class="type">int</span> len)</span>  ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°ç»„ä¸€éƒ¨åˆ†,è¿”å›çš„æ˜¯è¯»å–çš„å­—èŠ‚ä¸ªæ•°</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>  å…³é—­èµ„æº  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="number">3.</span>FileWriter</span><br><span class="line">æ„é€ :</span><br><span class="line">  FileWriter(File file) </span><br><span class="line">  FileWriter(String fileName)     </span><br><span class="line">  FileWriter(String fileName, <span class="type">boolean</span> append) -&gt; è¿½åŠ ,ç»­å†™</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> c)</span> -&gt; ä¸€æ¬¡å†™ä¸€ä¸ªå­—ç¬¦ </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">char</span>[] cbuf)</span> ä¸€æ¬¡å†™ä¸€ä¸ªå­—ç¬¦æ•°ç»„ </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">char</span>[] cbuf, <span class="type">int</span> off, <span class="type">int</span> len)</span> ä¸€æ¬¡å†™ä¸€ä¸ªå­—ç¬¦æ•°ç»„ä¸€éƒ¨åˆ†  </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(String str)</span> ç›´æ¥å†™ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span>  :å°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·åˆ°æ–‡ä»¶ä¸­    </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>  å…³æµ ï¼ˆè°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨è§¦å‘flushï¼‰</span><br><span class="line">æ³¨æ„:FileWriterråº•å±‚è‡ªå¸¦ä¸€ä¸ªç¼“å†²åŒº,æˆ‘ä»¬å†™çš„æ•°æ®ä¼šå…ˆä¿å­˜åˆ°ç¼“å†²åŒºä¸­,æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·åˆ°æ–‡ä»¶ä¸­</span><br><span class="line">flush():å°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·åˆ°æ–‡ä»¶ä¸­,åç»­æµå¯¹è±¡è¿˜èƒ½ç»§ç»­ä½¿ç”¨</span><br><span class="line">close():å…ˆåˆ·æ–°åå…³é—­,åç»­æµå¯¹è±¡ä¸èƒ½ä½¿ç”¨äº†    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>FileReader</span><br><span class="line">æ„é€ :</span><br><span class="line">  FileReader(File file)</span><br><span class="line">  FileReader(String path)</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">()</span> -&gt; ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦,è¿”å›çš„æ˜¯è¯»å–å­—ç¬¦å¯¹åº”çš„<span class="type">int</span>å€¼ </span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">char</span>[] cbuf)</span> -&gt; ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦æ•°ç»„,è¿”å›çš„æ˜¯è¯»å–ä¸ªæ•°  </span><br><span class="line">  <span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">char</span>[] cbuf, <span class="type">int</span> off, <span class="type">int</span> len)</span> -&gt; ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦æ•°ç»„ä¸€éƒ¨åˆ†,è¿”å›çš„æ˜¯è¯»å–ä¸ªæ•°</span><br><span class="line">           cbuf:è¯»å–çš„æ•°ç»„</span><br><span class="line">           off:ä»æ•°ç»„çš„å“ªä¸ªç´¢å¼•å¼€å§‹è¯»</span><br><span class="line">           len:è¯»å¤šå°‘ä¸ª</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> -&gt; å…³é—­èµ„æº  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>JDK7ä¹‹åioå¼‚å¸¸å¤„ç†æ–¹å¼</span><br><span class="line"><span class="number">1.</span>æ ¼å¼:</span><br><span class="line">  <span class="keyword">try</span>(IOå¯¹è±¡)&#123;</span><br><span class="line">      å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç </span><br><span class="line">  &#125;<span class="keyword">catch</span>(å¼‚å¸¸ç±»å‹ å¯¹è±¡å)&#123;</span><br><span class="line">      å¤„ç†å¼‚å¸¸</span><br><span class="line">  &#125;</span><br><span class="line"><span class="number">2.</span>æ³¨æ„:</span><br><span class="line">  ä»¥ä¸Šæ ¼å¼å¤„ç†IOå¼‚å¸¸,ä¼šè‡ªåŠ¨å…³æµ</span><br></pre></td></tr></table></figure><h6 id="å­—èŠ‚-å­—ç¬¦ç¼“å†²æµ-è½¬æ¢æµ-åºåˆ—åŒ–æ¥å£-åºåˆ—åŒ–æµ-æ‰“å°æµ"><a href="#å­—èŠ‚-å­—ç¬¦ç¼“å†²æµ-è½¬æ¢æµ-åºåˆ—åŒ–æ¥å£-åºåˆ—åŒ–æµ-æ‰“å°æµ" class="headerlink" title="å­—èŠ‚&#x2F;å­—ç¬¦ç¼“å†²æµ è½¬æ¢æµ åºåˆ—åŒ–æ¥å£&#x2F;åºåˆ—åŒ–æµ  æ‰“å°æµ"></a>å­—èŠ‚&#x2F;å­—ç¬¦ç¼“å†²æµ è½¬æ¢æµ åºåˆ—åŒ–æ¥å£&#x2F;åºåˆ—åŒ–æµ  æ‰“å°æµ</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å­—èŠ‚ç¼“å†²æµ</span></span><br><span class="line">  a.BufferedOutputStream:å­—èŠ‚ç¼“å†²è¾“å‡ºæµ</span><br><span class="line">    æ„é€ :BufferedOutputStream(OutputStream out)</span><br><span class="line">    ä½¿ç”¨:å’ŒFileOutputStreamä¸€æ ·</span><br><span class="line">        </span><br><span class="line">  b.BufferedInputStream:å­—èŠ‚ç¼“å†²è¾“å…¥æµ</span><br><span class="line">    æ„é€ :BufferedInputStream(InputStream in)</span><br><span class="line">    ä½¿ç”¨:å’ŒFileInputStreamä¸€æ ·   </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//å­—ç¬¦ç¼“å†²è¾“å‡ºæµ_BufferedWriter </span></span><br><span class="line">æ„é€ :</span><br><span class="line">  BufferedWriter(Writer w)</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  ç”¨èµ·æ¥å’ŒFileWriterä¸€æ ·</span><br><span class="line">ç‰¹æœ‰æ–¹æ³•:</span><br><span class="line">  newLine() æ¢è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­—ç¬¦ç¼“å†²è¾“å…¥æµ_BufferedReader</span></span><br><span class="line">æ„é€ :</span><br><span class="line">  BufferedReader(Reader r)</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">  ç”¨æ³•å’ŒFileReaderä¸€æ ·</span><br><span class="line">ç‰¹æœ‰æ–¹æ³•:</span><br><span class="line">  String <span class="title function_">readLine</span><span class="params">()</span>-&gt; ä¸€æ¬¡è¯»ä¸€è¡Œ,å¦‚æœè¯»åˆ°ç»“æŸæ ‡è®°,è¿”å›çš„æ˜¯<span class="literal">null</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">//è½¬æ¢æµ_InputStreamReader</span></span><br><span class="line">æ„é€ :</span><br><span class="line">  InputStreamReader(InputStream in,String charsetName)</span><br><span class="line">                                   charsetName:æŒ‡å®šç¼–ç ,ä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line">ä½œç”¨:</span><br><span class="line">  å¯ä»¥ç›´æ¥æŒ‡å®šç¼–ç ,æŒ‰ç…§æŒ‡å®šçš„ç¼–ç å»è¯»å†…å®¹</span><br><span class="line">ç”¨æ³•:</span><br><span class="line">  åŸºæœ¬ç”¨æ³•å’ŒFileReaderä¸€æ ·</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//è½¬æ¢æµ_OutputStreamWriter</span></span><br><span class="line">æ„é€ :</span><br><span class="line">  OutputStreamWriter(OutputStream out,String charsetName)</span><br><span class="line">ä½œç”¨:</span><br><span class="line">  æŒ‰ç…§æŒ‡å®šçš„ç¼–ç è§„åˆ™å»å­˜æ•°æ®</span><br><span class="line">ç”¨æ³•:</span><br><span class="line">  å’ŒFileWriterä¸€æ ·</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">//åºåˆ—åŒ–æµå’Œååºåˆ—åŒ–æµ</span></span><br><span class="line"> ObjectOutputStream -&gt; åºåˆ—åŒ–æµ -&gt; å†™å¯¹è±¡</span><br><span class="line"> ObjectInputStream -&gt; ååºåˆ—åŒ–æµ -&gt; è¯»å¯¹è±¡  </span><br><span class="line"> </span><br><span class="line"> åºåˆ—åŒ–egï¼š</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">()</span><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;module22\\person.txt&quot;</span>));</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;æ¶›å“¥&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        oos.writeObject(p1);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line">  ååºåˆ—åŒ–egï¼š</span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">read</span><span class="params">()</span><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;module22\\person.txt&quot;</span>));</span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) ois.readObject();</span><br><span class="line">        System.out.println(person);</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">æ‰“å°æµegï¼š</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01PrintStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintStream</span>(<span class="string">&quot;module22\\printstream.txt&quot;</span>);</span><br><span class="line">        ps.println(<span class="string">&quot;æ¶›å“¥æ˜¯ä¸€ä¸ªå¤§å¸…å“¥&quot;</span>);</span><br><span class="line">        ps.println(<span class="string">&quot;æ¶›å“¥æ˜¯ä¸€ä¸ªå°é²œè‚‰&quot;</span>);</span><br><span class="line">        ps.println(<span class="string">&quot;æ¶›å“¥å’Œé‡‘è²ä¸ä¸ºäººçŸ¥çš„æ•…äº‹&quot;</span>);</span><br><span class="line">        ps.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ”¹å˜æµå‘:</span><br><span class="line">  ä»€ä¹ˆå«åšæ”¹å˜æµå‘:</span><br><span class="line">    System.out.println()-&gt; æœ¬èº«æ˜¯è¾“å‡ºåˆ°æ§åˆ¶å°ä¸Š</span><br><span class="line">    æ”¹å˜æµå‘:å¯ä»¥è®©è¾“å‡ºè¯­å¥ä»æ§åˆ¶å°ä¸Šè¾“å‡ºæ”¹å˜æˆå¾€æŒ‡å®šæ–‡ä»¶ä¸­è¾“å‡º</span><br><span class="line">        </span><br><span class="line">  æ–¹æ³•:Systemä¸­çš„æ–¹æ³•:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setOut</span><span class="params">(PrintStream out)</span> -&gt; æ”¹å˜æµå‘ -&gt;è®©è¾“å‡ºè¯­å¥ä»æ§åˆ¶å°è¾“å‡ºè½¬ç§»åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</span><br></pre></td></tr></table></figure><h6 id="propertiesç»“åˆIOæµ"><a href="#propertiesç»“åˆIOæµ" class="headerlink" title="propertiesç»“åˆIOæµ"></a>propertiesç»“åˆIOæµ</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æ¦‚è¿°: Properties extends Hashtable</span><br><span class="line">ç‰¹ç‚¹:</span><br><span class="line">    a.æ— åº,æ— ç´¢å¼•</span><br><span class="line">    b.keyå”¯ä¸€,valueå¯é‡å¤</span><br><span class="line">    c.çº¿ç¨‹å®‰å…¨</span><br><span class="line">    d.keyå’Œvalueé»˜è®¤ç±»å‹éƒ½æ˜¯String</span><br><span class="line">    </span><br><span class="line">ç‰¹æœ‰æ–¹æ³•:</span><br><span class="line">    setProperty(String key,String value) å­˜é”®å€¼å¯¹</span><br><span class="line">    getProperty(String key) -&gt; æ ¹æ®keyè·å–value</span><br><span class="line">    stringPropertyNames()-&gt; è·å–æ‰€æœ‰çš„keyå­˜æ”¾åˆ°seté›†åˆä¸­</span><br><span class="line">    load(InputStream in) -&gt; å°†æµä¸­çš„æ•°æ®åŠ è½½åˆ°Propertiesé›†åˆä¸­</span><br></pre></td></tr></table></figure><h5 id="ç½‘ç»œç¼–ç¨‹"><a href="#ç½‘ç»œç¼–ç¨‹" class="headerlink" title="ç½‘ç»œç¼–ç¨‹"></a>ç½‘ç»œç¼–ç¨‹</h5><h5 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h5><h5 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="headerlink" title="æ–°ç‰¹æ€§"></a>æ–°ç‰¹æ€§</h5><h5 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h5><h5 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h5>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</title>
      <link href="/2025/04/10/JAVA%E5%AD%A6%E7%94%9F%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/"/>
      <url>/2025/04/10/JAVA%E5%AD%A6%E7%94%9F%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="åŠŸèƒ½æ¦‚è¿°ï¼š"><a href="#åŠŸèƒ½æ¦‚è¿°ï¼š" class="headerlink" title="åŠŸèƒ½æ¦‚è¿°ï¼š"></a>åŠŸèƒ½æ¦‚è¿°ï¼š</h2><ul><li>æ¯ä¸ªStudent å¯¹è±¡å­˜å‚¨ä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯</li><li>æŸ¥è¯¢åŠŸèƒ½ï¼š<ul><li>é€šè¿‡å§“åæŸ¥è¯¢ï¼ˆè€ƒè™‘é‡åæƒ…å†µï¼‰</li><li>é€šè¿‡å­¦å·æŸ¥è¯¢</li></ul></li><li>ä¿®æ”¹åŠŸèƒ½ï¼š<ul><li>ä¿®æ”¹å§“å</li><li>ä¿®æ”¹å­¦å·</li><li>ä¿®æ”¹å¹´é¾„</li><li>ä¿®æ”¹ç­çº§ä¿¡æ¯</li></ul></li><li>å¢åˆ ä¿¡æ¯ï¼š<ul><li>å¢åŠ &#x2F;åˆ é™¤æ¡ç›®</li></ul></li><li>å±•ç¤ºå…¨éƒ¨ï¼š<ul><li>å±•ç¤ºå½“å‰å…¨éƒ¨ä¿¡æ¯</li></ul></li></ul><h2 id="é¡¹ç›®ç»“æ„ï¼š"><a href="#é¡¹ç›®ç»“æ„ï¼š" class="headerlink" title="é¡¹ç›®ç»“æ„ï¼š"></a>é¡¹ç›®ç»“æ„ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">    â””â”€com</span><br><span class="line">        â””â”€stu_info_manage</span><br><span class="line">            â”œâ”€controller</span><br><span class="line">            â”‚      main.java</span><br><span class="line">            â”‚      UserInput.java</span><br><span class="line">            â”‚</span><br><span class="line">            â”œâ”€data</span><br><span class="line">            â”‚      Add_rm.java</span><br><span class="line">            â”‚      Change_info.java</span><br><span class="line">            â”‚      Info_Stroage.java</span><br><span class="line">            â”‚      Search.java</span><br><span class="line">            â”‚      Student.java</span><br><span class="line">            â”‚</span><br><span class="line">            â””â”€service</span><br><span class="line">                    Add_rm.java</span><br><span class="line">                    ChangeInfo.java</span><br><span class="line">                    Search.java</span><br></pre></td></tr></table></figure><h2 id="å®ç°ï¼š"><a href="#å®ç°ï¼š" class="headerlink" title="å®ç°ï¼š"></a>å®ç°ï¼š</h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªStudentæ ‡å‡†JavaBeanï¼ŒåŒ…å«å„ä¸ªgetï¼Œsetæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getId_num</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.id_num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId_num</span><span class="params">(String id_num)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id_num = id_num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getClass_info</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> class_info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setClass_info</span><span class="params">(String class_info)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.class_info = class_info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String id_num;</span><br><span class="line">    <span class="keyword">private</span> String class_info;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæ ¹æ®æ ‡å‡†Javaç®¡ç†ç³»ç»Ÿç»“æ„ï¼Œåˆ†å‡º3ä¸ªpackageï¼š</p><ul><li>è¡¨å±‚ï¼šcontroller</li><li>æœåŠ¡å±‚ï¼šservice</li><li>æ•°æ®å±‚ï¼šdaoï¼ˆæˆ‘å†™çš„dataï¼‰</li></ul><p>è¡¨å±‚ä¸­ï¼Œä½¿ç”¨Userinputtç±»å¤„ç†ç”¨æˆ·çš„è¾“å…¥è¾“å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.controller;</span><br><span class="line"><span class="keyword">import</span> com.stu_info_manage.data.Student;</span><br><span class="line"><span class="keyword">import</span> com.stu_info_manage.service.Search;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserInput</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print_init_info</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Welcome,è¾“å…¥ä½ çš„æ“ä½œ&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;1ï¼šæŸ¥è¯¢\n2.ä¿®æ”¹\n3.æ·»åŠ \\åˆ é™¤\n4.åˆ—å‡ºæ‰€æœ‰&quot;</span>);</span><br><span class="line">            <span class="type">Scanner</span> <span class="variable">init_sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">            <span class="type">int</span> <span class="variable">init_choice</span> <span class="operator">=</span> init_sc.nextInt();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (init_choice ==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                choice1_init();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (init_choice == <span class="number">2</span>) &#123;</span><br><span class="line"></span><br><span class="line">                choice2_init();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (init_choice == <span class="number">3</span>) &#123;</span><br><span class="line"></span><br><span class="line">                add_rm_stu_init();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (init_choice == <span class="number">4</span>) &#123;</span><br><span class="line"></span><br><span class="line">                show_all();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è¯·é‡æ–°è¾“å…¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">choice1_init</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        stu = <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½ æƒ³é€šè¿‡ä»€ä¹ˆæŸ¥è¯¢ï¼Ÿï¼Œè¾“å…¥\n1.å§“å\n2.å­¦å·&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">choice1_sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">choice1_choice</span> <span class="operator">=</span> choice1_sc.nextInt();</span><br><span class="line">        <span class="keyword">if</span>(choice1_choice == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ é€‰æ‹©ä»å§“åæŸ¥è¯¢&quot;</span>);</span><br><span class="line">            garbage_char = choice1_sc.nextLine();</span><br><span class="line">            name = choice1_sc.nextLine();</span><br><span class="line">            stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            stu_list = Search.search_form_name(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(choice1_choice == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ é€‰æ‹©ä»å­¦å·æŸ¥è¯¢&quot;</span>);</span><br><span class="line">            garbage_char = choice1_sc.nextLine();</span><br><span class="line">            id_num = choice1_sc.nextLine();</span><br><span class="line">            stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            stu_list = Search.search_form_id_num(id_num);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½ çš„æŸ¥è¯¢ç»“æœï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; stu_list.size(); i++) &#123;</span><br><span class="line">            stu = stu_list.get(i);</span><br><span class="line">            System.out.println(<span class="string">&quot;name:&quot;</span>+stu.getName()+<span class="string">&quot; id:&quot;</span>+stu.getId_num()+<span class="string">&quot; age:&quot;</span>+stu.getAge()+<span class="string">&quot; class:&quot;</span>+stu.getClass_info());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">choice2_init</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¾“å…¥ä½ æƒ³ä¿®æ”¹çš„äººçš„å­¦å·&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">choice2_sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        id_num = choice2_sc.nextLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½ é€‰æ‹©äº†å­¦å·ä¸ºï¼š&quot;</span>+id_num+<span class="string">&quot; çš„äºº&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä½ æƒ³ä¿®æ”¹çš„ä¿¡æ¯ï¼š\n 1.å§“å \n 2.å­¦å· \n 3.å¹´é¾„ \n 4.ç­çº§&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">choice</span> <span class="operator">=</span> choice2_sc.nextInt();</span><br><span class="line">        <span class="keyword">if</span>(choice == <span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ è¦å°†å§“åæ”¹æˆä»€ä¹ˆï¼š&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trash</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            <span class="type">String</span> <span class="variable">rename</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†å§“åä¿®æ”¹ä¸º &quot;</span>+rename);</span><br><span class="line"></span><br><span class="line">            com.stu_info_manage.service.<span class="type">ChangeInfo</span> <span class="variable">changeInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.ChangeInfo();</span><br><span class="line"></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">renamed</span> <span class="operator">=</span> changeInfo.Rename(rename,id_num);</span><br><span class="line">            <span class="keyword">if</span>(renamed)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">2</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†å­¦å·æ”¹æˆä»€ä¹ˆï¼Ÿ&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trash</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            <span class="type">String</span> <span class="variable">re_id_num</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†å­¦å·æ”¹æˆï¼š&quot;</span>+re_id_num);</span><br><span class="line"></span><br><span class="line">            com.stu_info_manage.service.<span class="type">ChangeInfo</span> <span class="variable">changeInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.ChangeInfo();</span><br><span class="line">            System.out.println(<span class="string">&quot;before: &quot;</span>+id_num+<span class="string">&quot; after: &quot;</span>+re_id_num);</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">re_id_numed</span> <span class="operator">=</span> changeInfo.Re_id_num(id_num,re_id_num);</span><br><span class="line">            <span class="keyword">if</span>(re_id_numed)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">3</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†å¹´é¾„æ”¹æˆä»€ä¹ˆï¼Ÿ&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trash</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            <span class="type">int</span> <span class="variable">reage</span> <span class="operator">=</span> choice2_sc.nextInt();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†å¹´é¾„æ”¹ä¸º&quot;</span>+reage);</span><br><span class="line">            com.stu_info_manage.service.<span class="type">ChangeInfo</span> <span class="variable">changeInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.ChangeInfo();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">reaged</span> <span class="operator">=</span> changeInfo.Reage(reage,id_num);</span><br><span class="line">            <span class="keyword">if</span>(reaged)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">4</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†ç­çº§æ”¹æˆä»€ä¹ˆï¼Ÿ&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trash</span> <span class="operator">=</span> choice2_sc.nextLine();</span><br><span class="line">            String reclass= choice2_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³å°†ç­çº§æ”¹ä¸º&quot;</span>+reclass);</span><br><span class="line">            com.stu_info_manage.service.<span class="type">ChangeInfo</span> <span class="variable">changeInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.ChangeInfo();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">reclassed</span> <span class="operator">=</span> changeInfo.Reclass(reclass,id_num);</span><br><span class="line">            <span class="keyword">if</span>(reclassed)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add_rm_stu_init</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŠ æˆå‘˜æŒ‰1ï¼Œå‡æˆå‘˜æŒ‰2&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">choice3_sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">add_or_rm</span> <span class="operator">=</span> choice3_sc.nextInt();</span><br><span class="line">        <span class="keyword">if</span>(add_or_rm==<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥å§“å&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trush</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            <span class="type">String</span> <span class="variable">add_name</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥å­¦å·&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">add_id</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥å¹´é¾„&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">add_age</span> <span class="operator">=</span> choice3_sc.nextInt();</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥ç­çº§&quot;</span>);</span><br><span class="line">            trush = choice3_sc.nextLine();</span><br><span class="line">            <span class="type">String</span> <span class="variable">add_class</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³æ·»åŠ ï¼š&quot;</span>+add_name+<span class="string">&quot; &quot;</span>+add_id+<span class="string">&quot; &quot;</span>+add_age+<span class="string">&quot; &quot;</span>+add_class);</span><br><span class="line">            com.stu_info_manage.service.<span class="type">Add_rm</span> <span class="variable">add_rm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.Add_rm();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">added</span> <span class="operator">=</span> add_rm.add_item(add_name,add_id,add_age,add_class);</span><br><span class="line">            <span class="keyword">if</span>(added)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (add_or_rm==<span class="number">2</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥ä½ è¦åˆ é™¤çš„å­¦å·&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">trush</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            <span class="type">String</span> <span class="variable">rm_id</span> <span class="operator">=</span> choice3_sc.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½ æƒ³åˆ é™¤ï¼š&quot;</span>+rm_id);</span><br><span class="line">            com.stu_info_manage.service.<span class="type">Add_rm</span> <span class="variable">add_rm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.service.Add_rm();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">rmed</span> <span class="operator">=</span> add_rm.rm_item(rm_id);</span><br><span class="line">            <span class="keyword">if</span>(rmed)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show_all</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        com.stu_info_manage.data.Info_Stroage.show_all();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String id_num;</span><br><span class="line">    <span class="keyword">private</span> Student stu;</span><br><span class="line">    <span class="keyword">private</span> String garbage_char;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Student&gt; stu_list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœåŠ¡å±‚ä¸­ï¼Œåˆ†å‡º å¢åˆ æ¡ç›® &#x2F; ä¿®æ”¹ä¿¡æ¯ &#x2F; æŸ¥æ‰¾æ¡ç›® ä¸‰å—ï¼Œå› ä¸ºè¿™ä¸ªå°ç³»ç»ŸæœåŠ¡å±‚ä¸ç”¨å¤„ç†ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰€ä»¥åŸºæœ¬æ˜¯ä¸€ä¸ªè½¬æ¥å¤´çš„ä½œç”¨ï¼Œä¸è¿‡è¿˜æ˜¯å†™å‡ºæ¥äº†æ¡†æ¶ï¼š</p><ul><li>å¢åˆ æ¡ç›®ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Add_rm</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add_item</span><span class="params">(String add_name,String add_id_num,<span class="type">int</span> add_age,String add_class)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">added</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(add_age&gt;<span class="number">30</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            added = <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            com.stu_info_manage.data.<span class="type">Add_rm</span> <span class="variable">add_rm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Add_rm();</span><br><span class="line">            added = add_rm.add_item(add_name,add_id_num,add_age,add_class);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> added;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="type">boolean</span> <span class="title function_">rm_item</span><span class="params">(String rm_id_num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">rmed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Add_rm</span> <span class="variable">add_rm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Add_rm();</span><br><span class="line">        rmed = add_rm.rm_item(rm_id_num);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rmed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹ä¿¡æ¯ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChangeInfo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">Rename</span><span class="params">(String rename,String id_num)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.rename = rename;</span><br><span class="line">        <span class="built_in">this</span>.id_num = id_num;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Change_info</span> <span class="variable">change_info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Change_info();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">renamed</span> <span class="operator">=</span> change_info.Rename(<span class="built_in">this</span>.id_num,<span class="built_in">this</span>.rename);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> renamed;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">Re_id_num</span><span class="params">(String id_num,String id_num_aft)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.id_num = id_num;</span><br><span class="line">        <span class="built_in">this</span>.id_num_aft = id_num_aft;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Change_info</span> <span class="variable">change_info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Change_info();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">re_id_numed</span> <span class="operator">=</span> change_info.Re_id_numed(<span class="built_in">this</span>.id_num,<span class="built_in">this</span>.id_num_aft);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> re_id_numed;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">Reage</span><span class="params">(<span class="type">int</span> reage,String id_num)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.reage = reage;</span><br><span class="line">        <span class="built_in">this</span>.id_num = id_num;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Change_info</span> <span class="variable">change_info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Change_info();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">reaged</span> <span class="operator">=</span> change_info.Reage(<span class="built_in">this</span>.id_num,<span class="built_in">this</span>.reage);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reaged;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">Reclass</span><span class="params">(String reclass,String id_num)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.reclass = reclass;</span><br><span class="line">        <span class="built_in">this</span>.id_num = id_num;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Change_info</span> <span class="variable">change_info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Change_info();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">reclassed</span> <span class="operator">=</span> change_info.Reclass(<span class="built_in">this</span>.id_num,<span class="built_in">this</span>.reclass);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reclassed;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rename;</span><br><span class="line">    <span class="keyword">private</span> String reclass;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> reage;</span><br><span class="line">    <span class="keyword">private</span> String id_num;</span><br><span class="line">    <span class="keyword">private</span> String id_num_aft;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>æŸ¥æ‰¾æ¡ç›®ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.service;</span><br><span class="line"><span class="keyword">import</span> com.stu_info_manage.data.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Search</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; <span class="title function_">search_form_name</span><span class="params">(String name)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Search</span> <span class="variable">sh</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Search</span>();</span><br><span class="line">        sh.name = name;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Search</span> <span class="variable">sh_data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Search();</span><br><span class="line">        sh.stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        sh.stu_list = sh_data.search_form_name(sh.name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  sh.stu_list;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; <span class="title function_">search_form_id_num</span><span class="params">(String id_num)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Search</span> <span class="variable">sh</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Search</span>();</span><br><span class="line">        sh.id_num = id_num;</span><br><span class="line">        com.stu_info_manage.data.<span class="type">Search</span> <span class="variable">sh_data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.stu_info_manage.data.Search();</span><br><span class="line">        sh.stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        sh.stu_list = sh_data.search_form_id_num(sh.id_num);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sh.stu_list;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String id_num ;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> Student stu;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Student&gt; stu_list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ•°æ®å±‚åŒæ ·åˆ†å‡ºä¸‰å±‚ï¼Œä¹Ÿç›¸å½“äºè½¬æ¥å¤´ï¼Œä¸äºˆåˆ—å‡º</p><p>æœ€ç»ˆæ•°æ®å¤„ç†åœ¨Info_stroageç±»ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu_info_manage.data;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Info_Stroage</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init_example</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        stu_null = <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        stu_null .setName(<span class="string">&quot;null&quot;</span>);</span><br><span class="line">        stu_null.setAge(<span class="number">000</span>);</span><br><span class="line">        stu_null.setId_num(<span class="string">&quot;000&quot;</span>);</span><br><span class="line"></span><br><span class="line">        students = <span class="keyword">new</span> <span class="title class_">Student</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            students[i] = <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        students[<span class="number">0</span>].setName(<span class="string">&quot;ctx&quot;</span>);</span><br><span class="line">        students[<span class="number">0</span>].setAge(<span class="number">20</span>);</span><br><span class="line">        students[<span class="number">0</span>].setId_num(<span class="string">&quot;2023211949&quot;</span>);</span><br><span class="line">        students[<span class="number">0</span>].setClass_info(<span class="string">&quot;23dx0211&quot;</span>);</span><br><span class="line"></span><br><span class="line">        students[<span class="number">2</span>].setName(<span class="string">&quot;ctx&quot;</span>);</span><br><span class="line">        students[<span class="number">2</span>].setAge(<span class="number">21</span>);</span><br><span class="line">        students[<span class="number">2</span>].setId_num(<span class="string">&quot;2023211950&quot;</span>);</span><br><span class="line">        students[<span class="number">2</span>].setClass_info(<span class="string">&quot;23dx0211&quot;</span>);</span><br><span class="line"></span><br><span class="line">        students[<span class="number">1</span>].setName(<span class="string">&quot;zwc&quot;</span>);</span><br><span class="line">        students[<span class="number">1</span>].setAge(<span class="number">20</span>);</span><br><span class="line">        students[<span class="number">1</span>].setId_num(<span class="string">&quot;2023211940&quot;</span>);</span><br><span class="line">        students[<span class="number">1</span>].setClass_info(<span class="string">&quot;23dx0210&quot;</span>);</span><br><span class="line"></span><br><span class="line">        stu_num = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; <span class="title function_">getStudents_name</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">stu_num</span>  <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (students[i].getName()!=<span class="literal">null</span>&amp;&amp;students[i].getName().equals(name))</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;find the studrent:&quot;</span>+i);</span><br><span class="line">                stu_list.add(students[i]);</span><br><span class="line">                stu_num ++ ;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(stu_num==<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;stu_name_is_null&quot;</span>);</span><br><span class="line">            stu_list.add(stu_null);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stu_list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; <span class="title function_">getStudents_id_num</span><span class="params">(String id_num)</span> &#123;</span><br><span class="line">        stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">stu_num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (students[i].getId_num()!=<span class="literal">null</span> &amp;&amp; students[i].getId_num().equals(id_num))</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;find the studrent:&quot;</span>+i);</span><br><span class="line">                stu_list.add(students[i]);</span><br><span class="line">                stu_num++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(stu_num == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;the student is null&quot;</span>);</span><br><span class="line">            stu_list.add(stu_null);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stu_list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">Rename</span><span class="params">(String id_num,String rename)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">renamed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(students[i].getId_num()!=<span class="literal">null</span>&amp;&amp;students[i].getId_num().equals(id_num))</span><br><span class="line">            &#123;</span><br><span class="line">                students[i].setName(rename);</span><br><span class="line">                renamed = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> renamed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">Re_id_num</span><span class="params">(String id_num_pre,String id_num_aft)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">re_id_numed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(students[i].getId_num()!=<span class="literal">null</span>&amp;&amp;students[i].getId_num().equals(id_num_pre))</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;find_stu&quot;</span>+i);</span><br><span class="line">                students[i].setId_num(id_num_aft);</span><br><span class="line">                re_id_numed = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(re_id_numed);</span><br><span class="line">        <span class="keyword">return</span> re_id_numed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">Reage</span><span class="params">(String id_num,<span class="type">int</span> reage)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">reaged</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(students[i].getId_num()!=<span class="literal">null</span>&amp;&amp;students[i].getId_num().equals(id_num))</span><br><span class="line">            &#123;</span><br><span class="line">                students[i].setAge(reage);</span><br><span class="line">                reaged = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> reaged;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">Reclass</span><span class="params">(String id_num,String reclass)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">reclassed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(students[i].getId_num()!=<span class="literal">null</span>&amp;&amp;students[i].getId_num().equals(id_num))</span><br><span class="line">            &#123;</span><br><span class="line">                students[i].setClass_info(reclass);</span><br><span class="line">                reclassed = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> reclassed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">add_item</span><span class="params">(String add_name,String add_id_num,<span class="type">int</span> add_age,String add_class)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">added</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        students[stu_num].setName(add_name);</span><br><span class="line">        students[stu_num].setId_num(add_id_num);</span><br><span class="line">        students[stu_num].setAge(add_age);</span><br><span class="line">        students[stu_num].setClass_info(add_class);</span><br><span class="line">        stu_num++;</span><br><span class="line">        added = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> added;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">rm_item</span><span class="params">(String rm_id_num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">rmed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">loc</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(students[i].getId_num().equals(rm_id_num)) &#123;</span><br><span class="line">                loc = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> loc; i &lt; stu_num; i++) &#123;</span><br><span class="line">            students[i] = students[i+<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stu_num--;</span><br><span class="line">        rmed = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> rmed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">show_all</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;total: &quot;</span>+stu_num);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; stu_num; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;name: &quot;</span>+students[i].getName()+<span class="string">&quot; age: &quot;</span>+students[i].getAge()+<span class="string">&quot; id: &quot;</span>+students[i].getId_num()+<span class="string">&quot; class: &quot;</span>+students[i].getClass_info());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Student[] students;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Student stu_null;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; stu_list;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> stu_num;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å¼€å‘è®°å½•"><a href="#å¼€å‘è®°å½•" class="headerlink" title="å¼€å‘è®°å½•"></a>å¼€å‘è®°å½•</h2><h3 id="1-ArrayList-çš„ä½¿ç”¨"><a href="#1-ArrayList-çš„ä½¿ç”¨" class="headerlink" title="1.ArrayList çš„ä½¿ç”¨"></a>1.ArrayList çš„ä½¿ç”¨</h3><p>åœ¨å­˜å‚¨å¯¹è±¡çš„æ—¶å€™ï¼Œä¸€å¼€å§‹æƒ³æŠŠå¯¹è±¡å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡æ•°ç»„ï¼Œå½“ç„¶æœ€åä¹Ÿæ˜¯è¿™ä¹ˆå­˜çš„ï¼Œä½†åœ¨æŸ¥æ‰¾ç±»çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œæ„è¯†åˆ°å¯èƒ½å­˜åœ¨é‡åæƒ…å†µï¼Œå› æ­¤ä¸èƒ½å›ºå®šè¿”å›ä¸€ä¸ªStudentå¯¹è±¡ï¼Œè€Œåº”è¯¥è¿”å›ä¸€ä¸ªæ•°ç»„</p><p>ç„¶è€Œï¼Œæ•°ç»„çš„é•¿åº¦æ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥å¼•å…¥ArrayListå¯å˜é•¿æ•°ç»„æ¥è¿›è¡Œå¯¹è±¡çš„åŠ¨æ€æ•°ç›®å­˜å‚¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new ArrayList å¯¹è±¡ï¼š</span></span><br><span class="line">ArrayList&lt;Student&gt; stu_list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¢åŠ å…ƒç´ ï¼š</span></span><br><span class="line">stu_list.add(stu_example);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½œä¸ºå‡½æ•°è¿”å›å€¼ï¼š</span></span><br><span class="line"><span class="keyword">public</span> ArrayList&lt;stduent&gt; <span class="title function_">method</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºç¡€è¯­æ³•</title>
      <link href="/2025/01/07/cmake/"/>
      <url>/2025/01/07/cmake/</url>
      
        <content type="html"><![CDATA[<h2 id="CMakeLists-txtç¼–å†™"><a href="#CMakeLists-txtç¼–å†™" class="headerlink" title="CMakeLists.txtç¼–å†™"></a>CMakeLists.txtç¼–å†™</h2><ul><li>æ–‡ä»¶åå¿…é¡»ä¸¥æ ¼å†™ä¸ºCMakeLists</li></ul><h3 id="åŸºç¡€çš„ä¸‰å¥è¯ï¼š"><a href="#åŸºç¡€çš„ä¸‰å¥è¯ï¼š" class="headerlink" title="åŸºç¡€çš„ä¸‰å¥è¯ï¼š"></a>åŸºç¡€çš„ä¸‰å¥è¯ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cmake_minmum_required (VERSION <span class="number">2.8</span>) //è¿™å¥è¯æŒ‡çš„æ˜¯æ”¯æŒçš„cmakeæœ€ä½ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (<span class="keyword">test</span>)//è¿™å¥è¯æ˜¯é¡¹ç›®åç§°</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(test_executable_file main.c) </span><br><span class="line">//è¿™å¥è¯æœ‰ä¸¤ç±»å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é¢„è®¡ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåé¢çš„å‚æ•°æ˜¯Cppè¯­è¨€æºæ–‡ä»¶ï¼Œ</span><br><span class="line">å¦‚æœè¯´æœ‰å¤šä¸ªæºæ–‡ä»¶ï¼Œåˆ™åœ¨ç¬¬äºŒç±»å‚æ•°é‡Œé¢æ·»åŠ ï¼Œæ¯”å¦‚ï¼š</span><br><span class="line"><span class="keyword">add_executable</span>(test2 main.cpp <span class="keyword">test</span>.cpp)</span><br></pre></td></tr></table></figure><h3 id="æ¸…é™¤å‘½ä»¤ï¼š"><a href="#æ¸…é™¤å‘½ä»¤ï¼š" class="headerlink" title="æ¸…é™¤å‘½ä»¤ï¼š"></a>æ¸…é™¤å‘½ä»¤ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make clean //æ¸…é™¤test_executable_fileå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">rm -rf CMakeFiles CMakeCache.txt cmake_install.cmake Makefile test_executable_file //åˆ å¹²å‡€</span><br></pre></td></tr></table></figure><h3 id="å°†æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›å»çš„å‘½ä»¤ï¼š"><a href="#å°†æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›å»çš„å‘½ä»¤ï¼š" class="headerlink" title="å°†æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›å»çš„å‘½ä»¤ï¼š"></a>å°†æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›å»çš„å‘½ä»¤ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aux_source_directionary(dir var)</span><br><span class="line"><span class="comment">#è¿™å¥è¯æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‰é¢ä¸€ä¸ªdiræŒ‡çš„æ˜¯ç›®æ ‡è·¯å¾„ï¼Œåé¢çš„varæŒ‡çš„æ˜¯ä¸€ä¸ªå˜é‡</span></span><br><span class="line"><span class="comment">#å› æ­¤è¿™å¥è¯çš„ä½œç”¨å°±æ˜¯ï¼ŒæŠŠdirè·¯å¾„ä¸‹çš„cppæ–‡ä»¶åˆ—è¡¨å­˜åˆ°varå˜é‡é‡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯¹åº”çš„ï¼Œadd_executable() çš„ç¬¬äºŒä¸ªå‚æ•°å˜ä¸º $&#123;var&#125;:</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="keyword">test</span> <span class="variable">$&#123;var&#125;</span>)</span><br></pre></td></tr></table></figure><h3 id="ç”¨setå‘½ä»¤æ¥æŒ‡å®šæˆ‘ä»¬æƒ³åŒ…å«çš„æ–‡ä»¶ï¼š"><a href="#ç”¨setå‘½ä»¤æ¥æŒ‡å®šæˆ‘ä»¬æƒ³åŒ…å«çš„æ–‡ä»¶ï¼š" class="headerlink" title="ç”¨setå‘½ä»¤æ¥æŒ‡å®šæˆ‘ä»¬æƒ³åŒ…å«çš„æ–‡ä»¶ï¼š"></a>ç”¨setå‘½ä»¤æ¥æŒ‡å®šæˆ‘ä»¬æƒ³åŒ…å«çš„æ–‡ä»¶ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> (var</span><br><span class="line">./mian.c</span><br><span class="line">./test1.c</span><br><span class="line">./test2.c</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿™ä¸ªå‘½ä»¤æŠŠä¸Šé¢ä¸‰ä¸ªcæ–‡ä»¶åˆ—è¡¨å­˜åˆ°äº†varå˜é‡ï¼ŒåŒæ ·çš„ add_executable()çš„ç¬¬äºŒä¸ªå‚æ•°ä¹Ÿæ˜¯å˜ä¸º$&#123;var&#125;</span></span><br></pre></td></tr></table></figure><h3 id="æŒ‡å®šå¤´æ–‡ä»¶è·¯å¾„"><a href="#æŒ‡å®šå¤´æ–‡ä»¶è·¯å¾„" class="headerlink" title="æŒ‡å®šå¤´æ–‡ä»¶è·¯å¾„"></a>æŒ‡å®šå¤´æ–‡ä»¶è·¯å¾„</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include_directories</span> (dir1 dir2)</span><br><span class="line"><span class="comment">#æŠŠdir1 å’Œdir2 å†…çš„å¤´æ–‡ä»¶åŒ…å«è¿›å»</span></span><br></pre></td></tr></table></figure><h2 id="æ„å»ºé¡¹ç›®ç»“æ„"><a href="#æ„å»ºé¡¹ç›®ç»“æ„" class="headerlink" title="æ„å»ºé¡¹ç›®ç»“æ„"></a>æ„å»ºé¡¹ç›®ç»“æ„</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_subdirectory</span>(source_dir [binary_dir] [EXCLUDE_FROM_ALL])</span><br></pre></td></tr></table></figure><ul><li><p>source_dir æºä»£ç ç›®å½•</p><p>æŒ‡å®šä¸€ä¸ªåŒ…å«CMakeLists.txtå’Œä»£ç æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œè¯¥ç›®å½•å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¯¹äºåè€…ç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹æ˜¯CMAKE_CURRENT_SOURCE_DIRã€‚æ­¤å¤–ï¼Œå¦‚æœå­ç›®å½•å†æ¬¡åŒ…å«çš„CMakeLists.txtï¼Œåˆ™å°†ç»§ç»­å¤„ç†é‡Œå±‚çš„CMakeLists.txtï¼Œè€Œä¸æ˜¯ç»§ç»­å¤„ç†å½“å‰æºä»£ç </p></li><li><p>binary_dir äºŒè¿›åˆ¶ä»£ç ç›®å½•</p><p>è¿™ä¸ªç›®å½•æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæŒ‡å®šï¼Œcmakeå‘½ä»¤æ‰§è¡Œåçš„è¾“å‡ºæ–‡ä»¶å°†ä¼šå­˜æ”¾åœ¨æ­¤å¤„ï¼Œè‹¥æ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤æƒ…å†µç­‰äº<code>source_dir</code>æ²¡æœ‰è¿›è¡Œç›¸å¯¹è·¯å¾„è®¡ç®—å‰çš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯<code>CMAKE_BINARY_DIR</code></p></li><li><p>EXCLUDE_FEOM_ALL</p><p>è¿™ä¸ªæ ‡å¿—æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¼ é€’äº†è¯¥å‚æ•°è¡¨ç¤ºæ–°å¢åŠ çš„å­ç›®å½•å°†ä¼šæ’é™¤åœ¨ALLç›®å½•ä¹‹å¤–</p></li></ul><h4 id="åŒCMakeListsæ³•ï¼š"><a href="#åŒCMakeListsæ³•ï¼š" class="headerlink" title="åŒCMakeListsæ³•ï¼š"></a>åŒCMakeListsæ³•ï¼š</h4><ul><li><p>åœ¨æ ¹ç›®å½•ä¸‹æ„å»º CMakeLists.txt ï¼Œç„¶åå†è¿™ä¸ªlistsé‡Œé¢ï¼Œä½¿ç”¨add_subdirectionaryå‘½ä»¤ï¼Œä½¿ç¼–è¯‘è¿‡ç¨‹è½¬åˆ°srcæ–‡ä»¶å¤¹å†…çš„CMakeListsé‡Œé¢</p></li><li><p>åœ¨srcçš„CMakeListsé‡Œé¢ï¼Œç¼–å†™ä¸»è¦å·¥ä½œï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aux_source_directionary (. src_list)</span><br><span class="line"><span class="keyword">include_directories</span> (../<span class="keyword">include</span>)</span><br><span class="line"><span class="keyword">add_executable</span> (main <span class="variable">$&#123;src_list&#125;</span>)</span><br><span class="line"><span class="keyword">set</span> (EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin)</span><br></pre></td></tr></table></figure><ul><li>EXECUTABLE_OUTPUT_PATH ï¼šç›®æ ‡äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„å­˜æ”¾ä½ç½®</li><li>PROJECT_SOURCE_DIRï¼šå·¥ç¨‹çš„æ ¹ç›®å½•</li></ul><p>è¿™ä¸¤ä¸ªéƒ½æ˜¯cmakeçš„é¢„å®šä¹‰å˜é‡ï¼Œç›´æ¥æ‹¿æ¥ç”¨</p></li><li><p>åœ¨buildç›®å½•ä¸‹æ‰§è¡Œcmakeè¿‡ç¨‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>cd buildä»¥åï¼Œä¼šæŠŠæ‰§è¡Œç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶æ”¾åœ¨buildé‡Œé¢ï¼Œé˜²æ­¢æŠŠä»£ç ç»“æ„å˜æˆå²</p><p>cmake .. çš„å«ä¹‰ï¼Œæ˜¯ä»ä¸Šä¸€çº§ç›®å½•ä¸­å¯»æ‰¾cmakelist</p></li></ul><h4 id="å•CMakeListsæ³•"><a href="#å•CMakeListsæ³•" class="headerlink" title="å•CMakeListsæ³•"></a>å•CMakeListsæ³•</h4><p>ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹ç¼–å†™cmakelistï¼Œå¹¶æŠŠå‚æ•°å†™å¥½</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cmake_minmun_required (VERSION <span class="number">2.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(single_cmakelist)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin) <span class="comment">#æŠŠå¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ°biné‡Œè¾¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">aux_source_directory</span> (src SRC_LIST)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span> (<span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span> (main <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œæ–°å»ºä¸€ä¸ªbulidæ–‡ä»¶å¤¹ç„¶ååœ¨é‡Œé¢cmake .. makeå³å¯</p><h4 id="äºŒè€…çš„åŒºåˆ«"><a href="#äºŒè€…çš„åŒºåˆ«" class="headerlink" title="äºŒè€…çš„åŒºåˆ«"></a>äºŒè€…çš„åŒºåˆ«</h4><p>æœ€æ˜æ˜¾çš„åŒºåˆ«å°±æ˜¯ï¼ŒåŒcmakeliståˆ©ç”¨äº†add_subdirectoryI()å‡½æ•°è¿›å…¥åä¼˜å…ˆæ‰§è¡Œå­—æ¯é‡Œcmakelistçš„ç‰¹æ€§</p><p>æŠŠæ•´ä¸ªç¼–è¯‘è¿‡ç¨‹åˆ†å±‚äº†ï¼Œåˆ†æˆå¤–å±‚çš„æ§åˆ¶å…¨å±€å’Œå†…å±‚çš„å…·ä½“å®ç°</p><h2 id="åŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘æ§åˆ¶"><a href="#åŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘æ§åˆ¶" class="headerlink" title="åŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘æ§åˆ¶"></a>åŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘æ§åˆ¶</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (demo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (SRC_LIST <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/testFunc/testFunc.c) <span class="comment">#æŠŠsrcè·¯å¾„è®¾ç½®å¥½</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span> (testFunc_shared SHARED <span class="variable">$&#123;SRC_LIST&#125;</span>)  <span class="comment">#ç¬¬1ä¸ªå‚æ•°æŒ‡å®šåº“çš„åå­—ï¼›ç¬¬2ä¸ªå‚æ•°å†³å®šæ˜¯åŠ¨æ€è¿˜æ˜¯é™æ€ï¼Œå¦‚æœæ²¡æœ‰å°±é»˜è®¤é™æ€ï¼›ç¬¬3ä¸ªå‚æ•°æŒ‡å®šç”Ÿæˆåº“çš„æºæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">add_library</span> (testFunc_static STATIC <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set_target_properties</span> (testFunc_shared PROPERTIES OUTPUT_NAME <span class="string">&quot;testFunc&quot;</span>) </span><br><span class="line"><span class="keyword">set_target_properties</span> (testFunc_static PROPERTIES OUTPUT_NAME <span class="string">&quot;testFunc&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (LIBRARY_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/lib)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (demo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (SRC_LIST <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/src/main.c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># find testFunc.h</span></span><br><span class="line"><span class="keyword">include_directories</span> (<span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/testFunc/inc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(TESTFUNC_LIB testFunc HINTS <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/testFunc/lib)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span> (main <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span> (main <span class="variable">$&#123;TESTFUNC_LIB&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>find_library: åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æŒ‡å®šåº“ï¼Œå¹¶æŠŠåº“çš„ç»å¯¹è·¯å¾„å­˜æ”¾åˆ°å˜é‡é‡Œï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å˜é‡åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åº“åç§°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯HINTSï¼Œç¬¬4ä¸ªå‚æ•°æ˜¯è·¯å¾„ï¼Œå…¶å®ƒç”¨æ³•å¯ä»¥å‚è€ƒcmakeæ–‡æ¡£</li><li>target_link_libraries: æŠŠç›®æ ‡æ–‡ä»¶ä¸åº“æ–‡ä»¶è¿›è¡Œé“¾æ¥</li></ul><h2 id="æ¡ä»¶ç¼–è¯‘"><a href="#æ¡ä»¶ç¼–è¯‘" class="headerlink" title="æ¡ä»¶ç¼–è¯‘"></a>æ¡ä»¶ç¼–è¯‘</h2><h3 id="ç®€å•ç¨‹åº"><a href="#ç®€å•ç¨‹åº" class="headerlink" title="ç®€å•ç¨‹åº"></a>ç®€å•ç¨‹åº</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">2.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (demo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_compile_options</span>(-std=c++<span class="number">11</span> -Wall)  <span class="comment">#è¿™å¥è¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(main main.cpp)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç”ŸæˆæŒ‡å®šçš„bin"><a href="#ç”ŸæˆæŒ‡å®šçš„bin" class="headerlink" title="ç”ŸæˆæŒ‡å®šçš„bin"></a>ç”ŸæˆæŒ‡å®šçš„bin</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(demo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span>(MYDEBUG <span class="string">&quot;enable debug compilation&quot;</span> <span class="keyword">OFF</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> (EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_subdirectory</span>(src)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨optionå‘½ä»¤ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æˆ·è‡ªå·±è§„å®šçš„åå­—ï¼Œä¸­é—´æ˜¯æ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œæœ€åä¸€ä¸ªæ˜¯å¼€å…³ï¼Œä¸å†™é»˜è®¤æ˜¯å…³</p><p>ç„¶ååœ¨srcçš„cmakelisté‡Œé¢å°±å¯ä»¥è¯»å–å‘¼å‘¼è‡ªå·±è¾“å…¥çš„åå­—çš„å¼€å…³çŠ¶æ€æ¥å†³å®šï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(main1 main1.c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (MYDEBUG) <span class="comment">#å¦‚æœä¸ºON</span></span><br><span class="line">    <span class="keyword">add_executable</span>(main2 main2.c)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;Currently is not in debug mode&quot;</span>)    </span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CMake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é™æ€åº“/åŠ¨æ€åº“</title>
      <link href="/2025/01/07/%E9%9D%99%E6%80%81%E5%BA%93%E5%8A%A8%E6%80%81%E5%BA%93/"/>
      <url>/2025/01/07/%E9%9D%99%E6%80%81%E5%BA%93%E5%8A%A8%E6%80%81%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="å½¢å¼"><a href="#å½¢å¼" class="headerlink" title="å½¢å¼"></a>å½¢å¼</h2><p>ä¸€èˆ¬æ¥è¯´ï¼ŒWindowsçš„é™æ€åº“æ–‡ä»¶æ‰©å±•åæ˜¯ .libï¼ŒåŠ¨æ€åº“æ–‡ä»¶æ‰©å±•åæ˜¯ .dll (Dynamic-Link Libraries)ï¼›Linuxçš„é™æ€åº“æ‰©å±•åæ˜¯ .aï¼ŒåŠ¨æ€åº“æ‰©å±•åæ˜¯ .so (Shared Object)</p><p>Linuxç³»ç»Ÿå­˜å‚¨çš„åº“çš„ä½ç½®ä¸€èˆ¬åœ¨ï¼š&#x2F;lib å’Œ &#x2F;usr&#x2F;libã€‚ åœ¨ 64 ä½çš„ç³»ç»Ÿä¸Šæœ‰äº›åº“ä¹Ÿå¯èƒ½è¢«å­˜å‚¨åœ¨&#x2F;usr&#x2F;lib64 ä¸‹ã€‚åº“çš„å¤´æ–‡ä»¶ä¸€èˆ¬ä¼šè¢«å­˜å‚¨åœ¨ &#x2F;usr&#x2F;include ä¸‹æˆ–å…¶å­ç›®å½•ä¸‹ã€‚<br>Linuxåº“æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯é™æ€åº“ï¼Œå…¶å‘½ä»¤è§„åˆ™ä¸º libxxx.aï¼›ä¸€ç§æ˜¯å…±äº«åº“ï¼Œå…¶å‘½ä»¤è§„åˆ™ä¸º libxxx.so</p><h2 id="ç”Ÿæˆ"><a href="#ç”Ÿæˆ" class="headerlink" title="ç”Ÿæˆ"></a>ç”Ÿæˆ</h2><h3 id="é™æ€åº“ç”Ÿæˆ"><a href="#é™æ€åº“ç”Ÿæˆ" class="headerlink" title="é™æ€åº“ç”Ÿæˆ"></a>é™æ€åº“ç”Ÿæˆ</h3><h4 id="step1-ç¼–è¯‘ç”Ÿæˆ-oæ–‡ä»¶"><a href="#step1-ç¼–è¯‘ç”Ÿæˆ-oæ–‡ä»¶" class="headerlink" title="step1 ç¼–è¯‘ç”Ÿæˆ.oæ–‡ä»¶"></a>step1 ç¼–è¯‘ç”Ÿæˆ.oæ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -c hello.c</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°†ä¼šç”Ÿæˆä¸€ä¸ªhello.oæ–‡ä»¶ </p><p>-c å’Œå«ä¹‰ï¼šåªç¼–è¯‘ï¼Œä¸é“¾æ¥</p><h4 id="step2-ä½¿ç”¨-oæ–‡ä»¶ç”Ÿæˆ-aé™æ€åº“"><a href="#step2-ä½¿ç”¨-oæ–‡ä»¶ç”Ÿæˆ-aé™æ€åº“" class="headerlink" title="step2 ä½¿ç”¨.oæ–‡ä»¶ç”Ÿæˆ .aé™æ€åº“"></a>step2 ä½¿ç”¨.oæ–‡ä»¶ç”Ÿæˆ .aé™æ€åº“</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ar -crv libhello.a hello.o</span><br></pre></td></tr></table></figure><p>-crvæ˜¯arå‘½ä»¤çš„é€‰é¡¹ï¼šcï¼Œrï¼Œvåˆ†åˆ«ä»£è¡¨crateï¼Œreplaceï¼Œverbose</p><ol><li><strong><code>-c</code> (create)ï¼š</strong><ul><li>è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªæ–°çš„é™æ€åº“æ–‡ä»¶ï¼ˆå³ <code>libhello.a</code>ï¼‰ã€‚</li><li>å¦‚æœåº“æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œ<code>-c</code> ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œæ“ä½œã€‚</li><li>å¦‚æœæ²¡æœ‰æ­¤é€‰é¡¹ï¼Œ<code>ar</code> åœ¨åº“æ–‡ä»¶ä¸å­˜åœ¨æ—¶å¯èƒ½ä¼šæç¤ºé”™è¯¯ã€‚</li></ul></li><li><strong><code>-r</code> (replace)ï¼š</strong><ul><li>å°†ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æ–‡ä»¶ï¼ˆå¦‚ <code>hello.o</code>ï¼‰æ·»åŠ åˆ°é™æ€åº“ä¸­ã€‚</li><li>å¦‚æœé™æ€åº“ä¸­å·²ç»å­˜åœ¨åŒåæ–‡ä»¶ï¼Œåˆ™æ›¿æ¢å®ƒã€‚</li><li>å¦‚æœé™æ€åº“ä¸­ä¸å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œåˆ™ä¼šæ–°å¢è¯¥æ–‡ä»¶ã€‚</li></ul></li><li><strong><code>-v</code> (verbose)ï¼š</strong><ul><li>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚</li><li>åœ¨æ‰§è¡Œæ“ä½œæ—¶ï¼Œä¼šåˆ—å‡ºå…·ä½“å¤„ç†äº†å“ªäº›ç›®æ ‡æ–‡ä»¶ã€‚</li></ul></li></ol><h3 id="åŠ¨æ€åº“ç”Ÿæˆ"><a href="#åŠ¨æ€åº“ç”Ÿæˆ" class="headerlink" title="åŠ¨æ€åº“ç”Ÿæˆ"></a>åŠ¨æ€åº“ç”Ÿæˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC -o libhyhello.so hello.o</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o hello main.c libhyhello.so </span><br></pre></td></tr></table></figure><p><strong><code>-shared</code></strong></p><ul><li>æŒ‡å®šç”Ÿæˆä¸€ä¸ªå…±äº«åº“ï¼ˆåŠ¨æ€åº“ï¼Œ<code>.so</code> æ–‡ä»¶ï¼‰</li><li>å…±äº«åº“æ˜¯è¿è¡Œæ—¶åŠ¨æ€åŠ è½½çš„ï¼Œé€‚ç”¨äºå¤šè¿›ç¨‹å…±äº«ä»£ç ï¼Œå‡å°‘å†…å­˜å ç”¨</li></ul><p><strong><code>-fPIC</code></strong></p><ul><li>ç”Ÿæˆä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Codeï¼‰</li><li><strong>ä½œç”¨ï¼š</strong> å…±äº«åº“åœ¨å†…å­˜ä¸­åŠ è½½åˆ°ä»»ä½•åœ°å€éƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿™å¯¹äºåŠ¨æ€åº“è‡³å…³é‡è¦</li><li><code>hello.o</code> å¿…é¡»æ˜¯é€šè¿‡ <code>-fPIC</code> ç¼–è¯‘ç”Ÿæˆçš„ï¼Œç¡®ä¿ç›®æ ‡ä»£ç æ˜¯ä½ç½®æ— å…³çš„</li></ul><p><strong><code>-o libhyhello.so</code></strong></p><ul><li>æŒ‡å®šè¾“å‡ºæ–‡ä»¶åä¸º <code>libhyhello.so</code>ï¼Œè¿™æ˜¯åŠ¨æ€åº“çš„æ ‡å‡†å‘½åæ ¼å¼</li><li>Linux ç³»ç»Ÿä¸­ï¼ŒåŠ¨æ€åº“é€šå¸¸ä»¥ <code>lib</code> å¼€å¤´ï¼Œæ‰©å±•åä¸º <code>.so</code>ï¼ˆshared objectï¼‰</li></ul><p><strong><code>hello.o</code></strong></p><ul><li>è¾“å…¥æ–‡ä»¶ï¼Œæ˜¯å…ˆå‰ç”¨ <code>gcc</code> ç¼–è¯‘ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶</li></ul><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o hello main.c -L. -lhello</span><br></pre></td></tr></table></figure><p><strong><code>-L.</code></strong></p><ul><li>æŒ‡å®šåº“çš„æœç´¢è·¯å¾„ä¸ºå½“å‰ç›®å½• (<code>.</code>)ã€‚</li><li>é“¾æ¥å™¨åœ¨æŸ¥æ‰¾é™æ€åº“æˆ–åŠ¨æ€åº“æ—¶ï¼Œé™¤äº†é»˜è®¤çš„è·¯å¾„ï¼ˆå¦‚ <code>/usr/lib</code>ã€<code>/usr/local/lib</code>ï¼‰ï¼Œä¹Ÿä¼šåœ¨å½“å‰ç›®å½•ä¸­æŸ¥æ‰¾ã€‚</li><li><strong>ä½œç”¨ï¼š</strong> å¦‚æœé™æ€åº“æ–‡ä»¶ <code>libhello.a</code> æˆ–åŠ¨æ€åº“æ–‡ä»¶ <code>libhello.so</code> ä½äºå½“å‰ç›®å½•ï¼Œè¿™ä¸ªé€‰é¡¹ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿè¢«æ­£ç¡®æ‰¾åˆ°ã€‚</li></ul><p><strong><code>-lhello</code></strong></p><ul><li>è¡¨ç¤ºé“¾æ¥åä¸º <code>hello</code> çš„åº“ã€‚</li><li>å·¥ä½œåŸç†ï¼š<ul><li>é“¾æ¥å™¨ä¼šè‡ªåŠ¨å¯»æ‰¾ä»¥ä¸‹æ–‡ä»¶ï¼š<ul><li>é™æ€åº“ï¼š<code>libhello.a</code></li><li>åŠ¨æ€åº“ï¼š<code>libhello.so</code></li></ul></li><li>æœç´¢è·¯å¾„åŒ…æ‹¬é»˜è®¤è·¯å¾„å’Œé€šè¿‡ <code>-L</code> æŒ‡å®šçš„è·¯å¾„ï¼ˆè¿™é‡Œæ˜¯å½“å‰ç›®å½• <code>.</code>ï¼‰ã€‚</li></ul></li></ul><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc main.c libhyhello.a -o hello</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸‰"><a href="#æ–¹æ³•ä¸‰" class="headerlink" title="æ–¹æ³•ä¸‰"></a>æ–¹æ³•ä¸‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c main.c</span><br><span class="line">gcc -o hello main.o libmyhello.a</span><br></pre></td></tr></table></figure><h2 id="GCCå‘½ä»¤ç›¸åŒæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ-aæ–‡ä»¶ï¼Œè¿˜æ˜¯ä¼šå…ˆæ‰§è¡Œ-soæ–‡ä»¶ï¼Ÿ"><a href="#GCCå‘½ä»¤ç›¸åŒæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ-aæ–‡ä»¶ï¼Œè¿˜æ˜¯ä¼šå…ˆæ‰§è¡Œ-soæ–‡ä»¶ï¼Ÿ" class="headerlink" title="GCCå‘½ä»¤ç›¸åŒæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ.aæ–‡ä»¶ï¼Œè¿˜æ˜¯ä¼šå…ˆæ‰§è¡Œ.soæ–‡ä»¶ï¼Ÿ"></a>GCCå‘½ä»¤ç›¸åŒæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ.aæ–‡ä»¶ï¼Œè¿˜æ˜¯ä¼šå…ˆæ‰§è¡Œ.soæ–‡ä»¶ï¼Ÿ</h2><p>å…ˆåˆ é™¤é™¤.cå’Œ.hæ–‡ä»¶å¤–çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åå†ç¼–è¯‘å½¢æˆ.oæ–‡ä»¶ï¼Œç”Ÿæˆ.oæ–‡ä»¶åï¼Œå†ç”±.oæ–‡ä»¶åˆ†åˆ«ç”Ÿæˆ.aæ–‡ä»¶å’Œ.soæ–‡ä»¶ã€‚<br>æ‰§è¡Œç¨‹åºåï¼Œå‘ç°å½“é™æ€åº“å’ŒåŠ¨æ€åº“åŒåæ—¶ï¼Œgcc å‘½ä»¤å°†ä¼˜å…ˆä½¿ç”¨åŠ¨æ€åº“ï¼Œé»˜è®¤å»è¿&#x2F;usr&#x2F;lib å’Œ&#x2F;lib ç­‰ç›®å½•ä¸­çš„åŠ¨æ€åº“ã€‚</p><h2 id="é™æ€åº“ä¸åŠ¨æ€åº“çš„åŒºåˆ«"><a href="#é™æ€åº“ä¸åŠ¨æ€åº“çš„åŒºåˆ«" class="headerlink" title="é™æ€åº“ä¸åŠ¨æ€åº“çš„åŒºåˆ«"></a>é™æ€åº“ä¸åŠ¨æ€åº“çš„åŒºåˆ«</h2><p>æ¯ä¸€ä¸ªç¨‹åºåœ¨ä½¿ç”¨é™æ€åº“æ—¶ï¼Œéƒ½ä¼šå°†é™æ€åº“æ–‡ä»¶æ‹·è´ä¸€ä»½æ·»åŠ åˆ°è‡ªèº«ã€‚å¦‚æœæœ‰å¤šä¸ªç¨‹åºéƒ½è¦ä½¿ç”¨è¯¥é™æ€åº“æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šç»™è‡ªèº«æ·»åŠ ä¸€ä»½æ‹·è´ï¼Œè¿™å°±å¯¼è‡´ä¼šäº§ç”Ÿç©ºé—´æµªè´¹ã€‚åœ¨æºæ–‡ä»¶è¾ƒå°‘æ—¶ä¸æ˜æ˜¾ï¼Œä½†å¦‚æœåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œé™æ€åº“æ–‡ä»¶æœ¬èº«å°±æ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”ä½¿ç”¨è¯¥é™æ€åº“æ–‡ä»¶çš„æºç¨‹åºå¾ˆå¤šï¼Œè¿™å°±ä¼šé€ æˆå¤§é‡å†…å­˜æµªè´¹ã€‚<br>è€ŒåŠ¨æ€åº“æ–‡ä»¶åœ¨è¢«ä½¿ç”¨æ—¶ï¼Œä¼šå¯¹æ‰€æœ‰æƒ³ä½¿ç”¨è¯¥åŠ¨æ€åº“çš„æºç¨‹åºæ·»åŠ ä¸€ä¸ªæ ‡è®°ï¼Œåœ¨ç¨‹åºæ‰§è¡Œæ—¶å†é“¾æ¥åŠ¨æ€åº“æ–‡ä»¶ä½¿ç”¨ã€‚è¿™å°±æ˜¯åŠ¨æ€åº“çš„ä¼˜ç‚¹ï¼Œä¹Ÿæ˜¯åŠ¨æ€åº“è¢«ç§°ä¸ºå…±äº«åº“çš„åŸå› ã€‚</p><p>å‚è€ƒèµ„æ–™<a href="https://blog.csdn.net/weixin_43717839/article/details/127991174?spm=1001.2014.3001.5502">ã€C++ã€‘é™æ€åº“å’ŒåŠ¨æ€åº“æ–‡ä»¶çš„ç”Ÿæˆå’Œä½¿ç”¨_c++ .aæ–‡ä»¶-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CMake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºç¡€è¯­æ³•</title>
      <link href="/2024/12/04/C++_%E5%85%A5%E9%97%A8/"/>
      <url>/2024/12/04/C++_%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="1-åŸºç¡€è¯­æ³•"><a href="#1-åŸºç¡€è¯­æ³•" class="headerlink" title="1. åŸºç¡€è¯­æ³•"></a><strong>1. åŸºç¡€è¯­æ³•</strong></h2><h3 id="1-1-å¼•ç”¨è¿ç®—-å’Œ-const-å…³é”®å­—"><a href="#1-1-å¼•ç”¨è¿ç®—-å’Œ-const-å…³é”®å­—" class="headerlink" title="1.1 å¼•ç”¨è¿ç®— &amp; å’Œ const å…³é”®å­—"></a><strong>1.1 å¼•ç”¨è¿ç®— <code>&amp;</code> å’Œ <code>const</code> å…³é”®å­—</strong></h3><h4 id="å¼•ç”¨è¿ç®—"><a href="#å¼•ç”¨è¿ç®—" class="headerlink" title="å¼•ç”¨è¿ç®— &amp;"></a><strong>å¼•ç”¨è¿ç®— <code>&amp;</code></strong></h4><p>å¼•ç”¨æ˜¯å·²æœ‰å˜é‡çš„åˆ«åï¼Œåˆ›å»ºå¼•ç”¨æ—¶ä¸ä¼šåˆ†é…æ–°å†…å­˜ï¼Œè€Œæ˜¯ç›´æ¥æ“ä½œåŸå˜é‡ã€‚<br><strong>å¼•ç”¨çš„ç‰¹æ€§ï¼š</strong></p><ol><li>å¿…é¡»åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ã€‚</li><li>ä¸€æ—¦åˆå§‹åŒ–ï¼Œå°±å’ŒåŸå˜é‡ç»‘å®šï¼Œä¸èƒ½é‡æ–°ç»‘å®šã€‚</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> &amp;ref = a; <span class="comment">// ref æ˜¯ a çš„å¼•ç”¨</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, ref = &quot;</span> &lt;&lt; ref &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    ref = <span class="number">20</span>; <span class="comment">// ä¿®æ”¹ refï¼Œç›¸å½“äºä¿®æ”¹ a</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;After modifying ref: a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, ref = &quot;</span> &lt;&lt; ref &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = 10, ref = 10</span><br><span class="line">After modifying ref: a = 20, ref = 20</span><br></pre></td></tr></table></figure><h5 id="å¸¸è§åº”ç”¨ï¼š"><a href="#å¸¸è§åº”ç”¨ï¼š" class="headerlink" title="å¸¸è§åº”ç”¨ï¼š"></a><strong>å¸¸è§åº”ç”¨ï¼š</strong></h5><ol><li><strong>å‡½æ•°ä¼ å‚ï¼š</strong> å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°å¯ä»¥é¿å…å€¼ä¼ é€’æ—¶çš„æ‹·è´ï¼Œæé«˜æ•ˆç‡ã€‚</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">increment</span><span class="params">(<span class="type">int</span> &amp;n)</span> </span>&#123;</span><br><span class="line">    n++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">increment</span>(x);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;x = &quot;</span> &lt;&lt; x &lt;&lt; endl; <span class="comment">// è¾“å‡º x = 6</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><strong>å¼•ç”¨è¿”å›å€¼ï¼š</strong> å¼•ç”¨å¯ä»¥ä½œä¸ºå‡½æ•°è¿”å›å€¼ï¼Œå…è®¸å‡½æ•°è¿”å›åŸå§‹å˜é‡çš„å¼•ç”¨ã€‚</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span>&amp; <span class="title">getReference</span><span class="params">(<span class="type">int</span> &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x; <span class="comment">// è¿”å›å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> &amp;ref = <span class="built_in">getReference</span>(a); </span><br><span class="line">    ref = <span class="number">20</span>; <span class="comment">// ä¿®æ”¹å¼•ç”¨ï¼Œå½±å“åŸå˜é‡</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; endl; <span class="comment">// è¾“å‡º a = 20</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="const-å…³é”®å­—"><a href="#const-å…³é”®å­—" class="headerlink" title="const å…³é”®å­—"></a><strong><code>const</code> å…³é”®å­—</strong></h4><p><code>const</code>å¯ä»¥ä¿®é¥°å˜é‡ã€å‡½æ•°å‚æ•°ã€æˆå‘˜å‡½æ•°ç­‰ï¼Œè¡¨ç¤ºä¸å¯ä¿®æ”¹çš„å±æ€§ã€‚</p><p><strong>ä¿®é¥°å˜é‡ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> x = <span class="number">10</span>; <span class="comment">// x æ˜¯å¸¸é‡</span></span><br><span class="line">x = <span class="number">20</span>;           <span class="comment">// é”™è¯¯ï¼šx ä¸èƒ½è¢«ä¿®æ”¹</span></span><br></pre></td></tr></table></figure><p><strong>ä¿®é¥°å‡½æ•°å‚æ•°ï¼š</strong> ç”¨<code>const</code>ä¿®é¥°å‡½æ•°å‚æ•°ï¼Œå¯ä»¥é˜²æ­¢å‡½æ•°ä¿®æ”¹ä¼ å…¥çš„å€¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// n æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ä¿®æ”¹</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;n = &quot;</span> &lt;&lt; n &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºç±»å¯¹è±¡æˆ–ç»“æ„ä½“ï¼Œé€šè¿‡å¼•ç”¨ä¼ é€’é¿å…æ‹·è´å¼€é”€ï¼ŒåŒæ—¶ç”¨ <code>const</code> ç¡®ä¿ä¸ä¼šä¿®æ”¹å†…å®¹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> <span class="type">const</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;MyClass display&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showObject</span><span class="params">(<span class="type">const</span> MyClass &amp;obj)</span> </span>&#123;</span><br><span class="line">    obj.<span class="built_in">display</span>(); <span class="comment">// å¯ä»¥è°ƒç”¨ const æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// obj.modify(); // é”™è¯¯ï¼šobj æ˜¯ constï¼Œä¸èƒ½è°ƒç”¨èƒ½ä¿®æ”¹å†…å®¹çš„æ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¿®é¥°æŒ‡é’ˆï¼š</strong></p><ul><li>æŒ‡é’ˆæœ¬èº«ä¸å¯ä¿®æ”¹ï¼š<code>int *const ptr;</code></li><li>æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä¿®æ”¹ï¼š<code>const int *ptr;</code></li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cppå¤åˆ¶ä»£ç <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> a = <span class="number">10</span>;        <span class="comment">// a æ˜¯å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> *ptr = &amp;a;     <span class="comment">// æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">int</span> b = <span class="number">20</span>;</span><br><span class="line">    <span class="type">int</span> *<span class="type">const</span> constPtr = &amp;b; <span class="comment">// å¸¸é‡æŒ‡é’ˆï¼Œåœ°å€ä¸èƒ½ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="1-2-å†…è”å‡½æ•°"><a href="#1-2-å†…è”å‡½æ•°" class="headerlink" title="1.2 å†…è”å‡½æ•°"></a><strong>1.2 å†…è”å‡½æ•°</strong></h3><p>ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå†…è”å‡½æ•°ç±»ä¼¼äºå®å®šä¹‰</p><h4 id="å†…è”å‡½æ•°çš„å®šä¹‰ï¼š"><a href="#å†…è”å‡½æ•°çš„å®šä¹‰ï¼š" class="headerlink" title="å†…è”å‡½æ•°çš„å®šä¹‰ï¼š"></a><strong>å†…è”å‡½æ•°çš„å®šä¹‰ï¼š</strong></h4><p>å†…è”å‡½æ•°æ˜¯é€šè¿‡ <code>inline</code> å…³é”®å­—å£°æ˜çš„å‡½æ•°ï¼Œç›®çš„æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å°½å¯èƒ½å°†è¯¥å‡½æ•°çš„ä»£ç æ’å…¥åˆ°å‡½æ•°è°ƒç”¨çš„ä½ç½®ï¼Œè€Œä¸æ˜¯é€šè¿‡æ­£å¸¸çš„å‡½æ•°è°ƒç”¨æœºåˆ¶ï¼ˆå¦‚æ ˆæ“ä½œï¼‰æ¥æ‰§è¡Œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå‡½æ•°è°ƒç”¨çš„å¼€é”€å¯ä»¥è¢«æ¶ˆé™¤ï¼Œä»è€Œæé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚</p><h4 id="å†…è”å‡½æ•°çš„ä¼˜ç‚¹ï¼š"><a href="#å†…è”å‡½æ•°çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="å†…è”å‡½æ•°çš„ä¼˜ç‚¹ï¼š"></a><strong>å†…è”å‡½æ•°çš„ä¼˜ç‚¹ï¼š</strong></h4><ol><li><strong>é¿å…å‡½æ•°è°ƒç”¨å¼€é”€</strong><br>æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½æ¶‰åŠä¸€äº›å¼€é”€ï¼ŒåŒ…æ‹¬å‚æ•°ä¼ é€’ã€æ ˆå¸§çš„åˆ›å»ºå’Œé”€æ¯ã€å‡½æ•°è¿”å›ç­‰ã€‚å¯¹äºéå¸¸ç®€å•çš„å‡½æ•°ï¼ˆå¦‚å¸¸è§çš„æ•°å­¦è®¡ç®—ã€è·å–å±æ€§å€¼ç­‰ï¼‰ï¼Œæ¯æ¬¡è°ƒç”¨è¿™äº›å°å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥ç›´æ¥å°†å‡½æ•°ä½“åµŒå…¥åˆ°è°ƒç”¨å¤„ï¼Œæ¶ˆé™¤è¿™äº›å¼€é”€ã€‚</li><li><strong>å¢å¼ºä»£ç æ•ˆç‡ï¼Œé€‚åˆé¢‘ç¹è°ƒç”¨çš„å°å‡½æ•°</strong><br>å†…è”å‡½æ•°å°¤å…¶é€‚ç”¨äºé‚£äº›é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„æ—¶é—´å¼€é”€ã€‚å½“ä¸€ä¸ªå°å‡½æ•°è¢«å¤§é‡è°ƒç”¨æ—¶ï¼Œå†…è”å¯ä»¥æ˜¾è‘—æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œä¸€äº›ç®€å•çš„ getterã€setter å‡½æ•°ã€æ•°å€¼è®¡ç®—å‡½æ•°ç­‰ï¼Œå†…è”å¤„ç†åèƒ½æ˜¾è‘—ä¼˜åŒ–æ€§èƒ½ã€‚</li><li><strong>å‡å°‘å‡½æ•°è°ƒç”¨æ ˆå¼€é”€</strong><br>ä¼ ç»Ÿå‡½æ•°è°ƒç”¨éœ€è¦ç»´æŠ¤è°ƒç”¨æ ˆï¼Œè€Œå†…è”å‡½æ•°çš„å±•å¼€ç›´æ¥å°†ä»£ç åµŒå…¥è°ƒç”¨å¤„ï¼Œé¿å…äº†æ ˆçš„åˆ›å»ºå’Œé”€æ¯è¿‡ç¨‹ï¼Œä»è€Œå‡å°‘äº†å†…å­˜å’Œå¤„ç†å™¨çš„è´Ÿæ‹…ã€‚</li></ol><h4 id="å†…è”å‡½æ•°çš„è¯­æ³•ï¼š"><a href="#å†…è”å‡½æ•°çš„è¯­æ³•ï¼š" class="headerlink" title="å†…è”å‡½æ•°çš„è¯­æ³•ï¼š"></a><strong>å†…è”å‡½æ•°çš„è¯­æ³•ï¼š</strong></h4><p>å†…è”å‡½æ•°çš„è¯­æ³•ä¸æ™®é€šå‡½æ•°å”¯ä¸€çš„åŒºåˆ«æ˜¯åœ¨å‡½æ•°å‰åŠ ä¸Š <code>inline</code> å…³é”®å­—ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">square</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Square of 5: &quot;</span> &lt;&lt; <span class="built_in">square</span>(<span class="number">5</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>square</code> å‡½æ•°è¢«å£°æ˜ä¸ºå†…è”å‡½æ•°ã€‚<code>inline</code> å…³é”®å­—å‘Šè¯‰ç¼–è¯‘å™¨å°½å¯èƒ½å°†è¿™ä¸ªå‡½æ•°çš„ä»£ç ç›´æ¥æ’å…¥åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹ã€‚</li><li>å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œç¼–è¯‘å™¨ä¼šå°† <code>square(5)</code> æ›¿æ¢ä¸º <code>5 * 5</code>ï¼Œé¿å…äº†è°ƒç”¨å‡½æ•°çš„ä¼ ç»Ÿå¼€é”€ã€‚</li></ul><h4 id="å†…è”å‡½æ•°çš„ä½¿ç”¨åœºæ™¯ï¼š"><a href="#å†…è”å‡½æ•°çš„ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="å†…è”å‡½æ•°çš„ä½¿ç”¨åœºæ™¯ï¼š"></a><strong>å†…è”å‡½æ•°çš„ä½¿ç”¨åœºæ™¯ï¼š</strong></h4><p>å†…è”å‡½æ•°æœ€é€‚åˆç”¨äºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ol><li><strong>ç®€å•å‡½æ•°</strong>ï¼šå†…è”å‡½æ•°æœ€é€‚åˆé‚£äº›è®¡ç®—é‡å°ã€é€»è¾‘ç®€å•çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå•çº¯çš„æ•°å­¦è¿ç®—ã€è·å–å’Œè®¾ç½®å˜é‡å€¼ç­‰ã€‚å†…è”ä¸ä¼šå¯¹å¤§å‹ã€å¤æ‚çš„å‡½æ•°æœ‰æ˜¾è‘—çš„ä¼˜åŒ–æ•ˆæœã€‚</li><li><strong>é¢‘ç¹è°ƒç”¨çš„å‡½æ•°</strong>ï¼šå¯¹äºéœ€è¦é¢‘ç¹è°ƒç”¨çš„çŸ­å°å‡½æ•°ï¼Œå†…è”å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„æ—¶é—´å’Œå¼€é”€ï¼Œå°¤å…¶æ˜¯åœ¨åµŒå¥—è°ƒç”¨å’Œå¾ªç¯ä¸­è°ƒç”¨çš„å‡½æ•°ã€‚</li><li><strong>ä¸æ¶‰åŠé€’å½’</strong>ï¼šå†…è”å‡½æ•°ä¸é€‚åˆé€’å½’å‡½æ•°ï¼Œå› ä¸ºé€’å½’çš„æ¯ä¸€æ¬¡è°ƒç”¨éƒ½æ¶‰åŠåˆ°ä¸åŒçš„æ ˆå¸§å’Œå‚æ•°ï¼Œå› æ­¤é€’å½’çš„å†…è”å±•å¼€ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</li><li><strong>é¿å…å¤§é‡æ ˆæ“ä½œçš„å‡½æ•°</strong>ï¼šå¦‚æœä¸€ä¸ªå‡½æ•°æ²¡æœ‰å¤ªå¤šçš„å±€éƒ¨å˜é‡ï¼Œä¹Ÿæ²¡æœ‰å¤æ‚çš„é€»è¾‘ï¼Œä½¿ç”¨å†…è”å¯ä»¥é¿å…å‡½æ•°è°ƒç”¨æ—¶äº§ç”Ÿçš„æ ˆå¼€é”€ã€‚</li></ol><h4 id="å†…è”å‡½æ•°çš„é™åˆ¶ï¼š"><a href="#å†…è”å‡½æ•°çš„é™åˆ¶ï¼š" class="headerlink" title="å†…è”å‡½æ•°çš„é™åˆ¶ï¼š"></a><strong>å†…è”å‡½æ•°çš„é™åˆ¶ï¼š</strong></h4><ol><li><strong>ä¸åŒç¼–è¯‘å™¨æ ‡å‡†ä¸åŒ</strong><br>é€šè¿‡ <code>inline</code> å…³é”®å­—å£°æ˜å‡½æ•°å¹¶ä¸æ„å‘³ç€ç¼–è¯‘å™¨ä¸€å®šä¼šå°†å…¶å†…è”å±•å¼€ã€‚ç¼–è¯‘å™¨å¯èƒ½ä¼šåŸºäºå‡½æ•°çš„å¤æ‚æ€§ã€è°ƒç”¨é¢‘ç‡ã€ä¼˜åŒ–ç›®æ ‡ç­‰å› ç´ å†³å®šæ˜¯å¦è¿›è¡Œå†…è”å±•å¼€ã€‚å› æ­¤ï¼Œå†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œéå¼ºåˆ¶è¦æ±‚ã€‚</li><li><strong>å¤æ‚å‡½æ•°ä¸é€‚åˆå†…è”</strong><br>å†…è”å‡½æ•°é€‚ç”¨äºç®€å•çš„ã€è®¡ç®—é‡å°çš„å‡½æ•°ã€‚å¯¹äºé€»è¾‘å¤æ‚ã€ä½“ç§¯è¾ƒå¤§çš„å‡½æ•°ï¼Œå†…è”å¯èƒ½å¯¼è‡´ä»£ç è†¨èƒ€ï¼Œä½¿å¾—ä»£ç å˜å¾—å†—é•¿ã€å ç”¨æ›´å¤šå†…å­˜ï¼Œç”šè‡³å¯èƒ½å¼•å‘æ€§èƒ½ä¸‹é™ã€‚</li><li><strong>é€’å½’å‡½æ•°ä¸åº”å†…è”</strong><br>é€’å½’å‡½æ•°æ˜¯ä¸èƒ½å†…è”çš„ï¼Œå› ä¸ºæ¯æ¬¡é€’å½’éƒ½ä¼šåˆ›å»ºæ–°çš„æ ˆå¸§ï¼Œè€Œå†…è”å‡½æ•°çš„ç›®çš„æ˜¯å‡å°‘æ ˆå¼€é”€ã€‚é€’å½’å±•å¼€ä¼šå¯¼è‡´æ ˆå¸§æ— æ³•å…±äº«ï¼Œè¿›è€Œæ¶ˆé™¤å†…è”çš„ä¼˜åŠ¿ã€‚</li></ol><h4 id="ç¼–è¯‘å™¨å¦‚ä½•å†³å®šå†…è”å±•å¼€ï¼š"><a href="#ç¼–è¯‘å™¨å¦‚ä½•å†³å®šå†…è”å±•å¼€ï¼š" class="headerlink" title="ç¼–è¯‘å™¨å¦‚ä½•å†³å®šå†…è”å±•å¼€ï¼š"></a><strong>ç¼–è¯‘å™¨å¦‚ä½•å†³å®šå†…è”å±•å¼€ï¼š</strong></h4><ul><li>å¯¹äºå°å‡½æ•°ï¼Œç¼–è¯‘å™¨é€šå¸¸ä¼šè‡ªåŠ¨è¿›è¡Œå†…è”ä¼˜åŒ–ï¼Œå³ä½¿æ²¡æœ‰æ˜¾å¼å£°æ˜ <code>inline</code>ã€‚</li><li>å¯¹äºè¾ƒå¤§çš„å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¸€èˆ¬ä¸ä¼šå†…è”ï¼Œå› ä¸ºå†…è”ä¼šå¯¼è‡´ä»£ç è†¨èƒ€ï¼Œå¢åŠ  CPU ç¼“å­˜çš„å‹åŠ›ï¼Œåè€Œå¯èƒ½å¸¦æ¥æ€§èƒ½ä¸‹é™ã€‚</li><li>ç¼–è¯‘å™¨è¿˜å¯èƒ½æ ¹æ®ä¸€äº›ç¼–è¯‘é€‰é¡¹ã€ä¼˜åŒ–çº§åˆ«ç­‰å†³å®šæ˜¯å¦å†…è”ã€‚</li></ul><h4 id="å†…è”ä¸å®çš„æ¯”è¾ƒï¼š"><a href="#å†…è”ä¸å®çš„æ¯”è¾ƒï¼š" class="headerlink" title="å†…è”ä¸å®çš„æ¯”è¾ƒï¼š"></a><strong>å†…è”ä¸å®çš„æ¯”è¾ƒï¼š</strong></h4><p>å†…è”å‡½æ•°æœ‰æ—¶å¯ä»¥æ›¿ä»£å®ï¼ˆ<code>#define</code>ï¼‰æ¥è¿›è¡Œå¸¸è§çš„è®¡ç®—ï¼Œä½†å®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›é‡è¦åŒºåˆ«ï¼š</p><ul><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå†…è”å‡½æ•°æ˜¯å¼ºç±»å‹çš„ï¼Œå®æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œå®¹æ˜“å¼•å‘éšå¼ç±»å‹è½¬æ¢é”™è¯¯ã€‚</li><li><strong>è°ƒè¯•å‹å¥½</strong>ï¼šå†…è”å‡½æ•°å¯ä»¥è¢«è°ƒè¯•å™¨è¿½è¸ªï¼Œè€Œå®æ— æ³•å•æ­¥è°ƒè¯•ã€‚</li><li><strong>ä½œç”¨åŸŸ</strong>ï¼šå†…è”å‡½æ•°éµå¾ªæ­£å¸¸çš„ä½œç”¨åŸŸè§„åˆ™ï¼Œè€Œå®åœ¨é¢„å¤„ç†é˜¶æ®µè¿›è¡Œæ›¿æ¢ï¼Œå¯èƒ½å¼•å‘ä½œç”¨åŸŸé—®é¢˜ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SQUARE(x) ((x) * (x)) <span class="comment">// å®</span></span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">square</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x * x; &#125; <span class="comment">// å†…è”å‡½æ•°</span></span><br></pre></td></tr></table></figure><p>å†…è”å‡½æ•°ç›¸è¾ƒäºå®æœ‰æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œæ›´å¥½çš„å¯ç»´æŠ¤æ€§ã€‚</p><hr><h3 id="1-3-å‡½æ•°å‚æ•°ç¼ºçœå€¼"><a href="#1-3-å‡½æ•°å‚æ•°ç¼ºçœå€¼" class="headerlink" title="1.3 å‡½æ•°å‚æ•°ç¼ºçœå€¼"></a><strong>1.3 å‡½æ•°å‚æ•°ç¼ºçœå€¼</strong></h3><h4 id="ç¼ºçœå‚æ•°çš„è§„åˆ™ï¼š"><a href="#ç¼ºçœå‚æ•°çš„è§„åˆ™ï¼š" class="headerlink" title="ç¼ºçœå‚æ•°çš„è§„åˆ™ï¼š"></a><strong>ç¼ºçœå‚æ•°çš„è§„åˆ™ï¼š</strong></h4><ol><li>ç¼ºçœå€¼ä»å³å‘å·¦å®šä¹‰ã€‚(ä¸èƒ½ä¸¤è¾¹æœ‰ç¼ºçœå€¼ï¼Œä¸­é—´å¤¹ç€ä¸€ä¸ªæ­£å¸¸çš„)</li><li>è°ƒç”¨æ—¶å¯ä»¥çœç•¥æœ‰ç¼ºçœå€¼çš„å‚æ•°ã€‚</li></ol><h4 id="ä»£ç ç¤ºä¾‹ï¼š"><a href="#ä»£ç ç¤ºä¾‹ï¼š" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">greet</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name = <span class="string">&quot;Guest&quot;</span>, <span class="type">int</span> age = <span class="number">18</span>)</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Hello, &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;! Age: &quot;</span> &lt;&lt; age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">greet</span>();                 <span class="comment">// ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">    <span class="built_in">greet</span>(<span class="string">&quot;Alice&quot;</span>);          <span class="comment">// è¦†ç›–ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="built_in">greet</span>(<span class="string">&quot;Bob&quot;</span>, <span class="number">25</span>);        <span class="comment">// è¦†ç›–æ‰€æœ‰å‚æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello, Guest! Age: <span class="number">18</span></span><br><span class="line">Hello, Alice! Age: <span class="number">18</span></span><br><span class="line">Hello, Bob! Age: <span class="number">25</span></span><br></pre></td></tr></table></figure><hr><h3 id="1-4-è¾“å…¥è¾“å‡º"><a href="#1-4-è¾“å…¥è¾“å‡º" class="headerlink" title="1.4 è¾“å…¥è¾“å‡º"></a><strong>1.4 è¾“å…¥è¾“å‡º</strong></h3><h4 id="æ ‡å‡†è¾“å…¥è¾“å‡ºï¼š"><a href="#æ ‡å‡†è¾“å…¥è¾“å‡ºï¼š" class="headerlink" title="æ ‡å‡†è¾“å…¥è¾“å‡ºï¼š"></a><strong>æ ‡å‡†è¾“å…¥è¾“å‡ºï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cppå¤åˆ¶ä»£ç <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Enter a number: &quot;</span>;</span><br><span class="line">    cin &gt;&gt; num;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; num &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>cin</code> ä»é”®ç›˜è¾“å…¥ã€‚</li><li><code>cout</code> è¾“å‡ºåˆ°å±å¹•ã€‚</li></ul><h4 id="æ ¼å¼åŒ–è¾“å‡ºï¼š"><a href="#æ ¼å¼åŒ–è¾“å‡ºï¼š" class="headerlink" title="æ ¼å¼åŒ–è¾“å‡ºï¼š"></a><strong>æ ¼å¼åŒ–è¾“å‡ºï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line">cout &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">2</span>) &lt;&lt; fixed &lt;&lt; <span class="number">3.14159</span>; <span class="comment">// è¾“å‡º 3.14</span></span><br></pre></td></tr></table></figure><hr><h4 id="äºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™"></a><strong>äºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™</strong></h4><h5 id="å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼š"><a href="#å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼š" class="headerlink" title="å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼š"></a><strong>å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</strong></h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">50</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Data d = &#123;<span class="number">1</span>, <span class="string">&quot;Alice&quot;</span>&#125;;</span><br><span class="line">    <span class="function">ofstream <span class="title">outFile</span><span class="params">(<span class="string">&quot;data.bin&quot;</span>, ios::binary)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (outFile) &#123;</span><br><span class="line">        outFile.<span class="built_in">write</span>((<span class="type">char</span> *)&amp;d, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    &#125;</span><br><span class="line">    outFile.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼š"><a href="#è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼š" class="headerlink" title="è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼š"></a><strong>è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</strong></h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ifstream <span class="title">inFile</span><span class="params">(<span class="string">&quot;data.bin&quot;</span>, ios::binary)</span></span>;</span><br><span class="line">Data d;</span><br><span class="line"><span class="keyword">if</span> (inFile) &#123;</span><br><span class="line">    inFile.<span class="built_in">read</span>((<span class="type">char</span> *)&amp;d, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;ID: &quot;</span> &lt;&lt; d.id &lt;&lt; <span class="string">&quot;, Name: &quot;</span> &lt;&lt; d.name &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">inFile.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure><hr><h3 id="1-5-å¼‚å¸¸å¤„ç†"><a href="#1-5-å¼‚å¸¸å¤„ç†" class="headerlink" title="1.5 å¼‚å¸¸å¤„ç†"></a><strong>1.5 å¼‚å¸¸å¤„ç†</strong></h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250105145816419.png" alt="image-20250105145816419"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20250105145901566.png" alt="image-20250105145901566"></p><h4 id="å¼‚å¸¸çš„åŸºæœ¬ç»“æ„ï¼š"><a href="#å¼‚å¸¸çš„åŸºæœ¬ç»“æ„ï¼š" class="headerlink" title="å¼‚å¸¸çš„åŸºæœ¬ç»“æ„ï¼š"></a><strong>å¼‚å¸¸çš„åŸºæœ¬ç»“æ„ï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdexcept&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">runtime_error</span>(<span class="string">&quot;Division by zero!&quot;</span>);</span><br><span class="line">    &#125; <span class="built_in">catch</span> (<span class="type">const</span> runtime_error &amp;e) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Caught exception: &quot;</span> &lt;&lt; e.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caught exception: Division by zero!</span><br></pre></td></tr></table></figure><h4 id="å¸¸è§å¼‚å¸¸ç±»å‹ï¼š"><a href="#å¸¸è§å¼‚å¸¸ç±»å‹ï¼š" class="headerlink" title="å¸¸è§å¼‚å¸¸ç±»å‹ï¼š"></a><strong>å¸¸è§å¼‚å¸¸ç±»å‹ï¼š</strong></h4><ul><li><code>std::exception</code>ï¼šæ‰€æœ‰å¼‚å¸¸çš„åŸºç±»ã€‚</li><li><code>std::runtime_error</code>ï¼šè¿è¡Œæ—¶é”™è¯¯ã€‚</li><li><code>std::invalid_argument</code>ï¼šæ— æ•ˆå‚æ•°ã€‚</li></ul><h2 id="2-ç±»ä¸å¯¹è±¡"><a href="#2-ç±»ä¸å¯¹è±¡" class="headerlink" title="2. ç±»ä¸å¯¹è±¡"></a><strong>2. ç±»ä¸å¯¹è±¡</strong></h2><h3 id="2-1-æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€ææ„å‡½æ•°"><a href="#2-1-æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€ææ„å‡½æ•°" class="headerlink" title="2.1 æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€ææ„å‡½æ•°"></a><strong>2.1 æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€ææ„å‡½æ•°</strong></h3><h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a><strong>æ„é€ å‡½æ•°</strong></h4><p>æ„é€ å‡½æ•°æ˜¯ç±»çš„ç‰¹æ®Šå‡½æ•°ï¼Œåœ¨å¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡ã€‚<br><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>åå­—ä¸ç±»åç›¸åŒï¼Œæ— è¿”å›å€¼ã€‚</li><li>å¯ä»¥é‡è½½ï¼ˆæ”¯æŒå¤šä¸ªæ„é€ å‡½æ•°ï¼‰ã€‚</li></ol><p><strong>è¯­æ³•ä¸ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) &#123;</span><br><span class="line">        value = v;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Constructor called, value = &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">obj1</span><span class="params">(<span class="number">10</span>)</span></span>; <span class="comment">// è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">    obj<span class="number">1.</span><span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Constructor called, value = <span class="number">10</span></span><br><span class="line">Value: <span class="number">10</span></span><br></pre></td></tr></table></figure><hr><h4 id="å¤åˆ¶æ„é€ å‡½æ•°"><a href="#å¤åˆ¶æ„é€ å‡½æ•°" class="headerlink" title="å¤åˆ¶æ„é€ å‡½æ•°"></a><strong>å¤åˆ¶æ„é€ å‡½æ•°</strong></h4><p>å¤åˆ¶æ„é€ å‡½æ•°ç”¨äºé€šè¿‡å·²æœ‰å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ã€‚<br><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ClassName</span>(<span class="type">const</span> ClassName &amp;obj);</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">const</span> MyClass &amp;obj) &#123;</span><br><span class="line">        value = obj.value;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Copy constructor called!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">obj1</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    MyClass obj2 = obj1; <span class="comment">// è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    obj<span class="number">2.</span><span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Copy constructor called!</span><br><span class="line">Value: <span class="number">10</span></span><br></pre></td></tr></table></figure><hr><h4 id="ææ„å‡½æ•°"><a href="#ææ„å‡½æ•°" class="headerlink" title="ææ„å‡½æ•°"></a><strong>ææ„å‡½æ•°</strong></h4><p>ææ„å‡½æ•°ç”¨äºé‡Šæ”¾å¯¹è±¡é”€æ¯æ—¶å ç”¨çš„èµ„æºã€‚<br><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>åå­—ä¸ºç±»åå‰åŠ  <code>~</code>ã€‚</li><li>æ— å‚æ•°ã€æ— è¿”å›å€¼ã€‚</li><li>ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªææ„å‡½æ•°ï¼Œ<strong>ä¸èƒ½é‡è½½</strong>ã€‚</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Constructor called!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">MyClass</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Destructor called!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MyClass obj;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Inside main function.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// ç¨‹åºç»“æŸï¼Œè°ƒç”¨ææ„å‡½æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Constructor called!</span><br><span class="line">Inside main function.</span><br><span class="line">Destructor called!</span><br></pre></td></tr></table></figure><hr><h3 id="2-2-this-æŒ‡é’ˆ"><a href="#2-2-this-æŒ‡é’ˆ" class="headerlink" title="2.2 this æŒ‡é’ˆ"></a><strong>2.2 <code>this</code> æŒ‡é’ˆ</strong></h3><p><code>this</code> æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘è°ƒç”¨æˆå‘˜å‡½æ•°çš„å½“å‰å¯¹è±¡ã€‚å¸¸ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ol><li>åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡åŒåçš„æƒ…å†µã€‚</li><li>åœ¨é“¾å¼è°ƒç”¨ä¸­è¿”å›å½“å‰å¯¹è±¡çš„å¼•ç”¨ã€‚</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> value) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;value = value; <span class="comment">// ä½¿ç”¨ this æŒ‡é’ˆåŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">MyClass &amp;<span class="title">setValue</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;value = value;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›å½“å‰å¯¹è±¡å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    obj.<span class="built_in">setValue</span>(<span class="number">20</span>).<span class="built_in">display</span>(); <span class="comment">// é“¾å¼è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Value: 20</span><br></pre></td></tr></table></figure><hr><h3 id="2-3-å‹å…ƒå‡½æ•°ã€é™æ€æˆå‘˜å˜é‡ã€const-æˆå‘˜å‡½æ•°"><a href="#2-3-å‹å…ƒå‡½æ•°ã€é™æ€æˆå‘˜å˜é‡ã€const-æˆå‘˜å‡½æ•°" class="headerlink" title="2.3 å‹å…ƒå‡½æ•°ã€é™æ€æˆå‘˜å˜é‡ã€const æˆå‘˜å‡½æ•°"></a><strong>2.3 å‹å…ƒå‡½æ•°ã€é™æ€æˆå‘˜å˜é‡ã€<code>const</code> æˆå‘˜å‡½æ•°</strong></h3><h4 id="å‹å…ƒå‡½æ•°"><a href="#å‹å…ƒå‡½æ•°" class="headerlink" title="å‹å…ƒå‡½æ•°"></a><strong>å‹å…ƒå‡½æ•°</strong></h4><p>å‹å…ƒå‡½æ•°å¯ä»¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ï¼Œé€šå¸¸ç”¨æ¥å®ç°ç‰¹æ®Šæ“ä½œã€‚<br><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">friend</span> ReturnType <span class="title">FunctionName</span><span class="params">(ClassName &amp;obj)</span></span>;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="type">void</span> <span class="title">display</span><span class="params">(<span class="type">const</span> MyClass &amp;obj)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‹å…ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">(<span class="type">const</span> MyClass &amp;obj)</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; obj.value &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="built_in">display</span>(obj); <span class="comment">// è°ƒç”¨å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Value: 10</span><br></pre></td></tr></table></figure><hr><h4 id="é™æ€æˆå‘˜å˜é‡"><a href="#é™æ€æˆå‘˜å˜é‡" class="headerlink" title="é™æ€æˆå‘˜å˜é‡"></a><strong>é™æ€æˆå‘˜å˜é‡</strong></h4><p>é™æ€æˆå‘˜å˜é‡å±äºç±»è€Œä¸æ˜¯å¯¹è±¡ï¼Œæ‰€æœ‰å¯¹è±¡å…±äº«ä¸€ä»½ã€‚<br><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>å¿…é¡»åœ¨ç±»å¤–åˆå§‹åŒ–ã€‚</li><li>ä½¿ç”¨ <code>ClassName::StaticMember</code> è®¿é—®ã€‚</li></ol><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> count; <span class="comment">// å£°æ˜é™æ€æˆå‘˜å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>() &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123; <span class="comment">// é™æ€æˆå‘˜å‡½æ•°</span></span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–é™æ€æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="type">int</span> MyClass::count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MyClass obj1, obj2, obj3;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Number of objects: &quot;</span> &lt;&lt; MyClass::<span class="built_in">getCount</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Number of objects: 3</span><br></pre></td></tr></table></figure><hr><h4 id="const-æˆå‘˜å‡½æ•°"><a href="#const-æˆå‘˜å‡½æ•°" class="headerlink" title="const æˆå‘˜å‡½æ•°"></a><strong><code>const</code> æˆå‘˜å‡½æ•°</strong></h4><p><code>const</code> æˆå‘˜å‡½æ•°ä¿è¯å‡½æ•°ä¸ä¼šä¿®æ”¹ç±»çš„æˆå‘˜å˜é‡ã€‚<br><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ReturnType <span class="title">FunctionName</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="comment">// const æˆå‘˜å‡½æ•°</span></span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setValue</span><span class="params">(<span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        value = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="type">const</span> MyClass <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; obj.<span class="built_in">getValue</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// obj.setValue(20); // é”™è¯¯ï¼šconst å¯¹è±¡åªèƒ½è°ƒç”¨ const æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Value: 10</span><br></pre></td></tr></table></figure><hr><h3 id="2-4-æ•°æ®å°è£…ä¸è®¿é—®é™å®šç¬¦"><a href="#2-4-æ•°æ®å°è£…ä¸è®¿é—®é™å®šç¬¦" class="headerlink" title="2.4 æ•°æ®å°è£…ä¸è®¿é—®é™å®šç¬¦"></a><strong>2.4 æ•°æ®å°è£…ä¸è®¿é—®é™å®šç¬¦</strong></h3><h4 id="è®¿é—®é™å®šç¬¦"><a href="#è®¿é—®é™å®šç¬¦" class="headerlink" title="è®¿é—®é™å®šç¬¦"></a><strong>è®¿é—®é™å®šç¬¦</strong></h4><ul><li><strong><code>public</code>:</strong> å…¬æœ‰æˆå‘˜ï¼Œç±»å¤–éƒ¨å¯è®¿é—®ã€‚</li><li><strong><code>private</code>:</strong> ç§æœ‰æˆå‘˜ï¼Œä»…ç±»å†…éƒ¨å¯è®¿é—®ã€‚</li><li><strong><code>protected</code>:</strong> å—ä¿æŠ¤æˆå‘˜ï¼Œä»…ç±»åŠå…¶å­ç±»å¯è®¿é—®ã€‚</li></ul><h4 id="ä»£ç ç¤ºä¾‹ï¼š-1"><a href="#ä»£ç ç¤ºä¾‹ï¼š-1" class="headerlink" title="ä»£ç ç¤ºä¾‹ï¼š"></a><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> privateValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> publicValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="type">int</span> protectedValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>() : <span class="built_in">privateValue</span>(<span class="number">10</span>), <span class="built_in">publicValue</span>(<span class="number">20</span>), <span class="built_in">protectedValue</span>(<span class="number">30</span>) &#123;&#125; <span class="comment">//æ„é€ å‡½æ•°åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Private: &quot;</span> &lt;&lt; privateValue &lt;&lt; <span class="string">&quot;, Public: &quot;</span> &lt;&lt; publicValue</span><br><span class="line">             &lt;&lt; <span class="string">&quot;, Protected: &quot;</span> &lt;&lt; protectedValue &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MyClass obj;</span><br><span class="line">    obj.publicValue = <span class="number">50</span>; <span class="comment">// å…¬æœ‰æˆå‘˜å¯ç›´æ¥è®¿é—®</span></span><br><span class="line">    <span class="comment">// obj.privateValue = 60; // é”™è¯¯ï¼šç§æœ‰æˆå‘˜ä¸èƒ½ç›´æ¥è®¿é—®</span></span><br><span class="line">    obj.<span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Private: 10, Public: 50, Protected: 30</span><br></pre></td></tr></table></figure><h2 id="3-è¿ç®—ç¬¦é‡è½½"><a href="#3-è¿ç®—ç¬¦é‡è½½" class="headerlink" title="3. è¿ç®—ç¬¦é‡è½½"></a><strong>3. è¿ç®—ç¬¦é‡è½½</strong></h2><p>è¿ç®—ç¬¦é‡è½½å…è®¸ä¸ºç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å®šä¹‰è¿ç®—ç¬¦çš„è¡Œä¸ºã€‚<br><strong>æ³¨æ„ï¼š</strong></p><ul><li>ä¸èƒ½é‡è½½ <code>::</code>ï¼ˆä½œç”¨åŸŸè§£æï¼‰ã€<code>.</code>ï¼ˆæˆå‘˜è®¿é—®ï¼‰ç­‰ã€‚</li><li>è‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç”¨æˆ·å®šä¹‰ç±»å‹ã€‚</li></ul><hr><h3 id="3-1-ç±»å†…è¿ç®—ç¬¦é‡è½½"><a href="#3-1-ç±»å†…è¿ç®—ç¬¦é‡è½½" class="headerlink" title="3.1 ç±»å†…è¿ç®—ç¬¦é‡è½½"></a><strong>3.1 ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></h3><p>è¿ç®—ç¬¦å¯ä»¥ä½œä¸ºç±»çš„æˆå‘˜å‡½æ•°é‡è½½ã€‚<br><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ReturnType <span class="title">operatorSymbol</span><span class="params">(Arguments)</span></span>;</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹ï¼šé‡è½½-è¿ç®—ç¬¦"><a href="#ç¤ºä¾‹ï¼šé‡è½½-è¿ç®—ç¬¦" class="headerlink" title="ç¤ºä¾‹ï¼šé‡è½½ + è¿ç®—ç¬¦"></a><strong>ç¤ºä¾‹ï¼šé‡è½½ <code>+</code> è¿ç®—ç¬¦</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">double</span> real, imag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> r, <span class="type">double</span> i) : <span class="built_in">real</span>(r), <span class="built_in">imag</span>(i) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½ + è¿ç®—ç¬¦</span></span><br><span class="line">    Complex <span class="keyword">operator</span>+(<span class="type">const</span> Complex &amp;c) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(real + c.real, imag + c.imag);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; real &lt;&lt; <span class="string">&quot; + &quot;</span> &lt;&lt; imag &lt;&lt; <span class="string">&quot;i&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Complex <span class="title">c1</span><span class="params">(<span class="number">1.5</span>, <span class="number">2.5</span>)</span>, <span class="title">c2</span><span class="params">(<span class="number">2.0</span>, <span class="number">3.0</span>)</span></span>;</span><br><span class="line">    Complex c3 = c1 + c2; <span class="comment">// è°ƒç”¨è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">    c<span class="number">3.</span><span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.5</span> + <span class="number">5.5</span>i</span><br></pre></td></tr></table></figure><hr><h3 id="3-2-ç±»å¤–è¿ç®—ç¬¦é‡è½½"><a href="#3-2-ç±»å¤–è¿ç®—ç¬¦é‡è½½" class="headerlink" title="3.2 ç±»å¤–è¿ç®—ç¬¦é‡è½½"></a><strong>3.2 ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></h3><p>ç±»å¤–å®šä¹‰è¿ç®—ç¬¦æ—¶éœ€è¦å°†å…¶å£°æ˜ä¸ºå‹å…ƒå‡½æ•°ã€‚<br><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">friend</span> ReturnType <span class="title">operatorSymbol</span><span class="params">(<span class="type">const</span> ClassName &amp;lhs, <span class="type">const</span> ClassName &amp;rhs)</span></span>;</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹ï¼šé‡è½½"><a href="#ç¤ºä¾‹ï¼šé‡è½½" class="headerlink" title="ç¤ºä¾‹ï¼šé‡è½½ &lt;&lt; è¿ç®—ç¬¦"></a><strong>ç¤ºä¾‹ï¼šé‡è½½ <code>&lt;&lt;</code> è¿ç®—ç¬¦</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">double</span> real, imag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> r, <span class="type">double</span> i) : <span class="built_in">real</span>(r), <span class="built_in">imag</span>(i) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">friend</span> ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;out, <span class="type">const</span> Complex &amp;c);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‹å…ƒå‡½æ•°</span></span><br><span class="line">ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;out, <span class="type">const</span> Complex &amp;c) &#123;</span><br><span class="line">    out &lt;&lt; c.real &lt;&lt; <span class="string">&quot; + &quot;</span> &lt;&lt; c.imag &lt;&lt; <span class="string">&quot;i&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Complex <span class="title">c1</span><span class="params">(<span class="number">1.5</span>, <span class="number">2.5</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Complex number: &quot;</span> &lt;&lt; c1 &lt;&lt; endl; <span class="comment">// ä½¿ç”¨é‡è½½è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Complex number: <span class="number">1.5</span> + <span class="number">2.5</span>i</span><br></pre></td></tr></table></figure><h3 id="3-3-ç±»å†…è¿ç®—ç¬¦é‡è½½å’Œç±»å¤–è¿ç®—ç¬¦é‡è½½çš„åŒºåˆ«"><a href="#3-3-ç±»å†…è¿ç®—ç¬¦é‡è½½å’Œç±»å¤–è¿ç®—ç¬¦é‡è½½çš„åŒºåˆ«" class="headerlink" title="3.3 ç±»å†…è¿ç®—ç¬¦é‡è½½å’Œç±»å¤–è¿ç®—ç¬¦é‡è½½çš„åŒºåˆ«"></a>3.3 ç±»å†…è¿ç®—ç¬¦é‡è½½å’Œç±»å¤–è¿ç®—ç¬¦é‡è½½çš„åŒºåˆ«</h3><h4 id="1-å®šä¹‰æ–¹å¼"><a href="#1-å®šä¹‰æ–¹å¼" class="headerlink" title="1. å®šä¹‰æ–¹å¼"></a><strong>1. å®šä¹‰æ–¹å¼</strong></h4><h5 id="ç±»å†…è¿ç®—ç¬¦é‡è½½"><a href="#ç±»å†…è¿ç®—ç¬¦é‡è½½" class="headerlink" title="ç±»å†…è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p><strong>å®šä¹‰ä½ç½®ï¼š</strong> åœ¨ç±»çš„å†…éƒ¨å®šä¹‰ä¸ºç±»çš„æˆå‘˜å‡½æ•°ã€‚</p></li><li><p><strong>è°ƒç”¨æ–¹å¼ï¼š</strong> éšå¼ä½¿ç”¨ç±»çš„å¯¹è±¡è°ƒç”¨ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»å†…é‡è½½è¿ç®—ç¬¦+</span></span><br><span class="line">    MyClass <span class="keyword">operator</span>+(<span class="type">const</span> MyClass &amp;other) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">MyClass</span>(value + other.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">a</span><span class="params">(<span class="number">10</span>)</span>, <span class="title">b</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">    MyClass c = a + b; <span class="comment">// è°ƒç”¨ç±»å†…çš„operator+</span></span><br><span class="line">    c.<span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h5 id="ç±»å¤–è¿ç®—ç¬¦é‡è½½"><a href="#ç±»å¤–è¿ç®—ç¬¦é‡è½½" class="headerlink" title="ç±»å¤–è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p><strong>å®šä¹‰ä½ç½®ï¼š</strong> åœ¨ç±»çš„å¤–éƒ¨å®šä¹‰ä¸ºæ™®é€šå‡½æ•°ï¼Œé€šå¸¸å£°æ˜ä¸ºç±»çš„ <strong>å‹å…ƒå‡½æ•°</strong>ï¼ˆå¦‚æœéœ€è¦è®¿é—®ç§æœ‰æˆ–ä¿æŠ¤æˆå‘˜ï¼‰ã€‚</p></li><li><p><strong>è°ƒç”¨æ–¹å¼ï¼š</strong> ä½¿ç”¨è¿ç®—ç¬¦ç›´æ¥ä½œç”¨äºç±»çš„å¯¹è±¡ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜ç±»å¤–å‹å…ƒå‡½æ•°ç”¨äºé‡è½½è¿ç®—ç¬¦+</span></span><br><span class="line">    <span class="keyword">friend</span> MyClass <span class="keyword">operator</span>+(<span class="type">const</span> MyClass &amp;a, <span class="type">const</span> MyClass &amp;b);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å¤–å®šä¹‰operator+</span></span><br><span class="line">MyClass <span class="keyword">operator</span>+(<span class="type">const</span> MyClass &amp;a, <span class="type">const</span> MyClass &amp;b) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">MyClass</span>(a.value + b.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">a</span><span class="params">(<span class="number">10</span>)</span>, <span class="title">b</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">    MyClass c = a + b; <span class="comment">// è°ƒç”¨ç±»å¤–çš„operator+</span></span><br><span class="line">    c.<span class="built_in">display</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><h4 id="2-å‚æ•°ä¸è°ƒç”¨åŒºåˆ«"><a href="#2-å‚æ•°ä¸è°ƒç”¨åŒºåˆ«" class="headerlink" title="2. å‚æ•°ä¸è°ƒç”¨åŒºåˆ«"></a><strong>2. å‚æ•°ä¸è°ƒç”¨åŒºåˆ«</strong></h4><h5 id="ç±»å†…è¿ç®—ç¬¦é‡è½½-1"><a href="#ç±»å†…è¿ç®—ç¬¦é‡è½½-1" class="headerlink" title="ç±»å†…è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p><strong>éšå¼ä¼ é€’å·¦æ“ä½œæ•°ï¼š</strong> ç±»çš„æˆå‘˜å‡½æ•°é»˜è®¤ä¼šæŠŠè°ƒç”¨è€…ä½œä¸º <strong>å·¦æ“ä½œæ•°</strong>ï¼Œå³æ“ä½œæ•°éœ€è¦é€šè¿‡å‚æ•°ä¼ é€’ã€‚</p></li><li><p><strong>å‚æ•°æ•°é‡ï¼š</strong> ä¸€å…ƒè¿ç®—ç¬¦ä¸éœ€è¦å‚æ•°ï¼ŒäºŒå…ƒè¿ç®—ç¬¦åªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼ˆå³æ“ä½œæ•°ï¼‰ã€‚</p></li><li><p>è°ƒç”¨æ–¹å¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyClass a, b;</span><br><span class="line">a + b; <span class="comment">// ç­‰ä»·äº a.operator+(b);</span></span><br></pre></td></tr></table></figure></li></ul><h5 id="ç±»å¤–è¿ç®—ç¬¦é‡è½½-1"><a href="#ç±»å¤–è¿ç®—ç¬¦é‡è½½-1" class="headerlink" title="ç±»å¤–è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p><strong>æ˜¾å¼ä¼ é€’æ“ä½œæ•°ï¼š</strong> æ‰€æœ‰æ“ä½œæ•°éƒ½é€šè¿‡å‚æ•°ä¼ é€’ï¼ŒåŒ…æ‹¬å·¦æ“ä½œæ•°ã€‚</p></li><li><p><strong>å‚æ•°æ•°é‡ï¼š</strong> ä¸€å…ƒè¿ç®—ç¬¦éœ€è¦ä¸€ä¸ªå‚æ•°ï¼ŒäºŒå…ƒè¿ç®—ç¬¦éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚</p></li><li><p>è°ƒç”¨æ–¹å¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyClass a, b;</span><br><span class="line">a + b; <span class="comment">// ç­‰ä»·äº operator+(a, b);</span></span><br></pre></td></tr></table></figure></li></ul><hr><h4 id="3-è®¿é—®æƒé™"><a href="#3-è®¿é—®æƒé™" class="headerlink" title="3. è®¿é—®æƒé™"></a><strong>3. è®¿é—®æƒé™</strong></h4><h5 id="ç±»å†…è¿ç®—ç¬¦é‡è½½-2"><a href="#ç±»å†…è¿ç®—ç¬¦é‡è½½-2" class="headerlink" title="ç±»å†…è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li>ç±»å†…çš„æˆå‘˜å‡½æ•°å¯ä»¥ç›´æ¥è®¿é—®ç±»çš„ <strong>ç§æœ‰æˆå‘˜</strong> å’Œ <strong>ä¿æŠ¤æˆå‘˜</strong>ï¼Œæ— éœ€é¢å¤–å¤„ç†ã€‚</li></ul><h5 id="ç±»å¤–è¿ç®—ç¬¦é‡è½½-2"><a href="#ç±»å¤–è¿ç®—ç¬¦é‡è½½-2" class="headerlink" title="ç±»å¤–è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p>å¦‚æœç±»å¤–çš„é‡è½½å‡½æ•°éœ€è¦è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜æˆ–ä¿æŠ¤æˆå‘˜ï¼Œå¿…é¡»å°†å…¶å£°æ˜ä¸º </p><p>å‹å…ƒå‡½æ•°</p><p>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">friend</span> MyClass <span class="keyword">operator</span>+(<span class="type">const</span> MyClass &amp;a, <span class="type">const</span> MyClass &amp;b);</span><br></pre></td></tr></table></figure></li></ul><hr><h4 id="4-åŠŸèƒ½èŒƒå›´"><a href="#4-åŠŸèƒ½èŒƒå›´" class="headerlink" title="4. åŠŸèƒ½èŒƒå›´"></a><strong>4. åŠŸèƒ½èŒƒå›´</strong></h4><h5 id="ç±»å†…è¿ç®—ç¬¦é‡è½½-3"><a href="#ç±»å†…è¿ç®—ç¬¦é‡è½½-3" class="headerlink" title="ç±»å†…è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li><p>ç±»å†…é‡è½½é€šå¸¸ç”¨äºè¿ç®—ç¬¦çš„ </p><p>å·¦æ“ä½œæ•°</p><p> å¿…é¡»æ˜¯ç±»çš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p><ul><li><code>a + b</code> ä¸­ï¼Œ<code>a</code> å¿…é¡»æ˜¯ç±»çš„å¯¹è±¡ã€‚</li><li>å¦‚æœå·¦æ“ä½œæ•°ä¸æ˜¯ç±»çš„å¯¹è±¡ï¼ˆå¦‚ <code>3 + a</code>ï¼‰ï¼Œç±»å†…è¿ç®—ç¬¦æ— æ³•ç›´æ¥å¤„ç†ã€‚</li></ul></li></ul><h5 id="ç±»å¤–è¿ç®—ç¬¦é‡è½½-3"><a href="#ç±»å¤–è¿ç®—ç¬¦é‡è½½-3" class="headerlink" title="ç±»å¤–è¿ç®—ç¬¦é‡è½½"></a><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></h5><ul><li>ç±»å¤–é‡è½½å¯ä»¥å¤„ç†æ›´çµæ´»çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼š<ul><li>å·¦æ“ä½œæ•°æ˜¯ç±»å¯¹è±¡æ—¶ï¼š<code>a + b</code>ã€‚</li><li>å·¦æ“ä½œæ•°ä¸æ˜¯ç±»å¯¹è±¡æ—¶ï¼š<code>3 + a</code>ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼šæ”¯æŒ <code>3 + a</code> çš„ç±»å¤–é‡è½½ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> MyClass <span class="keyword">operator</span>+(<span class="type">int</span> num, <span class="type">const</span> MyClass &amp;a); <span class="comment">// æ”¯æŒ3 + a</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å¤–å®šä¹‰</span></span><br><span class="line">MyClass <span class="keyword">operator</span>+(<span class="type">int</span> num, <span class="type">const</span> MyClass &amp;a) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">MyClass</span>(num + a.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">a</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">    MyClass b = <span class="number">3</span> + a; <span class="comment">// æ”¯æŒå·¦æ“ä½œæ•°ä¸ºæ™®é€šæ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="5-ä»£ç è®¾è®¡ä¸é€‚ç”¨åœºæ™¯"><a href="#5-ä»£ç è®¾è®¡ä¸é€‚ç”¨åœºæ™¯" class="headerlink" title="5. ä»£ç è®¾è®¡ä¸é€‚ç”¨åœºæ™¯"></a><strong>5. ä»£ç è®¾è®¡ä¸é€‚ç”¨åœºæ™¯</strong></h4><table><thead><tr><th><strong>æ¯”è¾ƒç»´åº¦</strong></th><th><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½</strong></th><th><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½</strong></th></tr></thead><tbody><tr><td><strong>é€‚ç”¨æ€§</strong></td><td>å·¦æ“ä½œæ•°å¿…é¡»æ˜¯ç±»å¯¹è±¡ã€‚</td><td>å·¦æ“ä½œæ•°å¯ä»¥æ˜¯ç±»å¯¹è±¡æˆ–å…¶ä»–ç±»å‹ã€‚</td></tr><tr><td><strong>è®¿é—®æƒé™</strong></td><td>èƒ½ç›´æ¥è®¿é—®ç±»çš„ç§æœ‰æˆ–ä¿æŠ¤æˆå‘˜ã€‚</td><td>éœ€è¦å£°æ˜ä¸ºå‹å…ƒå‡½æ•°æ‰èƒ½è®¿é—®ç§æœ‰æˆå‘˜ã€‚</td></tr><tr><td><strong>ä»£ç é£æ ¼</strong></td><td>æ›´ç´§å¯†åœ°ç»‘å®šç±»æœ¬èº«ï¼Œé€»è¾‘é›†ä¸­åœ¨ç±»å†…ã€‚</td><td>åŠŸèƒ½æ›´çµæ´»ï¼Œé€‚åˆè·¨ç±»æˆ–è·¨ç±»å‹çš„æ“ä½œç¬¦é‡è½½ã€‚</td></tr><tr><td><strong>å®ç°å¤æ‚åº¦</strong></td><td>è¾ƒç®€å•ï¼Œé€‚åˆå¸¸è§çš„è¿ç®—ç¬¦é‡è½½ã€‚</td><td>é€‚åˆéœ€è¦æ›´é«˜çµæ´»æ€§çš„é‡è½½åœºæ™¯ã€‚</td></tr></tbody></table><hr><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h4><ul><li><strong>ç±»å†…è¿ç®—ç¬¦é‡è½½ï¼š</strong><ul><li>å·¦æ“ä½œæ•°å¿…é¡»æ˜¯ç±»å¯¹è±¡ã€‚</li><li>ä½¿ç”¨æ›´ç®€å•ï¼Œé€‚åˆå†…éƒ¨é€»è¾‘ç´§å¯†ç»‘å®šç±»çš„æƒ…å†µã€‚</li></ul></li><li><strong>ç±»å¤–è¿ç®—ç¬¦é‡è½½ï¼š</strong><ul><li>å·¦æ“ä½œæ•°å¯ä»¥æ˜¯ç±»å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»å‹ã€‚</li><li>æ›´çµæ´»ï¼Œé€‚åˆéœ€è¦å¤„ç†è·¨ç±»æˆ–å¤šç§æ•°æ®ç±»å‹æ“ä½œçš„åœºæ™¯ã€‚</li></ul></li></ul><hr><h2 id="4-å¤šçº¿ç¨‹"><a href="#4-å¤šçº¿ç¨‹" class="headerlink" title="4. å¤šçº¿ç¨‹"></a><strong>4. å¤šçº¿ç¨‹</strong></h2><p>å¤šçº¿ç¨‹ä½¿ç¨‹åºå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ã€‚C++11 æä¾›äº† <code>std::thread</code> æ”¯æŒå¤šçº¿ç¨‹ã€‚</p><hr><h3 id="4-1-åˆ›å»ºçº¿ç¨‹"><a href="#4-1-åˆ›å»ºçº¿ç¨‹" class="headerlink" title="4.1 åˆ›å»ºçº¿ç¨‹"></a><strong>4.1 åˆ›å»ºçº¿ç¨‹</strong></h3><h4 id="è¯­æ³•ï¼š"><a href="#è¯­æ³•ï¼š" class="headerlink" title="è¯­æ³•ï¼š"></a><strong>è¯­æ³•ï¼š</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// çº¿ç¨‹è¦æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(function)</span></span>; <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">    t.<span class="built_in">join</span>(); <span class="comment">// ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ç¤ºä¾‹ï¼šç®€å•çº¿ç¨‹åˆ›å»º"><a href="#ç¤ºä¾‹ï¼šç®€å•çº¿ç¨‹åˆ›å»º" class="headerlink" title="ç¤ºä¾‹ï¼šç®€å•çº¿ç¨‹åˆ›å»º"></a><strong>ç¤ºä¾‹ï¼šç®€å•çº¿ç¨‹åˆ›å»º</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printMessage</span><span class="params">(<span class="type">const</span> string &amp;msg)</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Message: &quot;</span> &lt;&lt; msg &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">thread <span class="title">t1</span><span class="params">(printMessage, <span class="string">&quot;Hello from thread!&quot;</span>)</span></span>; <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">    t<span class="number">1.</span><span class="built_in">join</span>(); <span class="comment">// ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message: Hello from thread!</span><br></pre></td></tr></table></figure><hr><h3 id="4-2-å¤šçº¿ç¨‹åŒæ­¥"><a href="#4-2-å¤šçº¿ç¨‹åŒæ­¥" class="headerlink" title="4.2 å¤šçº¿ç¨‹åŒæ­¥"></a><strong>4.2 å¤šçº¿ç¨‹åŒæ­¥</strong></h3><p>ä¸ºäº†é¿å…å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹å…±äº«èµ„æºï¼ŒC++ æä¾›äº†äº’æ–¥é” (<code>std::mutex</code>)ã€‚</p><h4 id="ç¤ºä¾‹ï¼šä½¿ç”¨äº’æ–¥é”"><a href="#ç¤ºä¾‹ï¼šä½¿ç”¨äº’æ–¥é”" class="headerlink" title="ç¤ºä¾‹ï¼šä½¿ç”¨äº’æ–¥é”"></a><strong>ç¤ºä¾‹ï¼šä½¿ç”¨äº’æ–¥é”</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">mutex mtx; <span class="comment">// å®šä¹‰äº’æ–¥é”</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printNumbers</span><span class="params">(<span class="type">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">        mtx.<span class="built_in">lock</span>(); <span class="comment">// åŠ é”</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Thread &quot;</span> &lt;&lt; id &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">        mtx.<span class="built_in">unlock</span>(); <span class="comment">// è§£é”</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">thread <span class="title">t1</span><span class="params">(printNumbers, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">thread <span class="title">t2</span><span class="params">(printNumbers, <span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    t<span class="number">1.</span><span class="built_in">join</span>();</span><br><span class="line">    t<span class="number">2.</span><span class="built_in">join</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼ˆçº¿ç¨‹é¡ºåºå¯èƒ½ä¸åŒï¼‰ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thread <span class="number">1</span>: <span class="number">0</span></span><br><span class="line">Thread <span class="number">2</span>: <span class="number">0</span></span><br><span class="line">Thread <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">Thread <span class="number">2</span>: <span class="number">1</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="é«˜çº§çš„lockæ–¹å¼ï¼š"><a href="#é«˜çº§çš„lockæ–¹å¼ï¼š" class="headerlink" title="é«˜çº§çš„lockæ–¹å¼ï¼š"></a><strong>é«˜çº§çš„lockæ–¹å¼ï¼š</strong></h4><h3 id="1-std-mutex"><a href="#1-std-mutex" class="headerlink" title="1. std::mutex"></a>1. <strong><code>std::mutex</code></strong></h3><p>é¦–å…ˆè¦äº†è§£çš„æ˜¯ **<code>std::mutex</code>**ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºæœ¬çš„äº’æ–¥é‡ï¼Œç”¨äºå®ç°çº¿ç¨‹é—´çš„åŒæ­¥ã€‚åœ¨ C++11 ä¸­ï¼Œ<code>std::mutex</code> æä¾›äº†åŸºæœ¬çš„åŠ é”å’Œè§£é”åŠŸèƒ½ã€‚</p><ul><li>**<code>std::mutex::lock()</code>**ï¼šåŠ é”ã€‚</li><li>**<code>std::mutex::unlock()</code>**ï¼šè§£é”ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;  <span class="comment">// å®šä¹‰ä¸€ä¸ªå…¨å±€çš„äº’æ–¥é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">safeFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mtx.<span class="built_in">lock</span>();     <span class="comment">// æ‰‹åŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// è®¿é—®æˆ–ä¿®æ”¹å…±äº«èµ„æº</span></span><br><span class="line">    mtx.<span class="built_in">unlock</span>();   <span class="comment">// æ‰‹åŠ¨è§£é”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°½ç®¡æ‰‹åŠ¨åŠ é”å’Œè§£é”æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®ƒä»¬éœ€è¦å°å¿ƒå¤„ç†ï¼Œå°¤å…¶æ˜¯åœ¨å¼‚å¸¸å‘ç”Ÿæ—¶ã€‚å¦‚æœå‘ç”Ÿå¼‚å¸¸è€Œæœªèƒ½è§£é”äº’æ–¥é‡ï¼Œç¨‹åºå¯èƒ½ä¼šè¿›å…¥æ­»é”çŠ¶æ€ã€‚å› æ­¤ï¼ŒC++ æä¾›äº† <strong><code>std::lock_guard</code></strong> å’Œ <strong><code>std::unique_lock</code></strong> æ¥ç®€åŒ–äº’æ–¥é‡çš„ç®¡ç†ï¼Œç¡®ä¿é”åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚</p><h3 id="2-std-lock-guard"><a href="#2-std-lock-guard" class="headerlink" title="2. std::lock_guard"></a>2. <strong><code>std::lock_guard</code></strong></h3><p><code>std::lock_guard</code> æ˜¯ä¸€ä¸ªç®€å•çš„å°è£…ï¼Œå®ƒç”¨äºåœ¨ä½œç”¨åŸŸå†…è‡ªåŠ¨åŠ é”ï¼Œå¹¶ä¸”åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨è§£é”ã€‚å®ƒæ˜¯ä¸€ç§ <strong>ä½œç”¨åŸŸé”</strong>ï¼Œéå¸¸é€‚åˆäºåªéœ€è¦åŠ é”å¹¶è‡ªåŠ¨è§£é”çš„åœºæ™¯ã€‚</p><ul><li><strong>ä½œç”¨</strong>ï¼šå½“ <code>std::lock_guard</code> å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ é”äº’æ–¥é‡ã€‚å½“ <code>std::lock_guard</code> å¯¹è±¡è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œè¿›è€Œè§£é”äº’æ–¥é‡ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šé¿å…æ‰‹åŠ¨è§£é”ï¼Œé™ä½æ­»é”é£é™©ã€‚</li></ul><h4 id="è¯­æ³•ç¤ºä¾‹ï¼š"><a href="#è¯­æ³•ç¤ºä¾‹ï¼š" class="headerlink" title="è¯­æ³•ç¤ºä¾‹ï¼š"></a>è¯­æ³•ç¤ºä¾‹ï¼š</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">safeFunctionWithLockGuard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lk</span><span class="params">(mtx)</span></span>;  <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// è®¿é—®æˆ–ä¿®æ”¹å…±äº«èµ„æº</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Shared resource accessed with lock_guard\n&quot;</span>;</span><br><span class="line">    <span class="comment">// é”ä¼šåœ¨lkè¶…å‡ºä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">safeFunctionWithLockGuard</span>();  <span class="comment">// è°ƒç”¨å‡½æ•°ï¼Œè‡ªåŠ¨åŠ é”å’Œè§£é”</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>å½“ <code>lock_guard</code> å¯¹è±¡ <code>lk</code> è¢«åˆ›å»ºæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ é”äº’æ–¥é‡ <code>mtx</code>ã€‚</li><li>å½“ <code>lk</code> è¶…å‡ºä½œç”¨åŸŸï¼ˆå³ <code>safeFunctionWithLockGuard</code> å‡½æ•°ç»“æŸæ—¶ï¼‰ï¼Œ<code>lk</code> ä¼šè‡ªåŠ¨è§£é” <code>mtx</code>ã€‚</li></ul><p><code>std::lock_guard</code> çš„ç‰¹ç‚¹æ˜¯ç®€å•ä¸”æœ‰æ•ˆï¼Œä½†å®ƒä¸æ”¯æŒè§£é”æˆ–é‡æ–°é”å®šæ“ä½œï¼Œåªé€‚åˆäºç®€å•çš„åŠ é”å’Œè§£é”åœºæ™¯ã€‚</p><h3 id="3-std-unique-lock"><a href="#3-std-unique-lock" class="headerlink" title="3. std::unique_lock"></a>3. <strong><code>std::unique_lock</code></strong></h3><p><code>std::unique_lock</code> æ˜¯ä¸€ä¸ªæ¯” <code>std::lock_guard</code> æ›´åŠ çµæ´»çš„é”ç®¡ç†å·¥å…·ï¼Œå®ƒæä¾›äº†æ¯” <code>std::lock_guard</code> æ›´å¤šçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>å¯ä»¥æ˜¾å¼åœ° <strong>æ‰‹åŠ¨è§£é”</strong>ã€‚</li><li>æ”¯æŒ <strong>é”çš„å»¶è¿Ÿ</strong>ï¼ˆå³åœ¨åˆ›å»º <code>unique_lock</code> å¯¹è±¡æ—¶ä¸ç«‹å³åŠ é”ï¼‰ã€‚</li><li>å¯ä»¥ <strong>é‡æ–°é”å®š</strong>ã€‚</li><li>å¯ä»¥ <strong>è½¬ç§»é”çš„æ‰€æœ‰æƒ</strong>ï¼Œå³å°†é”çš„æ‰€æœ‰æƒä»ä¸€ä¸ª <code>unique_lock</code> å¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªã€‚</li></ul><p><code>std::unique_lock</code> æ˜¯ <strong>å¯ç§»åŠ¨çš„</strong>ï¼Œè€Œ <code>std::lock_guard</code> ä¸æ˜¯ã€‚</p><h4 id="è¯­æ³•ç¤ºä¾‹ï¼š-1"><a href="#è¯­æ³•ç¤ºä¾‹ï¼š-1" class="headerlink" title="è¯­æ³•ç¤ºä¾‹ï¼š"></a>è¯­æ³•ç¤ºä¾‹ï¼š</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">safeFunctionWithUniqueLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">ul</span><span class="params">(mtx)</span></span>;  <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// è®¿é—®æˆ–ä¿®æ”¹å…±äº«èµ„æº</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Shared resource accessed with unique_lock\n&quot;</span>;</span><br><span class="line">    ul.<span class="built_in">unlock</span>();  <span class="comment">// æ‰‹åŠ¨è§£é”</span></span><br><span class="line">    <span class="comment">// ä½ å¯ä»¥åœ¨è¿™é‡Œåšå…¶ä»–ä¸éœ€è¦é”çš„æ“ä½œ</span></span><br><span class="line">    ul.<span class="built_in">lock</span>();  <span class="comment">// å¦‚æœéœ€è¦ï¼Œå¯ä»¥é‡æ–°åŠ é”</span></span><br><span class="line">    <span class="comment">// è®¿é—®å…±äº«èµ„æº</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Shared resource accessed after relocking\n&quot;</span>;</span><br><span class="line">    <span class="comment">// é”ä¼šåœ¨ulè¶…å‡ºä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">safeFunctionWithUniqueLock</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li><code>std::unique_lock</code> åœ¨åˆ›å»ºæ—¶è‡ªåŠ¨åŠ é”äº’æ–¥é‡ <code>mtx</code>ã€‚</li><li>ä½¿ç”¨ <code>ul.unlock()</code> æ‰‹åŠ¨è§£é”ï¼Œä¹‹åå¯ä»¥æ‰§è¡Œä¸€äº›ä¸éœ€è¦é”çš„æ“ä½œã€‚</li><li><code>ul.lock()</code> å¯ä»¥åœ¨ä¹‹åé‡æ–°åŠ é”ã€‚</li><li>å½“ <code>unique_lock</code> å¯¹è±¡ <code>ul</code> è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼Œ<code>mtx</code> ä¼šè‡ªåŠ¨è§£é”ã€‚</li></ul><p><code>std::unique_lock</code> æä¾›äº†æ¯” <code>std::lock_guard</code> æ›´é«˜çš„çµæ´»æ€§ï¼Œä½†ä¹Ÿç›¸å¯¹å¤æ‚ä¸€äº›ã€‚å®ƒé€‚ç”¨äºéœ€è¦æ›´ç»†ç²’åº¦æ§åˆ¶çš„åœºæ™¯ï¼Œå¦‚éœ€è¦æ‰‹åŠ¨è§£é”å’Œé‡æ–°åŠ é”çš„æƒ…å†µã€‚</p><h3 id="4-std-lock-å’Œ-std-lock-guard-ä¸-std-unique-lock-çš„åŒºåˆ«"><a href="#4-std-lock-å’Œ-std-lock-guard-ä¸-std-unique-lock-çš„åŒºåˆ«" class="headerlink" title="4. std::lock å’Œ std::lock_guard ä¸ std::unique_lock çš„åŒºåˆ«"></a>4. <code>std::lock</code> å’Œ <code>std::lock_guard</code> ä¸ <code>std::unique_lock</code> çš„åŒºåˆ«</h3><ul><li>**<code>std::lock_guard</code>**ï¼š<ul><li>ç®€å•ï¼Œé€‚ç”¨äºæ— éœ€æ‰‹åŠ¨è§£é”çš„åœºæ™¯ã€‚</li><li>è‡ªåŠ¨åŠ é”å¹¶åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨è§£é”ã€‚</li><li>ä¸èƒ½æ˜¾å¼è§£é”æˆ–é‡æ–°åŠ é”ã€‚</li><li>ä¸èƒ½è½¬ç§»æ‰€æœ‰æƒã€‚</li></ul></li><li>**<code>std::unique_lock</code>**ï¼š<ul><li>æ›´çµæ´»ï¼Œé€‚ç”¨äºéœ€è¦æ‰‹åŠ¨è§£é”ã€é‡æ–°åŠ é”ã€æˆ–è½¬ç§»é”æ‰€æœ‰æƒçš„åœºæ™¯ã€‚</li><li>æ”¯æŒæ˜¾å¼è§£é”ï¼ˆ<code>unlock()</code>ï¼‰å’Œé‡æ–°åŠ é”ï¼ˆ<code>lock()</code>ï¼‰ã€‚</li><li>æ”¯æŒé”çš„å»¶è¿Ÿå’Œè½¬ç§»ã€‚</li></ul></li><li>**<code>std::mutex</code> å’Œ <code>std::lock</code>**ï¼š<ul><li><code>std::mutex</code> æä¾›äº†åŸºæœ¬çš„åŠ é”å’Œè§£é”æœºåˆ¶ã€‚</li><li><code>std::lock</code> æ˜¯ä¸€ä¸ªå¯ä»¥åŒæ—¶åŠ é”å¤šä¸ªäº’æ–¥é‡çš„å·¥å…·ï¼Œå¯ä»¥é˜²æ­¢æ­»é”çš„å‘ç”Ÿã€‚</li></ul></li></ul><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a>5. <strong>æ€»ç»“</strong></h3><ul><li><strong><code>std::lock_guard</code></strong> å’Œ <strong><code>std::unique_lock</code></strong> éƒ½æ˜¯ç”¨æ¥ç®¡ç†äº’æ–¥é‡é”çš„å·¥å…·ï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚</li><li><strong><code>std::lock_guard</code></strong> æ˜¯ç®€æ´çš„è‡ªåŠ¨é”ç®¡ç†å·¥å…·ï¼Œé€‚åˆç®€å•çš„åŠ é”å’Œè§£é”ã€‚</li><li><strong><code>std::unique_lock</code></strong> æä¾›äº†æ›´çµæ´»çš„é”ç®¡ç†æ–¹å¼ï¼Œæ”¯æŒæ‰‹åŠ¨è§£é”ã€é‡æ–°åŠ é”ç­‰é«˜çº§æ“ä½œã€‚</li><li>ä½¿ç”¨è¿™äº›é”å¯ä»¥æœ‰æ•ˆåœ°é¿å…æ­»é”ï¼Œå‡å°‘ç¼–å†™çº¿ç¨‹å®‰å…¨ä»£ç æ—¶çš„å¤æ‚æ€§ã€‚</li></ul><h2 id="5-STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰"><a href="#5-STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰" class="headerlink" title="5. STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰"></a><strong>5. STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰</strong></h2><p>STL æä¾›äº†å¸¸ç”¨çš„æ•°æ®ç»“æ„å’Œç®—æ³•ã€‚ä»¥ä¸‹æ˜¯é‡ç‚¹å†…å®¹ã€‚</p><hr><h3 id="5-1-å¸¸ç”¨å®¹å™¨"><a href="#5-1-å¸¸ç”¨å®¹å™¨" class="headerlink" title="5.1 å¸¸ç”¨å®¹å™¨"></a><strong>5.1 å¸¸ç”¨å®¹å™¨</strong></h3><h4 id="5-1-1-vector"><a href="#5-1-1-vector" class="headerlink" title="5.1.1 vector"></a><strong>5.1.1 <code>vector</code></strong></h4><p>åŠ¨æ€æ•°ç»„ï¼Œæ”¯æŒéšæœºè®¿é—®å’Œè‡ªåŠ¨æ‰©å®¹ã€‚</p><p><strong>ç¤ºä¾‹ï¼šåŸºæœ¬æ“ä½œ</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">4</span>); <span class="comment">// æ·»åŠ å…ƒç´ </span></span><br><span class="line">    vec.<span class="built_in">pop_back</span>();   <span class="comment">// åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> x : vec) &#123;</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br></pre></td></tr></table></figure><hr><h4 id="5-1-2-queue"><a href="#5-1-2-queue" class="headerlink" title="5.1.2 queue"></a><strong>5.1.2 <code>queue</code></strong></h4><p>å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰é˜Ÿåˆ—ã€‚</p><p><strong>ç¤ºä¾‹ï¼šåŸºæœ¬æ“ä½œ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    queue&lt;int&gt; q;</span><br><span class="line">    q.push(1); q.push(2); q.push(3);</span><br><span class="line"></span><br><span class="line">    while (!q.empty()) &#123;</span><br><span class="line">        cout &lt;&lt; q.front() &lt;&lt; &quot; &quot;; // è·å–é˜Ÿå¤´å…ƒç´ </span><br><span class="line">        q.pop(); // ç§»é™¤é˜Ÿå¤´å…ƒç´ </span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br></pre></td></tr></table></figure><hr><h4 id="5-1-3-deque"><a href="#5-1-3-deque" class="headerlink" title="5.1.3 deque"></a><strong>5.1.3 <code>deque</code></strong></h4><p>åŒç«¯é˜Ÿåˆ—ï¼Œå¯ä»¥ä»ä¸¤ç«¯æ’å…¥æˆ–åˆ é™¤ã€‚</p><p><strong>ç¤ºä¾‹ï¼šåŸºæœ¬æ“ä½œ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; dq = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    dq.<span class="built_in">push_front</span>(<span class="number">0</span>); <span class="comment">// å‰ç«¯æ’å…¥</span></span><br><span class="line">    dq.<span class="built_in">push_back</span>(<span class="number">4</span>);  <span class="comment">// åç«¯æ’å…¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> x : dq) &#123;</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br></pre></td></tr></table></figure><h5 id="è®°å½•ä»£ç "><a href="#è®°å½•ä»£ç " class="headerlink" title="è®°å½•ä»£ç "></a>è®°å½•ä»£ç </h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> <span class="comment">//input output æµï¼Œç±»ä¼¼äºstdio.h</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ventor æ•°ç»„ çš„ä¸‰ç§å®šä¹‰</span></span><br><span class="line">    vector &lt;<span class="type">int</span>&gt; v1; <span class="comment">//å®šä¹‰ä¸€ä¸ªç©ºæ•°ç»„</span></span><br><span class="line">    vector &lt;<span class="type">int</span>&gt; <span class="built_in">v2</span>(<span class="number">10</span>); <span class="comment">//å®šä¹‰ä¸€ä¸ª10ä¸ªå…ƒç´ çš„ç©ºæ•°ç»„</span></span><br><span class="line">    vector &lt;<span class="type">int</span>&gt; <span class="built_in">v3</span>(<span class="number">10</span>,<span class="number">2</span>); <span class="comment">//å®šä¹‰ä¸€ä¸ª10ä¸ªå…ƒç´ çš„ç©ºæ•°ç»„ï¼Œå¹¶ä¸”æ¯ä¸ªå˜é‡éƒ½åˆå§‹åŒ–ä¸º2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    v<span class="number">3.</span><span class="built_in">resize</span>(<span class="number">12</span>); <span class="comment">//resize å¯ä»¥æ›´æ”¹æ•°ç»„é•¿åº¦ï¼Œå¢åŠ æ•°ç»„é•¿åº¦çš„æ—¶å€™ï¼Œä¸ä¼šä¿®æ”¹åŸæœ‰å€¼</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ;i &lt;<span class="number">12</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;v3[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//å¯æ›¿æ¢åŸç”Ÿforå¾ªç¯çš„å·¥å…·ï¼šè¿­ä»£å™¨ (é€‚ç”¨äºc++11)</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p =v<span class="number">3.</span><span class="built_in">begin</span>();p!=v<span class="number">3.</span><span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;*p&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨è¿­ä»£å™¨çš„å¥½å¤„ï¼šæ— éœ€è€ƒè™‘forå¾ªç¯çš„å¼€å¤´å’Œç»“æŸ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//set: é›†åˆï¼Œå…ƒç´ äº’å¼‚ï¼Œè‡ªåŠ¨ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">    <span class="comment">//setåœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œæ²¡æœ‰é¢å¤–çš„å‚æ•°</span></span><br><span class="line">    set &lt;<span class="type">int</span>&gt; my_set;</span><br><span class="line">    <span class="comment">//æ’å…¥å…ƒç´ </span></span><br><span class="line">    my_set.<span class="built_in">insert</span>(<span class="number">8</span>);</span><br><span class="line">    my_set.<span class="built_in">insert</span>(<span class="number">2</span>);</span><br><span class="line">    my_set.<span class="built_in">insert</span>(<span class="number">5</span>);</span><br><span class="line">    my_set.<span class="built_in">insert</span>(<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿­ä»£å™¨éå†</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p = my_set.<span class="built_in">begin</span>();p!=my_set.<span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;*p&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">auto</span> p = my_set.<span class="built_in">find</span>(<span class="number">8</span>); <span class="comment">// .find(data)å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*p is &quot;</span>&lt;&lt;*p&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//set æ¸…é™¤æŸä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    my_set.<span class="built_in">erase</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p = my_set.<span class="built_in">begin</span>();p!=my_set.<span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;*p&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//map</span></span><br><span class="line">    map&lt;<span class="type">int</span>,string&gt; m;</span><br><span class="line">    m[<span class="number">2</span>] =<span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    m[<span class="number">1</span>] = <span class="string">&quot;wrold&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p = m.<span class="built_in">begin</span>();p!=m.<span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; (*p).first &lt;&lt;<span class="string">&quot;:&quot;</span>&lt;&lt;p-&gt;second&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    map&lt;string,<span class="type">int</span>&gt; m2;</span><br><span class="line">    m2[<span class="string">&quot;hello&quot;</span>] = <span class="number">9</span>;</span><br><span class="line">    m2[<span class="string">&quot;wrold&quot;</span>] = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p = m.<span class="built_in">begin</span>();p!=m.<span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; (*p).first &lt;&lt;<span class="string">&quot;:&quot;</span>&lt;&lt;p-&gt;second&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//stack</span></span><br><span class="line">    stack &lt;<span class="type">int</span>&gt; mystack;</span><br><span class="line">    mystack.<span class="built_in">push</span>(<span class="number">4</span>);</span><br><span class="line">    mystack.<span class="built_in">push</span>(<span class="number">3</span>);</span><br><span class="line">    mystack.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">    mystack.<span class="built_in">pop</span>();</span><br><span class="line">    cout&lt;&lt;mystack.<span class="built_in">top</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;mystack.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//queue</span></span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">2</span>);</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">4</span>);</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">6</span>);</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    q.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;q.<span class="built_in">front</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;q.<span class="built_in">back</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä½¿ç”¨å“ˆå¸Œè¡¨å®ç°çš„ unordered_map é¡ºåºç”±å“ˆå¸Œå‡½æ•°è§„å®š</span></span><br><span class="line">    <span class="comment">//unordered_map é»˜è®¤ä½¿ç”¨ std::hash ä½œä¸ºå“ˆå¸Œå‡½æ•°</span></span><br><span class="line">    unordered_map&lt;string,<span class="type">int</span>&gt; hashtable;</span><br><span class="line">    hashtable[<span class="string">&quot;apple&quot;</span>] = <span class="number">10</span>;</span><br><span class="line">    hashtable[<span class="string">&quot;banana&quot;</span>] = <span class="number">4</span>;</span><br><span class="line">    hashtable[<span class="string">&quot;pear&quot;</span>]  = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> p = hashtable.<span class="built_in">begin</span>();p!=hashtable.<span class="built_in">end</span>();p++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;p-&gt;first&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;p-&gt;second&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä½¿ç”¨å“ˆå¸Œè¡¨å®ç°çš„ unordered_set</span></span><br><span class="line">    unordered_set&lt;<span class="type">int</span>&gt; mySet;</span><br><span class="line">    <span class="comment">// æ’å…¥å…ƒç´ </span></span><br><span class="line">    mySet.<span class="built_in">insert</span>(<span class="number">10</span>);</span><br><span class="line">    mySet.<span class="built_in">insert</span>(<span class="number">20</span>);</span><br><span class="line">    mySet.<span class="built_in">insert</span>(<span class="number">30</span>);</span><br><span class="line">    mySet.<span class="built_in">insert</span>(<span class="number">10</span>); <span class="comment">// é‡å¤å…ƒç´ ä¸ä¼šæ’å…¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥å…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> (mySet.<span class="built_in">find</span>(<span class="number">20</span>) != mySet.<span class="built_in">end</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;20 is in the set.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†å…ƒç´  å…ƒç´ é¡ºåºç”±å†…éƒ¨å“ˆå¸Œå‡½æ•°å†³å®š</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="type">int</span>&amp; num : mySet) &#123;</span><br><span class="line">        cout &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="5-2-ç®—æ³•åº“"><a href="#5-2-ç®—æ³•åº“" class="headerlink" title="5.2 ç®—æ³•åº“"></a><strong>5.2 ç®—æ³•åº“</strong></h3><h4 id="5-2-1-std-sort"><a href="#5-2-1-std-sort" class="headerlink" title="5.2.1 std::sort"></a><strong>5.2.1 <code>std::sort</code></strong></h4><p>æ’åºå®¹å™¨ä¸­çš„å…ƒç´ ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>()); <span class="comment">// å‡åºæ’åº</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> x : vec) &#123;</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 1 3 4 5</span><br></pre></td></tr></table></figure><hr><h3 id="5-3-C-11-æ–°ç‰¹æ€§"><a href="#5-3-C-11-æ–°ç‰¹æ€§" class="headerlink" title="5.3 C++11 æ–°ç‰¹æ€§"></a><strong>5.3 C++11 æ–°ç‰¹æ€§</strong></h3><h4 id="5-3-1-auto-å…³é”®å­—"><a href="#5-3-1-auto-å…³é”®å­—" class="headerlink" title="5.3.1 auto å…³é”®å­—"></a><strong>5.3.1 <code>auto</code> å…³é”®å­—</strong></h4><p>è‡ªåŠ¨æ¨æ–­å˜é‡ç±»å‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> x = <span class="number">10</span>;  <span class="comment">// æ¨æ–­ä¸º int</span></span><br><span class="line"><span class="keyword">auto</span> y = <span class="number">3.14</span>; <span class="comment">// æ¨æ–­ä¸º double</span></span><br></pre></td></tr></table></figure><h4 id="5-3-2-Lambda-è¡¨è¾¾å¼c"><a href="#5-3-2-Lambda-è¡¨è¾¾å¼c" class="headerlink" title="5.3.2 Lambda è¡¨è¾¾å¼c"></a><strong>5.3.2 Lambda è¡¨è¾¾å¼c</strong></h4><p>å®šä¹‰åŒ¿åå‡½æ•°çš„æ–¹å¼ï¼Œé€‚åˆè½»é‡çº§æ“ä½œã€‚</p><p><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[æ•è·åˆ—è¡¨](å‚æ•°åˆ—è¡¨) -&gt; è¿”å›ç±»å‹ &#123; å‡½æ•°ä½“ &#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    for_each(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>(), [&amp;sum](<span class="type">int</span> x) &#123; sum += x; &#125;);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; sum &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sum: 15</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸²</title>
      <link href="/2024/11/25/%E4%B8%B2/"/>
      <url>/2024/11/25/%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸²çš„è¡¨ç¤ºå’Œå®ç°"><a href="#ä¸²çš„è¡¨ç¤ºå’Œå®ç°" class="headerlink" title="ä¸²çš„è¡¨ç¤ºå’Œå®ç°"></a>ä¸²çš„è¡¨ç¤ºå’Œå®ç°</h2><h3 id="å®šé•¿é¡ºåºå­˜å‚¨"><a href="#å®šé•¿é¡ºåºå­˜å‚¨" class="headerlink" title="å®šé•¿é¡ºåºå­˜å‚¨"></a>å®šé•¿é¡ºåºå­˜å‚¨</h3><p>ç›´æ¥å®šä¹‰æ•°ç»„ Sstring[MAXSTRLEN+1]</p><h3 id="å †åˆ†é…å­˜å‚¨"><a href="#å †åˆ†é…å­˜å‚¨" class="headerlink" title="å †åˆ†é…å­˜å‚¨"></a>å †åˆ†é…å­˜å‚¨</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">char</span> *ch;</span><br><span class="line"><span class="type">int</span> lenth;</span><br><span class="line">&#125;HString;</span><br></pre></td></tr></table></figure><h3 id="å—é“¾å­˜å‚¨"><a href="#å—é“¾å­˜å‚¨" class="headerlink" title="å—é“¾å­˜å‚¨"></a>å—é“¾å­˜å‚¨</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125090558654.png" alt="image-20241125090558654"></p><p>å—é“¾å­˜å‚¨çš„å®ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> CHUNKSIZE 80</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Chunk</span> //ç»“ç‚¹ç»“æ„</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">char</span> ch[CHUNKSIZE];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Chunk</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;Chunk;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Chunk *head,*tail;</span><br><span class="line">    <span class="type">int</span> curlen; </span><br><span class="line">&#125;LString;</span><br></pre></td></tr></table></figure><h2 id="åŒ¹é…æ¨¡å¼ç®—æ³•"><a href="#åŒ¹é…æ¨¡å¼ç®—æ³•" class="headerlink" title="åŒ¹é…æ¨¡å¼ç®—æ³•"></a>åŒ¹é…æ¨¡å¼ç®—æ³•</h2><h3 id="ç®€å•åŒ¹é…æ¨¡å¼ç®—æ³•"><a href="#ç®€å•åŒ¹é…æ¨¡å¼ç®—æ³•" class="headerlink" title="ç®€å•åŒ¹é…æ¨¡å¼ç®—æ³•"></a>ç®€å•åŒ¹é…æ¨¡å¼ç®—æ³•</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125091001386.png" alt="image-20241125091001386"></p><p>ç®€å•æ¥è¯´ï¼š</p><ul><li>ç¬¬ä¸€æ­¥ï¼Œä»å¤´å¼€å§‹æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²</li><li>å¦‚æœçŸ­çš„é‚£ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒå®Œäº†ï¼Œå¹¶ä¸”æ²¡æœ‰å‡ºç°ä¸ç­‰çš„æƒ…å†µï¼Œè¯´æ˜å·²ç»åŒ¹é…æˆåŠŸ</li><li>å¦‚æœè¯´å‡ºç°äº†S[i] !&#x3D; T[j]çš„æƒ…å†µï¼Œè¯´æ˜åœ¨è¿™ä¸ªä½ç½®ï¼Œå‡ºç°äº†åŒ¹é…å¤±è´¥ï¼Œäºæ˜¯è¿›è¡Œä¸‹ä¸€æ­¥</li><li>å­—ä¸²Té‡æ–°å¼€å§‹ä»ç¬¬ä¸€ä¸ªå…ƒç´ æ¯”è¾ƒï¼Œä¸»ä¸²Sä»ä¸Šä¸€æ¬¡å¼€å§‹æ¯”è¾ƒçš„å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹æ¯”è¾ƒ</li><li>ç”¨ç¨‹åºè¡¨è¾¾å°±æ˜¯ï¼ŒSä»i-j+2é‡æ–°å¼€å§‹æ¯”è¾ƒï¼Œtä»j &#x3D; 0é‡æ–°å¼€å§‹æ¯”è¾ƒ</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSTRLEN 255</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span> Sstring[MAXSTELEN+<span class="number">1</span>]</span><br><span class="line"><span class="type">int</span> <span class="title function_">index</span><span class="params">(Sstring S,Sstring T,<span class="type">int</span> pos)</span><span class="comment">//ä¼ å…¥çš„posä»£è¡¨æƒ³è¦ä»ä¸»ä¸²çš„ç¬¬å‡ ä¸ªä½ç½®å¼€å§‹æ¯”è¾ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">i = pos;</span><br><span class="line">    j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=S[<span class="number">0</span>] &amp;&amp; j&lt;=T[<span class="number">0</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==T[j])</span><br><span class="line">        &#123;</span><br><span class="line">            ++i;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">//é‡æ–°å¼€å§‹åŒ¹é…</span></span><br><span class="line">        &#123;</span><br><span class="line">            i=i-j+<span class="number">2</span>;</span><br><span class="line">            j = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(j&gt;T[<span class="number">0</span>])</span><br><span class="line">    &#123;<span class="keyword">return</span> i-T[<span class="number">0</span>];&#125; <span class="comment">//è¿”å›ä½ç½®</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦</p><p>æœ€å¥½ï¼š ä¸€æ¬¡æˆåŠŸ -&gt; O(m+n)</p><p>æœ€åï¼š æœ€åä¸€æ¬¡æˆåŠŸ -&gt; O(m*n)</p><h3 id="KMPç®—æ³•"><a href="#KMPç®—æ³•" class="headerlink" title="KMPç®—æ³•"></a>KMPç®—æ³•</h3><p><strong>æ ¸å¿ƒæ€æƒ³ï¼šä¸»ä¸²æŒ‡é’ˆä¸å›æº¯ï¼Œæ¨¡å¼ä¸²å‘åæ»‘åŠ¨è‡³æŸä¸ªä½ç½®ä¸Š</strong></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125105804817.png" alt="image-20241125105804817"></p><ul><li>ä¸€ä¸ªä¸»ä¸²ï¼Œä¸”ä¸»ä¸²ä¸å›æº¯</li><li>ä¸€ä¸ªå­—ä¸²ï¼Œä¸”å­—ä¸²çš„æ¯ä¸ªå…ƒç´ ä¼´éšç€nextæ•°ç»„çš„ä¸€ä¸ªå€¼</li><li>nextæ•°ç»„çš„æ„ä¹‰æ˜¯ï¼Œå½“åŒ¹é…å¤±è´¥çš„æ—¶å€™ï¼Œä¸‹ä¸€æ¬¡åŒ¹é…å¯ä»¥è·³è¿‡çš„å­—ç¬¦ä¸ªæ•°</li><li>nextæ•°ç»„çš„æ±‚æ³•ï¼Œæ˜¯å½“å‰å…ƒç´ åŠä¹‹å‰å…ƒç´ æ„æˆçš„å­—ç¬¦ä¸²ä¸­ï¼Œå‰åå…ƒç´ ä¸€è‡´çš„å…ƒç´ ä¸ªæ•°</li><li>æ±‚nextæ•°ç»„ï¼Œä½¿ç”¨é€’å½’çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ï¼Œç°åœ¨æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ ä¸€è‡´ï¼Œç°åœ¨è¯»å–ç¬¬å››ä¸ªå…ƒç´ ï¼Œæƒ³è¦åˆ¤æ–­å‰ä¸¤ä¸ªå’Œåä¸¤ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯ç›¸ç­‰çš„ï¼Œåªéœ€è¦åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ å’Œç¬¬ä¸‰ä¸ªå…ƒç´ ç›¸åŒçš„åŸºç¡€ä¸Šå†åˆ¤æ–­ç¬¬äºŒä¸ªå…ƒç´ å’Œç¬¬å››ä¸ªå…ƒç´ ç›¸ç­‰ä¸å¦ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šäº§ç”Ÿä¸¤ç§ç»“æœï¼š</li><li>ç»“æœä¸€ ï¼š å…ƒç´ 2 å’Œå…ƒç´ 4ç›¸ç­‰ï¼Œé‚£ä¹ˆç¬¬å››ä¸ªå…ƒç´ çš„nextæ•°ç»„å€¼å°±æ˜¯2</li><li>ç»“æœäºŒï¼š å…ƒç´ äºŒå’Œå…ƒç´ 4ä¸ç›¸ç­‰,é‚£ä¹ˆå¼€å§‹å¯»æ‰¾æ›´çŸ­çš„</li><li>åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»åˆ¤æ–­äº†ä¸€æ®µå‰åç¼€æ˜¯ç›¸ç­‰çš„ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªéšè—æ¡ä»¶ï¼Œå°±æ˜¯è¿™ä¸€å¯¹å‰åç¼€è‡ªå·±çš„å‰åç¼€ä¸å¯¹æ–¹çš„ä½¿å®Œå…¨ç›¸ç­‰çš„ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºä¸Šä¸€æ¬¡çš„å‰ç¼€è‡ªèº«çš„å‰åç¼€ï¼Œä»–ä»¬å°±æ˜¯<strong>å¯ä»¥å‡†å¤‡ç”¨äºæ·»åŠ æ–°å…ƒç´ åè¿›è¡Œåˆ¤æ–­æ˜¯å¦ä¸ºæ–°å‰åç¼€</strong>çš„ä¸€å¯¹å‰åç¼€</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125115306013.png" alt="image-20241125115306013"></p><p>æ¯”å¦‚è¿™ä¸ªï¼Œaba å’Œ aba æ˜¯å·²æœ‰çš„å‰åç¼€ï¼ŒåŠ ä¸Šbä»¥åï¼Œä¸å‰é¢çš„cä¸ä¸€è‡´ï¼Œäº§ç”Ÿå†²çª</p><ul><li>å¯¹abaæ‰¾å‰åç¼€ï¼Œæ ¹æ®nextæ•°ç»„ï¼Œå¯çŸ¥é•¿åº¦ä¸º1ï¼Œå³åªæœ‰aä¸€ä¸ª</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125115437507.png" alt="image-20241125115437507"></p><ul><li>ä¸‹é¢å†å¯¹ä¸¤ä¸ªaåé¢ä¸¤ä¸ªå…ƒç´ </li></ul><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><h5 id="è®¡ç®—nextæ•°ç»„"><a href="#è®¡ç®—nextæ•°ç»„" class="headerlink" title="è®¡ç®—nextæ•°ç»„"></a>è®¡ç®—nextæ•°ç»„</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">build_next</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s, <span class="type">int</span> *next)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(s); <span class="comment">// å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    next[<span class="number">0</span>] = <span class="number">0</span>;       <span class="comment">// åˆå§‹åŒ–ç¬¬ä¸€ä¸ªä½ç½®ä¸º 0</span></span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;         <span class="comment">// j æŒ‡å‘å‰ç¼€çš„æœ«å°¾</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="comment">// ä¸åŒ¹é…æ—¶å›é€€</span></span><br><span class="line">        <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j]) &#123;</span><br><span class="line">            j = next[j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœåŒ¹é…ï¼Œå‰ç¼€é•¿åº¦åŠ  1</span></span><br><span class="line">        <span class="keyword">if</span> (s[i] == s[j]) &#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        next[i] = j; <span class="comment">// è®°å½•å½“å‰ä½ç½®çš„ next å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/11/13/%E6%95%B0%E7%94%B5%E9%9B%B6%E5%9F%BA%E7%A1%80%E9%80%9F%E9%80%9A/"/>
      <url>/2024/11/13/%E6%95%B0%E7%94%B5%E9%9B%B6%E5%9F%BA%E7%A1%80%E9%80%9F%E9%80%9A/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¸é-ä¸éå¼ã€‚"><a href="#ä¸é-ä¸éå¼ã€‚" class="headerlink" title="ä¸é-ä¸éå¼ã€‚"></a>ä¸é-ä¸éå¼ã€‚</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imged670f44e36b6fb5c2d2c3acc0a8d31.png" alt="ed670f44e36b6fb5c2d2c3acc0a8d31"><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_img5b4d8c8c55aa5cec97ba996689a9399.png" alt="5b4d8c8c55aa5cec97ba996689a9399"></p><p>æ–¹æ³•æŠ€å·§ï¼šç”¨äºŒæ¬¡æ±‚åï¼Œå¼•å…¥åæ¼”å¾‹</p><h4 id="è½¬ä¸ºä¸æˆ–éï¼š"><a href="#è½¬ä¸ºä¸æˆ–éï¼š" class="headerlink" title="è½¬ä¸ºä¸æˆ–éï¼š"></a>è½¬ä¸ºä¸æˆ–éï¼š</h4><p>å…ˆæ±‚åå‡½æ•°ï¼Œåœ¨æ•´ä½“å–å</p><p>æ±‚åå‡½æ•°å¯ä»¥åœ¨å¡è¯ºå›¾ä¸­åœˆ0</p><h4 id="è½¬ä¸ºæˆ–éæˆ–é"><a href="#è½¬ä¸ºæˆ–éæˆ–é" class="headerlink" title="è½¬ä¸ºæˆ–éæˆ–é"></a>è½¬ä¸ºæˆ–éæˆ–é</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113171330964.png" alt="image-20241113171330964"></p><p>æœ€å¤§é¡¹ä¹‹ç§¯ å–åä¸¤æ¬¡å³å¯</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113180818326.png" alt="image-20241113180818326"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113181223584.png" alt="image-20241113181223584"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113182327370.png" alt="image-20241113182327370"></p><p><strong>æ±‚æœ€å°é¡¹ä¹‹å’Œçš„å¯¹å¶å¼ï¼Œå˜æˆæœ€å¤§é¡¹ä¹‹ç§¯ï¼Œé‡Œé¢çš„é¡¹çš„ä¸‹æ ‡ä¸º2çš„næ¬¡æ–¹å‡iå‡1</strong></p><h3 id="ç¬¬ä¸‰ç« "><a href="#ç¬¬ä¸‰ç« " class="headerlink" title="ç¬¬ä¸‰ç« "></a>ç¬¬ä¸‰ç« </h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113192709243.png" alt="image-20241113192709243"></p><p>npn,æŒ‡å‘åŸºæï¼Œpnpï¼ŒæŒ‡å‡ºåŸºæï¼ˆç±»æ¯”mosç®¡è®°å¿†ï¼Œmosç®¡ä¸­ï¼Œpæ²Ÿé“å‹æŒ‡å‡ºgateï¼Œnæ²Ÿé“å‹æŒ‡å‡ºgateï¼‰</p><p>ä¸‰æç®¡å·¥ä½œçŠ¶æ€:</p><p>åŸºæå’Œå‘å°„åŸºä¹‹é—´å½¢æˆè¾“å…¥å›è·¯ï¼Œä½†ç”µè·¯ä¸­å®é™…ä¸Šä½¿ç”¨çš„æ˜¯ceï¼ˆä¹Ÿå°±æ˜¯é›†ç”µæå’Œå‘å°„åŸºï¼‰ä¹‹é—´çš„ç”µæµå›è·¯</p><p>è¿™ä¸ªå›¾çš„ä¿¡æ¯ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113193307206.png" alt="image-20241113193307206"></p><ul><li>å‘å°„ç»“ï¼Œé›†ç”µç»“ çš„æ­£ååæŒ‡çš„æ˜¯ bç›¸å¯¹äºcå’Œeçš„ç”µå‹ </li><li>å½“bç”µå‹å¤§äºcå’Œeçš„æ—¶å€™ï¼Œç›´æ¥é¥±å’Œï¼Œé¥±å’Œçš„å«ä¹‰å°±æ˜¯ ic ä¸ä¼šå†å¢å¤§ï¼Œå› ä¸ºç”µå‹å·²ç»æ¯”bå°äº†</li><li>å½“bçš„ç”µå‹å¤§äºeï¼Œå¹¶ä¸”bçš„ç”µå‹å°äºcçš„æ—¶å€™ï¼Œæ²¡é¥±å’Œï¼Œæ­£åœ¨æ”¾å¤§</li><li>å½“bçš„ç”µå‹å°äºäºŒè€…ï¼Œç›´æ¥æˆªè‡³</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113192322430.png" alt="image-20241113192322430"></p><p>nmosæŒ‡å‘gate</p><p>pmosæŒ‡å‡ºgate</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113194438607.png" alt="image-20241113194438607"></p><p>Gæ(gate)â€”æ …æï¼Œä¸ç”¨è¯´æ¯”è¾ƒå¥½è®¤<br>Sæ(source)â€”æºæï¼Œä¸è®ºæ˜¯Pæ²Ÿé“è¿˜æ˜¯Næ²Ÿé“ï¼Œä¸¤æ ¹çº¿ç›¸äº¤çš„å°±æ˜¯<br>Dæ(drain)â€”æ¼æï¼Œä¸è®ºæ˜¯Pæ²Ÿé“è¿˜æ˜¯Næ²Ÿé“ï¼Œæ˜¯å•ç‹¬å¼•çº¿çš„é‚£è¾¹</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113194452674.png" alt="image-20241113194452674"></p><p> <strong>å¯¼é€š</strong>ç”µæµæ–¹å‘çš„åˆ¤æ–­ï¼š<strong>èƒ½ä¸ä¸­é—´é‚£ä¸ªç®­å¤´å½¢æˆé—­ç¯</strong></p><p>å¼€å…³ç‰¹æ€§:</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241113200142586.png" alt="image-20241113200142586"></p><p>nmos gate<strong>é«˜ç”µå¹³å¯¼é€š</strong></p><p>pmos  gate<strong>ä½ç”µå¹³å¯¼é€š</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>stm32å­¦ä¹ ç¬”è®°004</title>
      <link href="/2024/11/02/stm3204/"/>
      <url>/2024/11/02/stm3204/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šADC-é‡‡æ ·å¹¶é€šè¿‡ä¸²â¼å‘é€â¾„ä¸Šä½æœº"><a href="#ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šADC-é‡‡æ ·å¹¶é€šè¿‡ä¸²â¼å‘é€â¾„ä¸Šä½æœº" class="headerlink" title="ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šADC é‡‡æ ·å¹¶é€šè¿‡ä¸²â¼å‘é€â¾„ä¸Šä½æœº"></a>ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šADC é‡‡æ ·å¹¶é€šè¿‡ä¸²â¼å‘é€â¾„ä¸Šä½æœº</h2><h3 id="ADCç®€ä»‹"><a href="#ADCç®€ä»‹" class="headerlink" title="ADCç®€ä»‹"></a>ADCç®€ä»‹</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102110242914.png" alt="image-20241102110242914"></p><h3 id="ADCåŸç†ï¼ˆé€æ¬¡æ¯”è¾ƒå‹ï¼‰"><a href="#ADCåŸç†ï¼ˆé€æ¬¡æ¯”è¾ƒå‹ï¼‰" class="headerlink" title="ADCåŸç†ï¼ˆé€æ¬¡æ¯”è¾ƒå‹ï¼‰"></a>ADCåŸç†ï¼ˆé€æ¬¡æ¯”è¾ƒå‹ï¼‰</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102110346796.png" alt="image-20241102110346796"></p><h4 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h4><ol><li><p><strong>åˆå§‹åŒ–</strong>ï¼š</p><p>é€‰æ‹©è¾“å…¥ä¿¡å·å¹¶è®¾ç½®å‚è€ƒç”µå‹ã€‚</p></li><li><p><strong>é‡‡æ ·</strong>ï¼š</p><p>ADC è¯»å–è¾“å…¥æ¨¡æ‹Ÿä¿¡å·ï¼Œå¹¶åœ¨é‡‡æ ·ä¿æŒç”µè·¯ä¸­ä¿æŒè¯¥å€¼ã€‚</p></li><li><p><strong>é€æ¬¡æ¯”è¾ƒ</strong>ï¼š</p><p>ADC å¼€å§‹è¿›è¡Œé€æ¬¡æ¯”è¾ƒï¼Œå°†è¾“å…¥ä¿¡å·ä¸å†…éƒ¨çš„æ•°å­—åŒ–å€¼è¿›è¡Œæ¯”è¾ƒã€‚è¿™ä¸ªè¿‡ç¨‹é€šè¿‡ä¸€ä¸ªé€æ¬¡é€¼è¿‘å¯„å­˜å™¨å®ç°ã€‚</p><p>è®¾å®šä¸€ä¸ªåˆå§‹çš„æ•°å­—å€¼ï¼ˆé€šå¸¸æ˜¯ä¸­é—´å€¼ï¼‰ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºæ¨¡æ‹Ÿä¿¡å·ï¼ˆDAC è¾“å‡ºï¼‰ï¼Œå¹¶ä¸è¾“å…¥ä¿¡å·è¿›è¡Œæ¯”è¾ƒã€‚</p></li><li><p><strong>æ¯”è¾ƒç»“æœ</strong>ï¼š</p><p>å¦‚æœ DAC è¾“å‡ºçš„æ¨¡æ‹Ÿä¿¡å·å¤§äºè¾“å…¥ä¿¡å·ï¼Œåˆ™è¯¥ä½ä¸º 0ï¼›å¦‚æœå°äºï¼Œåˆ™è¯¥ä½ä¸º 1ã€‚æ ¹æ®æ¯”è¾ƒç»“æœï¼ŒSAR æ›´æ–°å…¶å½“å‰çš„æ•°å­—å€¼ã€‚</p><p>é€ä½æ¯”è¾ƒè¿‡ç¨‹ä»æœ€é«˜ä½åˆ°æœ€ä½ä½è¿›è¡Œï¼Œé€æ¬¡ç¡®å®šæ¯ä¸€ä½çš„å€¼ã€‚</p></li><li><p><strong>é‡å¤è¿‡ç¨‹</strong>ï¼š</p><p>é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰ä½éƒ½ç¡®å®šä¸ºæ­¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé€æ¬¡æ¯”è¾ƒå‹ ADC çš„è½¬æ¢è¿‡ç¨‹éœ€è¦ N æ¬¡æ¯”è¾ƒï¼Œå…¶ä¸­ N æ˜¯ ADC çš„åˆ†è¾¨ç‡ï¼ˆä½æ•°ï¼‰ã€‚</p></li><li><p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p><p>ä¸€æ—¦æ‰€æœ‰ä½éƒ½ç¡®å®šï¼Œè½¬æ¢ç»“æœå°±å­˜å‚¨åœ¨è¾“å‡ºå¯„å­˜å™¨ä¸­ï¼Œå¯ä»¥é€šè¿‡æ•°å­—æ¥å£è¯»å–ã€‚</p></li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102110819185.png" alt="image-20241102110819185"></p><h4 id="ADCåŸºæœ¬ç»“æ„"><a href="#ADCåŸºæœ¬ç»“æ„" class="headerlink" title="ADCåŸºæœ¬ç»“æ„"></a>ADCåŸºæœ¬ç»“æ„</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102111034836.png" alt="image-20241102111034836"></p><h3 id="ADCå››ç§å·¥ä½œæ¨¡å¼"><a href="#ADCå››ç§å·¥ä½œæ¨¡å¼" class="headerlink" title="ADCå››ç§å·¥ä½œæ¨¡å¼"></a>ADCå››ç§å·¥ä½œæ¨¡å¼</h3><ul><li>å•æ¬¡è½¬æ¢ï¼Œæ‰«æï¼šé…ç½®å¤šä¸ªé€šé“ï¼Œæ¯æ¬¡æ‰«æå¯ä»¥æ‰«æå¤šé€šé“ï¼Œä½†æ¯ä¸ªå¤§è¿‡ç¨‹éƒ½è¦ç”¨å‡½æ•°è§¦å‘</li><li>å•æ¬¡è½¬æ¢ï¼Œéæ‰«æï¼šé…ç½®å•ä¸ªåŒé€šé“ï¼Œæ¯æ¬¡æ‰«æéƒ½è¦ç”¨ä¸€ä¸ªå‡½æ•°è§¦å‘ä¸€æ¬¡</li><li>è¿ç»­è½¬æ¢ï¼Œæ‰«æï¼šé…ç½®å¤šä¸ªé€šé“ï¼Œè¿›è¡Œè¿ç»­æ‰«æï¼Œåªéœ€è§¦å‘ä¸€æ¬¡</li><li>è¿ç»­è½¬æ¢ï¼Œéæ‰«æï¼šé…ç½®ä¸€ä¸ªé€šé“ï¼Œåªæ‰«æä»–ï¼Œåªéœ€è§¦å‘ä¸€æ¬¡</li></ul><h3 id="è½¬æ¢æ—¶é—´"><a href="#è½¬æ¢æ—¶é—´" class="headerlink" title="è½¬æ¢æ—¶é—´"></a>è½¬æ¢æ—¶é—´</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102111751744.png" alt="image-20241102111751744"></p><h3 id="ç¨‹åºè®¾è®¡"><a href="#ç¨‹åºè®¾è®¡" class="headerlink" title="ç¨‹åºè®¾è®¡"></a>ç¨‹åºè®¾è®¡</h3><h4 id="ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼‰é¦–å…ˆæ˜¯é…ç½®adcåŠå…¶ä¸­æ–­ï¼š"><a href="#ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼‰é¦–å…ˆæ˜¯é…ç½®adcåŠå…¶ä¸­æ–­ï¼š" class="headerlink" title="ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼‰é¦–å…ˆæ˜¯é…ç½®adcåŠå…¶ä¸­æ–­ï¼š"></a>ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼‰é¦–å…ˆæ˜¯é…ç½®adcåŠå…¶ä¸­æ–­ï¼š</h4><h5 id="æ—¶é’Ÿé…ç½®"><a href="#æ—¶é’Ÿé…ç½®" class="headerlink" title="æ—¶é’Ÿé…ç½®"></a>æ—¶é’Ÿé…ç½®</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC3, ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC, ENABLE);</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤è¡Œä»£ç å¼€å¯äº† ADC3 å’Œ GPIOC çš„æ—¶é’Ÿã€‚åªæœ‰åœ¨æ—¶é’Ÿå¼€å¯åï¼ŒADC æ‰èƒ½å·¥ä½œ</p><h5 id="ADC-æ—¶é’Ÿåˆ†é¢‘"><a href="#ADC-æ—¶é’Ÿåˆ†é¢‘" class="headerlink" title="ADC æ—¶é’Ÿåˆ†é¢‘"></a>ADC æ—¶é’Ÿåˆ†é¢‘</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RCC_ADCCLKConfig(RCC_PCLK2_Div6);</span><br></pre></td></tr></table></figure><p>æ­¤è¡Œè®¾ç½® ADC çš„æ—¶é’Ÿåˆ†é¢‘ï¼Œ2å’Œ4ä¸èƒ½é€‰ï¼Œåªèƒ½ä»6å¼€å§‹é€‰</p><h5 id="GPIO-é…ç½®"><a href="#GPIO-é…ç½®" class="headerlink" title="GPIO é…ç½®"></a>GPIO é…ç½®</h5><p>å°† ADC çš„è¾“å…¥å¼•è„šé…ç½®ä¸ºæ¨¡æ‹Ÿè¾“å…¥æ¨¡å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_8 | GPIO_Pin_9;</span><br><span class="line">GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé…ç½®äº† GPIOC çš„ 6 åˆ° 9 å¼•è„šä¸ºæ¨¡æ‹Ÿè¾“å…¥ï¼Œä»¥ä¾¿ ADC å¯ä»¥è¯»å–è¿™äº›å¼•è„šä¸Šçš„ç”µå‹ä¿¡å·ã€‚</p><h5 id="ADC-é…ç½®"><a href="#ADC-é…ç½®" class="headerlink" title="ADC é…ç½®"></a>ADC é…ç½®</h5><p>ä½¿ç”¨ <code>ADC_InitTypeDef</code> ç»“æ„ä½“é…ç½® ADC å‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ADC_InitTypeDef ADC_InitStructure;</span><br><span class="line">ADC_InitStructure.ADC_Mode = ADC_Mode_Independent;</span><br><span class="line">ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right;</span><br><span class="line">ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_None;</span><br><span class="line">ADC_InitStructure.ADC_ContinuousConvMode = DISABLE;</span><br><span class="line">ADC_InitStructure.ADC_ScanConvMode = DISABLE;</span><br><span class="line">ADC_InitStructure.ADC_NbrOfChannel = 1;</span><br><span class="line">ADC_Init(ADC3, &amp;ADC_InitStructure);</span><br></pre></td></tr></table></figure><ul><li><strong>ç‹¬ç«‹æ¨¡å¼</strong>ï¼šè¡¨ç¤ºæ­¤ ADC ä¸ä¸å…¶ä»– ADC å…±äº«å·¥ä½œã€‚</li><li><strong>æ•°æ®å¯¹é½</strong>ï¼šé€‰æ‹©æ•°æ®å³å¯¹é½ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°å¤„ç†å’Œè§£æç»“æœã€‚</li><li><strong>å¤–éƒ¨è§¦å‘</strong>ï¼šè¿™é‡Œè®¾ç½®ä¸ºæ— å¤–éƒ¨è§¦å‘ï¼Œè¡¨ç¤ºä½¿ç”¨è½¯ä»¶è§¦å‘è¿›è¡Œè½¬æ¢ã€‚</li><li><strong>è¿ç»­è½¬æ¢</strong>ï¼šè®¾ç½®ä¸ºç¦ç”¨ï¼Œè¿™æ · ADC åªåœ¨æ¯æ¬¡è½¯ä»¶è§¦å‘æ—¶è¿›è¡Œä¸€æ¬¡è½¬æ¢ã€‚</li><li><strong>æ‰«ææ¨¡å¼</strong>ï¼šè®¾ç½®ä¸ºç¦ç”¨ï¼Œè¡¨ç¤ºåªé…ç½®å•ä¸ªé€šé“è¿›è¡Œè½¬æ¢ã€‚</li></ul><h5 id="ä½¿èƒ½-ADC-å’Œæ ¡å‡†"><a href="#ä½¿èƒ½-ADC-å’Œæ ¡å‡†" class="headerlink" title="ä½¿èƒ½ ADC å’Œæ ¡å‡†"></a>ä½¿èƒ½ ADC å’Œæ ¡å‡†</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ADC_Cmd(ADC3, ENABLE);</span><br><span class="line">ADC_ResetCalibration(ADC3);</span><br><span class="line">while (ADC_GetResetCalibrationStatus(ADC3) == SET);</span><br><span class="line">ADC_StartCalibration(ADC3);</span><br><span class="line">while (ADC_GetCalibrationStatus(ADC3) == SET);</span><br></pre></td></tr></table></figure><p>è¿™äº›ä»£ç æ®µä½¿èƒ½ ADCï¼Œå¹¶è¿›è¡Œæ ¡å‡†ä»¥ç¡®ä¿æµ‹é‡çš„å‡†ç¡®æ€§ã€‚æ ¡å‡†è¿‡ç¨‹åŒ…æ‹¬é‡ç½®æ ¡å‡†çŠ¶æ€å’Œå¼€å§‹æ ¡å‡†ã€‚</p><h5 id="ä¸­æ–­é…ç½®"><a href="#ä¸­æ–­é…ç½®" class="headerlink" title="ä¸­æ–­é…ç½®"></a>ä¸­æ–­é…ç½®</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = ADC3_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line">ADC_ITConfig(ADC3, ADC_IT_EOC, ENABLE);</span><br></pre></td></tr></table></figure><ul><li><strong>EOC ä¸­æ–­</strong>ï¼šä½¿èƒ½ EOC ä¸­æ–­ï¼Œè¿™æ · ADC è½¬æ¢å®Œæˆæ—¶ä¼šè§¦å‘ä¸­æ–­</li></ul><h5 id="æ•°æ®è¯»å–å’Œå¤„ç†"><a href="#æ•°æ®è¯»å–å’Œå¤„ç†" class="headerlink" title="æ•°æ®è¯»å–å’Œå¤„ç†"></a>æ•°æ®è¯»å–å’Œå¤„ç†</h5><h6 id="å¯åŠ¨-ADC-è½¬æ¢"><a href="#å¯åŠ¨-ADC-è½¬æ¢" class="headerlink" title="å¯åŠ¨ ADC è½¬æ¢"></a>å¯åŠ¨ ADC è½¬æ¢</h6><p>åœ¨ <code>AD_GetValue</code> å‡½æ•°ä¸­ï¼Œé€‰æ‹©é€šé“å¹¶å¯åŠ¨è½¬æ¢ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_5, 1, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_SoftwareStartConvCmd(ADC3, ENABLE);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ ¹æ®è¾“å…¥å‚æ•°é…ç½®è¦è¯»å–çš„ ADC é€šé“ï¼Œå¹¶é€šè¿‡è½¯ä»¶è§¦å‘å¼€å§‹è½¬æ¢ã€‚<code>ADC_SampleTime_55Cycles5</code> è¡¨ç¤ºé‡‡æ ·æ—¶é—´ä¸º 55.5 ä¸ª ADC æ—¶é’Ÿå‘¨æœŸï¼Œè¿™æ˜¯ä¸€ä¸ªå½±å“è½¬æ¢é€Ÿåº¦å’Œç²¾åº¦çš„å‚æ•°ã€‚</p><h5 id="ä¸­æ–­æœåŠ¡ä¾‹ç¨‹"><a href="#ä¸­æ–­æœåŠ¡ä¾‹ç¨‹" class="headerlink" title="ä¸­æ–­æœåŠ¡ä¾‹ç¨‹"></a>ä¸­æ–­æœåŠ¡ä¾‹ç¨‹</h5><p>ä¸­æ–­æœåŠ¡ä¾‹ç¨‹è´Ÿè´£å¤„ç† ADC è½¬æ¢å®Œæˆçš„äº‹ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">void ADC3_IRQHandler(void)</span><br><span class="line">&#123;</span><br><span class="line">    if (ADC_GetITStatus(ADC3, ADC_IT_EOC) != RESET)</span><br><span class="line">    &#123;</span><br><span class="line">        adc_value = ADC_GetConversionValue(ADC3);</span><br><span class="line">        adc_ready = 1;</span><br><span class="line">        ADC_ClearITPendingBit(ADC3, ADC_IT_EOC);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>æ£€æŸ¥ EOC æ ‡å¿—</strong>ï¼šå¦‚æœ EOC ä¸­æ–­è¢«è§¦å‘ï¼Œåˆ™è¯»å– ADC è½¬æ¢ç»“æœï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ <code>adc_value</code> ä¸­</li><li><strong>æ¸…é™¤ä¸­æ–­æ ‡å¿—</strong>ï¼šæ¸…é™¤ä¸­æ–­æ ‡å¿—ä»¥ä¾¿ä¸‹æ¬¡è§¦å‘ã€‚</li></ul><h4 id="é…ç½®è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªç‚¹ï¼š"><a href="#é…ç½®è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªç‚¹ï¼š" class="headerlink" title="é…ç½®è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªç‚¹ï¼š"></a>é…ç½®è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªç‚¹ï¼š</h4><ul><li><p>å› ä¸ºæ˜¯å•æ¬¡è½¬æ¢ï¼Œéè¿ç»­æ¨¡å¼ï¼Œæ‰€ä»¥æƒ³è®©å®ƒæŒç»­å·¥ä½œï¼Œæ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶éƒ½è¦æ‰‹åŠ¨</p><p>ADC_SoftwareStartConvCmd(ADC3, ENABLE)ä¸€æ¬¡</p></li><li><p>å› ä¸ºç¨‹åºæ²¡æœ‰ç”¨åˆ°dmaï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨å•é€šé“ï¼Œå¦åˆ™æ•°æ®æ‘ä¸è¿‡æ¥ï¼Œå› æ­¤å°±ç”¨å››ä¸ªé€šé“å‘¨æœŸæ€§æ‰«æçš„æ–¹å¼æ¥å®Œæˆ</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>        <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="type">uint32_t</span> mytime = <span class="number">0</span>;</span><br><span class="line"><span class="type">uint32_t</span> last_time = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint16_t</span> adc_value = <span class="number">0</span>; <span class="comment">// ç”¨äºä¿å­˜ ADC è¯»å–çš„å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">AD_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC3, ENABLE); <span class="comment">// å¼€å¯ ADC3 çš„æ—¶é’Ÿ</span></span><br><span class="line">    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC, ENABLE); <span class="comment">// å¼€å¯ GPIOC çš„æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">    RCC_ADCCLKConfig(RCC_PCLK2_Div6); <span class="comment">// é€‰æ‹©æ—¶é’Ÿ 6 åˆ†é¢‘ï¼ŒADCCLK = 72MHz / 6 = 12MHz</span></span><br><span class="line"></span><br><span class="line">    GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;</span><br><span class="line">    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_8 | GPIO_Pin_9;</span><br><span class="line">    GPIO_Init(GPIOC, &amp;GPIO_InitStructure); <span class="comment">// æ¨¡æ‹Ÿè¾“å…¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ADC åˆå§‹åŒ–</span></span><br><span class="line">    ADC_InitTypeDef ADC_InitStructure;</span><br><span class="line">    ADC_InitStructure.ADC_Mode = ADC_Mode_Independent; <span class="comment">// æ¨¡å¼ï¼Œé€‰æ‹©ç‹¬ç«‹æ¨¡å¼</span></span><br><span class="line">    ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right; <span class="comment">// æ•°æ®å¯¹é½ï¼Œé€‰æ‹©å³å¯¹é½</span></span><br><span class="line">    ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_None; <span class="comment">// å¤–éƒ¨è§¦å‘ï¼Œä½¿ç”¨è½¯ä»¶è§¦å‘</span></span><br><span class="line">    ADC_InitStructure.ADC_ContinuousConvMode = DISABLE; <span class="comment">// è¿ç»­è½¬æ¢ï¼Œå¤±èƒ½</span></span><br><span class="line">    ADC_InitStructure.ADC_ScanConvMode = DISABLE; <span class="comment">// æ‰«ææ¨¡å¼ï¼Œå¤±èƒ½</span></span><br><span class="line">    ADC_InitStructure.ADC_NbrOfChannel = <span class="number">1</span>; <span class="comment">// é€šé“æ•°ä¸º 1</span></span><br><span class="line">    ADC_Init(ADC3, &amp;ADC_InitStructure);</span><br><span class="line"></span><br><span class="line">    ADC_Cmd(ADC3, ENABLE); <span class="comment">// ä½¿èƒ½ ADC3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ADC æ ¡å‡†</span></span><br><span class="line">    ADC_ResetCalibration(ADC3); <span class="comment">// å›ºå®šæµç¨‹</span></span><br><span class="line">    <span class="keyword">while</span> (ADC_GetResetCalibrationStatus(ADC3) == SET);</span><br><span class="line">    ADC_StartCalibration(ADC3);</span><br><span class="line">    <span class="keyword">while</span> (ADC_GetCalibrationStatus(ADC3) == SET);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½® ADC ä¸­æ–­</span></span><br><span class="line">    NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannel = ADC3_IRQn;<span class="comment">// ç¡®ä¿æ˜¯ ADC3 çš„ä¸­æ–­</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>;</span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">    NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line">    ADC_ITConfig(ADC3, ADC_IT_EOC, ENABLE); <span class="comment">// ä½¿èƒ½ ADC çš„ EOC ä¸­æ–­</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">AD_GetValue</span><span class="params">(<span class="type">int</span> recentchanel)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (recentchanel == <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ADC_RegularChannelConfig(ADC3, ADC_Channel_4, <span class="number">1</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (recentchanel == <span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ADC_RegularChannelConfig(ADC3, ADC_Channel_5, <span class="number">1</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (recentchanel == <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ADC_RegularChannelConfig(ADC3, ADC_Channel_6, <span class="number">1</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (recentchanel == <span class="number">7</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ADC_RegularChannelConfig(ADC3, ADC_Channel_7, <span class="number">1</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ADC_SoftwareStartConvCmd(ADC3, ENABLE); <span class="comment">// è½¯ä»¶è§¦å‘ ADC è½¬æ¢ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">return</span> adc_value; <span class="comment">// è¿”å›æœ€æ–°çš„ ADC å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ADC3_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> <span class="comment">// ADC3 ä¸­æ–­å¤„ç†å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (ADC_GetITStatus(ADC3, ADC_IT_EOC) != RESET) <span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ EOC ä¸­æ–­</span></span><br><span class="line">    &#123;</span><br><span class="line">        adc_value = ADC_GetConversionValue(ADC3); <span class="comment">// è¯»å– ADC å€¼</span></span><br><span class="line">        ADC_ClearITPendingBit(ADC3, ADC_IT_EOC); <span class="comment">// æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">get_time_interval</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> current_time = mytime;</span><br><span class="line">    <span class="type">uint32_t</span> interval = current_time - last_time; <span class="comment">// è®¡ç®—æ—¶é—´é—´éš”</span></span><br><span class="line">    last_time = current_time; <span class="comment">// æ›´æ–°ä¸Šæ¬¡æ—¶é—´</span></span><br><span class="line">    <span class="keyword">return</span> interval/<span class="number">100</span>;<span class="comment">//å¾®ç§’åŒ–æˆæ¯«ç§’ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼Œå®šæ—¶å™¨ä¸­æ–­ï¼‰ä¸‹é¢æ˜¯timer-h"><a href="#ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼Œå®šæ—¶å™¨ä¸­æ–­ï¼‰ä¸‹é¢æ˜¯timer-h" class="headerlink" title="ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼Œå®šæ—¶å™¨ä¸­æ–­ï¼‰ä¸‹é¢æ˜¯timer.h"></a>ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»ï¼Œå®šæ—¶å™¨ä¸­æ–­ï¼‰ä¸‹é¢æ˜¯timer.h</h4><p>å› ä¸ºè¦è·å–æ—¶é—´é—´éš”ï¼Œæ‰€ä»¥é…ç½®timå®šæ—¶å™¨</p><p>æ€è·¯å¦‚ä¸‹:</p><ul><li>å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ mytime</li><li>å®šä¹‰ä¸€ä¸ªå˜é‡ last_time</li><li>timeré…ç½®åˆ†é¢‘72-1ï¼Œè‡ªåŠ¨é‡è£…å€¼1</li><li>é…ç½®ä¸­æ–­ï¼Œæ¯æ¬¡ä¸­æ–­ï¼Œmytimeéƒ½åŠ ä¸€ï¼Œå®ç°å¾®ç§’çº§åˆ«çš„è®¡æ•°</li><li>å½“è°ƒç”¨adcç›¸å…³å‡½æ•°çš„æ—¶å€™ï¼Œè®¡ç®—mytimeä¸last_timeçš„å·®å€¼</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);<span class="comment">//ä½¿èƒ½æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">TIM_InternalClockConfig(TIM2);</span><br><span class="line"></span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1; <span class="comment">//Ö¸è®¾ç½®æ—¶é’Ÿåˆ†é¢‘ï¼ˆ1åˆ†é¢‘ï¼‰</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; <span class="comment">//å‘ä¸Šè®¡æ•°</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">10</span><span class="number">-1</span>;<span class="comment">//å‘¨æœŸæ˜¯10å¾®ç§’</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">72</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_RepetitionCounter=<span class="number">0</span>;<span class="comment">//é‡å¤è®¡æ•°ï¼ˆé«˜çº§è®¡æ—¶å™¨æœ‰ï¼Œç°åœ¨ä¸ç”¨ï¼‰</span></span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update); <span class="comment">//æ¸…é™¤TIM2çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½ï¼Œç¡®ä¿å®šæ—¶å™¨å¼€å§‹æ—¶æ²¡æœ‰æ®‹ç•™çš„ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"></span><br><span class="line">TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);<span class="comment">//å¼€å¯æ›´æ–°ä¸­æ–­åˆ°nvicé€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line"></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel= TIM2_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=<span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority=<span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸»å‡½æ•°ï¼š"><a href="#ä¸»å‡½æ•°ï¼š" class="headerlink" title="ä¸»å‡½æ•°ï¼š"></a>ä¸»å‡½æ•°ï¼š</h4><p>å®šä¹‰ä¸€ä¸ªå››ä¸ªå˜é‡çš„æ•°ç»„ï¼Œç”¨äºæ ‡å¿—å„ä¸ªçº¢å¤–å¯¹ç®¡çš„çŠ¶æ€ï¼Œåªæœ‰æ»¡è¶³çŠ¶æ€æ”¹å˜çš„åˆ¤å®šæ¡ä»¶æ—¶ï¼Œå†æ”¹å˜çŠ¶æ€ï¼Œé˜²æ­¢ä¸²å£é‚£é‡Œä¸€ç›´ä¹±è·³</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Serial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="type">uint8_t</span> RxData;</span><br><span class="line"><span class="type">int</span> ifblack[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">extern</span> <span class="type">uint32_t</span> mytime;</span><br><span class="line"><span class="type">void</span> <span class="title function_">BlkOrWte</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> recentchanel)</span>;</span><br><span class="line"><span class="type">int</span> recentchanel = <span class="number">4</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">AD_Init();</span><br><span class="line">Serial_Init();</span><br><span class="line">Timer_Init();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowNum(<span class="number">1</span>,<span class="number">6</span>,mytime,<span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span>(recentchanel == <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = AD_GetValue(recentchanel);</span><br><span class="line">BlkOrWte(a,recentchanel);</span><br><span class="line">recentchanel = <span class="number">5</span>;</span><br><span class="line">OLED_ShowNum(<span class="number">1</span>,<span class="number">1</span>,a,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(recentchanel == <span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = AD_GetValue(recentchanel);</span><br><span class="line">BlkOrWte(a,recentchanel);</span><br><span class="line">recentchanel = <span class="number">6</span>;</span><br><span class="line">OLED_ShowNum(<span class="number">2</span>,<span class="number">1</span>,a,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(recentchanel == <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = AD_GetValue(recentchanel);</span><br><span class="line">BlkOrWte(a,recentchanel);</span><br><span class="line">recentchanel = <span class="number">7</span>;</span><br><span class="line">OLED_ShowNum(<span class="number">3</span>,<span class="number">1</span>,a,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(recentchanel == <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = AD_GetValue(recentchanel);</span><br><span class="line">BlkOrWte(a,recentchanel);</span><br><span class="line">recentchanel = <span class="number">4</span>;</span><br><span class="line">OLED_ShowNum(<span class="number">4</span>,<span class="number">1</span>,a,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">BlkOrWte</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> recentchanel)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a&gt;<span class="number">2000</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ifblack[recentchanel<span class="number">-4</span>]==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_SendNumber(recentchanel,<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;:black\r\n&quot;</span>);</span><br><span class="line">Serial_SendNumber(get_time_interval(),<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">ifblack[recentchanel<span class="number">-4</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a&lt;<span class="number">500</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ifblack[recentchanel<span class="number">-4</span>] == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_SendNumber(recentchanel,<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;white\r\n&quot;</span>);</span><br><span class="line">Serial_SendNumber(get_time_interval(),<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">ifblack[recentchanel<span class="number">-4</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//æ›´æ–°ä¸­æ–­å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (TIM_GetITStatus(TIM2, TIM_IT_Update) == SET)<span class="comment">//è·å–TIM3å®šæ—¶å™¨çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">&#123;</span><br><span class="line">mytime++;</span><br><span class="line">TIM_ClearITPendingBit(TIM2, TIM_IT_Update);<span class="comment">//æ¸…é™¤æ›´æ–°ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ç°è±¡ï¼š"><a href="#è§†é¢‘ç°è±¡ï¼š" class="headerlink" title="è§†é¢‘ç°è±¡ï¼š"></a>è§†é¢‘ç°è±¡ï¼š</h3><h2 id="ä»»åŠ¡2-â€”â€”DMAè½¬è¿æ•°æ®"><a href="#ä»»åŠ¡2-â€”â€”DMAè½¬è¿æ•°æ®" class="headerlink" title="ä»»åŠ¡2 â€”â€”DMAè½¬è¿æ•°æ®"></a>ä»»åŠ¡2 â€”â€”DMAè½¬è¿æ•°æ®</h2><h3 id="dmaç®€ä»‹"><a href="#dmaç®€ä»‹" class="headerlink" title="dmaç®€ä»‹"></a>dmaç®€ä»‹</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241102130840765.png" alt="image-20241102130840765"></p><h3 id="æŠ€æœ¯ç‚¹ä»‹ç»"><a href="#æŠ€æœ¯ç‚¹ä»‹ç»" class="headerlink" title="æŠ€æœ¯ç‚¹ä»‹ç»"></a>æŠ€æœ¯ç‚¹ä»‹ç»</h3><h4 id="DMA-é…ç½®å’Œä½¿â½¤"><a href="#DMA-é…ç½®å’Œä½¿â½¤" class="headerlink" title="DMA é…ç½®å’Œä½¿â½¤"></a>DMA é…ç½®å’Œä½¿â½¤</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DMAåˆå§‹åŒ–</span></span><br><span class="line">DMA_InitTypeDef DMA_InitStructure;<span class="comment">//å®šä¹‰ç»“æ„ä½“å˜é‡</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralBaseAddr = (<span class="type">uint32_t</span>)&amp;ADC3-&gt;DR;<span class="comment">//å¤–è®¾åŸºåœ°å€</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_HalfWord;<span class="comment">//å¤–è®¾æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œå¯¹åº”16ä¸ºçš„ADCæ•°æ®å¯„å­˜å™¨</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;<span class="comment">//å¤–è®¾åœ°å€è‡ªå¢ï¼Œé€‰æ‹©å¤±èƒ½ï¼Œå§‹ç»ˆä»¥ADCæ•°æ®å¯„å­˜å™¨ä¸ºæº</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryBaseAddr = (<span class="type">uint32_t</span>)AD_Value;<span class="comment">//å­˜å‚¨å™¨åŸºåœ°å€ï¼ŒAD_Value</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord;<span class="comment">//å­˜å‚¨å™¨æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œä¸æºæ•°æ®å®½åº¦å¯¹åº”</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;<span class="comment">//å­˜å‚¨å™¨åœ°å€è‡ªå¢ä½¿èƒ½ï¼Œæ¯æ¬¡è½¬è¿åï¼Œæ•°ç»„ä½ç½®ä¸‹ç§»</span></span><br><span class="line">DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC;<span class="comment">//ä¼ è¾“æ–¹å‘ï¼Œé€‰æ‹©ç”±å¤–è®¾åˆ°å­˜å‚¨å™¨ï¼ŒADCæ•°æ®å¯„å­˜å™¨è½¬åˆ°æ•°ç»„</span></span><br><span class="line">DMA_InitStructure.DMA_BufferSize = <span class="number">4</span>;<span class="comment">//è½¬è¿æ¬¡æ•°ï¼Œä¸ADCé€šé“æ•°ä¸€è‡´</span></span><br><span class="line">DMA_InitStructure.DMA_Mode = DMA_Mode_Circular;<span class="comment">//å¾ªç¯æ¨¡å¼ï¼Œä¸ADCçš„è¿ç»­è½¬æ¢ä¸€è‡´</span></span><br><span class="line">DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;<span class="comment">//å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨å¤±èƒ½</span></span><br><span class="line">DMA_InitStructure.DMA_Priority = DMA_Priority_Medium;<span class="comment">//ä¼˜å…ˆçº§ï¼Œä¸­ç­‰</span></span><br><span class="line">DMA_Init(DMA2_Channel5, &amp;DMA_InitStructure);<span class="comment">//å°†ç»“æ„ä½“å˜é‡äº¤ç»™DMA_Initï¼Œé…ç½®DMA2çš„é€šé“5</span></span><br></pre></td></tr></table></figure><h5 id="DMA-InitTypeDef-ç»“æ„ä½“æˆå‘˜"><a href="#DMA-InitTypeDef-ç»“æ„ä½“æˆå‘˜" class="headerlink" title="DMA_InitTypeDef ç»“æ„ä½“æˆå‘˜"></a>DMA_InitTypeDef ç»“æ„ä½“æˆå‘˜</h5><ol><li><p><strong>DMA_PeripheralBaseAddr</strong>ï¼š</p><p>è®¾ç½®å¤–è®¾çš„åŸºåœ°å€ï¼ŒDMA ä¼ è¾“æ—¶çš„æºåœ°å€ã€‚</p><p>é€šå¸¸æ˜¯å¤–è®¾å¯„å­˜å™¨çš„åœ°å€ï¼Œæ¯”å¦‚ ADC çš„æ•°æ®å¯„å­˜å™¨ &amp;ADC3-&gt;DR</p></li><li><p><strong>DMA_PeripheralDataSize</strong>ï¼š</p><p>è®¾ç½®å¤–è®¾æ•°æ®çš„å®½åº¦ã€‚</p><p>DMA_PeripheralDataSize_Byteï¼š8ä½æ•°æ®å®½åº¦</p><p>DMA_PeripheralDataSize_HalfWordï¼š16ä½æ•°æ®å®½åº¦ï¼ˆé€šå¸¸ç”¨äº ADCï¼‰</p><p>DMA_PeripheralDataSize_Wordï¼š32ä½æ•°æ®å®½åº¦</p></li><li><p><strong>DMA_PeripheralInc</strong>ï¼š</p><p>è®¾ç½®å¤–è®¾åœ°å€è‡ªå¢ã€‚</p><p>DMA_PeripheralInc_Disableï¼šå¤–è®¾åœ°å€ä¸è‡ªå¢ï¼ˆå¸¸ç”¨äº ADCï¼‰ã€‚</p><p>DMA_PeripheralInc_Enableï¼šå¤–è®¾åœ°å€è‡ªå¢</p></li><li><p><strong>DMA_MemoryBaseAddr</strong>ï¼š</p><p>è®¾ç½®å­˜å‚¨å™¨çš„åŸºåœ°å€ï¼ŒDMA å°†æ•°æ®å†™å…¥çš„ç›®çš„åœ°</p><p>é€šå¸¸æ˜¯æŒ‡å‘ä¸€ä¸ªæ•°ç»„æˆ–å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆï¼Œä¾‹å¦‚ AD_Value</p></li><li><p><strong>DMA_MemoryDataSize</strong>ï¼š</p><p>è®¾ç½®å­˜å‚¨å™¨æ•°æ®çš„å®½åº¦ã€‚</p><p>DMA_Memorialized_Byteï¼š8ä½æ•°æ®å®½åº¦ã€‚</p><p>DMA_Memorialized_HalfWordï¼š16ä½æ•°æ®å®½åº¦ã€‚</p><p>DMA_Memorialized_Wordï¼š32ä½æ•°æ®å®½åº¦ã€‚</p></li><li><p><strong>DMA_MemoryInc</strong>ï¼š</p><p>è®¾ç½®å­˜å‚¨å™¨åœ°å€è‡ªå¢ã€‚</p><p>DMA_MemoryInc_Disableï¼šå­˜å‚¨å™¨åœ°å€ä¸è‡ªå¢ï¼ˆæ‰€æœ‰æ•°æ®å†™å…¥åŒä¸€ä½ç½®ï¼‰ã€‚</p><p>DMA_MemoryInc_Enableï¼šå­˜å‚¨å™¨åœ°å€è‡ªå¢ï¼ˆæ¯æ¬¡ä¼ è¾“åï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼‰ã€‚</p></li><li><p><strong>DMA_DIR</strong>ï¼š</p><p>è®¾ç½®æ•°æ®ä¼ è¾“çš„æ–¹å‘ã€‚</p><p>DMA_DIR_PeripheralSRCï¼šä»å¤–è®¾åˆ°å­˜å‚¨å™¨ï¼ˆå¦‚ ADC åˆ°å†…å­˜ï¼‰ã€‚</p><p>DMA_DIR_MemorySRCï¼šä»å­˜å‚¨å™¨åˆ°å¤–è®¾ï¼ˆå¦‚å†…å­˜åˆ° DACï¼‰ã€‚</p></li><li><p><strong>DMA_BufferSize</strong>ï¼š</p><p>è®¾ç½®ä¼ è¾“çš„æ•°æ®å¤§å°ï¼ˆä¼ è¾“æ¬¡æ•°ï¼‰ã€‚</p><p>æŒ‡å®šä¼ è¾“çš„æ ·æœ¬æ•°é‡ã€‚ä¾‹å¦‚ï¼Œè‹¥ä½ è¦ä» ADC è·å– 4 ä¸ªæ ·æœ¬ï¼Œåˆ™è®¾ç½®ä¸º 4ã€‚</p></li><li><p><strong>DMA_Mode</strong>ï¼š</p><p>è®¾ç½® DMA çš„å·¥ä½œæ¨¡å¼ã€‚</p><p>DMA_Mode_Normalï¼šæ­£å¸¸æ¨¡å¼ï¼Œä¼ è¾“ä¸€æ¬¡ååœæ­¢ã€‚</p><p>DMA_Mode_Circularï¼šå¾ªç¯æ¨¡å¼ï¼Œå®Œæˆä¸€æ¬¡ä¼ è¾“åè‡ªåŠ¨é‡æ–°å¼€å§‹ï¼Œé€‚åˆè¿ç»­æ•°æ®é‡‡é›†ã€‚</p></li><li><p><strong>DMA_M2M</strong>ï¼š</p><p>è®¾ç½®å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨ä¼ è¾“çš„ä½¿èƒ½ã€‚</p><p>DMA_M2M_Disableï¼šç¦ç”¨å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨çš„ä¼ è¾“ï¼ˆé€šå¸¸ç”¨äºå¤–è®¾åˆ°å­˜å‚¨å™¨ä¼ è¾“ï¼‰ã€‚</p><p>DMA_M2M_Enableï¼šå¯ç”¨å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨çš„ä¼ è¾“ï¼ˆé€‚ç”¨äºç‰¹å®šåº”ç”¨ï¼‰ã€‚</p></li><li><p><strong>DMA_Priority</strong>ï¼š</p><p>è®¾ç½® DMA ä¼ è¾“çš„ä¼˜å…ˆçº§ã€‚</p><p>DMA_Priority_Lowï¼šä½ä¼˜å…ˆçº§ã€‚</p><p>DMA_Priority_Mediumï¼šä¸­ä¼˜å…ˆçº§ã€‚</p><p>DMA_Priority_Highï¼šé«˜ä¼˜å…ˆçº§ã€‚</p><p>DMA_Priority_VeryHighï¼šæœ€é«˜ä¼˜å…ˆçº§ã€‚</p></li></ol><h4 id="ADC-è§¦å‘-DMA"><a href="#ADC-è§¦å‘-DMA" class="headerlink" title="ADC è§¦å‘ DMA"></a>ADC è§¦å‘ DMA</h4><ol><li><p><strong>DMA é…ç½®</strong>ï¼š</p><p>åœ¨ ADC åˆå§‹åŒ–ä¸­ï¼Œå¯ä»¥é…ç½® DMA ä½¿èƒ½ã€‚å½“ ADC å®Œæˆä¸€æ¬¡è½¬æ¢æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å‘ DMA å‘é€ä¸€ä¸ªä¿¡å·ï¼ŒæŒ‡ç¤ºæ•°æ®å·²ç»å‡†å¤‡å¥½è¿›è¡Œä¼ è¾“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADC_DMACmd(ADC3, ENABLE);</span><br></pre></td></tr></table></figure></li><li><p><strong>æ•°æ®ä¼ è¾“</strong>ï¼š</p><p>ä¸€æ—¦ DMA æ¥æ”¶åˆ°æ¥è‡ª ADC çš„è§¦å‘ä¿¡å·ï¼Œå®ƒä¼šä» ADC çš„æ•°æ®å¯„å­˜å™¨ä¸­è¯»å–è½¬æ¢ç»“æœï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°æŒ‡å®šçš„å†…å­˜åœ°å€ï¼ˆä¾‹å¦‚æŸä¸ªæ•°ç»„ä¸­ï¼‰</p></li></ol><h3 id="å®šæ—¶å™¨é…ç½®"><a href="#å®šæ—¶å™¨é…ç½®" class="headerlink" title="å®šæ—¶å™¨é…ç½®"></a>å®šæ—¶å™¨é…ç½®</h3><p>10å¾®ç§’ä¸ºå‘¨æœŸï¼Œä»¥ä¾¿è®°å½•å¾®å¦™çº§åˆ«çš„DMAè¿‡ç¨‹ï¼ˆä¹Ÿä¸æ˜¯å¾ˆç²¾å‡†ï¼ŒDMAè½¬è¿å¤ªå¿«äº†ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);<span class="comment">//ä½¿èƒ½æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">TIM_InternalClockConfig(TIM2);</span><br><span class="line"></span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1; <span class="comment">//Ö¸è®¾ç½®æ—¶é’Ÿåˆ†é¢‘ï¼ˆ1åˆ†é¢‘ï¼‰</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; <span class="comment">//å‘ä¸Šè®¡æ•°</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">10</span><span class="number">-1</span>;<span class="comment">//å‘¨æœŸæ˜¯10å¾®ç§’</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">72</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_RepetitionCounter=<span class="number">0</span>;<span class="comment">//é‡å¤è®¡æ•°ï¼ˆé«˜çº§è®¡æ—¶å™¨æœ‰ï¼Œç°åœ¨ä¸ç”¨ï¼‰</span></span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update); <span class="comment">//æ¸…é™¤TIM2çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½ï¼Œç¡®ä¿å®šæ—¶å™¨å¼€å§‹æ—¶æ²¡æœ‰æ®‹ç•™çš„ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"></span><br><span class="line">TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);<span class="comment">//å¼€å¯æ›´æ–°ä¸­æ–­åˆ°nvicé€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line"></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel= TIM2_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=<span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority=<span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸»å‡½æ•°æºç "><a href="#ä¸»å‡½æ•°æºç " class="headerlink" title="ä¸»å‡½æ•°æºç "></a>ä¸»å‡½æ•°æºç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Serial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="type">int</span> delta_time = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> ifblack[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">extern</span> <span class="type">uint32_t</span> mytime;</span><br><span class="line"><span class="type">int</span> dma_transfer_count =<span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">BlkOrWte</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> recentchanel)</span>;</span><br><span class="line"><span class="type">int</span> recentchanel = <span class="number">4</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">AD_Init();</span><br><span class="line">Serial_Init();</span><br><span class="line">Timer_Init();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowNum(<span class="number">1</span>,<span class="number">1</span>,mytime,<span class="number">10</span>);</span><br><span class="line">Serial_SendNumber(AD_Value[<span class="number">0</span>],<span class="number">4</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">Serial_SendNumber(AD_Value[<span class="number">1</span>],<span class="number">4</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">Serial_SendNumber(AD_Value[<span class="number">2</span>],<span class="number">4</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">Serial_SendNumber(AD_Value[<span class="number">3</span>],<span class="number">4</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;  delta_time:&quot;</span>);</span><br><span class="line">Serial_SendNumber(delta_time,<span class="number">5</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//æ›´æ–°ä¸­æ–­å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (TIM_GetITStatus(TIM2, TIM_IT_Update) == SET)<span class="comment">//è·å–TIM3å®šæ—¶å™¨çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">&#123;</span><br><span class="line">mytime++;</span><br><span class="line">TIM_ClearITPendingBit(TIM2, TIM_IT_Update);<span class="comment">//æ¸…é™¤æ›´æ–°ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">DMA2_Channel4_5_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> <span class="comment">//é…ç½®ä¸€ä¸‹dma2çš„ä¸­æ–­å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (DMA_GetITStatus(DMA2_IT_TC5)) &#123;</span><br><span class="line">        dma_transfer_count++; <span class="comment">// å¢åŠ è½¬è¿è®¡æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (dma_transfer_count &gt;= <span class="number">1</span>) &#123; <span class="comment">// æ¯æ¬¡è½¬è¿è®¡ç®—æ—¶é—´é—´éš”</span></span><br><span class="line">            delta_time = get_time_interval(); <span class="comment">// è®¡ç®—æ—¶é—´é—´éš”</span></span><br><span class="line">            dma_transfer_count = <span class="number">0</span>; <span class="comment">// é‡ç½®è®¡æ•°å™¨</span></span><br><span class="line">        &#125;</span><br><span class="line">        DMA_ClearITPendingBit(DMA2_IT_TC5); <span class="comment">// æ¸…é™¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ç°è±¡ï¼š-1"><a href="#è§†é¢‘ç°è±¡ï¼š-1" class="headerlink" title="è§†é¢‘ç°è±¡ï¼š"></a>è§†é¢‘ç°è±¡ï¼š</h3><h2 id="vofa"><a href="#vofa" class="headerlink" title="vofa"></a>vofa</h2><h3 id="JustFloat-åè®®çš„ç»“æ„"><a href="#JustFloat-åè®®çš„ç»“æ„" class="headerlink" title="JustFloat åè®®çš„ç»“æ„"></a>JustFloat åè®®çš„ç»“æ„</h3><ol><li>æ•°æ®å¸§ï¼š<br> æ¯ä¸ªæ•°æ®å¸§åŒ…å«ä¸€ä¸ªæµ®ç‚¹æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªé€šé“çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæœ‰å››ä¸ªé€šé“çš„æ•°æ®è¦ä¼ è¾“ï¼Œæ•°æ®å¸§ä¸­å°±è¦åŒ…å«å››ä¸ªæµ®ç‚¹æ•°</li><li>å°ç«¯æ ¼å¼ï¼š<br>JustFloat åè®®ä½¿ç”¨å°ç«¯æ ¼å¼å­˜å‚¨æµ®ç‚¹æ•°ï¼Œæœ€ä½æœ‰æ•ˆå­—èŠ‚å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€ä¸­</li><li>å¸§å°¾ï¼š<br>æ¯ä¸ªæ•°æ®å¸§çš„æœ«å°¾éƒ½æœ‰ä¸€ä¸ªå›ºå®šçš„å¸§å°¾æ ‡å¿—ï¼Œç”¨äºæ ‡è¯†æ•°æ®å¸§çš„ç»“æŸï¼š {0x00, 0x00, 0x80, 0x7f}</li></ol><h3 id="æ•°æ®ä¼ è¾“è¿‡ç¨‹"><a href="#æ•°æ®ä¼ è¾“è¿‡ç¨‹" class="headerlink" title="æ•°æ®ä¼ è¾“è¿‡ç¨‹"></a>æ•°æ®ä¼ è¾“è¿‡ç¨‹</h3><ol><li><p>æ•°æ®å‡†å¤‡ï¼š</p><p>éœ€è¦ä¼ è¾“çš„æ•°æ®é¦–å…ˆè¢«è½¬æ¢æˆæµ®ç‚¹æ•°ï¼Œå¹¶æŒ‰ç…§å°ç«¯æ ¼å¼å­˜å‚¨åœ¨æ•°ç»„ä¸­ã€‚</p></li><li><p>æ•°æ®å‘é€ï¼š<br> å°†æµ®ç‚¹æ•°ç»„å’Œå¸§å°¾æ ‡å¿—ä¸€èµ·å‘é€åˆ°æ¥æ”¶ç«¯ã€‚æ¥æ”¶ç«¯é€šè¿‡è¯†åˆ«å¸§å°¾æ ‡å¿—æ¥ç¡®å®šæ•°æ®å¸§çš„ç»“æŸï¼Œå¹¶è§£ææµ®ç‚¹æ•°ç»„ä¸­çš„æ•°æ®ã€‚</p></li><li><p>æ•°æ®è§£æï¼š</p><p>æ¥æ”¶ç«¯æ¥æ”¶åˆ°æ•°æ®å¸§åï¼Œè§£ææµ®ç‚¹æ•°ç»„ä¸­çš„æ•°æ®ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œå¤„ç†æˆ–æ˜¾ç¤ºã€‚</p></li></ol><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>é€‚åˆå¤šé€šé“æ•°æ®é‡‡é›†ï¼Œä¾‹å¦‚æ­£åœ¨åšçš„å¾ªè¿¹å°è½¦æœ‰å¤šä¸ªçº¢å¤–å¯¹ç®¡ï¼Œæ¯ä¸ªçº¢å¤–å¯¹ç®¡ä»£è¡¨ä¸€ä¸ªé€šé“çš„æ•°æ®ã€‚</p><h3 id="å›¾å½¢æ§ä»¶çš„ä½¿ç”¨"><a href="#å›¾å½¢æ§ä»¶çš„ä½¿ç”¨" class="headerlink" title="å›¾å½¢æ§ä»¶çš„ä½¿ç”¨"></a>å›¾å½¢æ§ä»¶çš„ä½¿ç”¨</h3><p>ä»¥æœ€å¸¸ç”¨çš„ç¤ºæ³¢å™¨ä¸ºä¾‹</p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241103190053878.png" alt="image-20241103190053878" style="zoom: 33%;" /><p>åœ¨å·¦ä¾§é€‰æ‹©æ§ä»¶ç¤ºæ³¢å™¨å¹¶æŠŠå®ƒæ‹–è¿›å»</p><ul><li>å³é”®å¯ä»¥é€‰æ‹©å¡«å……æ–¹å¼</li><li>ä¸‹é¢ä¸‰ä¸ªåœˆå¯ä»¥è°ƒæ•´æ³¢å½¢èŒƒå›´ï¼ŒåŒ…å«ç‚¹æ•°ç­‰</li><li>autoå¯ä»¥è®©æ³¢å½¢ä»¥æœ€ä½³æ–¹å¼è‡ªåŠ¨å‘ˆç°</li></ul><h3 id="å…·ä½“ä½¿ç”¨æ–¹æ³•"><a href="#å…·ä½“ä½¿ç”¨æ–¹æ³•" class="headerlink" title="å…·ä½“ä½¿ç”¨æ–¹æ³•"></a>å…·ä½“ä½¿ç”¨æ–¹æ³•</h3><h4 id="é…ç½®ä¸€ä¸‹è¿™ä¸ªèƒ½ç”¨è¿™ä¸ªåè®®çš„å‡½æ•°"><a href="#é…ç½®ä¸€ä¸‹è¿™ä¸ªèƒ½ç”¨è¿™ä¸ªåè®®çš„å‡½æ•°" class="headerlink" title="é…ç½®ä¸€ä¸‹è¿™ä¸ªèƒ½ç”¨è¿™ä¸ªåè®®çš„å‡½æ•°"></a>é…ç½®ä¸€ä¸‹è¿™ä¸ªèƒ½ç”¨è¿™ä¸ªåè®®çš„å‡½æ•°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;serial.h&quot;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Vofa_JustFloat</span><span class="params">(<span class="type">float</span> *data, <span class="type">uint8_t</span> num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> tempData[<span class="number">100</span>];</span><br><span class="line">    <span class="type">uint8_t</span> temp_end[<span class="number">4</span>] = &#123;<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x7f</span>&#125;;</span><br><span class="line">    <span class="type">float</span> temp_copy[num];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;temp_copy, data, <span class="keyword">sizeof</span>(<span class="type">float</span>) * num);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(tempData, (<span class="type">uint8_t</span> *)&amp;temp_copy, <span class="keyword">sizeof</span>(temp_copy));</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;tempData[num * <span class="number">4</span>], &amp;temp_end[<span class="number">0</span>], <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸²å£å‘é€å‡½æ•°</span></span><br><span class="line">    Serial_SendArray(tempData,(num + <span class="number">1</span>) * <span class="number">4</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå‰å‡ è¡Œéƒ½æ˜¯åœ¨è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå¤„ç†å®Œæˆåå¾—åˆ°tempdataï¼Œæ˜¯ä¸€ä¸ªuint8_tç±»å‹çš„æ•°ç»„</li><li>å¾—åˆ°æ•°ç»„ä¹‹åï¼Œç”¨æ±Ÿç§‘å¤§çš„ä¸²å£å‘é€å‡½æ•°ç›´æ¥å‘åˆ°é€å³å¯</li><li>ä½¿ç”¨æ–¹æ³•ï¼šè¾“å…¥ï¼ˆæµ®ç‚¹æ•°æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ï¼‰</li></ul><h3 id="é…ç½®ADC-DMA"><a href="#é…ç½®ADC-DMA" class="headerlink" title="é…ç½®ADC&amp;&amp;DMA"></a>é…ç½®ADC&amp;&amp;DMA</h3><p>ä¾ç„¶é‡‡ç”¨ä¸Šé¢çš„é…ç½®ï¼Œå¹¶å°†ADCæ•°æ®æ¥å…¥æ‹“å±•åˆ°12ï¼Ÿä¸ªï¼ˆå’±åªå‘äº†10ä¸ªçº¢å¤–å¯¹ç®¡ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>        <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="type">uint32_t</span> mytime = <span class="number">0</span>;</span><br><span class="line"><span class="type">uint32_t</span> last_time = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">uint16_t</span> AD_Value_for_DMA2[<span class="number">5</span>];</span><br><span class="line"><span class="type">uint16_t</span> AD_Value_for_DMA1[<span class="number">5</span>];<span class="comment">//ç”¨äºå­˜æ”¾ADè½¬æ¢ç»“æœçš„å…¨å±€æ•°ç»„</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">AD_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC3, ENABLE);<span class="comment">//å¼€å¯ADC3çš„æ—¶é’Ÿ</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF, ENABLE);<span class="comment">//å¼€å¯GPIOFçš„æ—¶é’Ÿ</span></span><br><span class="line">RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA2, ENABLE);<span class="comment">//å¼€å¯DMA2çš„æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RCC_ADCCLKConfig(RCC_PCLK2_Div6);<span class="comment">//é€‰æ‹©æ—¶é’Ÿ6åˆ†é¢‘ï¼ŒADCCLK = 72MHz / 6 = 12MHz</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_8 | GPIO_Pin_9 |GPIO_Pin_10;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOF, &amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‰©ä¸‹çš„</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | GPIO_Pin_2 | GPIO_Pin_3 | GPIO_Pin_4 |GPIO_Pin_5;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_4, <span class="number">1</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_5, <span class="number">2</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_6, <span class="number">3</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_7, <span class="number">4</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC3, ADC_Channel_8, <span class="number">5</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line"></span><br><span class="line">ADC_RegularChannelConfig(ADC1, ADC_Channel_11, <span class="number">6</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC1, ADC_Channel_12, <span class="number">7</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC1, ADC_Channel_13, <span class="number">8</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC1, ADC_Channel_14, <span class="number">9</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line">ADC_RegularChannelConfig(ADC1, ADC_Channel_15, <span class="number">10</span>, ADC_SampleTime_55Cycles5);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ADC_InitTypeDef ADC_InitStructure;</span><br><span class="line">ADC_InitStructure.ADC_Mode = ADC_Mode_Independent;</span><br><span class="line">ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right;<span class="comment">//è¿™é‡Œå¥½åƒè¿˜è¦æ”¹ä¸€ä¸ªç‹¬ç«‹æ¨¡å¼ï¼Ÿ</span></span><br><span class="line">ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_None;</span><br><span class="line">ADC_InitStructure.ADC_ContinuousConvMode = ENABLE;</span><br><span class="line">ADC_InitStructure.ADC_ScanConvMode = ENABLE;</span><br><span class="line">ADC_InitStructure.ADC_NbrOfChannel = <span class="number">10</span>;</span><br><span class="line">ADC_Init(ADC3, &amp;ADC_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//DMAåˆå§‹åŒ–</span></span><br><span class="line">DMA_InitTypeDef DMA_InitStructure;<span class="comment">//å®šä¹‰ç»“æ„ä½“å˜é‡</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralBaseAddr = (<span class="type">uint32_t</span>)&amp;ADC3-&gt;DR;<span class="comment">//å¤–è®¾åŸºåœ°å€</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_HalfWord;<span class="comment">//å¤–è®¾æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œå¯¹åº”16ä¸ºçš„ADCæ•°æ®å¯„å­˜å™¨</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;<span class="comment">//å¤–è®¾åœ°å€è‡ªå¢ï¼Œé€‰æ‹©å¤±èƒ½ï¼Œå§‹ç»ˆä»¥ADCæ•°æ®å¯„å­˜å™¨ä¸ºæº</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryBaseAddr = (<span class="type">uint32_t</span>)AD_Value_for_DMA2;<span class="comment">//å­˜å‚¨å™¨åŸºåœ°å€</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord;<span class="comment">//å­˜å‚¨å™¨æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œä¸æºæ•°æ®å®½åº¦å¯¹åº”</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;<span class="comment">//å­˜å‚¨å™¨åœ°å€è‡ªå¢ä½¿èƒ½ï¼Œæ¯æ¬¡è½¬è¿åï¼Œæ•°ç»„ä½ç½®ä¸‹ç§»</span></span><br><span class="line">DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC;<span class="comment">//ä¼ è¾“æ–¹å‘ï¼Œé€‰æ‹©ç”±å¤–è®¾åˆ°å­˜å‚¨å™¨ï¼ŒADCæ•°æ®å¯„å­˜å™¨è½¬åˆ°æ•°ç»„</span></span><br><span class="line">DMA_InitStructure.DMA_BufferSize =<span class="number">5</span>;<span class="comment">//è½¬è¿æ¬¡æ•°</span></span><br><span class="line">DMA_InitStructure.DMA_Mode = DMA_Mode_Circular;<span class="comment">//å¾ªç¯æ¨¡å¼ï¼Œä¸ADCçš„è¿ç»­è½¬æ¢ä¸€è‡´</span></span><br><span class="line">DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;<span class="comment">//å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨å¤±èƒ½</span></span><br><span class="line">DMA_InitStructure.DMA_Priority = DMA_Priority_Medium;<span class="comment">//ä¼˜å…ˆçº§ï¼Œä¸­ç­‰</span></span><br><span class="line">DMA_Init(DMA2_Channel5, &amp;DMA_InitStructure);<span class="comment">//å°†ç»“æ„ä½“å˜é‡äº¤ç»™DMA_Initï¼Œé…ç½®DMA2çš„é€šé“5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DMA_InitStructure.DMA_PeripheralBaseAddr = (<span class="type">uint32_t</span>)&amp;ADC1-&gt;DR;<span class="comment">//å¤–è®¾åŸºåœ°å€</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_HalfWord;<span class="comment">//å¤–è®¾æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œå¯¹åº”16ä¸ºçš„ADCæ•°æ®å¯„å­˜å™¨</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;<span class="comment">//å¤–è®¾åœ°å€è‡ªå¢ï¼Œé€‰æ‹©å¤±èƒ½ï¼Œå§‹ç»ˆä»¥ADCæ•°æ®å¯„å­˜å™¨ä¸ºæº</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryBaseAddr = (<span class="type">uint32_t</span>)AD_Value_for_DMA1;<span class="comment">//å­˜å‚¨å™¨åŸºåœ°å€</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord;<span class="comment">//å­˜å‚¨å™¨æ•°æ®å®½åº¦ï¼ŒåŠå­—ï¼Œä¸æºæ•°æ®å®½åº¦å¯¹åº”</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;<span class="comment">//å­˜å‚¨å™¨åœ°å€è‡ªå¢ä½¿èƒ½ï¼Œæ¯æ¬¡è½¬è¿åï¼Œæ•°ç»„ä½ç½®ä¸‹ç§»</span></span><br><span class="line">DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC;<span class="comment">//ä¼ è¾“æ–¹å‘ï¼Œé€‰æ‹©ç”±å¤–è®¾åˆ°å­˜å‚¨å™¨ï¼ŒADCæ•°æ®å¯„å­˜å™¨è½¬åˆ°æ•°ç»„</span></span><br><span class="line">DMA_InitStructure.DMA_BufferSize =<span class="number">5</span>;<span class="comment">//è½¬è¿æ¬¡æ•°</span></span><br><span class="line">DMA_InitStructure.DMA_Mode = DMA_Mode_Circular;<span class="comment">//å¾ªç¯æ¨¡å¼ï¼Œä¸ADCçš„è¿ç»­è½¬æ¢ä¸€è‡´</span></span><br><span class="line">DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;<span class="comment">//å­˜å‚¨å™¨åˆ°å­˜å‚¨å™¨å¤±èƒ½</span></span><br><span class="line">DMA_InitStructure.DMA_Priority = DMA_Priority_Medium;<span class="comment">//ä¼˜å…ˆçº§ï¼Œä¸­ç­‰</span></span><br><span class="line">DMA_Init(DMA1_Channel1, &amp;DMA_InitStructure);<span class="comment">//å°†ç»“æ„ä½“å˜é‡äº¤ç»™DMA_Initï¼Œé…ç½®DMA1çš„é€šé“1</span></span><br><span class="line"></span><br><span class="line">DMA_Cmd(DMA1_Channel1, ENABLE);</span><br><span class="line">DMA_Cmd(DMA2_Channel5, ENABLE);</span><br><span class="line">ADC_DMACmd(ADC3, ENABLE);<span class="comment">//ADC3è§¦å‘DMA2çš„ä¿¡å·ä½¿èƒ½</span></span><br><span class="line">ADC_DMACmd(ADC1, ENABLE);</span><br><span class="line">ADC_Cmd(ADC1, ENABLE);</span><br><span class="line">ADC_Cmd(ADC3, ENABLE);</span><br><span class="line"></span><br><span class="line">DMA_ITConfig(DMA2_Channel5, DMA_IT_TC, ENABLE);  <span class="comment">// å¯ç”¨ä¼ è¾“å®Œæˆä¸­æ–­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½® DMA ä¸­æ–­</span></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannel = DMA2_Channel4_5_IRQn; <span class="comment">//45å…±äº«ä¸­æ–­</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>; <span class="comment">// å…ˆå ä¼˜å…ˆçº§</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>; <span class="comment">// ä»ä¼˜å…ˆçº§</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE; <span class="comment">// ä½¿èƒ½ä¸­æ–­</span></span><br><span class="line">    NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DMA_ITConfig(DMA1_Channel1, DMA_IT_TC, ENABLE);  <span class="comment">// å¯ç”¨ä¼ è¾“å®Œæˆä¸­æ–­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½® DMA ä¸­æ–­</span></span><br><span class="line"></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannel = DMA1_Channel1_IRQn; </span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>; <span class="comment">// å…ˆå ä¼˜å…ˆçº§</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>; <span class="comment">// ä»ä¼˜å…ˆçº§</span></span><br><span class="line">    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE; <span class="comment">// ä½¿èƒ½ä¸­æ–­</span></span><br><span class="line">    NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ADCæ ¡å‡†</span></span><br><span class="line">ADC_ResetCalibration(ADC3);<span class="comment">//å›ºå®šæµç¨‹ï¼Œå†…éƒ¨æœ‰ç”µè·¯ä¼šè‡ªåŠ¨æ‰§è¡Œæ ¡å‡†</span></span><br><span class="line"><span class="keyword">while</span> (ADC_GetResetCalibrationStatus(ADC3) == SET);</span><br><span class="line">ADC_StartCalibration(ADC3);</span><br><span class="line"><span class="keyword">while</span> (ADC_GetCalibrationStatus(ADC3) == SET);</span><br><span class="line"></span><br><span class="line">ADC_ResetCalibration(ADC1);<span class="comment">//å›ºå®šæµç¨‹ï¼Œå†…éƒ¨æœ‰ç”µè·¯ä¼šè‡ªåŠ¨æ‰§è¡Œæ ¡å‡†</span></span><br><span class="line"><span class="keyword">while</span> (ADC_GetResetCalibrationStatus(ADC3) == SET);</span><br><span class="line">ADC_StartCalibration(ADC1);</span><br><span class="line"><span class="keyword">while</span> (ADC_GetCalibrationStatus(ADC3) == SET);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ADCè§¦å‘</span></span><br><span class="line">ADC_SoftwareStartConvCmd(ADC3, ENABLE);</span><br><span class="line">ADC_SoftwareStartConvCmd(ADC1, ENABLE);<span class="comment">//è½¯ä»¶è§¦å‘ADCå¼€å§‹å·¥ä½œï¼Œç”±äºADCå¤„äºè¿ç»­è½¬æ¢æ¨¡å¼ï¼Œæ•…è§¦å‘ä¸€æ¬¡åADCå°±å¯ä»¥ä¸€ç›´è¿ç»­ä¸æ–­åœ°å·¥ä½œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="mainå‡½æ•°è°ƒç”¨"><a href="#mainå‡½æ•°è°ƒç”¨" class="headerlink" title="mainå‡½æ•°è°ƒç”¨"></a>mainå‡½æ•°è°ƒç”¨</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Serial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;vofa.h&quot;</span></span></span><br><span class="line"><span class="type">float</span> mydata[<span class="number">10</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Serial_Init();</span><br><span class="line">OLED_Init();</span><br><span class="line">AD_Init();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»¥dma2ä¸ºä¸»ï¼Œdma2è§¦å‘ä»¥åï¼Œé¡ºä¾¿æŠŠdma1å’Œdam2çš„ä¸€å—å‘å‡ºå»ï¼Œå½“ç„¶dma1çš„è‡ªå·±ä¹Ÿå­˜ä¸€é</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">DMA2_Channel4_5_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (DMA_GetITStatus(DMA2_IT_TC5)) &#123;</span><br><span class="line">        mydata[<span class="number">0</span>] = AD_Value_for_DMA2[<span class="number">0</span>];</span><br><span class="line">mydata[<span class="number">1</span>] = AD_Value_for_DMA2[<span class="number">1</span>];</span><br><span class="line">mydata[<span class="number">2</span>] = AD_Value_for_DMA2[<span class="number">2</span>];</span><br><span class="line">mydata[<span class="number">3</span>] = AD_Value_for_DMA2[<span class="number">3</span>];</span><br><span class="line">         mydata[<span class="number">4</span>] = AD_Value_for_DMA2[<span class="number">4</span>];</span><br><span class="line">mydata[<span class="number">5</span>] = AD_Value_for_DMA1[<span class="number">0</span>];</span><br><span class="line">mydata[<span class="number">6</span>] = AD_Value_for_DMA1[<span class="number">1</span>];</span><br><span class="line">mydata[<span class="number">7</span>] = AD_Value_for_DMA1[<span class="number">2</span>];        </span><br><span class="line">mydata[<span class="number">8</span>] = AD_Value_for_DMA1[<span class="number">3</span>];</span><br><span class="line">mydata[<span class="number">9</span>] = AD_Value_for_DMA1[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">Vofa_JustFloat(mydata,<span class="number">10</span>);</span><br><span class="line">        DMA_ClearITPendingBit(DMA2_IT_TC5); <span class="comment">// æ¸…é™¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">DMA1_Channel1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (DMA_GetITStatus(DMA1_IT_TC1)) &#123;</span><br><span class="line">mydata[<span class="number">5</span>] = AD_Value_for_DMA1[<span class="number">0</span>];</span><br><span class="line">mydata[<span class="number">6</span>] = AD_Value_for_DMA1[<span class="number">1</span>];</span><br><span class="line">mydata[<span class="number">7</span>] = AD_Value_for_DMA1[<span class="number">2</span>];        </span><br><span class="line">mydata[<span class="number">8</span>] = AD_Value_for_DMA1[<span class="number">3</span>];</span><br><span class="line">mydata[<span class="number">9</span>] = AD_Value_for_DMA1[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">        DMA_ClearITPendingBit(DMA1_IT_TC1); <span class="comment">// æ¸…é™¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ç°è±¡ï¼š-2"><a href="#è§†é¢‘ç°è±¡ï¼š-2" class="headerlink" title="è§†é¢‘ç°è±¡ï¼š"></a>è§†é¢‘ç°è±¡ï¼š</h3><h2 id="ä»»åŠ¡å››ï¼šè¿›è¡Œç®€å•çš„å¾ªè¿¹"><a href="#ä»»åŠ¡å››ï¼šè¿›è¡Œç®€å•çš„å¾ªè¿¹" class="headerlink" title="ä»»åŠ¡å››ï¼šè¿›è¡Œç®€å•çš„å¾ªè¿¹"></a>ä»»åŠ¡å››ï¼šè¿›è¡Œç®€å•çš„å¾ªè¿¹</h2><h2 id="å¤–è®¾åŸç†"><a href="#å¤–è®¾åŸç†" class="headerlink" title="å¤–è®¾åŸç†"></a>å¤–è®¾åŸç†</h2><p><strong>çº¢å¤–å¯¹ç®¡</strong>ï¼šçº¢å¤–å¯¹ç®¡å¾ªè¿¹çš„åŸç†ä¸»è¦æ˜¯åˆ©ç”¨äº†ä¸åŒé¢œè‰²ç‰©ä½“å¯¹çº¢å¤–çº¿çš„åå°„å’Œå¸æ”¶èƒ½åŠ›ä¸åŒã€‚å…¶åŸºæœ¬å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p> çº¢å¤–å‘å°„ï¼šçº¢å¤–å¯¹ç®¡ç”±ä¸€ä¸ªçº¢å¤–å‘å°„ç®¡å’Œä¸€ä¸ªçº¢å¤–æ¥æ”¶ç®¡ç»„æˆã€‚çº¢å¤–å‘å°„ç®¡é€šç”µåä¼šæŒç»­å‘å¤–å‘å°„ç‰¹å®šæ³¢é•¿çš„çº¢å¤–çº¿ã€‚</p><p>å…‰çº¿åå°„ï¼šå½“çº¢å¤–å…‰çº¿ç…§å°„åˆ°ç‰©ä½“è¡¨é¢æ—¶ï¼Œæ ¹æ®ç‰©ä½“çš„é¢œè‰²å’Œæè´¨ç‰¹æ€§ï¼Œä¼šå¯¹çº¢å¤–çº¿äº§ç”Ÿä¸åŒçš„åå°„æƒ…å†µã€‚ç™½è‰²ç‰©ä½“å¯¹å…‰çº¿çš„åå°„èƒ½åŠ›è¾ƒå¼ºï¼Œèƒ½å¤Ÿå°†å¤§éƒ¨åˆ†ç…§å°„åˆ°å…¶è¡¨é¢çš„çº¢å¤–çº¿åå°„å‡ºå»ï¼›è€Œé»‘è‰²ç‰©ä½“å¯¹å…‰çº¿çš„å¸æ”¶èƒ½åŠ›è¾ƒå¼ºï¼Œåå°„çš„çº¢å¤–çº¿åˆ™è¾ƒå°‘ã€‚</p><p>æ¥æ”¶ä¸è½¬æ¢ï¼šçº¢å¤–æ¥æ”¶ç®¡æ˜¯ä¸€ç§å¯¹çº¢å¤–çº¿æ•æ„Ÿçš„å…‰æ•å…ƒä»¶ã€‚å½“æ¥æ”¶ç®¡æ¥æ”¶åˆ°åå°„å›æ¥çš„çº¢å¤–çº¿æ—¶ï¼Œå…¶å†…éƒ¨çš„ç‰©ç†ç‰¹æ€§ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œäº§ç”Ÿç”µæµæˆ–ç”µå‹çš„å˜åŒ–ã€‚å¦‚æœæ¥æ”¶åˆ°çš„çº¢å¤–å…‰å¼ºåº¦è¾ƒå¤§ï¼Œæ¥æ”¶ç®¡äº§ç”Ÿçš„ç”µæµæˆ–ç”µå‹å°±ä¼šç›¸åº”è¾ƒå¤§ï¼›åä¹‹ï¼Œå¦‚æœæ¥æ”¶åˆ°çš„çº¢å¤–å…‰å¾ˆå¼±æˆ–å‡ ä¹æ²¡æœ‰ï¼Œæ¥æ”¶ç®¡äº§ç”Ÿçš„ç”µæµæˆ–ç”µå‹å°±ä¼šéå¸¸å°ã€‚</p><p> ä¿¡å·è¾“å‡ºä¸åˆ¤æ–­ï¼šé€šå¸¸ä¼šå°†çº¢å¤–æ¥æ”¶ç®¡çš„è¾“å‡ºä¿¡å·è¿æ¥åˆ°ä¸€ä¸ªæ¯”è¾ƒç”µè·¯æˆ–ä¿¡å·å¤„ç†ç”µè·¯ã€‚è¯¥ç”µè·¯ä¼šå°†æ¥æ”¶ç®¡è¾“å‡ºçš„ä¿¡å·ä¸ä¸€ä¸ªé¢„è®¾çš„é˜ˆå€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ¥æ”¶ç®¡è¾“å‡ºçš„ä¿¡å·å¤§äºé˜ˆå€¼ï¼Œè¯´æ˜æ¥æ”¶åˆ°çš„çº¢å¤–å…‰è¾ƒå¼ºï¼Œæ­¤æ—¶åˆ¤æ–­ä¸ºçº¢å¤–å¯¹ç®¡å¤„äºç™½è‰²åŒºåŸŸï¼›å¦‚æœæ¥æ”¶ç®¡è¾“å‡ºçš„ä¿¡å·å°äºé˜ˆå€¼ï¼Œè¯´æ˜æ¥æ”¶åˆ°çš„çº¢å¤–å…‰è¾ƒå¼±ï¼Œæ­¤æ—¶åˆ¤æ–­ä¸ºçº¢å¤–å¯¹ç®¡å¤„äºé»‘è‰²è½¨è¿¹ä¸Šã€‚</p><p>åŸºäºä»¥ä¸ŠåŸç†ï¼Œå°†çº¢å¤–å¯¹ç®¡å®‰è£…åœ¨ç§»åŠ¨çš„ç‰©ä½“ï¼ˆå¦‚æ™ºèƒ½å°è½¦ï¼‰ä¸Šï¼Œå¹¶åˆç†è®¾ç½®å¤šä¸ªçº¢å¤–å¯¹ç®¡çš„ä½ç½®ï¼Œå°±å¯ä»¥é€šè¿‡æ£€æµ‹ä¸åŒä½ç½®çš„çº¢å¤–å¯¹ç®¡ä¿¡å·ï¼Œåˆ¤æ–­ç‰©ä½“ç›¸å¯¹äºé»‘çº¿è½¨è¿¹çš„ä½ç½®ï¼Œä»è€Œå®ç°å¾ªè¿¹åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå½“å°è½¦çš„å·¦ä¾§çº¢å¤–å¯¹ç®¡æ£€æµ‹åˆ°é»‘è‰²è½¨è¿¹ï¼Œè€Œå³ä¾§çº¢å¤–å¯¹ç®¡æ£€æµ‹åˆ°ç™½è‰²åŒºåŸŸæ—¶ï¼Œè¯´æ˜å°è½¦å‘å·¦åç¦»äº†è½¨è¿¹ï¼Œæ§åˆ¶ç³»ç»Ÿå°±å¯ä»¥æ§åˆ¶å°è½¦å‘å³è½¬ï¼Œä»¥ä¿æŒåœ¨é»‘è‰²è½¨è¿¹ä¸Šè¡Œé©¶ã€‚</p><p><strong>å¾ªè¿¹æ¨¡å—</strong>ï¼šæ ¹æ®çº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­å°è½¦è¡Œèµ°çš„çŠ¶æ€</p><p>5ä¸ªçº¢å¤–å¯¹ç®¡å®‰è£…åœ¨å°è½¦çš„å¯¹åº”ä½ç½®</p><p>å°†ADCå€¼è½¬æ¢ä¸ºé»‘çº¿1æˆ–è€…æ²¡æœ‰çº¿0,çº¢å¤–å¯¹ç®¡ä»å·¦å¾€å³åˆ†åˆ«ä¸ºIPT0,IPT1ï¼ŒIPT2ï¼ŒIPT3ï¼ŒIPT4</p><p>æˆ‘ä»¬æ ¹æ®åå°„å›çš„ä¿¡æ¯å°†å°è½¦è¿åŠ¨åˆ†ä¸ºå‡ ç§æƒ…å†µ</p><p><strong>PIDï¼š</strong>æ¯”ä¾‹-ç§¯åˆ†-å¾®åˆ†æ§åˆ¶å™¨ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„åé¦ˆæ§åˆ¶ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºå·¥ä¸šæ§åˆ¶ã€è‡ªåŠ¨åŒ–ç­‰é¢†åŸŸã€‚</p><p> åŸºæœ¬åŸç†</p><ol><li>æ¯”ä¾‹æ§åˆ¶ï¼ˆPï¼‰</li></ol><p> æ¯”ä¾‹æ§åˆ¶æ˜¯æ ¹æ®å½“å‰çš„è¯¯å·®å€¼ä¸ä¸€ä¸ªæ¯”ä¾‹ç³»æ•°ç›¸ä¹˜æ¥è®¡ç®—æ§åˆ¶é‡ã€‚è¯¯å·®å€¼æ˜¯è®¾å®šå€¼ä¸å®é™…å€¼ä¹‹é—´çš„å·®å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœè®¾å®šæ¸©åº¦ä¸º 50â„ƒï¼Œå½“å‰å®é™…æ¸©åº¦ä¸º 45â„ƒï¼Œè¯¯å·®ä¸º 5â„ƒã€‚å‡è®¾æ¯”ä¾‹ç³»æ•°ä¸º 2ï¼Œé‚£ä¹ˆæ¯”ä¾‹æ§åˆ¶çš„è¾“å‡ºä¸º 5Ã—2 &#x3D; 10ã€‚</p><p>æ¯”ä¾‹æ§åˆ¶çš„ä½œç”¨æ˜¯å¯¹è¯¯å·®è¿›è¡Œå¿«é€Ÿå“åº”ï¼Œä½†ä¸èƒ½æ¶ˆé™¤ç¨³æ€è¯¯å·®ï¼Œå³å½“ç³»ç»Ÿè¾¾åˆ°ç¨³å®šçŠ¶æ€æ—¶ï¼Œå¯èƒ½ä»ç„¶å­˜åœ¨ä¸€å®šçš„è¯¯å·®ã€‚</p><ol start="2"><li>ç§¯åˆ†æ§åˆ¶ï¼ˆIï¼‰</li></ol><p> ç§¯åˆ†æ§åˆ¶æ˜¯å¯¹è¯¯å·®è¿›è¡Œç´¯ç§¯æ±‚å’Œï¼Œå¹¶å°†ç´¯ç§¯çš„è¯¯å·®ä¸ä¸€ä¸ªç§¯åˆ†ç³»æ•°ç›¸ä¹˜æ¥è®¡ç®—æ§åˆ¶é‡ã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç§¯åˆ†é¡¹ä¼šä¸æ–­å¢å¤§ï¼Œç›´åˆ°è¯¯å·®ä¸ºé›¶ã€‚ç§¯åˆ†æ§åˆ¶çš„ä½œç”¨æ˜¯æ¶ˆé™¤ç¨³æ€è¯¯å·®ï¼Œä½†ç§¯åˆ†ä½œç”¨è¿‡å¼ºå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå“åº”å˜æ…¢æˆ–å‡ºç°è¶…è°ƒã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨æ¸©åº¦æ§åˆ¶ä¸­ï¼Œå¦‚æœè¯¯å·®ä¸€ç›´å­˜åœ¨ï¼Œç§¯åˆ†é¡¹ä¼šä¸æ–­ç´¯ç§¯ï¼Œä½¿å¾—æ§åˆ¶é‡é€æ¸å¢å¤§ï¼Œç›´åˆ°æ¸©åº¦è¾¾åˆ°è®¾å®šå€¼ã€‚</p><ol start="3"><li>å¾®åˆ†æ§åˆ¶ï¼ˆDï¼‰</li></ol><p> å¾®åˆ†æ§åˆ¶æ˜¯æ ¹æ®è¯¯å·®çš„å˜åŒ–ç‡ï¼ˆå³å½“å‰è¯¯å·®ä¸ä¸Šä¸€æ—¶åˆ»è¯¯å·®çš„å·®å€¼ï¼‰ä¸ä¸€ä¸ªå¾®åˆ†ç³»æ•°ç›¸ä¹˜æ¥è®¡ç®—æ§åˆ¶é‡ã€‚</p><p>å¾®åˆ†æ§åˆ¶çš„ä½œç”¨æ˜¯é¢„æµ‹è¯¯å·®çš„å˜åŒ–è¶‹åŠ¿ï¼Œæå‰ç»™å‡ºæ§åˆ¶ä¿¡å·ï¼Œä»è€Œå‡å°è¶…è°ƒé‡å’Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ¸©åº¦ä¸Šå‡é€Ÿåº¦å¾ˆå¿«ï¼Œå¾®åˆ†æ§åˆ¶ä¼šäº§ç”Ÿä¸€ä¸ªè¾ƒå¤§çš„è´Ÿæ§åˆ¶é‡ï¼Œä»¥æŠ‘åˆ¶æ¸©åº¦çš„å¿«é€Ÿä¸Šå‡ã€‚</p><p> å·¥ä½œè¿‡ç¨‹</p><p>  é¦–å…ˆï¼Œæµ‹é‡ç³»ç»Ÿçš„å®é™…è¾“å‡ºå€¼ã€‚</p><p>ç„¶åï¼Œè®¡ç®—å®é™…è¾“å‡ºå€¼ä¸è®¾å®šå€¼ä¹‹é—´çš„è¯¯å·®ã€‚</p><p>åˆ†åˆ«è®¡ç®—æ¯”ä¾‹ã€ç§¯åˆ†å’Œå¾®åˆ†ä¸‰ä¸ªéƒ¨åˆ†çš„æ§åˆ¶é‡ï¼š</p><p>æ¯”ä¾‹æ§åˆ¶é‡ &#x3D; æ¯”ä¾‹ç³»æ•° Ã— è¯¯å·®</p><p>ç§¯åˆ†æ§åˆ¶é‡ &#x3D; ç§¯åˆ†ç³»æ•° Ã— è¯¯å·®çš„ç´¯ç§¯å’Œ</p><p>å¾®åˆ†æ§åˆ¶é‡ &#x3D; å¾®åˆ†ç³»æ•° Ã— è¯¯å·®çš„å˜åŒ–ç‡</p><p>å°†ä¸‰ä¸ªéƒ¨åˆ†çš„æ§åˆ¶é‡ç›¸åŠ ï¼Œå¾—åˆ°æ€»çš„æ§åˆ¶é‡ã€‚</p><p> æ ¹æ®æ§åˆ¶é‡æ¥è°ƒæ•´ç³»ç»Ÿçš„è¾“å…¥ï¼Œä½¿ç³»ç»Ÿçš„è¾“å‡ºé€æ¸æ¥è¿‘è®¾å®šå€¼ã€‚</p><h2 id="å¤–è®¾åº”ç”¨"><a href="#å¤–è®¾åº”ç”¨" class="headerlink" title="å¤–è®¾åº”ç”¨"></a>å¤–è®¾åº”ç”¨</h2><p>æˆ‘ä»¬æ ¹æ®åå°„å›çš„ä¿¡æ¯å°†å°è½¦è¿åŠ¨åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µ</p><ol><li>ç›´è¡Œ</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º00100</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">qianjin();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ol><li>å·¦è½¬90åº¦</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º11000æˆ–è€…11100</p><p>å¼€å§‹å·¦è½¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnleft(<span class="number">90</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å³è½¬90åº¦</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º00011æˆ–è€…00111</p><p>å¼€å§‹å³è½¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">90</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å‘å·¦åä¸€äº›</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º01000</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnleft(<span class="number">30</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å‘å³åä¸€äº›</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º00010</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">30</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æ‰å¤´</li></ol><p>æ­¤æ—¶äº”ä¸ªçº¢å¤–å¯¹ç®¡åå°„å›çš„ä¿¡æ¯ä¸º00000</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">180</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>åœ¨é‡è§å²”è·¯æ—¶ï¼Œé€‰æ‹©å³è½¬</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">90</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç›´æµç”µæœºä½œä¸ºåŠ¨åŠ›æºï¼Œé€šè¿‡ç”µæœºé©±åŠ¨ç”µè·¯æ¥æ§åˆ¶ç”µæœºçš„è½¬é€Ÿå’Œæ–¹å‘ã€‚</p><p>é€šè¿‡æ§åˆ¶å·¦å³ä¸¤ä¸ªç”µæœºçš„è½¬é€Ÿå’Œæ–¹å‘ï¼Œå¯ä»¥ä½¿å°è½¦å®ç°å‰è¿›ã€åé€€ã€è½¬å¼¯ç­‰åŠ¨ä½œã€‚ä¾‹å¦‚ï¼Œå½“å·¦ä¾§ç”µæœºè½¬é€Ÿé«˜äºå³ä¾§ç”µæœºè½¬é€Ÿæ—¶ï¼Œå°è½¦ä¼šå‘å³è½¬ï¼›å½“å³ä¾§ç”µæœºè½¬é€Ÿé«˜äºå·¦ä¾§ç”µæœºè½¬é€Ÿæ—¶ï¼Œå°è½¦ä¼šå‘å·¦è½¬ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">leftforward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rightforward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">leftbackward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rightbackward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">turnright</span><span class="params">(<span class="type">uint16_t</span> angle)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> dt = (<span class="number">8</span>*angle);</span><br><span class="line">leftforward();</span><br><span class="line">rightbackward();</span><br><span class="line">Delay_ms(dt);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">turnleft</span><span class="params">(<span class="type">uint16_t</span> angle)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> dt = (<span class="number">8</span>*angle);</span><br><span class="line">leftbackward();</span><br><span class="line">rightforward();</span><br><span class="line">Delay_ms(dt);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨PWMæ”¹å˜é€Ÿåº¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">my_set_tim_compare</span><span class="params">(<span class="type">uint16_t</span> brr)</span></span><br><span class="line">&#123;</span><br><span class="line">TIM_SetCompare2(TIM4,brr);</span><br><span class="line">TIM_SetCompare1(TIM4,brr);</span><br><span class="line">TIM_SetCompare2(TIM2,brr);</span><br><span class="line">TIM_SetCompare1(TIM2,brr);</span><br><span class="line">TIM_SetCompare2(TIM1,brr);</span><br><span class="line">TIM_SetCompare1(TIM1,brr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PDout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOD, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOD, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PEout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOE, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOE, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PBout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOB, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOB, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM4_PWM_Init</span><span class="params">(u16 arr,u16 psc)</span></span><br><span class="line">&#123;  </span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;</span><br><span class="line">TIM_OCInitTypeDef  TIM_OCInitStructure;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4, ENABLE);</span><br><span class="line"> RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOD,ENABLE); </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7; <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;  <span class="comment">//å¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);<span class="comment">//TIM4é€šé“2</span></span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6; <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;  <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);<span class="comment">//TIM4é€šé“1</span></span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_12);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_13;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_13);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_14; </span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_14);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_15;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_15);</span><br><span class="line"> </span><br><span class="line">TIM_TimeBaseStructure.TIM_Period = arr; </span><br><span class="line">TIM_TimeBaseStructure.TIM_Prescaler =psc; </span><br><span class="line">TIM_TimeBaseStructure.TIM_ClockDivision = <span class="number">0</span>; </span><br><span class="line">TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  </span><br><span class="line">TIM_TimeBaseInit(TIM4, &amp;TIM_TimeBaseStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC2Init(TIM4, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM4, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">TIM_Cmd(TIM4, ENABLE);  </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_PWM_Init</span><span class="params">(u16 arr,u16 psc)</span></span><br><span class="line">&#123;  </span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;</span><br><span class="line">TIM_OCInitTypeDef  TIM_OCInitStructure;</span><br><span class="line"> </span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);</span><br><span class="line"> RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOE,ENABLE); </span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE); </span><br><span class="line"></span><br><span class="line">  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOE, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOE,GPIO_Pin_9);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOE, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOE,GPIO_Pin_11);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10; </span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOB, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_10);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOB, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_11);</span><br><span class="line"> </span><br><span class="line">TIM_TimeBaseStructure.TIM_Period = arr; </span><br><span class="line">TIM_TimeBaseStructure.TIM_Prescaler =psc; </span><br><span class="line">TIM_TimeBaseStructure.TIM_ClockDivision = <span class="number">0</span>; </span><br><span class="line">TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  </span><br><span class="line">TIM_TimeBaseInit(TIM2, &amp;TIM_TimeBaseStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC2Init(TIM2, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM2, &amp;TIM_OCInitStructure);  </span><br><span class="line"></span><br><span class="line"> TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2;</span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM1, &amp;TIM_OCInitStructure);</span><br><span class="line"> </span><br><span class="line">TIM_Cmd(TIM2, ENABLE); </span><br><span class="line">TIM_Cmd(TIM1, ENABLE);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">qianjin</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">houtui</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">stop</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“åˆä»»åŠ¡äºŒçš„éƒ¨åˆ†ï¼Œè®¾è®¡å‡ºç®€å•çš„å¾ªè¿¹ç®—æ³•</p><h2 id="ä»»åŠ¡å®ç°"><a href="#ä»»åŠ¡å®ç°" class="headerlink" title="ä»»åŠ¡å®ç°"></a>ä»»åŠ¡å®ç°</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;contral car.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;PWM.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OLED.h&quot;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">TIM4_PWM_Init(<span class="number">450</span>,<span class="number">7199</span>);</span><br><span class="line">TIM2_PWM_Init(<span class="number">450</span>,<span class="number">7199</span>);</span><br><span class="line">AD_Init();</span><br><span class="line">OLED_Init();</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  AD_GetValue();</span><br><span class="line">  OLED_ShowNum(<span class="number">1</span>,<span class="number">1</span>,IPT[<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line">  OLED_ShowNum(<span class="number">2</span>,<span class="number">1</span>,IPT[<span class="number">1</span>],<span class="number">1</span>);</span><br><span class="line">  OLED_ShowNum(<span class="number">3</span>,<span class="number">1</span>,IPT[<span class="number">2</span>],<span class="number">1</span>);</span><br><span class="line">  OLED_ShowNum(<span class="number">4</span>,<span class="number">1</span>,IPT[<span class="number">3</span>],<span class="number">1</span>);</span><br><span class="line">  OLED_ShowNum(<span class="number">1</span>,<span class="number">4</span>,IPT[<span class="number">4</span>],<span class="number">1</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//ç›´è¡Œ</span></span><br><span class="line">  <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">qianjin();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å·¦åä¸€ç‚¹ç‚¹</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnleft(<span class="number">30</span>);</span><br><span class="line">&#125;<span class="comment">//å³åä¸€ç‚¹ç‚¹</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">30</span>);</span><br><span class="line">&#125;<span class="comment">//å·¦è½¬</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnleft(<span class="number">90</span>);</span><br><span class="line">&#125;<span class="comment">//å³è½¬</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">90</span>);</span><br><span class="line">&#125;<span class="comment">//è½¬å¼¯</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">0</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">180</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(IPT[<span class="number">0</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">2</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">3</span>]==<span class="number">1</span>&amp;&amp;IPT[<span class="number">4</span>]==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">turnright(<span class="number">90</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint16_t</span> AD_Value[<span class="number">5</span>];</span><br><span class="line"><span class="type">uint16_t</span> tixed_value1=<span class="number">1000</span>;</span><br><span class="line"><span class="type">uint16_t</span> tixed_value2=<span class="number">500</span>;</span><br><span class="line"><span class="type">uint16_t</span> IPT[<span class="number">5</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">AD_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC3,ENABLE);<span class="comment">//å¼€å¯ADC1å’ŒGPIOCçš„æ—¶é’Ÿ</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC|RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line">RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA2,ENABLE);<span class="comment">//å¼€å¯æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RCC_ADCCLKConfig(RCC_PCLK2_Div6);<span class="comment">//åˆ†é¢‘ï¼Œåˆ†é¢‘ä¹‹åADCCLK=72MHz/6=12</span></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line"> GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;</span><br><span class="line">GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6|GPIO_Pin_8|GPIO_Pin_10|GPIO_Pin_9;</span><br><span class="line">GPIO_Init(GPIOF, &amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ADC_RegularChannelConfig(ADC3,ADC_Channel_4,<span class="number">1</span>,ADC_SampleTime_13Cycles5);<span class="comment">//è§„åˆ™ç»„åºåˆ—3çš„ä½ç½®ï¼Œé…ç½®ä¸ºé€šé“</span></span><br><span class="line"></span><br><span class="line">ADC_RegularChannelConfig(ADC3,ADC_Channel_6,<span class="number">2</span>,ADC_SampleTime_13Cycles5);<span class="comment">//è§„åˆ™ç»„åºåˆ—3çš„ä½ç½®ï¼Œé…ç½®ä¸ºé€šé“</span></span><br><span class="line">ADC_RegularChannelConfig(ADC3,ADC_Channel_7,<span class="number">3</span>,ADC_SampleTime_13Cycles5);<span class="comment">//è§„åˆ™ç»„åºåˆ—3çš„ä½ç½®ï¼Œé…ç½®ä¸ºé€šé“</span></span><br><span class="line">ADC_RegularChannelConfig(ADC3,ADC_Channel_8,<span class="number">4</span>,ADC_SampleTime_13Cycles5);<span class="comment">//è§„åˆ™ç»„åºåˆ—3çš„ä½ç½®ï¼Œé…ç½®ä¸ºé€šé“</span></span><br><span class="line"></span><br><span class="line">    ADC_RegularChannelConfig(ADC3,ADC_Channel_12,<span class="number">5</span>,ADC_SampleTime_13Cycles5);<span class="comment">//è§„åˆ™ç»„åºåˆ—1çš„ä½ç½®ï¼Œé…ç½®ä¸ºé€šé“</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ADC_InitTypeDef ADC_InitStructure;</span><br><span class="line">ADC_InitStructure.ADC_ContinuousConvMode=DISABLE ;</span><br><span class="line">ADC_InitStructure.ADC_DataAlign=ADC_DataAlign_Right;<span class="comment">//æ•°æ®å¯¹é½ï¼Œé€‰æ‹©å³å¯¹é½</span></span><br><span class="line">ADC_InitStructure.ADC_ExternalTrigConv=ADC_ExternalTrigConv_None;<span class="comment">//å¤–éƒ¨è§¦å‘ï¼Œä½¿ç”¨è½¯ä»¶è§¦å‘ï¼Œä¸éœ€è¦å¤–éƒ¨è§¦å‘</span></span><br><span class="line">ADC_InitStructure.ADC_Mode=ADC_Mode_Independent;<span class="comment">//æ¨¡å¼ï¼Œé€‰æ‹©ç‹¬ç«‹æ¨¡å¼ï¼Œå³å•ç‹¬ä½¿ç”¨ADC1</span></span><br><span class="line">ADC_InitStructure.ADC_NbrOfChannel=<span class="number">5</span> ;<span class="comment">//é€šé“æ•°ï¼Œä¸º1ï¼Œä»…åœ¨æ‰«ææ¨¡å¼ä¸‹ï¼Œæ‰éœ€è¦æŒ‡å®šå¤§äº1çš„æ•°ï¼Œåœ¨éæ‰«ææ¨¡å¼ä¸‹ï¼Œåªèƒ½æ˜¯1</span></span><br><span class="line">ADC_InitStructure.ADC_ScanConvMode=ENABLE ;<span class="comment">//æ‰«ææ¨¡å¼</span></span><br><span class="line">ADC_Init(ADC3,&amp;ADC_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DMA_InitTypeDef DMA_InitStructure;</span><br><span class="line">DMA_InitStructure.DMA_BufferSize=<span class="number">5</span>;<span class="comment">//è½¬è¿çš„æ•°æ®å¤§å°ï¼ˆè½¬è¿æ¬¡æ•°ï¼‰</span></span><br><span class="line">DMA_InitStructure.DMA_DIR=DMA_DIR_PeripheralSRC;<span class="comment">//æ•°æ®ä¼ è¾“æ–¹å‘ï¼Œé€‰æ‹©ç”±å¤–è®¾åˆ°å­˜å‚¨å™¨</span></span><br><span class="line">DMA_InitStructure.DMA_M2M=DMA_M2M_Disable;<span class="comment">//ç¡¬ä»¶è§¦å‘æˆ–è€…è½¯ä»¶è§¦å‘,è¯¥å¤„é€‰æ‹©è½¯ä»¶è§¦å‘</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryBaseAddr=(<span class="type">uint32_t</span>)AD_Value;<span class="comment">//å­˜å‚¨å™¨åˆå§‹åœ°å€ï¼Œç»™å®šå½¢å‚AddrB</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryDataSize=DMA_MemoryDataSize_HalfWord;<span class="comment">//å­˜å‚¨å™¨æ•°æ®å®½åº¦ï¼Œé€‰æ‹©å­—èŠ‚</span></span><br><span class="line">DMA_InitStructure.DMA_MemoryInc=DMA_MemoryInc_Enable;<span class="comment">//å­˜å‚¨å™¨åœ°å€è‡ªå¢ï¼Œé€‰æ‹©ä½¿èƒ½</span></span><br><span class="line">DMA_InitStructure.DMA_Mode=DMA_Mode_Normal;<span class="comment">//æ¨¡å¼ï¼Œé€‰æ‹©æ­£å¸¸æ¨¡å¼</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralBaseAddr=(<span class="type">uint32_t</span>)&amp;ADC3-&gt;DR;<span class="comment">//å¤–è®¾åˆå§‹åœ°å€ï¼Œç»™å®šå½¢å‚AddrA</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralDataSize=DMA_PeripheralDataSize_HalfWord;<span class="comment">//å¤–è®¾æ•°æ®å®½åº¦ï¼Œé€‰æ‹©å­—èŠ‚</span></span><br><span class="line">DMA_InitStructure.DMA_PeripheralInc=DMA_PeripheralInc_Disable;<span class="comment">//å¤–è®¾åœ°å€è‡ªå¢ï¼Œé€‰æ‹©ä½¿èƒ½</span></span><br><span class="line">DMA_InitStructure.DMA_Priority=DMA_Priority_Medium;<span class="comment">//ä¼˜å…ˆçº§ï¼Œé€‰æ‹©ä¸­ç­‰</span></span><br><span class="line">DMA_Init(DMA2_Channel5,&amp;DMA_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DMA_Cmd(DMA2_Channel5,ENABLE);</span><br><span class="line">ADC_DMACmd(ADC3 ,ENABLE );</span><br><span class="line">ADC_Cmd(ADC3,ENABLE);</span><br><span class="line"></span><br><span class="line">ADC_ResetCalibration(ADC3);<span class="comment">//æ ¡å‡†</span></span><br><span class="line"><span class="keyword">while</span>(ADC_GetResetCalibrationStatus(ADC3)==SET);</span><br><span class="line">ADC_StartCalibration(ADC3);</span><br><span class="line"><span class="keyword">while</span>(ADC_GetCalibrationStatus(ADC3)==SET);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>  <span class="title function_">AD_GetValue</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">DMA_Cmd(DMA2_Channel5,DISABLE);</span><br><span class="line">DMA_SetCurrDataCounter (DMA2_Channel5,<span class="number">5</span>);</span><br><span class="line">DMA_Cmd(DMA2_Channel5,ENABLE);</span><br><span class="line"></span><br><span class="line">ADC_SoftwareStartConvCmd(ADC3,ENABLE);<span class="comment">//è½¯ä»¶è§¦å‘ADè½¬æ¢ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(DMA_GetFlagStatus(DMA2_FLAG_TC5)==RESET);</span><br><span class="line">DMA_ClearFlag(DMA2_FLAG_TC5);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†ADCå€¼è½¬æ¢ä¸ºé»‘çº¿1æˆ–è€…æ²¡æœ‰çº¿0,çº¢å¤–å¯¹ç®¡ä»å·¦å¾€å³åˆ†åˆ«ä¸ºIPT0,IPT1ï¼ŒIPT2ï¼ŒIPT3ï¼ŒIPT4</span></span><br><span class="line"><span class="type">uint8_t</span> i;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=<span class="number">7</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(AD_Value[i]&gt;=tixed_value1)</span><br><span class="line">&#123;</span><br><span class="line">IPT[i]=<span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (AD_Value[i]&lt;=tixed_value2) &#123;</span><br><span class="line">   IPT[i]=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> IPT[i]=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">my_set_tim_compare</span><span class="params">(<span class="type">uint16_t</span> brr)</span></span><br><span class="line">&#123;</span><br><span class="line">TIM_SetCompare2(TIM4,brr);</span><br><span class="line">TIM_SetCompare1(TIM4,brr);</span><br><span class="line">TIM_SetCompare2(TIM2,brr);</span><br><span class="line">TIM_SetCompare1(TIM2,brr);</span><br><span class="line">TIM_SetCompare2(TIM1,brr);</span><br><span class="line">TIM_SetCompare1(TIM1,brr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PDout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOD, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOD, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PEout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOE, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOE, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PBout</span><span class="params">(<span class="type">uint8_t</span> pin, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        GPIO_SetBits(GPIOB, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin high</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GPIO_ResetBits(GPIOB, <span class="number">1</span> &lt;&lt; pin); <span class="comment">// Set the pin low</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM4_PWM_Init</span><span class="params">(u16 arr,u16 psc)</span></span><br><span class="line">&#123;  </span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;</span><br><span class="line">TIM_OCInitTypeDef  TIM_OCInitStructure;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4, ENABLE);</span><br><span class="line"> RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOD,ENABLE); </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7; <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;  <span class="comment">//å¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);<span class="comment">//TIM4é€šé“2</span></span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6; <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;  <span class="comment">//</span></span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);<span class="comment">//TIM4é€šé“1</span></span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_12);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_13;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_13);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_14; </span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_14);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_15;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOD, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOD,GPIO_Pin_15);</span><br><span class="line"> </span><br><span class="line">TIM_TimeBaseStructure.TIM_Period = arr; </span><br><span class="line">TIM_TimeBaseStructure.TIM_Prescaler =psc; </span><br><span class="line">TIM_TimeBaseStructure.TIM_ClockDivision = <span class="number">0</span>; </span><br><span class="line">TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  </span><br><span class="line">TIM_TimeBaseInit(TIM4, &amp;TIM_TimeBaseStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC2Init(TIM4, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM4, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">TIM_Cmd(TIM4, ENABLE);  </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_PWM_Init</span><span class="params">(u16 arr,u16 psc)</span></span><br><span class="line">&#123;  </span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;</span><br><span class="line">TIM_OCInitTypeDef  TIM_OCInitStructure;</span><br><span class="line"> </span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);</span><br><span class="line"> RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOE,ENABLE); </span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE); </span><br><span class="line"></span><br><span class="line">  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOE, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOE,GPIO_Pin_9);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOE, &amp;GPIO_InitStructure);</span><br><span class="line">GPIO_ResetBits(GPIOE,GPIO_Pin_11);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10; </span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOB, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_10);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; </span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class="line">GPIO_Init(GPIOB, &amp;GPIO_InitStructure); </span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_11);</span><br><span class="line"> </span><br><span class="line">TIM_TimeBaseStructure.TIM_Period = arr; </span><br><span class="line">TIM_TimeBaseStructure.TIM_Prescaler =psc; </span><br><span class="line">TIM_TimeBaseStructure.TIM_ClockDivision = <span class="number">0</span>; </span><br><span class="line">TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  </span><br><span class="line">TIM_TimeBaseInit(TIM2, &amp;TIM_TimeBaseStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC2Init(TIM2, &amp;TIM_OCInitStructure);  </span><br><span class="line"> </span><br><span class="line">TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2; </span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM2, &amp;TIM_OCInitStructure);  </span><br><span class="line"></span><br><span class="line"> TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM2;</span><br><span class="line"> TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable; </span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High; </span><br><span class="line">TIM_OC1Init(TIM1, &amp;TIM_OCInitStructure);</span><br><span class="line"> </span><br><span class="line">TIM_Cmd(TIM2, ENABLE); </span><br><span class="line">TIM_Cmd(TIM1, ENABLE);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">qianjin</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">houtui</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">stop</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;PWM.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">leftforward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rightforward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">1</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">leftbackward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PDout(<span class="number">12</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">13</span>,<span class="number">1</span>);</span><br><span class="line">PDout(<span class="number">14</span>,<span class="number">0</span>);</span><br><span class="line">PDout(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rightbackward</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PEout(<span class="number">9</span>,<span class="number">0</span>);</span><br><span class="line">PEout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">PBout(<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line">PBout(<span class="number">11</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">turnright</span><span class="params">(<span class="type">uint16_t</span> angle)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> dt = (<span class="number">8</span>*angle);</span><br><span class="line">leftforward();</span><br><span class="line">rightbackward();</span><br><span class="line">Delay_ms(dt);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">turnleft</span><span class="params">(<span class="type">uint16_t</span> angle)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> dt = (<span class="number">8</span>*angle);</span><br><span class="line">leftbackward();</span><br><span class="line">rightforward();</span><br><span class="line">Delay_ms(dt);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ï¼š"><a href="#è§†é¢‘ï¼š" class="headerlink" title="è§†é¢‘ï¼š"></a>è§†é¢‘ï¼š</h3><h2 id="ä»»åŠ¡äº”"><a href="#ä»»åŠ¡äº”" class="headerlink" title="ä»»åŠ¡äº”"></a>ä»»åŠ¡äº”</h2><h3 id="å¹¶è”æ¯”è¾ƒå‹ADCæ¦‚è¿°"><a href="#å¹¶è”æ¯”è¾ƒå‹ADCæ¦‚è¿°" class="headerlink" title="å¹¶è”æ¯”è¾ƒå‹ADCæ¦‚è¿°"></a>å¹¶è”æ¯”è¾ƒå‹ADCæ¦‚è¿°</h3><p>å¹¶è”æ¯”è¾ƒå‹ADCæ˜¯é€šè¿‡å¹¶è¡Œæ¯”è¾ƒå¤šä¸ªç”µå‹è¾“å…¥å€¼ï¼Œå°†è¾“å…¥æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡å·çš„ä¸€ç§æ–¹å¼ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åŒæ—¶å°†è¾“å…¥ç”µå‹ä¸å¤šä¸ªå‚è€ƒç”µå‹è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œå¿«é€Ÿç¡®å®šè¾“å…¥ç”µå‹çš„æ•°å­—è¡¨ç¤ºã€‚</p><h3 id="å„éƒ¨åˆ†åŠŸèƒ½"><a href="#å„éƒ¨åˆ†åŠŸèƒ½" class="headerlink" title="å„éƒ¨åˆ†åŠŸèƒ½"></a>å„éƒ¨åˆ†åŠŸèƒ½</h3><ol><li><strong>æ¯”è¾ƒå™¨</strong>ï¼šä¸»è¦åŠŸèƒ½æ˜¯å°†è¾“å…¥çš„æ¨¡æ‹Ÿä¿¡å·ä¸ä¸€ç»„é¢„è®¾çš„å‚è€ƒç”µå‹è¿›è¡Œæ¯”è¾ƒã€‚æ¯”è¾ƒå™¨è¾“å‡ºé«˜ç”µå¹³æˆ–ä½ç”µå¹³ï¼Œè¡¨ç¤ºè¾“å…¥ä¿¡å·é«˜äºæˆ–ä½äºå‚è€ƒç”µå‹ã€‚</li><li><strong>å‚è€ƒç”µå‹æº</strong>ï¼šæä¾›ä¸€ç»„ç¨³å®šçš„å‚è€ƒç”µå‹ï¼Œé€šå¸¸æ˜¯ä»0Våˆ°æœ€é«˜è¾“å…¥ç”µå‹ï¼ˆä¾‹å¦‚ï¼Œ3.3Væˆ–5Vï¼‰ã€‚è¿™ç»„å‚è€ƒç”µå‹å¯ä»¥æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œå¸®åŠ©æ¯”è¾ƒå™¨è¿›è¡Œæ¯”è¾ƒã€‚</li><li><strong>ç¼–ç å™¨</strong>ï¼šæ ¹æ®æ¯”è¾ƒå™¨çš„è¾“å‡ºï¼Œå°†æ¯”è¾ƒç»“æœè½¬æ¢ä¸ºç›¸åº”çš„äºŒè¿›åˆ¶æ•°å­—ã€‚å¦‚æœæ¯”è¾ƒå™¨çš„è¾“å‡ºè¡¨ç¤ºæœ‰å‡ ä¸ªé«˜ç”µå¹³ï¼Œç¼–ç å™¨å°±ä¼šç¡®å®šè¾“å…¥ä¿¡å·çš„æ•°å€¼ã€‚</li><li><strong>è§¦å‘å™¨</strong>ï¼šåœ¨å®Œæˆæ¯”è¾ƒåï¼Œè§¦å‘å™¨ç”¨æ¥é”å­˜æ¯”è¾ƒå™¨çš„ç»“æœï¼Œç¡®ä¿åœ¨ADCè½¬æ¢å®Œæˆä¹‹å‰ï¼Œä¸ä¼šå—åˆ°è¾“å…¥ä¿¡å·å˜åŒ–çš„å½±å“ã€‚</li><li><strong>é—¨ç”µè·¯</strong>ï¼šæ§åˆ¶ADCçš„å·¥ä½œçŠ¶æ€ï¼Œä¾‹å¦‚ä½¿èƒ½å’Œç¦ç”¨ADCçš„åŠŸèƒ½ã€‚</li></ol><h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><ol><li><strong>è¾“å…¥ä¿¡å·é‡‡æ ·</strong>ï¼šé¦–å…ˆï¼ŒADCä»è¾“å…¥ä¿¡å·ï¼ˆæ¨¡æ‹Ÿç”µå‹ï¼‰è¿›è¡Œé‡‡æ ·ã€‚</li><li><strong>å¹¶è¡Œæ¯”è¾ƒ</strong>ï¼šæ¨¡æ‹Ÿä¿¡å·ä¼šåŒæ—¶ä¸å¤šä¸ªå‚è€ƒç”µå‹è¿›è¡Œæ¯”è¾ƒï¼Œç”±å¤šä¸ªæ¯”è¾ƒå™¨å¹¶è¡Œå¤„ç†ã€‚</li><li><strong>è¾“å‡ºç¼–ç </strong>ï¼šæ ¹æ®æ¯”è¾ƒå™¨çš„ç»“æœï¼Œç¼–ç å™¨å°†è¾“å‡ºå¯¹åº”çš„æ•°å­—ä¿¡å·ã€‚</li><li><strong>ç»“æœè¾“å‡º</strong>ï¼šæœ€ç»ˆï¼Œè½¬æ¢åçš„æ•°å­—ä¿¡å·è¢«è¾“å‡ºï¼Œé€šå¸¸æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œä»¥ä¾›åç»­æ•°å­—å¤„ç†ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>stm32å­¦ä¹ ç¬”è®°003</title>
      <link href="/2024/10/21/stm3203/"/>
      <url>/2024/10/21/stm3203/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šä¸²â¼ä¸­æ–­æ¥æ”¶å›æ˜¾"><a href="#ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šä¸²â¼ä¸­æ–­æ¥æ”¶å›æ˜¾" class="headerlink" title="ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šä¸²â¼ä¸­æ–­æ¥æ”¶å›æ˜¾"></a>ä»»åŠ¡ï¼ˆ1ï¼‰ï¼šä¸²â¼ä¸­æ–­æ¥æ”¶å›æ˜¾</h2><h3 id="çŸ¥è¯†å­¦ä¹ ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»â€”â€”-é€šä¿¡åè®®-åŒå·¥æ¨¡å¼ï¼‰"><a href="#çŸ¥è¯†å­¦ä¹ ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»â€”â€”-é€šä¿¡åè®®-åŒå·¥æ¨¡å¼ï¼‰" class="headerlink" title="çŸ¥è¯†å­¦ä¹ ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»â€”â€”&gt;é€šä¿¡åè®®&#x2F;åŒå·¥æ¨¡å¼ï¼‰"></a>çŸ¥è¯†å­¦ä¹ ï¼ˆæŠ€æœ¯ç‚¹ä»‹ç»â€”â€”&gt;é€šä¿¡åè®®&#x2F;åŒå·¥æ¨¡å¼ï¼‰</h3><h4 id="é€šä¿¡çš„ç›®çš„-åè®®"><a href="#é€šä¿¡çš„ç›®çš„-åè®®" class="headerlink" title="é€šä¿¡çš„ç›®çš„&#x2F;åè®®"></a>é€šä¿¡çš„ç›®çš„&#x2F;åè®®</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021105006393.png" alt="image-20241021105006393"></p><ul><li><p>åœ¨stm32å†…éƒ¨ï¼Œpwmè¾“å‡ºï¼Œå®šæ—¶å™¨è®¡æ•°ç­‰åŠŸèƒ½ï¼Œéƒ½æ˜¯åœ¨å•ç‰‡æœºå†…éƒ¨çš„è¾“å‡ºå¯„å­˜å™¨ï¼Œæ•°æ®å¯„å­˜å™¨å®ç°çš„</p></li><li><p>åœ¨stm32å¤–éƒ¨ï¼Œæƒ³è¦ä½¿ç”¨å…¶ä»–çš„å¤–æŒ‚çš„èŠ¯ç‰‡ï¼Œå°±è¦ä¸stm32<strong>è¿›è¡Œé€šä¿¡</strong></p></li><li><p>åè®®ï¼šåŒæ–¹çº¦å®šçš„ç”¨äºé€šä¿¡çš„è§„åˆ™</p></li><li><p>USART     TXï¼š Transmit Exchange æ•°æ®å‘é€    RX: Receive Exchange æ•°æ®æ¥æ”¶ </p></li><li><p>I2C            SCLï¼š æ—¶é’Ÿ          SDAï¼šæ•°æ®</p></li><li><p>SPI            SCLKï¼šæ—¶é’Ÿ         MOSIï¼šä¸»æœºè¾“å‡ºæ•°æ®è„š       MISOï¼š ä¸»æœºè¾“å…¥æ•°æ®è„š       CSï¼šç‰‡é€‰ï¼Œç”¨äºæŒ‡å®šé€šä¿¡å¯¹è±¡</p></li><li><p>CAN          CAN-H   CAN_Lï¼šä¸¤ä¸ªå·®åˆ†æ•°æ®è„šï¼Œç”¨ä¸¤ä¸ªå¼•è„šè¡¨ç¤ºä¸€ä¸ªå·®åˆ†çš„æ•°æ®</p></li><li><p>USB          DP  DMï¼Œæˆ–è€…è„šD+   D-, ä¹Ÿæ˜¯ä¸€å¯¹å·®åˆ†æ•°æ®è„š</p></li></ul><h4 id="åŒå·¥æ¨¡å¼çš„åŒºåˆ«ï¼š"><a href="#åŒå·¥æ¨¡å¼çš„åŒºåˆ«ï¼š" class="headerlink" title="åŒå·¥æ¨¡å¼çš„åŒºåˆ«ï¼š"></a>åŒå·¥æ¨¡å¼çš„åŒºåˆ«ï¼š</h4><ul><li>å…¨åŒå·¥ï¼šæ˜¯æŒ‡é€šä¿¡åŒæ–¹èƒ½å¤ŸåŒæ—¶è¿›è¡ŒåŒå‘é€šä¿¡ï¼Œä¸€èˆ¬æ¥è¯´éƒ½æœ‰ä¸¤æ ¹é€šä¿¡çº¿</li><li>åŠåŒå·¥ï¼šåŒä¸€æ—¶åˆ» åªèƒ½è¿›è¡Œå•æ–¹å‘çš„é€šä¿¡ ï¼ˆåŒä¸€æ—¶é—´ä¸‹åªèƒ½è¿›è¡Œå•å‘ä¼ è¾“ï¼Œä½†æ˜¯ä¸åŒçš„æ—¶é—´ä¼ è¾“çš„æ–¹å‘å¯ä»¥ä¸åŒï¼‰</li><li>å•å·¥ï¼š æ— è®ºä»€ä¹ˆæ—¶åˆ»ï¼Œéƒ½åªèƒ½ç”±ä¸€ä¸ªè®¾å¤‡ä¼ åˆ°å¦ä¸€ä¸ªè®¾å¤‡ï¼Œä¸èƒ½åç€æ¥ ï¼ˆæ¯”å¦‚æŠŠä¸²å£çš„rxå¼•è„šå»æ‰ï¼Œé‚£ä¸²å£å°±é€€åŒ–æˆå•å·¥äº†ï¼‰</li></ul><h4 id="æ—¶é’Ÿç‰¹æ€§"><a href="#æ—¶é’Ÿç‰¹æ€§" class="headerlink" title="æ—¶é’Ÿç‰¹æ€§"></a>æ—¶é’Ÿç‰¹æ€§</h4><ul><li>å¦‚æœæœ‰å•ç‹¬çš„æ—¶é’Ÿä¿¡å·çº¿ï¼Œå°±æ˜¯åŒæ­¥çš„ï¼Œæ²¡æœ‰å°±æ˜¯å¼‚æ­¥çš„</li><li>å¼‚æ­¥ç›¸æ¯”äºåŒæ­¥ï¼Œåªæ˜¯è¯´ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´æ—¶é’Ÿçš„ä¿¡æ¯ï¼ˆé‡‡æ ·é¢‘ç‡ï¼‰ä¸èƒ½ä¼ é€’ç½¢äº†ï¼Œæ‰€ä»¥åœ¨å¼€å§‹å‰è®¾ç½®å¥½ä¸¤è€…çº¦å®šçš„é‡‡æ ·é¢‘ç‡ï¼Œå¹¶æ·»åŠ å¸§å¤´å¸§å°¾ç­‰ï¼Œè¿›è¡Œé‡‡æ ·ä½ç½®çš„å¯¹é½</li></ul><h4 id="ç”µå¹³ç‰¹æ€§"><a href="#ç”µå¹³ç‰¹æ€§" class="headerlink" title="ç”µå¹³ç‰¹æ€§"></a>ç”µå¹³ç‰¹æ€§</h4><ul><li>å•ç«¯ï¼šå•ç«¯ç”µå¹³æ‰€è°“çš„é«˜ä½ç”µå¹³ï¼Œéƒ½æ˜¯ç›¸å¯¹äºgndçš„ï¼Œå› æ­¤å•ç«¯é€šä¿¡çš„åŒæ–¹å¿…é¡»<strong>å…±åœ°</strong>ï¼Œå› æ­¤ï¼Œå‰ä¸‰ä¸ªé€šä¿¡åè®®ä¸¥æ ¼æ¥è¯´å¼•è„šä¸€æ è¿˜è¦åŠ ä¸ŠGNDå¼•è„š</li><li>å·®åˆ†ï¼šå·®åˆ†ä¿¡å·æ˜¯é€šè¿‡ä¸¤ä¸ªä¿¡å·çš„ç”µå‹å·®æ¥è¿›è¡Œé€šä¿¡çš„ï¼Œå› æ­¤ä¸éœ€è¦æ¥åœ°ï¼ˆä¸»è¦æ˜¯è¯´canï¼Œå› ä¸ºusbé‡Œé¢æœ‰äº›ä¸œè¥¿ä¹Ÿæ˜¯å•ç«¯ä¿¡å·ï¼Œè¿˜æ˜¯å¾—æ¥åœ°ï¼‰</li></ul><h4 id="è®¾å¤‡"><a href="#è®¾å¤‡" class="headerlink" title="è®¾å¤‡"></a>è®¾å¤‡</h4><ul><li>ç‚¹å¯¹ç‚¹ï¼šä¸¤ä¸ªè®¾å¤‡ä¹‹é—´ç‚¹å¯¹ç‚¹ï¼Œç›´æ¥ä¼ è¾“å°±è¡Œäº†</li><li>å¤šè®¾å¤‡ï¼šæ”¯æŒä¸æ­¢æœ‰ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œå¯ä»¥æŒ‚è½½å¤šä¸ªè®¾å¤‡ï¼Œåœ¨é€šä¿¡å‰è¦è¿›è¡Œ<strong>å¯»å€</strong>æ“ä½œï¼Œæ¥ç¡®å®šè¦è¿›è¡Œé€šä¿¡çš„å¯¹è±¡</li></ul><h3 id="æŠ€æœ¯ç‚¹ä»‹ç»â€”â€”-ä¸²å£é€šä¿¡"><a href="#æŠ€æœ¯ç‚¹ä»‹ç»â€”â€”-ä¸²å£é€šä¿¡" class="headerlink" title="æŠ€æœ¯ç‚¹ä»‹ç»â€”â€”&gt;ä¸²å£é€šä¿¡"></a>æŠ€æœ¯ç‚¹ä»‹ç»â€”â€”&gt;ä¸²å£é€šä¿¡</h3><h5 id="ç¡¬ä»¶ç”µè·¯æ¥æ³•ï¼š"><a href="#ç¡¬ä»¶ç”µè·¯æ¥æ³•ï¼š" class="headerlink" title="ç¡¬ä»¶ç”µè·¯æ¥æ³•ï¼š"></a>ç¡¬ä»¶ç”µè·¯æ¥æ³•ï¼š</h5><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021112612894.png" alt="image-20241021112612894" style="zoom: 33%;" /><p>ç”µå¹³æ ‡å‡†ï¼ˆä½¿ç”¨çš„ä¸»è¦éƒ½æ˜¯ttlç”µå¹³ï¼‰</p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021112838627.png" alt="image-20241021112838627" style="zoom: 33%;" /><h5 id="ä¸²å£å‚æ•°å’Œæ—¶åº"><a href="#ä¸²å£å‚æ•°å’Œæ—¶åº" class="headerlink" title="ä¸²å£å‚æ•°å’Œæ—¶åº"></a>ä¸²å£å‚æ•°å’Œæ—¶åº</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021113332364.png" alt="image-20241021113332364"></p><ul><li><p>æ³¨æ„ï¼Œå½“ä¸²å£ç©ºé—²çš„æ—¶å€™ï¼Œå§‹ç»ˆæ˜¯é«˜ç”µå¹³ï¼Œèµ·å§‹ä½å’Œç»ˆæ­¢ä½çš„ä½œç”¨å°±æ˜¯ï¼š</p><p>èµ·å§‹ä½â€”â€”äº§ç”Ÿä¸€ä¸ªä¸‹é™æ²¿ï¼Œå‘Šè¯‰è®¾å¤‡è¦å¼€å§‹å‘æ•°æ®äº†         </p><p>ç»ˆæ­¢ä½â€”â€”äº§ç”Ÿä¸€ä¸ªä¸Šå‡æ²¿ï¼Œæ ‡å¿—ç€è¿™ä¸ªå­—èŠ‚ä¼ è¾“å®Œæˆï¼ŒåŒæ—¶å°†ç”µå¹³æ‹‰å›é«˜ç”µå¹³</p></li><li><p>æ•°æ®ä½â€”â€”ä½ä½å…ˆè¡Œçš„å«ä¹‰</p><p>å‡è®¾è¦å‘é€ä¸€ä¸ª0x0Fï¼Œç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆæŠŠä»–è½¬åŒ–æˆäºŒè¿›åˆ¶ 00001111 ï¼Œç„¶åä»ä½ä½å¼€å§‹ä¼ å…¥ï¼Œå³ä¼ å…¥é¡ºåºä¸º11110000ï¼Œäº§ç”Ÿçš„æ³¢å½¢å°±æ˜¯</p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021113946893.png" alt="image-20241021113946893" style="zoom: 67%;" /><p>å½“ç„¶ï¼Œæ¥æ”¶çš„ä¸€æ–¹ä¹Ÿæ˜¯ä½ä½å…ˆè¡Œï¼Œäº§ç”Ÿçš„æ³¢å½¢å°±æ˜¯00001111ï¼Œè¿˜æ˜¯å›åˆ°äº†0 x0F</p></li><li><p>æ ¡éªŒä½ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021114145525.png" alt="image-20241021114145525"></p></li></ul><p>æ ¡éªŒåˆ†ä¸ºå¥‡æ ¡éªŒå’Œå¶æ ¡éªŒï¼Œå¥‡æ ¡éªŒå°±æ˜¯è‡ªåŠ¨è¡¥å…¨æœ€åä¸€ä½ï¼Œä½¿<strong>æ•°æ®ä½</strong>æ‰€æœ‰ä½ç½®ä¸Šçš„1ä¸ºå¥‡æ•°ä¸ªï¼Œå¶æ ¡éªŒæ˜¯å¶æ•°ä¸ª</p><h5 id="USTAR"><a href="#USTAR" class="headerlink" title="USTAR"></a>USTAR</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021130136230.png" alt="image-20241021130136230"></p><ul><li><p>æœ€å¸¸ä½¿ç”¨é…ç½®ï¼šæ”¶å‘å™¨ï¼šå¼‚æ­¥æ³¢ç‰¹ç‡ï¼š9600&#x2F;115200æ•°æ®ä½é•¿åº¦ï¼š8åœæ­¢ä½é•¿åº¦ï¼š1æ— æ ¡éªŒ</p></li><li><p>ç¡¬ä»¶æµæ§åˆ¶çš„æ„æ€ï¼Œå°±æ˜¯åœ¨rxå’Œtxä¸­è¿˜æœ‰ä¸€æ ¹çº¿ç”¨äºé€šä¿¡ï¼Œè¿™æ¡çº¿çš„çš„ä¿¡å·å‘å°„ç«¯æ˜¯æ¥æ”¶ç«¯è®¾å¤‡ï¼Œé»˜è®¤é«˜ç”µå¹³</p><p>å½“æ¥æ”¶ç«¯è®¾å¤‡å‡†å¤‡å¥½æ¥æ”¶çš„æ—¶å€™ï¼Œå°±ç½®ä½ç”µå¹³ï¼Œå‘é€ç«¯å°±å¼€å§‹å‘ä¿¡å·ï¼Œè¿™æ ·èƒ½é¿å…æ¥å¦‚æœæ”¶ç«¯æ€§èƒ½æ¯”è¾ƒä½ï¼Œè¿˜æ²¡å‡†å¤‡å¥½å°±æ¥å—ä¸€å †æ•°æ®ä»è€Œå‡ºé”™ ï¼Œä½†æ˜¯ç¡¬ä»¶æ§åˆ¶æµä¸€èˆ¬ä¹Ÿä¸ç”¨</p></li><li><p>usatrèµ„æºï¼š usatr1åœ¨apb2æ€»çº¿ä¸Šï¼Œusatr2ï¼Œusatr3åœ¨apb1æ€»çº¿ä¸Š</p></li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021181937363.png" alt="image-20241021181937363"></p><p>USTARåŸºæœ¬ç»“æ„ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241021184406936.png" alt="image-20241021184406936"></p><h5 id="ä¸²å£é€šä¿¡ä¸­çš„hexæ¨¡å¼å’Œæ–‡æœ¬æ¨¡å¼"><a href="#ä¸²å£é€šä¿¡ä¸­çš„hexæ¨¡å¼å’Œæ–‡æœ¬æ¨¡å¼" class="headerlink" title="ä¸²å£é€šä¿¡ä¸­çš„hexæ¨¡å¼å’Œæ–‡æœ¬æ¨¡å¼"></a>ä¸²å£é€šä¿¡ä¸­çš„hexæ¨¡å¼å’Œæ–‡æœ¬æ¨¡å¼</h5><p>hexæ¨¡å¼ï¼šä»¥åŸå§‹æ•°æ®çš„å½¢å¼å±•ç¤º</p><p>æ–‡æœ¬æ¨¡å¼ï¼šä»¥åŸå§‹æ•°æ®ç¼–ç åçš„å½¢å¼æ˜¾ç¤º</p><p>ç¤ºæ„å›¾ï¼š</p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241022001324298.png" alt="image-20241022001324298" style="zoom: 67%;" /><h3 id="æŠ€æœ¯ç‚¹ä»‹ç»ï¼šä¸²â¼-RXNE-ä¸­æ–­ï¼ˆå¦‚ä½•é…ç½®ï¼Œå¦‚ä½•ä½¿â½¤ï¼‰"><a href="#æŠ€æœ¯ç‚¹ä»‹ç»ï¼šä¸²â¼-RXNE-ä¸­æ–­ï¼ˆå¦‚ä½•é…ç½®ï¼Œå¦‚ä½•ä½¿â½¤ï¼‰" class="headerlink" title="æŠ€æœ¯ç‚¹ä»‹ç»ï¼šä¸²â¼ RXNE ä¸­æ–­ï¼ˆå¦‚ä½•é…ç½®ï¼Œå¦‚ä½•ä½¿â½¤ï¼‰"></a>æŠ€æœ¯ç‚¹ä»‹ç»ï¼šä¸²â¼ RXNE ä¸­æ–­ï¼ˆå¦‚ä½•é…ç½®ï¼Œå¦‚ä½•ä½¿â½¤ï¼‰</h3><h4 id="é…ç½®exneä¸­æ–­ï¼š"><a href="#é…ç½®exneä¸­æ–­ï¼š" class="headerlink" title="é…ç½®exneä¸­æ–­ï¼š"></a>é…ç½®exneä¸­æ–­ï¼š</h4><p>é…ç½®ä¸­æ–­ï¼Œæ— éå°±æ˜¯æŠŠå½“å‰è•´å«æŸä¸ªå¯ä»¥å½“åšä¸­æ–­äº‹ä»¶çš„å¤–è®¾è¿æ¥é€šè·¯åˆ°nvic</p><p>æ¯”å¦‚ä¹‹å‰çš„timä¸­æ–­ï¼Œå°±æ˜¯ä½¿ç”¨tim2_it_configå‡½æ•°è¿æ¥åˆ°nvicé€šè·¯ä»¥é…ç½®ä¸­æ–­</p><p>æ‰€ä»¥ç±»ä¼¼çš„ï¼Œé…ç½®ä¸­æ–­çš„ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯ï¼Œé…ç½®usart1åˆ°nvicçš„é€šè·¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);<span class="comment">//è¿™å¥usatr1çš„itconfigé…ç½®äº†usatr1åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯å¸¸è§„çš„é…ç½®nvic</p><ul><li>å…ˆåˆ†ç»„ï¼Œé»˜è®¤ä¸€èˆ¬ä½¿ç”¨group2</li><li>åˆ›å»ºä¸€ä¸ªnvicåˆå§‹åŒ–ç»“æ„ä½“ï¼Œç»“æ„ä½“åŒ…å«channelï¼Œcmdï¼Œå“åº”ä¼˜å…ˆçº§å’ŒæŠ¢å ä¼˜å…ˆçº§</li><li>channelï¼ˆé€šé“ï¼‰ï¼šå°±å…·ä½“é€šé“è€Œå®šï¼Œé…ç½®è°çš„nvicï¼Œå°±ç”¨è°çš„nvicåˆ°è‡ªèº«çš„é€šé“ï¼Œæ¯”å¦‚å¯¹äºtim2æ¥è¯´ï¼Œé€šé“å°±æ˜¯tim2_irqn,è¿™é‡Œå¯¹äºusart1æ¥è¯´ï¼Œé€šé“å°±æ˜¯usart1_irqn</li><li>cmdï¼šå°±æ˜¯ä¸ªå¼€å…³ï¼Œenableå³å¯ï¼Œä¸¤ä¸ªä¼˜å…ˆçº§è§†æƒ…å†µè€Œå®š</li><li>æœ€ååˆå§‹åŒ–nvicç»“æ„ä½“ï¼Œå¹¶å¼€å¯usartå¼€å…³</li></ul><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸‹é¢é…ç½®æ¥æ”¶ä¸­æ–­</span></span><br><span class="line">USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);<span class="comment">//è¿™å¥usatr1çš„itconfigé…ç½®äº†usatr1åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®nvic</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);<span class="comment">//å…ˆåˆ†ç»„</span></span><br><span class="line">NVIC_InitTypeDef NVIC_InitSturcture;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannel = USART1_IRQn; <span class="comment">//é…ç½®nvicçš„irqné€šé“</span></span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitSturcture);</span><br><span class="line"></span><br><span class="line">USART_Cmd(USART1,ENABLE);<span class="comment">//æ‰“å¼€å¼€å…³</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œnvicå°±ä¼šè‡ªåŠ¨è°ƒç”¨ä¸­æ–­å‡½æ•°ï¼Œå½“ä¸­æ–­å‡½æ•°é‡Œæˆ‘ä»¬ç»™å‡ºçš„æ¡ä»¶ä¸ºçœŸæ—¶ï¼Œå°±èƒ½åªæƒ³æˆ‘ä»¬æƒ³è¦çš„æ“ä½œ</p><h4 id="ä½¿ç”¨exneä¸­æ–­ï¼š"><a href="#ä½¿ç”¨exneä¸­æ–­ï¼š" class="headerlink" title="ä½¿ç”¨exneä¸­æ–­ï¼š"></a>ä½¿ç”¨exneä¸­æ–­ï¼š</h4><p>ä¸­æ–­æ‰§è¡Œæ—¶æœ€æ ¸å¿ƒçš„ä»£ç å°±æ˜¯ä¸­æ–­æ‰§è¡Œå‡½æ•°ï¼šUSART1_IRQHandler</p><p>å› æ­¤æˆ‘ä»¬é…ç½®ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œè¿™é‡Œæƒ³ç”¨exneæ˜¯å¦ä¸ºçœŸæ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥æ¡ä»¶åº”è®¾ä¸º</p><p>if(USART_GetITStatus(USART1,USART_IT_RXNE)&#x3D;&#x3D; SET)</p><p>å¦‚æœè¿™ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œé‚£ä¹ˆè¯´æ˜è®¡ç®—æœºå‘å•ç‰‡æœºå‘é€äº†æ•°æ®ï¼Œæˆ‘ä»¬æ­¤æ—¶çš„ä»»åŠ¡æ˜¯<strong>æ¥å—è¿™ä¸ªæ•°æ®ï¼Œå¹¶æŠŠå®ƒå›æ˜¾åˆ°è®¡ç®—æœºä¸Š</strong>ï¼Œé‚£åœ¨ä¸­æ–­å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½æ¥æ ‡å¿—å•ç‰‡æœºæ¥æ”¶åˆ°äº†æ•°æ®ï¼Œå†è®¾ç½®ä¸€ä¸ªä¸´æ—¶å˜é‡ç”¨äºå­˜å‚¨æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œåœ¨ä¸»å‡½æ•°ä¸­ï¼Œå¦‚æœæ ‡å¿—ä½ä¸ºçœŸï¼Œé‚£å°±æŠŠæ•°æ®æ‹¿å‡ºæ¥å¹¶å‘é€åˆ°è®¡ç®—æœºä¸Š</p><p>åœ¨serial.cä¸­ï¼Œè®¾ç½®ä¸¤ä¸ªä¸´æ—¶å˜é‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint8_t</span> Serial_RxData;</span><br><span class="line"><span class="type">uint8_t</span> Serial_RxFlag;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªå°è£…å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxFlag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(Serial_RxFlag == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxData</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Serial_RxData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¹¶æŒ‰ç…§æˆ‘ä»¬çš„è®¾æƒ³é…ç½®ä¸­æ–­å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">USART1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(USART_GetITStatus(USART1,USART_IT_RXNE)== SET)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxData = USART_ReceiveData(USART1);</span><br><span class="line">Serial_RxFlag = <span class="number">1</span>;</span><br><span class="line">USART_ClearITPendingBit(USART1,USART_IT_RXNE);<span class="comment">//æ¸…é™¤æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±åªéœ€è¦åœ¨ä¸»å‡½æ•°ä¸­ä¸æ–­æ£€æŸ¥flagæ˜¯å¦ä¸º1ï¼Œå¦‚æœä¸º1ï¼Œè®¾ç½®ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œå¹¶å°†å®ƒèµ‹å€¼ä¸ºgetrxdataå‡½æ•°çš„è¿”å›å€¼ï¼Œç„¶åå°†è¿™ä¸ªè¿”å›å€¼å‘å›è®¡ç®—æœºï¼Œå³å¯å®Œæˆ</p><p>ä¸»å‡½æ•°å†…å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint8_t</span> RxData;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">Serial_Init();</span><br><span class="line">Serial_Printf(<span class="string">&quot;num is %d&quot;</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(Serial_GetRxFlag() == <span class="number">1</span>)<span class="comment">//åˆ¤æ–­flagæ˜¯å¦ä¸º1</span></span><br><span class="line">&#123;</span><br><span class="line">RxData = Serial_GetRxData();<span class="comment">//æ˜¯çš„è¯ï¼Œè·å–ä¿¡æ¯</span></span><br><span class="line">Serial_Printf(<span class="string">&quot;%c&quot;</span>,RxData);<span class="comment">//å›æ˜¾</span></span><br><span class="line">OLED_ShowHexNum(<span class="number">1</span>,<span class="number">1</span>,RxData,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>serial.cæ€»ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> Serial_RxData;</span><br><span class="line"><span class="type">uint8_t</span> Serial_RxFlag;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1,ENABLE);<span class="comment">//USATR1åœ¨APB2æ€»çº¿ä¸Š</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP; <span class="comment">//txè®¾ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU; <span class="comment">//rxè®¾ç½®ä¸ºä¸Šæ‹‰è¾“å…¥ï¼ˆè¾“å…¥ä¸å­˜åœ¨å¤ç”¨ä¸å¤ç”¨çš„ï¼Œå› ä¸ºè¾“å‡ºåªèƒ½æœ‰ä¸€ä¸ªï¼Œä½†æ˜¯è¾“å…¥å¯ä»¥æœ‰å¤šä¸ªï¼‰</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USART_InitTypeDef USART_InitStructure;</span><br><span class="line">USART_InitStructure.USART_BaudRate = <span class="number">9600</span>; <span class="comment">//è®¾ç½®æ³¢ç‰¹ç‡</span></span><br><span class="line">USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None; <span class="comment">//è®¾ç½®æ²¡æœ‰ç¡¬ä»¶æµæ§åˆ¶</span></span><br><span class="line">USART_InitStructure.USART_Mode = USART_Mode_Rx|USART_Mode_Tx; <span class="comment">//è®¾ç½®æ¨¡å¼ä¸ºrxå’Œtxéƒ½ç”¨</span></span><br><span class="line">USART_InitStructure.USART_Parity = USART_Parity_No; <span class="comment">//è®¾ç½®ä¸è¿›è¡Œå¥‡å¶æ ¡éªŒ</span></span><br><span class="line">USART_InitStructure.USART_StopBits = USART_StopBits_1;<span class="comment">//è®¾ç½®ç»ˆæ­¢ä½é•¿åº¦ä½1</span></span><br><span class="line">USART_InitStructure.USART_WordLength = USART_WordLength_8b;<span class="comment">//è®¾ç½®æ•°æ®é•¿åº¦ä¸º8ä½</span></span><br><span class="line"></span><br><span class="line">USART_Init(USART1,&amp;USART_InitStructure);<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®æ¥æ”¶ä¸­æ–­</span></span><br><span class="line">USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);<span class="comment">//è¿™å¥usatr1çš„itconfigé…ç½®äº†usatr1åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®nvic</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);<span class="comment">//å…ˆåˆ†ç»„</span></span><br><span class="line">NVIC_InitTypeDef NVIC_InitSturcture;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannel = USART1_IRQn; <span class="comment">//é…ç½®nvicçš„irqné€šé“</span></span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitSturcture);</span><br><span class="line"></span><br><span class="line">USART_Cmd(USART1,ENABLE);<span class="comment">//æ‰“å¼€å¼€å…³</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxFlag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(Serial_RxFlag == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxData</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Serial_RxData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">USART1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(USART_GetITStatus(USART1,USART_IT_RXNE)== SET)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxData = USART_ReceiveData(USART1);</span><br><span class="line">Serial_RxFlag = <span class="number">1</span>;</span><br><span class="line">USART_ClearITPendingBit(USART1,USART_IT_RXNE);<span class="comment">//æ¸…é™¤æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_SendByte</span><span class="params">(<span class="type">uint8_t</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">USART_SendData(USART1,Byte);</span><br><span class="line"><span class="keyword">while</span>(USART_GetFlagStatus(USART1,USART_FLAG_TXE) == RESET);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_SendArray</span><span class="params">(<span class="type">uint8_t</span> *Array,<span class="type">uint16_t</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint16_t</span> i;</span><br><span class="line"><span class="keyword">for</span>(i =<span class="number">0</span>;i&lt;length;i++)</span><br><span class="line">&#123;</span><br><span class="line">Serial_SendByte(Array[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_SendString</span><span class="params">(<span class="type">char</span>* String)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;String[i]!=<span class="number">0</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">Serial_SendByte(String[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">Serial_Pow</span><span class="params">(<span class="type">uint32_t</span> X, <span class="type">uint32_t</span> Y)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint32_t</span> Result = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (Y --)</span><br><span class="line">&#123;</span><br><span class="line">Result *= X;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_SendNumber</span><span class="params">(<span class="type">uint32_t</span> Number, <span class="type">uint8_t</span> Length)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Length; i ++)</span><br><span class="line">&#123;</span><br><span class="line">Serial_SendByte(Number / Serial_Pow(<span class="number">10</span>, Length - i - <span class="number">1</span>) % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">fputc</span><span class="params">(<span class="type">int</span> ch, FILE *f)</span></span><br><span class="line">&#123;</span><br><span class="line">Serial_SendByte(ch);<span class="comment">//å°†printfçš„åº•å±‚é‡å®šå‘åˆ°è‡ªå·±çš„å‘é€å­—èŠ‚å‡½æ•°</span></span><br><span class="line"><span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_Printf</span><span class="params">(<span class="type">char</span> *format, ...)</span><span class="comment">//å¤šå‚æ•°</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> String[<span class="number">100</span>];</span><br><span class="line">va_list arg;</span><br><span class="line">va_start(arg, format);</span><br><span class="line"><span class="built_in">vsprintf</span>(String, format, arg);</span><br><span class="line">va_end(arg);</span><br><span class="line">Serial_SendString(String);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘æ¼”ç¤ºï¼š"><a href="#è§†é¢‘æ¼”ç¤ºï¼š" class="headerlink" title="è§†é¢‘æ¼”ç¤ºï¼š"></a>è§†é¢‘æ¼”ç¤ºï¼š</h3><h2 id="2-ä»»åŠ¡äºŒï¼šä¸²å£æ§åˆ¶LEDäº®ç­"><a href="#2-ä»»åŠ¡äºŒï¼šä¸²å£æ§åˆ¶LEDäº®ç­" class="headerlink" title="(2)ä»»åŠ¡äºŒï¼šä¸²å£æ§åˆ¶LEDäº®ç­"></a>(2)ä»»åŠ¡äºŒï¼šä¸²å£æ§åˆ¶LEDäº®ç­</h2><h3 id="æŠ€æœ¯ç‚¹ä»‹ç»-ï¼šä¸²â¼-RXNE-ä¸­æ–­ï¼ˆå¦‚ä½•åˆ©â½¤è¯»å–åˆ°çš„æ•°æ®ï¼‰"><a href="#æŠ€æœ¯ç‚¹ä»‹ç»-ï¼šä¸²â¼-RXNE-ä¸­æ–­ï¼ˆå¦‚ä½•åˆ©â½¤è¯»å–åˆ°çš„æ•°æ®ï¼‰" class="headerlink" title="æŠ€æœ¯ç‚¹ä»‹ç» ï¼šä¸²â¼ RXNE ä¸­æ–­ï¼ˆå¦‚ä½•åˆ©â½¤è¯»å–åˆ°çš„æ•°æ®ï¼‰"></a>æŠ€æœ¯ç‚¹ä»‹ç» ï¼šä¸²â¼ RXNE ä¸­æ–­ï¼ˆå¦‚ä½•åˆ©â½¤è¯»å–åˆ°çš„æ•°æ®ï¼‰</h3><h4 id="ä½¿ç”¨æ•°æ®åŒ…è·å–è¾“å…¥çš„æ•°æ®ï¼š"><a href="#ä½¿ç”¨æ•°æ®åŒ…è·å–è¾“å…¥çš„æ•°æ®ï¼š" class="headerlink" title="ä½¿ç”¨æ•°æ®åŒ…è·å–è¾“å…¥çš„æ•°æ®ï¼š"></a>ä½¿ç”¨æ•°æ®åŒ…è·å–è¾“å…¥çš„æ•°æ®ï¼š</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023161552791.png" alt="image-20241023161552791"></p><h5 id="1-ä»€ä¹ˆæ˜¯æ•°æ®åŒ…ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯æ•°æ®åŒ…ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯æ•°æ®åŒ…ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯æ•°æ®åŒ…ï¼Ÿ</h5><p>åœ¨ä¸²å£é€šä¿¡ä¸­ï¼Œæ•°æ®åŒ…æ˜¯ç”¨æ¥ä¼ è¾“æœ‰ç»“æ„çš„æ•°æ®çš„ä¸€ç§â€œåŒ…è£…â€ã€‚å®ƒå°±åƒå¯„å¿«é€’ä¸€æ ·ï¼ŒæŠŠæˆ‘ä»¬è¦ä¼ è¾“çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ§åˆ¶å‘½ä»¤æˆ–ä¼ æ„Ÿå™¨æ•°æ®ï¼‰è£…è¿›ä¸€ä¸ªâ€œåŒ…è£¹â€é‡Œï¼Œå†é€šè¿‡ä¸²å£æŠŠè¿™ä¸ªåŒ…è£¹ä»ä¸Šä½æœºï¼ˆæ¯”å¦‚ç”µè„‘ï¼‰å‘åˆ°å•ç‰‡æœºï¼ˆSTM32ï¼‰ã€‚æ•°æ®åŒ…æ˜¯ä¸ºäº†è®©åŒæ–¹æ¸…æ¥šåœ°çŸ¥é“ï¼Œä¼ è¿‡æ¥çš„è¿™äº›æ•°æ®æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå¦‚ä½•å¤„ç†ï¼Œå¦‚ä½•æ£€æŸ¥æœ‰æ²¡æœ‰å‡ºé”™ã€‚</p><h5 id="2-æ•°æ®åŒ…çš„åŸºæœ¬ç»„æˆ"><a href="#2-æ•°æ®åŒ…çš„åŸºæœ¬ç»„æˆ" class="headerlink" title="2. æ•°æ®åŒ…çš„åŸºæœ¬ç»„æˆ"></a>2. æ•°æ®åŒ…çš„åŸºæœ¬ç»„æˆ</h5><p>ä¸€ä¸ªæ ‡å‡†çš„æ•°æ®åŒ…ä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š</p><ol><li><strong>èµ·å§‹ç¬¦</strong>ï¼šå‘Šè¯‰æ¥æ”¶ç«¯ï¼Œâ€œæ•°æ®è¦å¼€å§‹äº†ï¼â€ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦æˆ–å­—èŠ‚</li><li><strong>æ•°æ®å­—æ®µ</strong>ï¼šè¿™é‡Œæ‰æ˜¯å®é™…æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯ä¼ æ„Ÿå™¨çš„æ•°æ®ã€æ§åˆ¶å‘½ä»¤æˆ–è€…çŠ¶æ€åé¦ˆã€‚æ•°æ®å­—æ®µå¯ä»¥æ˜¯ä¸€ä¸ªå­—èŠ‚æˆ–å¤šä¸ªå­—èŠ‚ã€‚</li><li><strong>ç»“æŸç¬¦</strong>ï¼šå‘Šè¯‰æ¥æ”¶ç«¯ï¼Œâ€œæ•°æ®ä¼ å®Œäº†ï¼â€ã€‚å¸¸ç”¨çš„ç»“æŸç¬¦ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹å®šå­—ç¬¦ï¼Œ</li><li>æœ‰æ—¶å€™ï¼Œç»“æŸç¬¦å‰é¢è¿˜å¯ä»¥åŠ ä¸ªæ ¡éªŒç¬¦</li></ol><p><strong>ä¾‹å­</strong>ï¼šå‡è®¾ä½ æƒ³é€šè¿‡ä¸²å£ä¼ é€’ä¸¤ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç®€å•çš„æ•°æ®åŒ…ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">èµ·å§‹ç¬¦@| æ•°æ®<span class="number">1</span>| æ•°æ®<span class="number">2</span>| ç»“æŸç¬¦ $</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li><strong>@</strong> æ˜¯èµ·å§‹ç¬¦</li><li>æ•°æ®1 å’Œ æ•°æ®2 æ˜¯å®é™…è¦ä¼ è¾“çš„æ•°æ®</li><li><strong>$</strong> æ˜¯ç»“æŸç¬¦</li></ul><h5 id="3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®åŒ…ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®åŒ…ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ" class="headerlink" title="3. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®åŒ…ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"></a>3. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®åŒ…ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h5><ul><li><strong>æ•°æ®æœ‰åºä¼ è¾“ï¼Œé¿å…æ··ä¹±</strong>,ä¸²å£é€šä¿¡æ˜¯<strong>é€ä¸ªå­—èŠ‚</strong>åœ°ä¼ è¾“æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æ•°æ®åŒ…çš„æ¦‚å¿µï¼Œå•ç‰‡æœºæ— æ³•çŸ¥é“æ¥æ”¶åˆ°çš„æŸäº›å­—èŠ‚åˆ°åº•æ˜¯ä»€ä¹ˆâ€”â€”æ˜¯å¼€å§‹çš„å‘½ä»¤è¿˜æ˜¯ä¸­é€”ä¼ è¿‡æ¥çš„æ•°æ®ï¼Ÿä½¿ç”¨æ•°æ®åŒ…åï¼Œèµ·å§‹ç¬¦å’Œç»“æŸç¬¦è®©STM32æ¸…æ¥šåœ°çŸ¥é“æ•°æ®ä»å“ªé‡Œå¼€å§‹ã€å“ªé‡Œç»“æŸï¼Œé¿å…äº†æ•°æ®æ··ä¹±ã€‚</li></ul><h5 id="4-ä½¿ç”¨æ•°æ®åŒ…çš„æ­¥éª¤"><a href="#4-ä½¿ç”¨æ•°æ®åŒ…çš„æ­¥éª¤" class="headerlink" title="4. ä½¿ç”¨æ•°æ®åŒ…çš„æ­¥éª¤"></a>4. ä½¿ç”¨æ•°æ®åŒ…çš„æ­¥éª¤</h5><p><strong>(1) æ„é€ æ•°æ®åŒ…å¹¶å‘é€</strong></p><ul><li>ä¸Šä½æœºï¼ˆæ¯”å¦‚ç”µè„‘ï¼‰æ ¹æ®é¢„å®šå¥½çš„æ ¼å¼ï¼Œæ„é€ ä¸€ä¸ªæ•°æ®åŒ…ã€‚å‡å¦‚ä½ æƒ³æ§åˆ¶ä¸€ä¸ªç¯çš„äº®ç­ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªæ•°æ®åŒ…ï¼Œé‡Œé¢åŒ…æ‹¬ï¼šè®¾å¤‡IDï¼ˆä»£è¡¨ç¯ï¼‰ã€æ§åˆ¶å‘½ä»¤ï¼ˆå¼€æˆ–å…³ï¼‰ï¼Œä»¥åŠæ ¡éªŒä½æ¥ä¿è¯æ•°æ®æ²¡æœ‰å‡ºé”™ã€‚</li></ul><p><strong>(2) æ¥æ”¶æ•°æ®åŒ…</strong></p><ul><li>STM32 ä¼šé€šè¿‡ä¸²å£æ¥æ”¶æ•°æ®ã€‚åœ¨æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œå®ƒé¦–å…ˆè¦æ‰¾åˆ°èµ·å§‹ç¬¦ï¼Œç¡®å®šè¿™æ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®åŒ…ï¼Œç„¶åå¼€å§‹æ¥æ”¶åé¢çš„æ•°æ®å­—æ®µã€‚å¦‚æœæœ‰æ ¡éªŒä½ï¼Œè¿˜èƒ½é€šè¿‡ä»–æ¥æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®ã€‚</li></ul><p><strong>(4) æ‰§è¡Œç›¸åº”æ“ä½œ</strong></p><ul><li>è§£æå®Œæˆåï¼ŒSTM32å¯ä»¥æ ¹æ®æ•°æ®å­—æ®µä¸­çš„å‘½ä»¤ï¼Œæ‰§è¡Œå¯¹åº”çš„æ“ä½œï¼Œæ¯”å¦‚æ‰“å¼€æˆ–å…³é—­ç¯ï¼Œè¯»å–ä¼ æ„Ÿå™¨æ•°æ®ç­‰ã€‚</li></ul><h4 id="ç”»çŠ¶æ€æœºè¿›è¡Œç¨‹åºè®¾è®¡"><a href="#ç”»çŠ¶æ€æœºè¿›è¡Œç¨‹åºè®¾è®¡" class="headerlink" title="ç”»çŠ¶æ€æœºè¿›è¡Œç¨‹åºè®¾è®¡"></a>ç”»çŠ¶æ€æœºè¿›è¡Œç¨‹åºè®¾è®¡</h4><p><strong>åœ¨è®¾è®¡ç¨‹åºçš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨çŠ¶æ€æœºæ¥ç”»å‡ºç¨‹åºçš„æµç¨‹ï¼Œæ¥ç†æ¸…é€»è¾‘</strong>ï¼Œå¦‚ä¸‹ä¾¿æ˜¯æ–‡æœ¬æ•°æ®åŒ…æ¥æ”¶çš„çŠ¶æ€æœºç¤ºæ„å›¾:</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023162516302.png" alt="image-20241023162516302"></p><h4 id="rxneä¸­æ–­çš„å®ç°ï¼š"><a href="#rxneä¸­æ–­çš„å®ç°ï¼š" class="headerlink" title="rxneä¸­æ–­çš„å®ç°ï¼š"></a>rxneä¸­æ–­çš„å®ç°ï¼š</h4><p><strong>æ ¸å¿ƒï¼š</strong></p><p>åŒä»»åŠ¡ä¸€ï¼Œä¸­æ–­æ‰§è¡Œæ—¶æœ€æ ¸å¿ƒçš„ä»£ç ä¾ç„¶æ˜¯æ˜¯ä¸­æ–­æ‰§è¡Œå‡½æ•°ï¼šUSART1_IRQHandlerï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„ä¸­æ–­åå¼•å‘çš„åŠŸèƒ½è¦åœ¨è¿™é‡Œé¢é…ç½®</p><p><strong>æ–¹æ³•ï¼š</strong></p><p>è¦æƒ³è®©stm32é€šè¿‡æ¥æ”¶ ledoff å’Œledon æ¥è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œæ— éæ˜¯æŠŠä»»åŠ¡1æ¥æ”¶æ•°å­—çš„åœ°æ–¹æ”¹æˆæ¥æ”¶å­—ç¬¦ä¸²æ•°æ®åŒ…å³å¯ï¼Œæ¥æ”¶æ•°æ®åŒ…çš„ç¨‹åºæŒ‰ç…§çŠ¶æ€æœºçš„ç”»æ³•è®¾è®¡ï¼Œæ¥æ”¶åˆ°æ•°æ®ä»¥åï¼Œä¸LEDOFF LEDONè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£å°±æ‰§è¡Œç›¸åº”æ“ä½œï¼Œå¯¹ä¸ä¸Šå·çš„è¯å°±è¿”å›error</p><h5 id="æ€»ç»“ä¸€ä¸‹æ­¥éª¤ï¼š"><a href="#æ€»ç»“ä¸€ä¸‹æ­¥éª¤ï¼š" class="headerlink" title="æ€»ç»“ä¸€ä¸‹æ­¥éª¤ï¼š"></a>æ€»ç»“ä¸€ä¸‹æ­¥éª¤ï¼š</h5><ol><li>ä½¿èƒ½usart1æ—¶é’Ÿï¼Œgpioæ—¶é’Ÿï¼Œé…ç½®å¥½gpioå’Œusatr1çš„åˆå§‹åŒ–ç»“æ„ä½“</li><li>ä½¿ç”¨usatrçš„itconfigå‡½æ•°æ‰“é€šrxneåˆ°nvicçš„é€šè·¯</li><li>é…ç½®å¥½nvicï¼Œè®¾ç½®å¥½ä¸­æ–­å‚æ•°</li><li>ç¼–å†™USART1_IRQHandlerå‡½æ•°ï¼ŒæŠŠä¸­æ–­å‡½æ•°æ‰§è¡Œæ­¥éª¤å†™å¥½</li></ol><h3 id="ä»£ç å®ç°ï¼š"><a href="#ä»£ç å®ç°ï¼š" class="headerlink" title="ä»£ç å®ç°ï¼š"></a>ä»£ç å®ç°ï¼š</h3><h4 id="åº“å‡½æ•°ï¼š"><a href="#åº“å‡½æ•°ï¼š" class="headerlink" title="åº“å‡½æ•°ï¼š"></a>åº“å‡½æ•°ï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> Serial_RxPacket[<span class="number">100</span>];<span class="comment">//æ•°æ®åŒ…æ•°ç»„</span></span><br><span class="line"><span class="type">uint8_t</span> Serial_RxFlag;<span class="comment">//æ•°æ®åŒ…æ¥å—æ ‡å¿—ä½</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1,ENABLE);<span class="comment">//USATR1åœ¨APB2æ€»çº¿ä¸Š</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP; <span class="comment">//txè®¾ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU; <span class="comment">//rxè®¾ç½®ä¸ºä¸Šæ‹‰è¾“å…¥ï¼ˆè¾“å…¥ä¸å­˜åœ¨å¤ç”¨ä¸å¤ç”¨çš„ï¼Œå› ä¸ºè¾“å‡ºåªèƒ½æœ‰ä¸€ä¸ªï¼Œä½†æ˜¯è¾“å…¥å¯ä»¥æœ‰å¤šä¸ªï¼‰</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">USART_InitTypeDef USART_InitStructure;</span><br><span class="line">USART_InitStructure.USART_BaudRate = <span class="number">9600</span>; <span class="comment">//è®¾ç½®æ³¢ç‰¹ç‡</span></span><br><span class="line">USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None; <span class="comment">//è®¾ç½®æ²¡æœ‰ç¡¬ä»¶æµæ§åˆ¶</span></span><br><span class="line">USART_InitStructure.USART_Mode = USART_Mode_Rx|USART_Mode_Tx; <span class="comment">//è®¾ç½®æ¨¡å¼ä¸ºrxå’Œtxéƒ½ç”¨</span></span><br><span class="line">USART_InitStructure.USART_Parity = USART_Parity_No; <span class="comment">//è®¾ç½®ä¸è¿›è¡Œå¥‡å¶æ ¡éªŒ</span></span><br><span class="line">USART_InitStructure.USART_StopBits = USART_StopBits_1;<span class="comment">//è®¾ç½®ç»ˆæ­¢ä½é•¿åº¦ä½1</span></span><br><span class="line">USART_InitStructure.USART_WordLength = USART_WordLength_8b;<span class="comment">//è®¾ç½®æ•°æ®é•¿åº¦ä¸º8ä½</span></span><br><span class="line"></span><br><span class="line">USART_Init(USART1,&amp;USART_InitStructure);<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®æ¥æ”¶ä¸­æ–­</span></span><br><span class="line">USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);<span class="comment">//è¿™å¥usatr1çš„itconfigé…ç½®äº†usatr1åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®nvic</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);<span class="comment">//å…ˆåˆ†ç»„</span></span><br><span class="line">NVIC_InitTypeDef NVIC_InitSturcture;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannel = USART1_IRQn; <span class="comment">//é…ç½®nvicçš„irqné€šé“</span></span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitSturcture);</span><br><span class="line"></span><br><span class="line">USART_Cmd(USART1,ENABLE);<span class="comment">//æ‰“å¼€å¼€å…³</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxFlag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(Serial_RxFlag == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">USART1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> RxState = <span class="number">0</span>;<span class="comment">//å½“å‰çŠ¶æ€æœºçŠ¶æ€çš„é™æ€å˜é‡ï¼Œå‡ºå‡½æ•°ä¹‹åä¸ä¼šé”€æ¯ï¼Œä¸‹æ¬¡ç”¨çš„æ—¶å€™ä¿æŒä¸Šæ¬¡ç”¨æœ€åçš„å€¼</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> pRxPacket = <span class="number">0</span>;<span class="comment">//å½“å‰æ¥æ”¶æ•°æ®ä½ç½®çš„é™æ€å˜é‡</span></span><br><span class="line"><span class="keyword">if</span> (USART_GetITStatus(USART1, USART_IT_RXNE) == SET)<span class="comment">//æ˜¯å¦æ˜¯USART1çš„æ¥æ”¶è§¦å‘ä¸­æ–­</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> RxData = USART_ReceiveData(USART1);<span class="comment">//è¯»å–æ•°æ®å¯„å­˜å™¨ï¼Œå­˜æ”¾åœ¨æ¥æ”¶çš„æ•°æ®å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®çŠ¶æ€æœºç”»çš„å›¾ç¼–å†™ä¸‹é¢çš„ç¨‹åºï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//rxstateä¸º0ï¼Œæ¥æ”¶æ•°æ®åŒ…åŒ…å¤´</span></span><br><span class="line"><span class="keyword">if</span> (RxState == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;@&#x27;</span> &amp;&amp; Serial_RxFlag == <span class="number">0</span>)<span class="comment">//æ•°æ®æ˜¯åŒ…å¤´ï¼Œå¹¶ä¸”ä¸Šä¸€ä¸ªæ•°æ®åŒ…å·²å¤„ç†å®Œäº†</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">1</span>;<span class="comment">//ä¸‹é¢æ¥å—æ•°æ®</span></span><br><span class="line">pRxPacket = <span class="number">0</span>;<span class="comment">//æ•°æ®åŒ…çš„ä½ç½®å½’é›¶ï¼Œå¼€å§‹æŒ¨ä¸ªå¾€é‡Œå¡</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//restateä¸º1ï¼Œæ¥æ”¶æ•°æ®åŒ…æ•°æ®ï¼ŒåŒæ—¶åˆ¤æ–­æ˜¯å¦æ¥æ”¶åˆ°äº†ç¬¬ä¸€ä¸ªåŒ…å°¾</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (RxState == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;\r&#x27;</span>)<span class="comment">//å¦‚æœæ”¶åˆ°ç¬¬ä¸€ä¸ªåŒ…å°¾</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">2</span>;<span class="comment">//ç½®ä¸‹ä¸€ä¸ªçŠ¶æ€</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//æ¥æ”¶åˆ°äº†æ­£å¸¸çš„æ•°æ®</span></span><br><span class="line">&#123;</span><br><span class="line">Serial_RxPacket[pRxPacket] = RxData;<span class="comment">//æ•°æ®å­˜å…¥æ•°æ®åŒ…æ•°ç»„çš„å¯¹åº”çš„ä½ç½®</span></span><br><span class="line">pRxPacket ++;<span class="comment">//æ ‡è®°ä¸‹ä¸€æ¬¡è¯¥å­˜æ”¾çš„ä½ç½®</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//rxstateä¸º2ï¼Œæ¥æ”¶æ•°æ®åŒ…ç¬¬äºŒä¸ªåŒ…å°¾</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (RxState == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;\n&#x27;</span>)<span class="comment">//å¦‚æœæ”¶åˆ°ç¬¬äºŒä¸ªåŒ…å°¾</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">0</span>;<span class="comment">//çŠ¶æ€å½’0</span></span><br><span class="line">Serial_RxPacket[pRxPacket] = <span class="string">&#x27;\0&#x27;</span>;<span class="comment">//å°†æ”¶åˆ°çš„å­—ç¬¦æ•°æ®åŒ…æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸæ ‡å¿—ï¼ˆä¸ç„¶ä¸ä¼šè‡ªå¸¦ï¼‰</span></span><br><span class="line">Serial_RxFlag = <span class="number">1</span>;<span class="comment">//rxflagä¸º1ï¼ŒæˆåŠŸæ¥æ”¶ä¸€ä¸ªæ•°æ®åŒ…</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">USART_ClearITPendingBit(USART1, USART_IT_RXNE);<span class="comment">//æ¸…é™¤æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°;"></a>ä¸»å‡½æ•°;</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Serial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="type">uint8_t</span> RxData;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">LED_Init(<span class="number">1</span>);</span><br><span class="line">Serial_Init();</span><br><span class="line">Serial_Printf(<span class="string">&quot;num is %d&quot;</span>,<span class="number">10</span>);</span><br><span class="line">OLED_ShowString(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;TxPacket&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">3</span>, <span class="number">1</span>, <span class="string">&quot;RxPacket&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Serial_RxFlag == <span class="number">1</span>)<span class="comment">//å¦‚æœæ¥æ”¶åˆ°æ•°æ®åŒ…</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowString(<span class="number">4</span>, <span class="number">1</span>, <span class="string">&quot;                &quot;</span>);<span class="comment">//OLEDæ¸…é™¤åŸæœ‰çš„æ˜¾ç¤º</span></span><br><span class="line">OLED_ShowString(<span class="number">4</span>, <span class="number">1</span>, Serial_RxPacket);<span class="comment">//æ˜¾ç¤ºæ¥æ”¶åˆ°çš„æ•°æ®åŒ…</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†æ”¶åˆ°çš„æ•°æ®åŒ…è¿›è¡Œå­—ç¬¦ä¸²æ¯”å¯¹ï¼Œæ‰§è¡Œå¯¹åº”æ“ä½œ</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strcmp</span>(Serial_RxPacket, <span class="string">&quot;LEDON&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">LED_ON(<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;LEDONOK\r\n&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;                &quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;LEDONOK&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(Serial_RxPacket, <span class="string">&quot;LEDOFF&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">LED_OFF(<span class="number">1</span>);</span><br><span class="line">Serial_SendString(<span class="string">&quot;LEDOFFOK\r\n&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;                &quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;LEDOFFOK&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//è¾“å…¥ä¸æ˜¯æˆ‘ä»¬æŒ‡å®šçš„æ ¼å¼</span></span><br><span class="line">&#123;</span><br><span class="line">Serial_SendString(<span class="string">&quot;ERROR\r\n&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;                &quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;ERROR&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;<span class="comment">//å°†æ¥æ”¶æ•°æ®åŒ…æ ‡å¿—ä½æ¸…é›¶ï¼Œå¦åˆ™æ— æ³•æ¥æ”¶åç»­æ•°æ®åŒ…</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å®ç°è§†é¢‘ï¼š"><a href="#å®ç°è§†é¢‘ï¼š" class="headerlink" title="å®ç°è§†é¢‘ï¼š"></a>å®ç°è§†é¢‘ï¼š</h3><h2 id="ä»»åŠ¡ï¼ˆ3ï¼‰ï¼šé€šè¿‡ä¸²â¼è°ƒæ•´LEDé—ªçƒé¢‘ç‡"><a href="#ä»»åŠ¡ï¼ˆ3ï¼‰ï¼šé€šè¿‡ä¸²â¼è°ƒæ•´LEDé—ªçƒé¢‘ç‡" class="headerlink" title="ä»»åŠ¡ï¼ˆ3ï¼‰ï¼šé€šè¿‡ä¸²â¼è°ƒæ•´LEDé—ªçƒé¢‘ç‡"></a>ä»»åŠ¡ï¼ˆ3ï¼‰ï¼šé€šè¿‡ä¸²â¼è°ƒæ•´LEDé—ªçƒé¢‘ç‡</h2><h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><p><strong>ç›¸æ¯”äºä»»åŠ¡äºŒï¼Œæ— éæ˜¯æ”¹å˜ä¸€ä¸‹ä¸­æ–­äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶å°±æ˜¯æ”¹å˜ä¸€ä¸ªfloatå˜é‡è€Œå·²</strong></p><p>è¿™ä¸ªfloatå˜é‡èŒƒå›´å–å€¼0-3ï¼Œç²¾åº¦0.1</p><p>å½“ç„¶ï¼Œæ¶‰åŠåˆ°æ—¶é—´å°±è¦é…ç½®ä¸€ä¸‹timè®¡æ—¶å™¨æ¥ç»“åˆä½¿ç”¨</p><p>æˆ‘ä»¬æ¬å‡ºä¹‹å‰ç§’è®¡æ—¶å™¨çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);<span class="comment">//ä½¿èƒ½æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">TIM_InternalClockConfig(TIM2);</span><br><span class="line"></span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1; <span class="comment">//Ö¸è®¾ç½®æ—¶é’Ÿåˆ†é¢‘ï¼ˆ1åˆ†é¢‘ï¼‰</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; <span class="comment">//å‘ä¸Šè®¡æ•°</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">10000</span><span class="number">-1</span>;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">7200</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_RepetitionCounter=<span class="number">0</span>;<span class="comment">//é‡å¤è®¡æ•°ï¼ˆé«˜çº§è®¡æ—¶å™¨æœ‰ï¼Œç°åœ¨ä¸ç”¨ï¼‰</span></span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update); <span class="comment">//æ¸…é™¤TIM2çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½ï¼Œç¡®ä¿å®šæ—¶å™¨å¼€å§‹æ—¶æ²¡æœ‰æ®‹ç•™çš„ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"></span><br><span class="line">TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);<span class="comment">//å¼€å¯æ›´æ–°ä¸­æ–­åˆ°nvicé€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line"><span class="comment">//çœç•¥</span></span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºå‘¨æœŸçš„è®¾å®šï¼Œ<strong>æ ¸å¿ƒä»£ç </strong>å°±æ˜¯è¿™ä¸¤ä¸ªï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">10000</span><span class="number">-1</span>;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">7200</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸€è¡Œæ˜¯arrï¼ˆè‡ªåŠ¨é‡è£…è®¡æ•°å€¼ï¼‰ï¼Œä¸‹é¢ä¸€è¡Œæ˜¯æŠŠ72mhz<strong>åˆ†æˆ7200ä»½</strong></p><p>å¦‚æœè¯´ä¸Šé¢æ˜¯10000çš„è¯ï¼Œé‚£å‘¨æœŸå°±æ˜¯1ç§’ï¼Œå¦‚æœæŠŠä¸Šé¢æ”¹æˆ5kï¼Œé‚£å‘¨æœŸå°±æ˜¯0.5ç§’</p><p><strong>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åªä¿®æ”¹arræ¥å®ç°æ”¹å˜å‘¨æœŸ</strong></p><p>ä¿®æ”¹arrçš„å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">TIM_SetAutoreload</span><span class="params">(TIM_TypeDef* TIMx, <span class="type">uint16_t</span> Autoreload)</span>;</span><br></pre></td></tr></table></figure><p>åŠ¨æ€ä¿®æ”¹ TIM_Periodï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ä¿®æ”¹è‡ªåŠ¨é‡è£…è½½å€¼</span><br><span class="line">TIM_SetAutoreload(TIM2, new_arr);</span><br><span class="line"></span><br><span class="line">// è§¦å‘æ›´æ–°äº‹ä»¶ï¼Œè®©æ–°çš„ARRå€¼ç«‹å³ç”Ÿæ•ˆ</span><br><span class="line">TIM_GenerateEvent(TIM2, TIM_EventSource_Update);</span><br></pre></td></tr></table></figure><h4 id="ä¸²å£ä¸­æ–­ï¼Œtimä¸­æ–­ï¼š"><a href="#ä¸²å£ä¸­æ–­ï¼Œtimä¸­æ–­ï¼š" class="headerlink" title="ä¸²å£ä¸­æ–­ï¼Œtimä¸­æ–­ï¼š"></a>ä¸²å£ä¸­æ–­ï¼Œtimä¸­æ–­ï¼š</h4><p>ä¸²å£ä¸­æ–­ï¼š</p><p>æºäºä¸Šä½æœºçš„ä¿¡æ¯è¾“å…¥ï¼Œä¸­æ–­åå¼•èµ·äº‹ä»¶â€”â€”tim2è®¡æ—¶å™¨å‘¨æœŸä¿®æ”¹</p><p>timä¸­æ–­ï¼š</p><p>æºäºè‡ªå¢è®¡æ•°å™¨è¾¾åˆ°é¢„è®¾å€¼ï¼Œä¸­æ–­åå¼•èµ·äº‹ä»¶â€”â€”å¼€å…³led</p><h3 id="äºŒè€…çš„é…åˆï¼š"><a href="#äºŒè€…çš„é…åˆï¼š" class="headerlink" title="äºŒè€…çš„é…åˆï¼š"></a>äºŒè€…çš„é…åˆï¼š</h3><p>å°†è¿™ä¸ªç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹æç‚¼å‡ºæ¥ï¼Œå°±æ˜¯ï¼š</p><p>å¯ç”¨tim2è®¡æ—¶å™¨ï¼Œå¯ç”¨usart1</p><p>â€”â€”&gt;æŠŠtim2çš„è‡ªåŠ¨é‡è£…è®¡æ•°äº‹ä»¶è¿æ¥åˆ°NVICï¼ŒæŠŠusart1çš„rxneäº‹ä»¶è¿æ¥åˆ°NVIC</p><p>â€”â€”&gt;é…ç½®tim2çš„ä¸­æ–­äº‹ä»¶ä¸ºäº®ç¯ç­ç¯ï¼Œrxneçš„ä¸­æ–­äº‹ä»¶é…ç½®ä¸º <strong>æ›´æ”¹tim2è®¡æ•°å™¨çš„å‘¨æœŸ</strong></p><p>â€”â€”&gt;é…ç½®usart1çš„ä¸²å£è¾“å…¥å‚æ•°ï¼Œé…ç½®å¥½å®ƒçš„æ¥æ”¶æ•°æ®åŒ…æ ¼å¼</p><p>â€”â€”&gt;åœ¨ä¸»å‡½æ•°ä¸­æ•´åˆè®¡ç®—ï¼Œåˆ†æ‹£æ•°æ®ï¼Œå®ç°åŠŸèƒ½</p><p>serial.c:</p><h3 id="ä»£ç å®ç°ï¼š-1"><a href="#ä»£ç å®ç°ï¼š-1" class="headerlink" title="ä»£ç å®ç°ï¼š"></a>ä»£ç å®ç°ï¼š</h3><h4 id="åº“å‡½æ•°"><a href="#åº“å‡½æ•°" class="headerlink" title="åº“å‡½æ•°"></a>åº“å‡½æ•°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> Serial_RxPacket[<span class="number">100</span>];<span class="comment">//æ•°æ®åŒ…æ•°ç»„</span></span><br><span class="line"><span class="type">uint8_t</span> Serial_RxFlag;<span class="comment">//æ•°æ®åŒ…æ¥å—æ ‡å¿—ä½</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Serial_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1,ENABLE);<span class="comment">//USATR1åœ¨APB2æ€»çº¿ä¸Š</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP; <span class="comment">//txè®¾ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU; <span class="comment">//rxè®¾ç½®ä¸ºä¸Šæ‹‰è¾“å…¥ï¼ˆè¾“å…¥ä¸å­˜åœ¨å¤ç”¨ä¸å¤ç”¨çš„ï¼Œå› ä¸ºè¾“å‡ºåªèƒ½æœ‰ä¸€ä¸ªï¼Œä½†æ˜¯è¾“å…¥å¯ä»¥æœ‰å¤šä¸ªï¼‰</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">USART_InitTypeDef USART_InitStructure;</span><br><span class="line">USART_InitStructure.USART_BaudRate = <span class="number">9600</span>; <span class="comment">//è®¾ç½®æ³¢ç‰¹ç‡</span></span><br><span class="line">USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None; <span class="comment">//è®¾ç½®æ²¡æœ‰ç¡¬ä»¶æµæ§åˆ¶</span></span><br><span class="line">USART_InitStructure.USART_Mode = USART_Mode_Rx|USART_Mode_Tx; <span class="comment">//è®¾ç½®æ¨¡å¼ä¸ºrxå’Œtxéƒ½ç”¨</span></span><br><span class="line">USART_InitStructure.USART_Parity = USART_Parity_No; <span class="comment">//è®¾ç½®ä¸è¿›è¡Œå¥‡å¶æ ¡éªŒ</span></span><br><span class="line">USART_InitStructure.USART_StopBits = USART_StopBits_1;<span class="comment">//è®¾ç½®ç»ˆæ­¢ä½é•¿åº¦ä½1</span></span><br><span class="line">USART_InitStructure.USART_WordLength = USART_WordLength_8b;<span class="comment">//è®¾ç½®æ•°æ®é•¿åº¦ä¸º8ä½</span></span><br><span class="line"></span><br><span class="line">USART_Init(USART1,&amp;USART_InitStructure);<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®æ¥æ”¶ä¸­æ–­</span></span><br><span class="line">USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);<span class="comment">//è¿™å¥usatr1çš„itconfigé…ç½®äº†usatr1åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢é…ç½®nvic</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);<span class="comment">//å…ˆåˆ†ç»„</span></span><br><span class="line">NVIC_InitTypeDef NVIC_InitSturcture;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannel = USART1_IRQn; <span class="comment">//é…ç½®nvicçš„irqné€šé“</span></span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelPreemptionPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_InitSturcture.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitSturcture);</span><br><span class="line"></span><br><span class="line">USART_Cmd(USART1,ENABLE);<span class="comment">//æ‰“å¼€å¼€å…³</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">Serial_GetRxFlag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(Serial_RxFlag == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">USART1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> RxState = <span class="number">0</span>;<span class="comment">//å½“å‰çŠ¶æ€æœºçŠ¶æ€çš„é™æ€å˜é‡ï¼Œå‡ºå‡½æ•°ä¹‹åä¸ä¼šé”€æ¯ï¼Œä¸‹æ¬¡ç”¨çš„æ—¶å€™ä¿æŒä¸Šæ¬¡ç”¨æœ€åçš„å€¼</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> pRxPacket = <span class="number">0</span>;<span class="comment">//å½“å‰æ¥æ”¶æ•°æ®ä½ç½®çš„é™æ€å˜é‡</span></span><br><span class="line"><span class="keyword">if</span> (USART_GetITStatus(USART1, USART_IT_RXNE) == SET)<span class="comment">//æ˜¯å¦æ˜¯USART1çš„æ¥æ”¶è§¦å‘ä¸­æ–­</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> RxData = USART_ReceiveData(USART1);<span class="comment">//è¯»å–æ•°æ®å¯„å­˜å™¨ï¼Œå­˜æ”¾åœ¨æ¥æ”¶çš„æ•°æ®å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®çŠ¶æ€æœºç”»çš„å›¾ç¼–å†™ä¸‹é¢çš„ç¨‹åºï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//rxstateä¸º0ï¼Œæ¥æ”¶æ•°æ®åŒ…åŒ…å¤´</span></span><br><span class="line"><span class="keyword">if</span> (RxState == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;@&#x27;</span> &amp;&amp; Serial_RxFlag == <span class="number">0</span>)<span class="comment">//æ•°æ®æ˜¯åŒ…å¤´ï¼Œå¹¶ä¸”ä¸Šä¸€ä¸ªæ•°æ®åŒ…å·²å¤„ç†å®Œäº†</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">1</span>;<span class="comment">//ä¸‹é¢æ¥å—æ•°æ®</span></span><br><span class="line">pRxPacket = <span class="number">0</span>;<span class="comment">//æ•°æ®åŒ…çš„ä½ç½®å½’é›¶ï¼Œå¼€å§‹æŒ¨ä¸ªå¾€é‡Œå¡</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//restateä¸º1ï¼Œæ¥æ”¶æ•°æ®åŒ…æ•°æ®ï¼ŒåŒæ—¶åˆ¤æ–­æ˜¯å¦æ¥æ”¶åˆ°äº†ç¬¬ä¸€ä¸ªåŒ…å°¾</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (RxState == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;\r&#x27;</span>)<span class="comment">//å¦‚æœæ”¶åˆ°ç¬¬ä¸€ä¸ªåŒ…å°¾</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">2</span>;<span class="comment">//ç½®ä¸‹ä¸€ä¸ªçŠ¶æ€</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//æ¥æ”¶åˆ°äº†æ­£å¸¸çš„æ•°æ®</span></span><br><span class="line">&#123;</span><br><span class="line">Serial_RxPacket[pRxPacket] = RxData;<span class="comment">//æ•°æ®å­˜å…¥æ•°æ®åŒ…æ•°ç»„çš„å¯¹åº”çš„ä½ç½®</span></span><br><span class="line">pRxPacket ++;<span class="comment">//æ ‡è®°ä¸‹ä¸€æ¬¡è¯¥å­˜æ”¾çš„ä½ç½®</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//rxstateä¸º2ï¼Œæ¥æ”¶æ•°æ®åŒ…ç¬¬äºŒä¸ªåŒ…å°¾</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (RxState == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (RxData == <span class="string">&#x27;\n&#x27;</span>)<span class="comment">//å¦‚æœæ”¶åˆ°ç¬¬äºŒä¸ªåŒ…å°¾</span></span><br><span class="line">&#123;</span><br><span class="line">RxState = <span class="number">0</span>;<span class="comment">//çŠ¶æ€å½’0</span></span><br><span class="line">Serial_RxPacket[pRxPacket] = <span class="string">&#x27;\0&#x27;</span>;<span class="comment">//å°†æ”¶åˆ°çš„å­—ç¬¦æ•°æ®åŒ…æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸæ ‡å¿—ï¼ˆä¸ç„¶ä¸ä¼šè‡ªå¸¦ï¼‰</span></span><br><span class="line">Serial_RxFlag = <span class="number">1</span>;<span class="comment">//rxflagä¸º1ï¼ŒæˆåŠŸæ¥æ”¶ä¸€ä¸ªæ•°æ®åŒ…</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">USART_ClearITPendingBit(USART1, USART_IT_RXNE);<span class="comment">//æ¸…é™¤æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸»å‡½æ•°ï¼š"><a href="#ä¸»å‡½æ•°ï¼š" class="headerlink" title="ä¸»å‡½æ•°ï¼š"></a>ä¸»å‡½æ•°ï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Serial.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="type">uint8_t</span> RxData;</span><br><span class="line"><span class="type">uint8_t</span> ledstate = <span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(TIM_GetITStatus(TIM2,TIM_IT_Update) == SET)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ledstate == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ledstate = <span class="number">1</span>;</span><br><span class="line">LED_ON(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ledstate = <span class="number">0</span>;</span><br><span class="line">LED_OFF(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">TIM_ClearITPendingBit(TIM2,TIM_IT_Update);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">LED_Init(<span class="number">1</span>);</span><br><span class="line">Serial_Init();</span><br><span class="line">Timer_Init();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Serial_RxFlag == <span class="number">1</span>)<span class="comment">//å¦‚æœæ¥æ”¶åˆ°æ•°æ®åŒ…</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;num:&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">1</span>,<span class="number">6</span>,Serial_RxPacket);</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> tempint = Serial_RxPacket[<span class="number">0</span>]<span class="number">-48</span>;</span><br><span class="line"><span class="type">float</span> tempflo = Serial_RxPacket[<span class="number">2</span>]<span class="number">-48</span>;</span><br><span class="line"><span class="type">int</span> arraylength = <span class="built_in">strlen</span>(Serial_RxPacket);</span><br><span class="line"><span class="keyword">if</span>(((Serial_RxPacket[<span class="number">1</span>]!=<span class="string">&#x27;.&#x27;</span> &amp;&amp; Serial_RxPacket[<span class="number">1</span>]==<span class="string">&#x27;0&#x27;</span>)&amp;&amp;(arraylength&gt;<span class="number">1</span>))||arraylength&gt;<span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowString(<span class="number">3</span>,<span class="number">1</span>,<span class="string">&quot;error input&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> arrtemp = <span class="number">10000</span>*(tempint + tempflo*<span class="number">0.1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(arrtemp&gt;<span class="number">0</span>&amp;&amp;arrtemp&lt;=<span class="number">30000</span>)</span><br><span class="line">&#123;OLED_ShowNum(<span class="number">2</span>,<span class="number">1</span>,arrtemp,<span class="number">8</span>);</span><br><span class="line">OLED_ShowString(<span class="number">3</span>,<span class="number">1</span>,<span class="string">&quot;valid input&quot;</span>);</span><br><span class="line"><span class="comment">// ä¿®æ”¹è‡ªåŠ¨é‡è£…è½½å€¼</span></span><br><span class="line">TIM_SetAutoreload(TIM2, arrtemp<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘æ›´æ–°äº‹ä»¶ï¼Œè®©æ–°çš„ARRå€¼ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line">TIM_GenerateEvent(TIM2, TIM_EventSource_Update);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowString(<span class="number">3</span>,<span class="number">1</span>,<span class="string">&quot;error input&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Serial_RxFlag = <span class="number">0</span>;<span class="comment">//å°†æ¥æ”¶æ•°æ®åŒ…æ ‡å¿—ä½æ¸…é›¶ï¼Œå¦åˆ™æ— æ³•æ¥æ”¶åç»­æ•°æ®åŒ…</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘æ•ˆæœï¼š"><a href="#è§†é¢‘æ•ˆæœï¼š" class="headerlink" title="è§†é¢‘æ•ˆæœï¼š"></a>è§†é¢‘æ•ˆæœï¼š</h3><h2 id="ä»»åŠ¡-4-Debug-åŠŸèƒ½å’Œä½¿â½¤"><a href="#ä»»åŠ¡-4-Debug-åŠŸèƒ½å’Œä½¿â½¤" class="headerlink" title="ä»»åŠ¡(4) Debug åŠŸèƒ½å’Œä½¿â½¤"></a>ä»»åŠ¡(4) Debug åŠŸèƒ½å’Œä½¿â½¤</h2><h3 id="debugåŠŸèƒ½ç®€è®°"><a href="#debugåŠŸèƒ½ç®€è®°" class="headerlink" title="debugåŠŸèƒ½ç®€è®°"></a>debugåŠŸèƒ½ç®€è®°</h3><h4 id="1-è¿›å…¥-Debug-æ¨¡å¼"><a href="#1-è¿›å…¥-Debug-æ¨¡å¼" class="headerlink" title="1. è¿›å…¥ Debug æ¨¡å¼"></a>1. è¿›å…¥ Debug æ¨¡å¼</h4><ol><li><strong>ç¼–è¯‘é¡¹ç›®</strong>ï¼š<ul><li>åœ¨èœå•æ ä¸­ï¼Œç‚¹å‡» <strong>â€œProjectâ€</strong> -&gt; **â€Build Targetâ€**ï¼ˆæˆ–ç›´æ¥ç‚¹å‡»å·¥å…·æ ä¸­çš„å°é”¤å­å›¾æ ‡ï¼‰ã€‚</li></ul></li><li><strong>è¿›å…¥ Debug æ¨¡å¼</strong>ï¼š<ul><li>ç‚¹å‡»å·¥å…·æ ä¸­çš„ <strong>â€œDebugâ€</strong> æŒ‰é’®ï¼ˆä¸€ä¸ªå¸¦æœ‰å°è™«å­çš„å›¾æ ‡ï¼‰ï¼Œæˆ–ä»èœå•ä¸­é€‰æ‹© <strong>â€œDebugâ€</strong> -&gt; **â€Start&#x2F;Stop Debug Sessionâ€**ã€‚</li></ul></li></ol><h4 id="2-å¤ä½-MCU"><a href="#2-å¤ä½-MCU" class="headerlink" title="2. å¤ä½ MCU"></a>2. å¤ä½ MCU</h4><ul><li><p>å¤ä½</p><p>åœ¨ Debug ç•Œé¢ä¸Šï¼Œæ‰¾åˆ°å·¥å…·æ ä¸­çš„ <strong>â€œResetâ€</strong> æŒ‰é’®<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222235399.png" alt="image-20241023222235399">ï¼Œç‚¹å‡»è¯¥æŒ‰é’®å³å¯å¤ä½</p></li></ul><h4 id="3-è°ƒè¯•è¿è¡Œæ¨¡å¼"><a href="#3-è°ƒè¯•è¿è¡Œæ¨¡å¼" class="headerlink" title="3. è°ƒè¯•è¿è¡Œæ¨¡å¼"></a>3. è°ƒè¯•è¿è¡Œæ¨¡å¼</h4><p>åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œæœ‰ä»¥ä¸‹æŒ‰é’®åœ¨ä¸Šæ–¹å·¥å…·æ ï¼š</p><ul><li><p><strong>å…¨é€Ÿè¿è¡Œï¼ˆF5ï¼‰</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222252338.png" alt="image-20241023222252338">è¿™ä¸ªæŒ‰é’®å°†ä½¿ç¨‹åºä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€,æˆ–è€…ç›´æ¥è¿è¡Œåˆ°è®¾ç½®çš„æ–­ç‚¹å¤„ã€‚</p></li><li><p><strong>å•æ­¥æ‰§è¡Œ</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222301550.png" alt="image-20241023222301550">ç‚¹æ¯ç‚¹ä¸€æ¬¡æŒ‰é’®ï¼Œç¨‹åºè¿è¡Œä¸€æ­¥ï¼Œé‡åˆ°å‡½æ•°ä¼šè¿›å…¥å‡½æ•°æ‰§è¡Œ</p></li><li><p><strong>é€è¡Œè°ƒè¯•</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222336782.png" alt="image-20241023222336782">æ¯ç‚¹ä¸€æ¬¡æŒ‰é’®ï¼Œç¨‹åºè¿è¡Œä¸€è¡Œï¼Œé‡åˆ°å‡½æ•°<strong>è·³è¿‡å‡½æ•°æ‰§è¡Œ</strong></p></li><li><p><strong>è·³å‡ºè°ƒè¯•</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222437618.png" alt="image-20241023222437618">åœ¨ä»£ç ä¸­æ‰¾åˆ°ä½ æƒ³è¿è¡Œåˆ°çš„è¡Œï¼Œå³é”®ç‚¹å‡»è¯¥è¡Œï¼Œç„¶åé€‰æ‹© **â€Run to Cursorâ€**ã€‚</p></li><li><p><strong>è¿è¡Œåˆ°å…‰æ ‡å¤„</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222526194.png" alt="image-20241023222526194">ç›´æ¥è¿è¡Œåˆ°å…‰æ ‡å¤„</p></li><li><p>å‰è¿›åé€€</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222957219.png" alt="image-20241023222957219">è¿”å›ä¸Šä¸€æ­¥è°ƒè¯•ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥è°ƒè¯•</p></li></ul><h4 id="4-æ–­ç‚¹-Breakpoint"><a href="#4-æ–­ç‚¹-Breakpoint" class="headerlink" title="4. æ–­ç‚¹ (Breakpoint)"></a>4. æ–­ç‚¹ (Breakpoint)</h4><ul><li><p>è®¾ç½®æ–­ç‚¹</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222555566.png" alt="image-20241023222555566">è®¾ç½®å½“å‰å…‰æ ‡å¤„æ˜¯æ–­ç‚¹</p></li><li><p>å¤±èƒ½æ–­ç‚¹</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222641250.png" alt="image-20241023222641250">å¤±èƒ½å½“å‰å…‰æ ‡å¤„çš„æ–­ç‚¹<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222703855.png" alt="image-20241023222703855">å¤±èƒ½æ‰€æœ‰æ–­ç‚¹<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241023222739694.png" alt="image-20241023222739694">åˆ é™¤æ‰€æœ‰æ–­ç‚¹</p></li></ul><h3 id="debugç”¨æ³•ç¤ºä¾‹"><a href="#debugç”¨æ³•ç¤ºä¾‹" class="headerlink" title="debugç”¨æ³•ç¤ºä¾‹"></a>debugç”¨æ³•ç¤ºä¾‹</h3><h4 id="è®¾ç½®æ–­ç‚¹"><a href="#è®¾ç½®æ–­ç‚¹" class="headerlink" title="è®¾ç½®æ–­ç‚¹"></a><strong>è®¾ç½®æ–­ç‚¹</strong></h4><ul><li><strong>è¡Œæ–­ç‚¹</strong>ï¼šåœ¨æºä»£ç çª—å£ï¼Œé€‰æ‹©éœ€è¦æš‚åœçš„ä»£ç è¡Œï¼ŒåŒå‡»è¡Œå·æˆ–å³é”®é€‰æ‹© <strong>â€œInsert&#x2F;Remove Breakpointâ€</strong></li><li><strong>æ¡ä»¶æ–­ç‚¹</strong>ï¼šå³é”®æ–­ç‚¹ï¼Œé€‰æ‹© **â€Edit Breakpointâ€**ï¼Œè®¾ç½®æ¡ä»¶ï¼ˆä¾‹å¦‚å˜é‡çš„å€¼æˆ–ç‰¹å®šçš„è¡¨è¾¾å¼ï¼‰</li></ul><h4 id="é€æ­¥æ‰§è¡Œä»£ç "><a href="#é€æ­¥æ‰§è¡Œä»£ç " class="headerlink" title="é€æ­¥æ‰§è¡Œä»£ç "></a>é€æ­¥æ‰§è¡Œä»£ç </h4><ul><li><strong>å•æ­¥æ‰§è¡Œï¼ˆStep Overï¼‰</strong>ï¼šç‚¹å‡» <strong>F10</strong>ï¼Œè·³è¿‡å‡½æ•°è°ƒç”¨ä½†æ‰§è¡Œå®Œæ•´çš„å•æ¡è¯­å¥ã€‚</li><li><strong>å•æ­¥è·³å…¥ï¼ˆStep Intoï¼‰</strong>ï¼šç‚¹å‡» <strong>F11</strong>ï¼Œè¿›å…¥å½“å‰è¡Œçš„å‡½æ•°ä½“å†…ï¼Œé€è¡ŒæŸ¥çœ‹å‡½æ•°çš„å†…éƒ¨æ‰§è¡Œæµç¨‹ã€‚</li><li><strong>è·³å‡ºå‡½æ•°ï¼ˆStep Outï¼‰</strong>ï¼šç‚¹å‡» <strong>Shift + F11</strong>ï¼Œç»§ç»­æ‰§è¡Œè‡³å‡½æ•°ç»“æŸå¹¶è¿”å›ã€‚</li><li><strong>è¿è¡Œåˆ°å…‰æ ‡å¤„ï¼ˆRun to Cursorï¼‰</strong>ï¼šå³é”®é€‰æ‹© â€œRun to Cursorâ€ï¼Œä»£ç å°†ä»å½“å‰æ‰§è¡Œä½ç½®ç›´æ¥è¿è¡Œåˆ°ä½ é€‰æ‹©çš„è¡Œã€‚</li></ul><h4 id="è§‚å¯Ÿå˜é‡å’Œå¯„å­˜å™¨"><a href="#è§‚å¯Ÿå˜é‡å’Œå¯„å­˜å™¨" class="headerlink" title="è§‚å¯Ÿå˜é‡å’Œå¯„å­˜å™¨"></a><strong>è§‚å¯Ÿå˜é‡å’Œå¯„å­˜å™¨</strong></h4><ul><li><p>è§‚å¯Ÿå˜é‡</p><p>åœ¨ <strong>Watch çª—å£</strong>ï¼ˆå³é”®å˜é‡ï¼Œé€‰æ‹© <strong>Add to Watch Window</strong>ï¼‰ï¼Œå¯ä»¥æŸ¥çœ‹å˜é‡å€¼çš„åŠ¨æ€å˜åŒ–ã€‚</p><p>é€šè¿‡â€œMemoryâ€çª—å£ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹å¹¶ä¿®æ”¹ç‰¹å®šå†…å­˜åœ°å€çš„å†…å®¹ã€‚</p></li><li><p>è§‚å¯Ÿå¯„å­˜å™¨</p><p>åœ¨ <strong>â€œRegistersâ€çª—å£</strong> ä¸­æŸ¥çœ‹ CPU å¯„å­˜å™¨çš„çŠ¶æ€ï¼Œè·Ÿè¸ªæ•°æ®å¤„ç†å’Œå¯„å­˜å™¨å€¼çš„å˜åŒ–ã€‚</p></li></ul><h4 id="è§‚å¯Ÿå’Œä¿®æ”¹å†…å­˜å†…å®¹"><a href="#è§‚å¯Ÿå’Œä¿®æ”¹å†…å­˜å†…å®¹" class="headerlink" title="è§‚å¯Ÿå’Œä¿®æ”¹å†…å­˜å†…å®¹"></a><strong>è§‚å¯Ÿå’Œä¿®æ”¹å†…å­˜å†…å®¹</strong></h4><ul><li><p>Memory çª—å£</p><p>é€šè¿‡ <strong>â€œViewâ€ &gt; â€œMemory Windowsâ€ &gt; â€œMemory 1&#x2F;2â€</strong> æ¥æ‰“å¼€å†…å­˜è§‚å¯Ÿçª—å£ã€‚</p><p>è¾“å…¥å†…å­˜åœ°å€ï¼Œå¯ä»¥å®æ—¶æŸ¥çœ‹æ•°æ®ã€‚çª—å£æ”¯æŒæŸ¥çœ‹ <strong>ASCII</strong> å’Œ <strong>Hex</strong> æ ¼å¼çš„æ•°æ®ã€‚</p></li><li><p>å®æ—¶ä¿®æ”¹</p><p>å³é”®å†…å­˜çª—å£ä¸­çš„å€¼ï¼Œé€‰æ‹©â€œModify Memoryâ€å¯å®æ—¶æ›´æ”¹ç‰¹å®šå†…å­˜ä½ç½®çš„å€¼ï¼Œä»¥æµ‹è¯•ç¨‹åºå¯¹ä¸åŒæ•°æ®çš„å“åº”ã€‚</p></li></ul><h4 id="ä½¿ç”¨è°ƒè¯•ä¿¡æ¯çª—å£"><a href="#ä½¿ç”¨è°ƒè¯•ä¿¡æ¯çª—å£" class="headerlink" title="ä½¿ç”¨è°ƒè¯•ä¿¡æ¯çª—å£"></a><strong>ä½¿ç”¨è°ƒè¯•ä¿¡æ¯çª—å£</strong></h4><ul><li><p>**è°ƒç”¨å †æ ˆ (Call Stack + Locals)**ï¼šæ˜¾ç¤ºå‡½æ•°è°ƒç”¨å †æ ˆï¼Œè·Ÿè¸ªä»£ç æ‰§è¡Œè·¯å¾„ã€‚é€‚ç”¨äºè°ƒè¯•é€’å½’æˆ–å¤šå±‚å‡½æ•°åµŒå¥—çš„é—®é¢˜ã€‚</p></li><li><p>ç¡¬ä»¶å¤–è®¾çª—å£ (Peripherals)</p><p>åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­æŸ¥çœ‹å’Œé…ç½®ç¡¬ä»¶å¤–è®¾ï¼ˆå¦‚ GPIOã€ä¸²å£ã€å®šæ—¶å™¨ï¼‰çš„çŠ¶æ€ã€‚</p><p>æ‰“å¼€ <strong>â€œViewâ€ &gt; â€œSystem Viewerâ€</strong> æŸ¥çœ‹ä¸åŒå¤–è®¾çš„å¯„å­˜å™¨å’ŒçŠ¶æ€ã€‚</p></li></ul><h3 id="Advance-projectä»»åŠ¡"><a href="#Advance-projectä»»åŠ¡" class="headerlink" title="Advance_projectä»»åŠ¡"></a>Advance_projectä»»åŠ¡</h3><ul><li>è¿›å…¥debugæ¨¡å¼ï¼Œå•æ­¥æ‰§è¡Œè‡³LED_Flashes_Initåï¼Œä¸¤ä¸ªç¯å…¨éƒ¨äº®èµ·ï¼Œä¸ºæ­£å¸¸ç°è±¡ï¼Œ</li><li>GPIO_EXIT_Initå‡½æ•°ä¸ºæŒ‰é”®æ§åˆ¶å¤–éƒ¨ä¸­æ–­ï¼Œå’Œbugå±•ç¤ºçš„ç°è±¡æ— å…³ï¼Œæ•…è·³è¿‡å³å¯</li><li>è¿›å…¥åˆ°æœ€æœ‰å¯èƒ½æœ‰é—®é¢˜çš„å‡½æ•°ï¼šTIM_Flashes_Init</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241025183756295.png" alt="image-20241025183756295"></p><ul><li><p>è¿›å…¥åˆ°TIM_Flashes_Initå‡½æ•°ä¸­ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªå‡½æ•°ä»…è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼šhandler</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå‰©ä¸‹çš„å…¨æ˜¯å¸¸è§„çš„timè®¡æ—¶å™¨åˆå§‹åŒ–ä»¥åŠnvicé…ç½®ï¼Œå°šæœªå‘ç°é”™è¯¯</p></li></ul><p>â€‹æ­¤æ—¶ï¼Œ<strong>handleræŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°ç°å·²è¢«åˆ—ä¸ºé‡å¤§å«Œç–‘å‡½æ•°ğŸ˜¡</strong></p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241025184110670.png" alt="image-20241025184110670" style="zoom:50%;" /><ul><li>è¿½æ ¹æº¯æºhandlerï¼š</li></ul><p>å›é€€åˆ°ä¸Šä¸€æ­¥ï¼Œå‘ç°handleræŒ‡é’ˆæŒ‡å‘äº†å«Œç–‘äºº<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241025184323222.png" alt="image-20241025184323222" style="zoom:33%;" /></p><p>tick_handlerå‡½æ•°ä¾å­˜äºFlashes_TIM_IRQHandlerï¼ˆä¸­æ–­å¤„ç†ï¼‰å‡½æ•°,åè€…æ‰§è¡Œï¼Œå‰è€…å°±æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬æ‰¾åˆ°åè€…ï¼Œç›´æ¥è®¾ç½®æ–­ç‚¹å¹¶è½¬åˆ°ï¼Œæˆ–è€…é€‰ä¸­ä¸­æ–­å¤„ç†å‡½æ•°ä½¿ç”¨ctrl+F10ï¼Œç›´æ¥æ‰§è¡Œåˆ°ä»–é‚£é‡Œï¼Œä¼šå‘ç°ç¨‹åºå¡åœ¨äº†</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241025185037967.png" alt="image-20241025185037967"></p><p>çœ‹åå­—ä¹ŸçŸ¥é“ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ¸…ç©ºtimeï¼Œè€Œä¸æ˜¯timeè‡ªå‡</p><p>å½“ç„¶ä¸ºäº†ä¸¥è°¨ï¼Œæˆ‘ä»¬è¿˜æ˜¯éªŒè¯ä¸€ä¸‹ï¼š</p><p>è½¬åˆ°è°ƒç”¨å®ƒçš„å‡½æ•°çš„å®šä¹‰ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241025184456370.png" alt="image-20241025184456370"></p><p>ç®€å•è®¡ç®—éªŒè¯ä¸€ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°è‡ªå·±çš„é€»è¾‘æ˜¯æ²¡æœ‰é—®é¢˜çš„</p><p>é‚£é—®é¢˜å°±å‡ºåœ¨ä»–è°ƒç”¨çš„åˆ«çš„å‡½æ•°ä¸­</p><ul><li>å‡½æ•°ä¸€ï¼šget_tick()</li><li>å‡½æ•°äºŒï¼šclare_tick()</li></ul><p>get_tickå‡½æ•°çš„é€»è¾‘æ˜¯ï¼Œè·å–å½“å‰è‡ªå¢è®¡æ•°è¾¾åˆ°é˜ˆå€¼äº§ç”Ÿçš„ä¸­æ–­æ¬¡æ•°</p><p>clare_tickå‡½æ•°çš„é€»è¾‘æ˜¯ï¼Œå®šæœŸæ¸…é™¤ä¸­æ–­æ¬¡æ•°é˜²æ­¢intå­˜ä¸ä¸‹äº†</p><p>å› æ­¤getå‡½æ•°çš„å®ç°å°±åº”è¯¥æ˜¯returnä¸­æ–­æ¬¡æ•°ï¼Œç»æ£€æŸ¥æ²¡é—®é¢˜</p><p>clareå‡½æ•°çš„å®ç°å°±åº”è¯¥æ˜¯æŠŠä¸­æ–­æ¬¡æ•°ç½®0ï¼Œå°±æ˜¯ä»–çš„é—®é¢˜</p><p>æŠŠ timeâ€“ æ”¹æˆ time &#x3D; 0ï¼›bugå·²ä¿®å¤</p><h3 id="æ¼”ç¤ºè§†é¢‘ï¼š"><a href="#æ¼”ç¤ºè§†é¢‘ï¼š" class="headerlink" title="æ¼”ç¤ºè§†é¢‘ï¼š"></a>æ¼”ç¤ºè§†é¢‘ï¼š</h3>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘ä¸–ä»£æ•°-005-æœ‰é™ç¾¤å’Œå­ç¾¤</title>
      <link href="/2024/10/18/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E6%9C%89%E9%99%90%E7%BE%A4%E5%92%8C%E5%AD%90%E7%BE%A4/"/>
      <url>/2024/10/18/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E6%9C%89%E9%99%90%E7%BE%A4%E5%92%8C%E5%AD%90%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h2 id="ä¸»è¦å†…å®¹ï¼š"><a href="#ä¸»è¦å†…å®¹ï¼š" class="headerlink" title="ä¸»è¦å†…å®¹ï¼š"></a>ä¸»è¦å†…å®¹ï¼š</h2><p>æœ‰é™ç¾¤çš„å®šä¹‰åŠæ€§è´¨(è¡¥å……)</p><p>å­ç¾¤çš„å®šä¹‰</p><p>å­ç¾¤çš„æ€§è´¨</p><p>å­ç¾¤çš„åˆ¤åˆ« </p><p>å…¸å‹å­ç¾¤</p><h2 id="æœ‰é™ç¾¤çš„å®šä¹‰åŠæ€§è´¨-è¡¥å……"><a href="#æœ‰é™ç¾¤çš„å®šä¹‰åŠæ€§è´¨-è¡¥å……" class="headerlink" title="æœ‰é™ç¾¤çš„å®šä¹‰åŠæ€§è´¨(è¡¥å……)"></a>æœ‰é™ç¾¤çš„å®šä¹‰åŠæ€§è´¨(è¡¥å……)</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018204835303.png" alt="image-20241018204835303"></p><p>ä»¤A&#x3D;{0,1,-1}ï¼Œè¯·é—®é›†åˆAå…³äºæ™®é€šä¹˜æ³•* èƒ½å¦ä½œæˆä¸€ä¸ª(æœ‰é™)ç¾¤ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><ul><li>ç­”ï¼šä¸è¡Œï¼Œæœ‰é›¶å…ƒï¼Œå’Œå•ä½å…ƒå†²çª</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018205115002.png" alt="image-20241018205115002"></p><p>è¯æ˜ï¼š</p><p>â€‹</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿‘ä¸–ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘ä¸–ä»£æ•°-003-ç¾¤çš„å®šä¹‰åŠæ€§è´¨</title>
      <link href="/2024/10/18/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E7%BE%A4%E7%9A%84%E5%AE%9A%E4%B9%89%E5%8F%8A%E6%80%A7%E8%B4%A8/"/>
      <url>/2024/10/18/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E7%BE%A4%E7%9A%84%E5%AE%9A%E4%B9%89%E5%8F%8A%E6%80%A7%E8%B4%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸»è¦å†…å®¹"><a href="#ä¸»è¦å†…å®¹" class="headerlink" title="ä¸»è¦å†…å®¹"></a>ä¸»è¦å†…å®¹</h2><ol><li>ç¾¤çš„å®šä¹‰</li><li>ç¾¤çš„åŸºæœ¬æ€§è´¨</li><li>ç¾¤çš„å®ä¾‹</li><li>ç¾¤ä¸­çš„æœ¯è¯­</li></ol><h2 id="ç¾¤çš„å®šä¹‰"><a href="#ç¾¤çš„å®šä¹‰" class="headerlink" title="ç¾¤çš„å®šä¹‰"></a>ç¾¤çš„å®šä¹‰</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018165805648.png" alt="image-20241018165805648"></p><ul><li><p>**&#x3D;&#x3D;ä»£æ•°ç³»ç»Ÿ&#x3D;&#x3D;  â€”â€”ç»“åˆå¾‹â€”â€”&gt; &#x3D;&#x3D;åŠç¾¤&#x3D;&#x3D; â€”æœ‰å•ä½å…ƒâ€”&gt;  &#x3D;&#x3D;å¹ºåŠç¾¤&#x3D;&#x3D;  **â€”ä¸¤æ¡è·¯â€”&gt;</p></li><li><p><strong>â€”â€”äº¤æ¢å¾‹â€”â€”&gt;  &#x3D;&#x3D;å¯æ¢å¹ºåŠç¾¤&#x3D;&#x3D;</strong></p><p><strong>â€”â€”å¦‚æœæ¯ä¸ªå…ƒç´ éƒ½æœ‰é€†å…ƒâ€”â€”&gt; &#x3D;&#x3D;ç¾¤&#x3D;&#x3D;</strong></p></li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018170724752.png" alt="image-20241018170724752"></p><p><img src="C:/Users/29111/AppData/Roaming/Typora/typora-user-images/image-20241018170702011.png" alt="image-20241018170702011"></p><ul><li><strong>å¯¹äºIV  ï¼Œå¯ä»¥è¿™ä¹ˆè€ƒè™‘ï¼šç›´æ¥è®©a&#x3D;bï¼Œé‚£ä¹ˆè¿ç®—çš„å·¦å•ä½å…ƒå’Œå³å•ä½å…ƒéƒ½å­˜åœ¨ï¼Œå³å•ä½å…ƒå­˜åœ¨ï¼Œç„¶åå†è®©bç­‰äºå•ä½å…ƒeï¼Œé‚£ä¹ˆå°±èƒ½æ¨å‡ºé€†å…ƒä¹Ÿå­˜åœ¨</strong></li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018171414327.png" alt="image-20241018171414327"></p><ul><li>ç­”æ¡ˆæ˜¯å¦å®šçš„</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018173248517.png" alt="image-20241018173248517"></p><h2 id="ç¾¤çš„æ€§è´¨"><a href="#ç¾¤çš„æ€§è´¨" class="headerlink" title="ç¾¤çš„æ€§è´¨"></a>ç¾¤çš„æ€§è´¨</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018173338024.png" alt="image-20241018173338024"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018173355154.png" alt="image-20241018173355154"></p><h4 id="è®¨è®ºç¾¤ä¸­ç‰¹å¼‚å…ƒç´ çš„æ€§è´¨"><a href="#è®¨è®ºç¾¤ä¸­ç‰¹å¼‚å…ƒç´ çš„æ€§è´¨" class="headerlink" title="è®¨è®ºç¾¤ä¸­ç‰¹å¼‚å…ƒç´ çš„æ€§è´¨"></a>è®¨è®ºç¾¤ä¸­ç‰¹å¼‚å…ƒç´ çš„æ€§è´¨</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018173458748.png" alt="image-20241018173458748"></p><ul><li>é€†ä¸€éï¼Œå†é€†ä¸€éï¼Œè¿˜ç­‰äºè‡ªèº«</li><li>å…ˆè¿ç®—å†é€†ï¼Œç­‰äºå…ˆé€†ï¼Œå†äº¤æ¢è¿‡æ¥ç®—</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018190900808.png" alt="image-20241018190900808"></p><ul><li>0å…ƒä¸å­˜åœ¨ï¼Œå› ä¸ºåªè¦æ˜¯ç¾¤ï¼Œå°±ä¸€å®šæœ‰é€†å…ƒï¼Œå¦‚æœæœ‰0å…ƒï¼Œå°±å†²çªäº†</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018191220599.png" alt="image-20241018191220599"></p><ul><li><strong>è¿™ä¸¤ä¸ªæ€§è´¨éƒ½æ˜¯åˆ©ç”¨äº†ç¾¤çš„æ€§è´¨ä¸­çš„å¯é€†æ€§</strong></li></ul><h2 id="ç¾¤çš„å®ä¾‹"><a href="#ç¾¤çš„å®ä¾‹" class="headerlink" title="ç¾¤çš„å®ä¾‹"></a>ç¾¤çš„å®ä¾‹</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018191555819.png" alt="image-20241018191555819"></p><h2 id="ç¾¤ä¸­çš„æœ¯è¯­"><a href="#ç¾¤ä¸­çš„æœ¯è¯­" class="headerlink" title="ç¾¤ä¸­çš„æœ¯è¯­"></a>ç¾¤ä¸­çš„æœ¯è¯­</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018191955947.png" alt="image-20241018191955947"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018192004215.png" alt="image-20241018192004215"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018192144706.png" alt="image-20241018192144706"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018192737213.png" alt="image-20241018192737213"></p><p>åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œç¾¤è¿ç®—æ˜¯<strong>å¯¹ç§°å·®</strong> âŠ•âŠ•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹æ€§è´¨ï¼š</p><ol><li><p><strong>å¯¹ç§°å·®çš„é€†å…ƒ</strong>ï¼šå¯¹ç§°å·®è¿ç®—çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œæ¯ä¸ªå…ƒç´ çš„é€†å…ƒå°±æ˜¯å®ƒæœ¬èº«ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä»»æ„ XâˆˆP({a,b})<em>X</em>âˆˆ<em>P</em>({<em>a</em>,<em>b</em>})ï¼Œæœ‰ï¼š</p><p>XâŠ•X&#x3D;âˆ…<em>X</em>âŠ•<em>X</em>&#x3D;âˆ…</p><p>å› ä¸ºå¯¹ç§°å·®åªä¿ç•™ä¸é‡å çš„å…ƒç´ ï¼Œå› æ­¤ä¸¤ä¸ªç›¸åŒçš„é›†åˆè¿›è¡Œå¯¹ç§°å·®æ“ä½œæ—¶ï¼Œç»“æœæ˜¯ç©ºé›†ã€‚</p></li><li><p><strong>å•ä½å…ƒ</strong>ï¼šåœ¨å¯¹ç§°å·®è¿ç®—ä¸‹ï¼Œå•ä½å…ƒæ˜¯<strong>ç©ºé›†</strong> âˆ…âˆ…ï¼Œå› ä¸ºå¯¹äºä»»æ„é›†åˆ X<em>X</em>ï¼Œæœ‰ï¼š</p><p>XâŠ•âˆ…&#x3D;X<em>X</em>âŠ•âˆ…&#x3D;<em>X</em></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå¯¹ç§°å·®çš„è¿ç®—å½“ä½œæŸç§â€œåŠ æ³•â€æ“ä½œï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„â€œé€†å…ƒâ€æ˜¯å®ƒè‡ªå·±ã€‚</p></li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018193708168.png" alt="image-20241018193708168"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018193743149.png" alt="image-20241018193743149"></p><h3 id="ç¾¤ä¸­å…ƒç´ çš„å¹‚"><a href="#ç¾¤ä¸­å…ƒç´ çš„å¹‚" class="headerlink" title="ç¾¤ä¸­å…ƒç´ çš„å¹‚"></a>ç¾¤ä¸­å…ƒç´ çš„å¹‚</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018194011084.png" alt="image-20241018194011084"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018194044829.png" alt="image-20241018194044829"></p><ul><li>æ³¨æ„ï¼Œå¿…é¡»æ˜¯å¯äº¤æ¢ç¾¤æ‰æ»¡è¶³ç¬¬ä¸‰æ¡æ€§è´¨</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018194316830.png" alt="image-20241018194316830"></p><h3 id="æ¨¡-nè¿ç®—ä¸­çš„å…ƒç´ çš„é˜¶"><a href="#æ¨¡-nè¿ç®—ä¸­çš„å…ƒç´ çš„é˜¶" class="headerlink" title="æ¨¡ nè¿ç®—ä¸­çš„å…ƒç´ çš„é˜¶"></a>æ¨¡ nè¿ç®—ä¸­çš„å…ƒç´ çš„é˜¶</h3><p>ä¾‹å­ä¸­æåˆ°çš„ç¾¤ âŸ¨Z6,âŠ•âŸ© æ˜¯æŒ‡æ¨¡ 6ä¸‹çš„åŠ æ³•ç¾¤ã€‚è¿™ä¸ªç¾¤çš„å…ƒç´ æ˜¯ Z6&#x3D;{[0],[1],[2],[3],[4],[5]}ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ æ˜¯æ•´æ•°å¯¹ 6 å–æ¨¡çš„ç­‰ä»·ç±»ï¼ˆå³ä½™æ•°ï¼‰ã€‚</p><p>åœ¨è¿™ä¸ªç¾¤ä¸­ï¼Œè¿ç®— âŠ•âŠ• æ˜¯æŒ‡<strong>æ¨¡ 6 åŠ æ³•</strong>ï¼Œä¾‹å¦‚ï¼š</p><ul><li>[2]âŠ•[3]&#x3D;[5]</li><li>[4]âŠ•[4]&#x3D;[2] ï¼ˆå› ä¸º 4+4&#x3D;8ï¼Œæ¨¡ 6 åå¾—åˆ° 2ï¼‰</li><li>[3]âŠ•[3]&#x3D;[0] ï¼ˆå› ä¸º 3+3&#x3D;6ï¼Œæ¨¡ 6 åå¾—åˆ° 0ï¼‰</li></ul><p>ç¾¤çš„å•ä½å…ƒæ˜¯ [0]ï¼Œå› ä¸ºå¯¹äºä»»æ„å…ƒç´  [a]âˆˆZ6ï¼Œæˆ‘ä»¬æœ‰ [a]âŠ•[0]&#x3D;[<em>a</em>]ã€‚</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018194624206.png" alt="image-20241018194624206"></p><p>râˆ£kï¼šè¿™ä¸ªç¬¦å·è¡¨ç¤º<strong>æ•´é™¤</strong>ã€‚è¯»ä½œâ€œr æ•´é™¤ kâ€ï¼Œæ„æ€æ˜¯ k å¯ä»¥è¢« ræ•´é™¤ï¼Œå³å­˜åœ¨ä¸€ä¸ªæ•´æ•° mï¼Œä½¿å¾— k&#x3D;mrã€‚ä¾‹å¦‚ï¼š</p><ul><li>3âˆ£6ï¼Œå› ä¸º 6 å¯ä»¥è¢« 3 æ•´é™¤ï¼Œä¸” 6&#x3D;3Ã—26&#x3D;3Ã—2ã€‚</li><li>4âˆ¤6ï¼Œå› ä¸º 6 ä¸èƒ½è¢« 4 æ•´é™¤ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018195442637.png" alt="image-20241018195442637"></p><p>è®¾ âˆ£aâˆ£&#x3D;rï¼Œå³a^r^&#x3D;<em>e</em>ã€‚æˆ‘ä»¬å¸Œæœ›è¯æ˜ a^âˆ’1^ çš„é˜¶ä¹Ÿæ˜¯ <em>r</em>ï¼Œå³ (a^âˆ’1^)^r^&#x3D;e</p><p>é€šè¿‡ç¾¤çš„æ€§è´¨ï¼Œ(a^âˆ’1^)^r^&#x3D;(a^r^)^âˆ’1^ç”±äº a^r^&#x3D;eï¼Œæˆ‘ä»¬æœ‰ï¼š</p><p>(a^r^)^âˆ’1^&#x3D;e^âˆ’1^&#x3D;e</p><p>å› æ­¤ï¼Œ(a^âˆ’1^)^r^&#x3D;eï¼Œè¯´æ˜ a^âˆ’1^ çš„é˜¶ä¸å¤§äº r</p><p>å¦ä¸€æ–¹é¢ï¼Œå‡è®¾ (a^âˆ’1^)^k^&#x3D;e å¯¹æŸä¸ª <em>k</em> æˆç«‹ã€‚æˆ‘ä»¬é€šè¿‡é€†å…ƒçš„æ€§è´¨å¾—åˆ°ï¼š</p><p>a^k^&#x3D;(a^âˆ’1^)^âˆ’k^&#x3D;e^âˆ’1^&#x3D;e</p><p>ç”±äº açš„é˜¶æ˜¯ <em>r</em>ï¼Œå› æ­¤ <em>k</em> å¿…é¡»æ˜¯ <em>r</em> çš„å€æ•°ï¼Œå³<em>k</em>&#x3D;<em>r</em>ã€‚è¿™è¯´æ˜ <em>a</em>^âˆ’1^ çš„é˜¶æ°å¥½æ˜¯ <em>r</em>ã€‚</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018200226504.png" alt="image-20241018200226504"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018200434602.png" alt="image-20241018200434602"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018200634225.png" alt="image-20241018200634225"></p><ul><li>é¦–å…ˆè¦è®¨è®ºæ˜¯ä¸æ˜¯æ— é™é›†</li><li>å¯¹äºä¸€å¨ä¸œè¥¿æ¥è¯´ï¼Œå·¦å³å„è‡ªæ·»ä¸€ä¸ªå…ƒç´ å’Œä¸€ä¸ªå…ƒç´ çš„é€†å’ŒåŸæ¥ä¸€å¨çš„åŸºæ•°ç›¸ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018200840462.png" alt="image-20241018200840462"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018202449239.png" alt="image-20241018202449239"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018204452162.png" alt="image-20241018204452162"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿‘ä¸–ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>stm32å­¦ä¹ ç¬”è®°002</title>
      <link href="/2024/10/16/stm3202/"/>
      <url>/2024/10/16/stm3202/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»»åŠ¡ä¸€ï¼šGPIOè¾“å…¥è¾“å‡º"><a href="#ä»»åŠ¡ä¸€ï¼šGPIOè¾“å…¥è¾“å‡º" class="headerlink" title="ä»»åŠ¡ä¸€ï¼šGPIOè¾“å…¥è¾“å‡º"></a>ä»»åŠ¡ä¸€ï¼šGPIOè¾“å…¥è¾“å‡º</h2><h3 id="åŸç†ï¼ˆå®ç°æ­¥éª¤ï¼‰"><a href="#åŸç†ï¼ˆå®ç°æ­¥éª¤ï¼‰" class="headerlink" title="åŸç†ï¼ˆå®ç°æ­¥éª¤ï¼‰"></a>åŸç†ï¼ˆå®ç°æ­¥éª¤ï¼‰</h3><ul><li>é€‰æ‹©ä¸¤ä¸ªGPIOå¼•è„šï¼ŒPB0è´Ÿè´£è¾“å‡ºï¼ŒPB1ä½œä¸ºè¾“å…¥ç«¯ã€‚</li></ul><ol><li><strong>GPIOé…ç½®</strong><ul><li>è®¾ç½®GPIOB0,B1ä¸ºæ¨æŒ½è¾“å‡ºæ¨¡å¼</li></ul></li><li><strong>æ§åˆ¶é€»è¾‘</strong><ul><li>ç¬¬ä¸€ä¸ªgpioè¾“å‡ºé«˜ä½ç”µå¹³ï¼Œæ§åˆ¶ç¬¬ä¸€ä¸ªç¯äº®ç­</li><li>æ¯æ¬¡å¾ªç¯å¼€å§‹æ—¶ï¼ŒReadInputDataBitå‡½æ•°<strong>è¯»å–GPIOB0çš„è¾“å…¥å¯„å­˜å™¨ï¼ˆIDRï¼‰</strong>ï¼Œè®°ä¸ºint led1_status</li><li>æ ¹æ®led1_statusï¼Œå»¶æ—¶200mså°†GPIOB1è°ƒæ•´ä¸ºä¸GPIO0 ä¸€è‡´</li><li>è°ƒæ•´ä¸€è‡´ä»¥åï¼Œå»¶æ—¶200mså°†GPIO0çš„çŠ¶æ€åè¿‡æ¥ï¼Œçœ‹èµ·æ¥å°±æ˜¯led1å…ˆç­äº†</li><li>å¦‚æ­¤å¾€å¤ï¼Œäº§ç”Ÿled2è·Ÿç€led1è·‘çš„çš„æ„Ÿè§‰</li></ul></li></ol><h3 id="ä»£ç å¦‚ä¸‹ï¼šï¼ˆlLEDD-ON-å’ŒLED-OFFä¸ºæˆ‘è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè¯¦è§ä»»åŠ¡ä¸‰â€”â€”ä»£ç æ¨¡å—åŒ–ï¼‰"><a href="#ä»£ç å¦‚ä¸‹ï¼šï¼ˆlLEDD-ON-å’ŒLED-OFFä¸ºæˆ‘è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè¯¦è§ä»»åŠ¡ä¸‰â€”â€”ä»£ç æ¨¡å—åŒ–ï¼‰" class="headerlink" title="ä»£ç å¦‚ä¸‹ï¼šï¼ˆlLEDD_ON å’ŒLED_OFFä¸ºæˆ‘è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè¯¦è§ä»»åŠ¡ä¸‰â€”â€”ä»£ç æ¨¡å—åŒ–ï¼‰"></a>ä»£ç å¦‚ä¸‹ï¼šï¼ˆlLEDD_ON å’ŒLED_OFFä¸ºæˆ‘è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè¯¦è§ä»»åŠ¡ä¸‰â€”â€”ä»£ç æ¨¡å—åŒ–ï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">LED_Init(<span class="number">1</span>);</span><br><span class="line">LED_Init(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> led1_status = GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_0);</span><br><span class="line"><span class="keyword">if</span>(led1_status)</span><br><span class="line">&#123;</span><br><span class="line">Delay_ms(<span class="number">200</span>);<span class="comment">//Ã‘Ã“ÃŠÂ±Ã’Â»ÃÃ‚</span></span><br><span class="line">LED_OFF(<span class="number">2</span>);</span><br><span class="line">Delay_ms(<span class="number">200</span>);</span><br><span class="line">LED_ON(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">Delay_ms(<span class="number">200</span>);</span><br><span class="line">LED_ON(<span class="number">2</span>);</span><br><span class="line">Delay_ms(<span class="number">200</span>);</span><br><span class="line">LED_OFF(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ï¼š"><a href="#è§†é¢‘ï¼š" class="headerlink" title="è§†é¢‘ï¼š"></a>è§†é¢‘ï¼š</h3><p><a href="https://cloud.video.taobao.com/play/u/44392709/p/1/d/ld/e/6/t/1/487344496185.mp4?auth_key=YXBwX2tleT04MDAwMDAwMTImYXV0aF9pbmZvPXsidGltZXN0YW1wRW5jcnlwdGVkIjoiMzc2ZDk2YzdjNGRhNGMyMTA4MjMwODNhYmFmNDc3YzQifSZkdXJhdGlvbj0mdGltZXN0YW1wPTE3Mjk2OTgxOTc=">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p><h2 id="ä»»åŠ¡äºŒ-PWMæ§åˆ¶èˆµæœº"><a href="#ä»»åŠ¡äºŒ-PWMæ§åˆ¶èˆµæœº" class="headerlink" title="ä»»åŠ¡äºŒ PWMæ§åˆ¶èˆµæœº"></a>ä»»åŠ¡äºŒ PWMæ§åˆ¶èˆµæœº</h2><h5 id="1-pwmé©±åŠ¨å‘¼å¸ç¯"><a href="#1-pwmé©±åŠ¨å‘¼å¸ç¯" class="headerlink" title="1.pwmé©±åŠ¨å‘¼å¸ç¯"></a>1.pwmé©±åŠ¨å‘¼å¸ç¯</h5><p>æ¦‚å¿µï¼šï¼ˆocä¸ºè¾“å‡ºæ¯”è¾ƒï¼Œoiä¸ºè¾“å…¥æ•è·ï¼Œccä¸ºè¾“å…¥æ•è·å’Œè¾“å‡ºæ¯”è¾ƒçš„å•å…ƒï¼‰</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017103420122.png" alt="image-20241017103420122"></p><p><strong>åŸç†</strong></p><p>ccrä¸ºæˆ‘ä»¬è‡ªå·±è®¾å®šçš„ä¸€ä¸ªæ•°å€¼ï¼Œcntä¸ºå‘¨æœŸè‡ªå¢çš„ï¼Œæ¯å½“cntç»“æŸä¸€ä¸ªå‘¨æœŸï¼Œå°±è§¦å‘ä¸€æ¬¡äº‹ä»¶ï¼ˆé‡æ–°è‡ªå¢ï¼‰ï¼Œåœ¨è¿™ä¸ªå‘¨æœŸå†…ï¼Œæ¯”è¾ƒcntå’Œccrçš„å¤§å°ï¼Œæ¥è°ƒæ§pwmè¾“å‡º<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017104240355.png" alt="image-20241017104240355"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017104928031.png" alt="image-20241017104928031"></p><p>è¾“å‡ºæ¨¡å¼æ§åˆ¶å™¨çš„ä¸åŒçŠ¶æ€ï¼š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017105149834.png" alt="image-20241017105149834"></p><ul><li><p>å†»ç»“ï¼šç”¨äºæš‚åœ</p></li><li><p>ç½®æœ‰æ•ˆç”µå¹³ &#x3D;&#x3D; ç½®é«˜ç”µå¹³      ç½®æ— æ•ˆç”µå¹³ &#x3D;&#x3D; ç½®ä½ç”µå¹³</p></li><li><p>ç”µå¹³åè½¬ï¼šæ–¹ä¾¿çš„è¾“å‡ºä¸€ä¸ªé¢‘ç‡å¯è°ƒï¼Œå ç©ºæ¯”ä¸º50%çš„pwmæ³¢</p></li><li><p>å¼ºåˆ¶ï¼šå¯è°ƒé«˜ä½çš„å†»ç»“</p></li><li><p>pwmæ¨¡å¼ï¼šæœ€å¸¸ç”¨<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017105859083.png" alt="image-20241017105859083"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017105938711.png" alt="image-20241017105938711"></p></li></ul><p>ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PWM_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);<span class="comment">//ä½¿èƒ½æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line"></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO,ENABLE);<span class="comment">//ä½¿èƒ½afioæ—¶é’Ÿ</span></span><br><span class="line">GPIO_PinRemapConfig(GPIO_PartialRemap1_TIM2,ENABLE);<span class="comment">//é‡æ˜ å°„ï¼ˆå¦‚æœæ˜¯jatgè°ƒè¯•ç«¯å£ï¼Œå†åŠ ä¸Šä¸‹é¢ä¸€å¥ï¼‰</span></span><br><span class="line">GPIO_PinRemapConfig(GPIO_Remap_SWJ_JTAGDisable,ENABLE); <span class="comment">//ç”¨afioå°†jtagè§£é™¤</span></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;<span class="comment">//æ³¨æ„è¿™ä¸ªä½ç½®è®¾ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin=GPIO_Pin_15;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_InternalClockConfig(TIM2);</span><br><span class="line"></span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1; <span class="comment">//Ö¸è®¾ç½®æ—¶é’Ÿåˆ†é¢‘ï¼ˆ1åˆ†é¢‘ï¼‰</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; <span class="comment">//å‘ä¸Šè®¡æ•°</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">100</span><span class="number">-1</span>;   <span class="comment">//ARR</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">720</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k   //PSC</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_RepetitionCounter=<span class="number">0</span>;<span class="comment">//é‡å¤è®¡æ•°ï¼ˆé«˜çº§è®¡æ—¶å™¨æœ‰ï¼Œç°åœ¨ä¸ç”¨ï¼‰</span></span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_OCInitTypeDef TIM_OCInitStructure; </span><br><span class="line"></span><br><span class="line">TIM_OCStructInit(&amp;TIM_OCInitStructure);<span class="comment">//é»˜è®¤ç»™æ‰€æœ‰å˜é‡ä¸€ä¸ªåˆå§‹å€¼ï¼Œé˜²æ­¢å‡ºé”™</span></span><br><span class="line"><span class="comment">//ä¸‹é¢å†æ”¹è‡ªå·±æƒ³æ”¹çš„</span></span><br><span class="line">TIM_OCInitStructure.TIM_OCMode=TIM_OCMode_PWM1;<span class="comment">//è®¾ç½®è¾“å‡ºæ¯”è¾ƒçš„æ¨¡å¼</span></span><br><span class="line">TIM_OCInitStructure.TIM_OCPolarity=TIM_OCPolarity_High;<span class="comment">//è®¾ç½®è¾“å‡ºæ¯”è¾ƒçš„ææ€§</span></span><br><span class="line">TIM_OCInitStructure.TIM_OutputState=TIM_OutputState_Enable;<span class="comment">//è®¾ç½®è¾“å‡ºä½¿èƒ½</span></span><br><span class="line">TIM_OCInitStructure.TIM_Pulse=<span class="number">0</span>;<span class="comment">//è®¾ç½®ccrå¯„å­˜å™¨å€¼</span></span><br><span class="line">TIM_OC1Init(TIM2,&amp;TIM_OCInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PWM_SetCompare1</span><span class="params">(<span class="type">uint16_t</span> Compare)</span></span><br><span class="line">&#123;</span><br><span class="line">TIM_SetCompare1(TIM2,Compare);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢æ˜¯mianå‡½æ•°</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OLED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;PWM.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> i;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PWM_Init();</span><br><span class="line">OLED_Init();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">100</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowNum(<span class="number">2</span>,<span class="number">1</span>,i,<span class="number">3</span>);</span><br><span class="line">PWM_SetCompare1(i);</span><br><span class="line">Delay_ms(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="è§†é¢‘ï¼š-1"><a href="#è§†é¢‘ï¼š-1" class="headerlink" title="è§†é¢‘ï¼š"></a>è§†é¢‘ï¼š</h4><p><a href="https://cloud.video.taobao.com/play/u/44392709/p/1/d/sd_265/e/6/t/1/487638019397.mp4?auth_key=YXBwX2tleT04MDAwMDAwMTImYXV0aF9pbmZvPXsidGltZXN0YW1wRW5jcnlwdGVkIjoiZGQ1MTM5ZThmZmIyYzhkMzY3ODlkYjhiYjRlZjM5YmYifSZkdXJhdGlvbj0mdGltZXN0YW1wPTE3Mjk2OTgxOTg=">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p><h5 id="2-pwmé©±åŠ¨èˆµæœºï¼ˆä¸»ä»»åŠ¡2ï¼‰"><a href="#2-pwmé©±åŠ¨èˆµæœºï¼ˆä¸»ä»»åŠ¡2ï¼‰" class="headerlink" title="2.pwmé©±åŠ¨èˆµæœºï¼ˆä¸»ä»»åŠ¡2ï¼‰"></a>2.pwmé©±åŠ¨èˆµæœºï¼ˆä¸»ä»»åŠ¡2ï¼‰</h5><p><strong>æŠ€æœ¯ç‚¹ä»‹ç»</strong>ï¼š</p><p>å®šæ—¶å™¨çš„æ¯”è¾ƒè¾“å‡ºï¼š</p><p>åŸç†ï¼šä¸»è¦ä¾é cntï¼ˆè‡ªå¢è®¡æ•°å™¨ï¼‰å’Œccrï¼ˆæˆ‘ä»¬è‡ªå·±è®¾å®šçš„ä¸€ä¸ªå€¼ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå½“cntç­‰äºccrçš„æ—¶å€™ï¼Œè§¦å‘äº‹ä»¶â€“é‡æ–°è®¡æ•°ï¼ˆè¯¦è§pwmé©±åŠ¨å‘¼å¸ç‚¹ç¯ä¸­çš„å›¾ç‰‡ï¼‰</p><h6 id="è¯¦ç»†è¿‡ç¨‹ï¼š"><a href="#è¯¦ç»†è¿‡ç¨‹ï¼š" class="headerlink" title="è¯¦ç»†è¿‡ç¨‹ï¼š"></a><strong>è¯¦ç»†è¿‡ç¨‹ï¼š</strong></h6><p><strong>è®¡æ•°å™¨ï¼ˆCNTï¼‰</strong>æ ¹æ®å®šæ—¶å™¨çš„æ—¶é’Ÿé¢‘ç‡å’Œé¢„åˆ†é¢‘å™¨çš„è®¾ç½®è‡ªåŠ¨å¢åŠ ï¼ˆæˆ–å‡å°‘ï¼‰ã€‚å½“è®¡æ•°å™¨è¾¾åˆ° ARRï¼ˆè‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨ï¼‰çš„å€¼æ—¶ï¼Œè®¡æ•°å™¨ä¼šé‡ç½®ï¼Œå¹¶ä»å¤´å¼€å§‹è®¡æ•°ã€‚</p><p><strong>æ¯”è¾ƒå€¼ï¼ˆCCRï¼‰</strong>æ¯ä¸ªå®šæ—¶å™¨é€šé“éƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒå¯„å­˜å™¨ï¼ˆCCRxï¼‰ï¼Œå®ƒå­˜å‚¨å®šæ—¶å™¨çš„æ¯”è¾ƒå€¼ã€‚å½“è®¡æ•°å™¨çš„å€¼ï¼ˆCNTï¼‰ä¸æ¯”è¾ƒå¯„å­˜å™¨çš„å€¼ç›¸ç­‰æ—¶ï¼Œå®šæ—¶å™¨ä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œæ”¹å˜è¾“å‡ºå¼•è„šçš„çŠ¶æ€</p><p><strong>ARRï¼ˆè‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨ï¼‰</strong>è®¾ç½®äº†è®¡æ•°å™¨çš„æœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ PWM ä¿¡å·çš„<strong>å‘¨æœŸ</strong>ã€‚è®¡æ•°å™¨åœ¨æ¯æ¬¡è¾¾åˆ° ARRçš„å€¼åä¼šè‡ªåŠ¨é‡ç½®ï¼Œå¼€å§‹æ–°çš„å‘¨æœŸã€‚</p><p><strong>CCRï¼ˆæ•è·æ¯”è¾ƒå¯„å­˜å™¨ï¼‰</strong>ç”¨äºè®¾ç½®æ¯”è¾ƒå€¼ï¼Œä¹Ÿå°±æ˜¯å®šæ—¶å™¨åœ¨è¿™ä¸ªå€¼æ—¶æ”¹å˜è¾“å‡ºçŠ¶æ€</p><h6 id="pwmæ˜¯ä»€ä¹ˆï¼š"><a href="#pwmæ˜¯ä»€ä¹ˆï¼š" class="headerlink" title="pwmæ˜¯ä»€ä¹ˆï¼š"></a>pwmæ˜¯ä»€ä¹ˆï¼š</h6><p>åœ¨ä¸€ä¸ªå¾ˆçŸ­çš„å‘¨æœŸå†…ï¼Œæˆ‘ä»¬è§„å®šä¸€å®šä¸€å®šæ—¶é—´é«˜ç”µå¹³ï¼Œä¸€æ®µæ—¶é—´çš„ä½ç”µå¹³ï¼ˆå³å ç©ºæ¯”ï¼‰ï¼Œè¿™æ ·ç”µå¹³å°±ä¼šä»¥è¾ƒé«˜çš„é¢‘ç‡è¿›è¡Œé«˜ä½å˜åŒ–ï¼Œè¾“å‡ºä¸€ä¸ªæ–¹æ³¢ï¼Œè¿™ä¸ªæ³¢å°±æ˜¯pwmæ³¢ï¼Œå¯ä»¥ç”¨æ¥é©±åŠ¨èˆµæœº</p><h6 id="pwmçš„å®ç°ï¼š"><a href="#pwmçš„å®ç°ï¼š" class="headerlink" title="pwmçš„å®ç°ï¼š"></a>pwmçš„å®ç°ï¼š</h6><p>å°±åƒä¸Šé¢è¯´çš„é‚£æ ·ï¼Œpwmçš„å®ç°é¦–å…ˆè¦è§„å®šä¸€ä¸ªå¾ˆå°çš„å‘¨æœŸï¼Œä»¥èˆµæœºä¸ºä¾‹ï¼Œæƒ³è¦æ§åˆ¶èˆµæœºï¼Œå‘¨æœŸå°±è¦è®¾ç½®ä¸º20ms,å¯¹åº”çš„arrå’Œpscè¦ç¬¦åˆ20msçš„å‘¨æœŸ</p><h5 id="æ ¸å¿ƒä»£ç ï¼š"><a href="#æ ¸å¿ƒä»£ç ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç ï¼š"></a><strong>æ ¸å¿ƒä»£ç ï¼š</strong></h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">20000</span><span class="number">-1</span>;   <span class="comment">//ARR</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">72</span><span class="number">-1</span>; <span class="comment">//PSC</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è®¡ç®—å®šæ—¶å™¨çš„è®¡æ•°é¢‘ç‡</span></span><br><span class="line"><span class="comment">å®šæ—¶å™¨è®¡æ•°é¢‘ç‡ç”± ç³»ç»Ÿæ—¶é’Ÿé¢‘ç‡ / (PSC + 1) å†³å®šã€‚</span></span><br><span class="line"><span class="comment">æ¯”å¦‚ï¼Œå¦‚æœ PSC = 71ï¼Œé‚£ä¹ˆå®šæ—¶å™¨çš„è®¡æ•°é¢‘ç‡ä¸ºï¼š</span></span><br><span class="line"><span class="comment">è®¡æ•°é¢‘ç‡=72MHzé™¤ä»¥ï¼ˆ71+1ï¼‰=1MHz</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">è¿™æ„å‘³ç€å®šæ—¶å™¨æ¯å¾®ç§’è®¡æ•°ä¸€æ¬¡ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">è®¾ç½® ARR å€¼</span></span><br><span class="line"><span class="comment">åœ¨ 1MHz è®¡æ•°é¢‘ç‡ä¸‹ï¼Œ20ms å¯¹åº”çš„è®¡æ•°å€¼ä¸ºï¼š</span></span><br><span class="line"><span class="comment">ARR=20msÃ—1MHz=20000</span></span><br><span class="line"><span class="comment">å› æ­¤ï¼Œå°† ARR è®¾ç½®ä¸º 20000-1 å°±å¯ä»¥äº§ç”Ÿä¸€ä¸ª 20ms å‘¨æœŸçš„ PWM ä¿¡å·ã€‚*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PWM_SetCompare2</span><span class="params">(<span class="type">uint16_t</span> Compare)</span><span class="comment">//åˆå§‹åŒ–å“ªä¸ªé€šé“ï¼Œå°±compareå‡ </span></span><br><span class="line">&#123;</span><br><span class="line">TIM_SetCompare2(TIM5,Compare); <span class="comment">//å ç©ºæ¯”</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Servo_SetAngle</span><span class="params">(<span class="type">float</span> Angele)</span></span><br><span class="line">&#123;</span><br><span class="line">PWM_SetCompare2(Angele/<span class="number">180</span>*<span class="number">2000</span>+<span class="number">500</span>); <span class="comment">//æŠŠè§’åº¦çº¿æ€§æ˜ å°„åˆ°å ç©ºæ¯”</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ€»ä»£ç "><a href="#æ€»ä»£ç " class="headerlink" title="æ€»ä»£ç "></a>æ€»ä»£ç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OLED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Servo.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Key.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> KeyNumAfter = <span class="number">0</span>;</span><br><span class="line"><span class="type">uint8_t</span> KeyNumBefore = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Angle = <span class="number">90</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Servo_Init();</span><br><span class="line">OLED_Init();</span><br><span class="line">OLED_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;Angle:&quot;</span>);</span><br><span class="line">OLED_ShowString(<span class="number">2</span>,<span class="number">1</span>,<span class="string">&quot;KNum:&quot;</span>);</span><br><span class="line">Key_Init();</span><br><span class="line"></span><br><span class="line">Servo_SetAngle(Angle);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">KeyNumAfter = Key_GetNum();<span class="comment">//è®¾ç½®ä¸€ä¸ªä¸­é—´ç¼“å†²å˜é‡ï¼Œé˜²æ­¢oledä¸Šçš„keyæ ‡è¯†ä¸€é—ªè€Œè¿‡</span></span><br><span class="line"><span class="keyword">if</span>(KeyNumAfter!=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">KeyNumBefore = KeyNumAfter;</span><br><span class="line">&#125;</span><br><span class="line">OLED_ShowNum(<span class="number">2</span>,<span class="number">7</span>,KeyNumBefore,<span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span>(KeyNumAfter)</span><br><span class="line">&#123;</span><br><span class="line">Angle+=<span class="number">30</span>;</span><br><span class="line"><span class="keyword">if</span>(Angle&gt;<span class="number">180</span>)</span><br><span class="line">&#123;</span><br><span class="line">Angle = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">Delay_ms(<span class="number">30</span>);</span><br><span class="line">&#125;</span><br><span class="line">Servo_SetAngle(Angle);</span><br><span class="line">OLED_ShowNum(<span class="number">1</span>,<span class="number">7</span>,Angle,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ç°è±¡ï¼š"><a href="#è§†é¢‘ç°è±¡ï¼š" class="headerlink" title="è§†é¢‘ç°è±¡ï¼š"></a>è§†é¢‘ç°è±¡ï¼š</h3><p><a href="https://cloud.video.taobao.com/play/u/44392709/p/1/d/sd_265/e/6/t/1/487432637028.mp4?auth_key=YXBwX2tleT04MDAwMDAwMTImYXV0aF9pbmZvPXsidGltZXN0YW1wRW5jcnlwdGVkIjoiZGQ1MTM5ZThmZmIyYzhkMzY3ODlkYjhiYjRlZjM5YmYifSZkdXJhdGlvbj0mdGltZXN0YW1wPTE3Mjk2OTgxOTg=">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p><h2 id="ä»»åŠ¡ä¸‰ï¼šé˜…è¯»å‚è€ƒæ‰‹å†Œ"><a href="#ä»»åŠ¡ä¸‰ï¼šé˜…è¯»å‚è€ƒæ‰‹å†Œ" class="headerlink" title="ä»»åŠ¡ä¸‰ï¼šé˜…è¯»å‚è€ƒæ‰‹å†Œ"></a>ä»»åŠ¡ä¸‰ï¼šé˜…è¯»å‚è€ƒæ‰‹å†Œ</h2><h3 id="gpioåŸç†ï¼š"><a href="#gpioåŸç†ï¼š" class="headerlink" title="gpioåŸç†ï¼š"></a>gpioåŸç†ï¼š</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/5d9aacdc3cbe0d2f22295cf8c98733d.png" alt="5d9aacdc3cbe0d2f22295cf8c98733d"></p><h6 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h6><ol><li>å›¾ä¸­ä¸ŠåŠéƒ¨åˆ†æ˜¯è¾“å…¥ç¤ºæ„å›¾ï¼Œä¿¡å·ä»ioå¼•è„šè¿›å…¥åï¼Œå…ˆç»è¿‡<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017202833215.png" alt="image-20241017202833215" style="zoom:33%;" />è¿™ä¸ªç»“æ„ï¼ˆç”¨äºæ§åˆ¶æ˜¯ä¸Šæ‹‰è¾“å…¥è¿˜æ˜¯ä¸‹æ‹‰è¾“å…¥çš„ç»“æ„ï¼‰ï¼Œç„¶åä¸‹é¢æ˜¯è¿™ä¸ªç»“æ„<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241017203040197.png" alt="image-20241017203040197" style="zoom:33%;" />è¿™ä¸ªè‚–ç‰¹åŸºç»“æ„çš„ä½œç”¨æ˜¯æŠŠä¿¡å·åˆ†ä¸ºé«˜ä½ç”µå¹³ï¼ˆ<strong>æ¨¡æ‹Ÿä¿¡å·è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·ï¼ˆå½“ç„¶æ›´æœ‰å¯èƒ½æ˜¯æŠŠæ•°å­—ä¿¡å·å¤„ç†ä¸€ä¸‹å˜å¾—æ›´ç¨³å®šï¼‰</strong>ï¼‰ï¼Œå¦‚æœåœ¨è¿™ä¸ªç»“æ„ç›´æ¥å°±ç›´æ¥è¾“å…¥ï¼Œé‚£å°±æ˜¯ç›´æ¥è¾“å…¥æ¨¡æ‹Ÿä¿¡å·ï¼ˆèµ°æœ€ä¸Šé¢ä¸€è·¯ï¼‰ï¼ˆè®°ä¸ºæ¨¡æ‹Ÿè¾“å…¥ï¼‰ï¼Œç»è¿‡è‚–ç‰¹åŸºè§¦å‘å™¨ä»¥åçš„ä¿¡å·å°±è¢«è½¬åŒ–ä¸ºäº†ç¨³å®šçš„æ•°å­—ä¿¡å·</li><li>ä»è‚–ç‰¹åŸºè§¦å‘å™¨å‡ºæ¥ä»¥åï¼Œæœ‰ä¸¤æ¡è·¯ï¼Œä¸€æ¡æ˜¯å¤ç”¨ï¼ˆä½¿ç”¨remapå‡½æ•°ï¼‰è¾“å…¥ï¼Œä¸€æ¡æ˜¯ç›´æ¥æ”¾å…¥è¾“å…¥æ•°æ®å¯„å­˜å™¨ï¼Œç›´æ¥è¾“å…¥äº†</li></ol><h6 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h6><ol><li>ä¸‹é¢æœ‰ä¸¤æ¡è·¯å¾„è¿›å…¥ï¼Œä¸€æ¡æ˜¯è¿›å…¥ä½è®¾ç½®&#x2F;æ¸…é™¤å¯„å­˜å™¨ï¼Œè¿™ä¸ªå¯„å­˜å™¨çš„ä½œç”¨æ˜¯å•ç‹¬è®¾ç½®æŸä½ï¼Œè€Œä¸å½±å“å…¶ä»–ä½</li><li>ç¬¬äºŒæ¡ç›´æ¥æ§åˆ¶è¾“å‡ºæ•°æ®å¯„å­˜å™¨ï¼Œè¿™ä¸ªæ˜¯ç›´æ¥æ§åˆ¶æ•´ä¸ªgpioå£çš„æ‰€æœ‰ä½</li><li>æœ€ä¸‹é¢ä¸€æ¡æ˜¯æ¥è‡ªç‰‡ä¸Šå¤–è®¾çš„<strong>å¤ç”¨åŠŸèƒ½</strong>è¾“å…¥ï¼Œä¾‹å­å¯ä»¥çœ‹å‰é¢çš„pwmæ§åˆ¶ledï¼ˆå°†gpioa15å¤ç”¨ï¼‰</li></ol><h3 id="timè®¡æ—¶å™¨ç›¸å…³"><a href="#timè®¡æ—¶å™¨ç›¸å…³" class="headerlink" title="timè®¡æ—¶å™¨ç›¸å…³"></a>timè®¡æ—¶å™¨ç›¸å…³</h3><p>è¯¦è§æ–‡æœ«  å…¶ä»–â€”â€”timå®šæ—¶å™¨å­¦ä¹ ç¬”è®°</p><h2 id="è¿›é˜¶ä»»åŠ¡â€“å‡½æ•°å°è£…â€“æµæ°´ç¯"><a href="#è¿›é˜¶ä»»åŠ¡â€“å‡½æ•°å°è£…â€“æµæ°´ç¯" class="headerlink" title="è¿›é˜¶ä»»åŠ¡â€“å‡½æ•°å°è£…â€“æµæ°´ç¯"></a>è¿›é˜¶ä»»åŠ¡â€“å‡½æ•°å°è£…â€“æµæ°´ç¯</h2><h3 id="æŠ€æœ¯ä»‹ç»"><a href="#æŠ€æœ¯ä»‹ç»" class="headerlink" title="æŠ€æœ¯ä»‹ç»"></a>æŠ€æœ¯ä»‹ç»</h3><h4 id="è·¨æ–‡ä»¶è°ƒç”¨"><a href="#è·¨æ–‡ä»¶è°ƒç”¨" class="headerlink" title="è·¨æ–‡ä»¶è°ƒç”¨"></a>è·¨æ–‡ä»¶è°ƒç”¨</h4><p>åœ¨ä¸»å‡½æ•°ä¸­includeå¤´æ–‡ä»¶ï¼Œè¿™ä¸ªå¤´æ–‡ä»¶ç”¨æ¥å­˜æ”¾å‡½æ•°å£°æ˜</p><p>ä»–æ‰€å£°æ˜çš„å‡½æ•°å­˜æ”¾äºåŒåçš„.cæ–‡ä»¶ä¸­</p><h4 id="å°è£…çš„æ„ä¹‰"><a href="#å°è£…çš„æ„ä¹‰" class="headerlink" title="å°è£…çš„æ„ä¹‰"></a>å°è£…çš„æ„ä¹‰</h4><p>ä»£ç çš„å°è£…èƒ½ä½¿ä»£ç æ›´åŠ ç®€æ´ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒå¯ä»¥å®ç°ç¼–ç¨‹çš„æ¨¡å—åŒ–ï¼Œå¯¹å„ä¸ªåŠŸèƒ½çš„å¢æ·»ï¼Œä¿®è¡¥ç­‰æ›´æ–¹ä¾¿ï¼Œå¦‚æœå·¥ç¨‹è¾ƒå¤§çš„è¯ï¼Œä»£ç çš„å°è£…æ˜¯å¿…ä¸å¯å°‘çš„</p><h4 id="æ¡ä»¶ç¼–è¯‘çš„ä½¿ç”¨"><a href="#æ¡ä»¶ç¼–è¯‘çš„ä½¿ç”¨" class="headerlink" title="æ¡ä»¶ç¼–è¯‘çš„ä½¿ç”¨"></a>æ¡ä»¶ç¼–è¯‘çš„ä½¿ç”¨</h4><p>ä»¥åˆšåˆšå†™çš„ waterfall.hä¸ºä¾‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __WATERFALL_H <span class="comment">//å¦‚æœæ²¡æœ‰å®šä¹‰è¿™ä¸ªå¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __WATERFALL_H<span class="comment">//é‚£ä¹ˆå®šä¹‰å®ƒ</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">led_waterfall</span><span class="params">(<span class="type">uint8_t</span> leds)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span><span class="comment">//å®šä¹‰ç»“æŸæ ‡å¿—</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¡ä»¶ç¼–è¯‘çš„ä½¿ç”¨ï¼Œèƒ½å¤Ÿé˜²æ­¢é‡å¤å®šä¹‰å¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºcè¯­è¨€å¼•å…¥å¤´æ–‡ä»¶çš„æ–¹å¼å°±æ˜¯ç›´æ¥æŠŠä»£ç å—å¤åˆ¶ç²˜è´´åˆ°ç›¸åº”ä½ç½®ï¼Œå¦‚æœåŒä¸€ä¸ªå¤´æ–‡ä»¶åœ¨ç¨‹åºä¸­ç²˜è´´ä¸¤æ¬¡ï¼Œé‚£å°±ä¼šå‡ºç°å¤§é‡é‡å¤å®šä¹‰çš„é”™è¯¯</p><h3 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h3><ol><li><p>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªæšä¸¾ç±»å‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">led1 = <span class="number">0x01</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">led2 = <span class="number">0x01</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">led3 = <span class="number">0x01</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">led4 = <span class="number">0x01</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line">led5 = <span class="number">0x01</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line">led6 = <span class="number">0x01</span> &lt;&lt; <span class="number">5</span></span><br><span class="line">&#125;leds;</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œä¸€ä¸ªåº“æ–‡ä»¶</p></li><li><p>é¦–å…ˆï¼Œå®šä¹‰æœ€å…³é”®çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯å”¯ä¸€å’Œmainå‡½æ•°é“¾æ¥çš„å‡½æ•°led_waterfallï¼ˆuint8_t ledsï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">led_waterfall</span><span class="params">(<span class="type">uint8_t</span> leds)</span></span><br><span class="line">&#123;</span><br><span class="line">LED_Init();</span><br><span class="line">TIM_Init();</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; <span class="number">0x01</span>) == <span class="number">0x01</span>)</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">1</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">1</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">2</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">2</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">3</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">3</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">3</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">4</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">4</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">4</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">5</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">5</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">5</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">6</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªå‡½æ•°å·§å¦™åœ°è¿ç”¨äº†<strong>äºŒè¿›åˆ¶çš„ä½è¿ç®—</strong>ï¼Œå‡½æ•°çš„å½¢å‚çœ‹ä¸Šå»åªèƒ½ä¼ å…¥ä¸€ä¸ªæ•´æ•°ï¼Œå®é™…ä¸Šé€šè¿‡ä¹‹å‰çš„æšä¸¾ç±»å‹ï¼Œå†ç»“åˆäºŒè¿›åˆ¶çš„æŒ‰ä½æˆ–è¿ç®—ï¼Œå¯ä»¥<strong>åªç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ•°æŠŠå¤šä¸ªä¿¡æ¯ä¼ é€’è¿›å‡½æ•°</strong>ï¼ˆæ¯ä½çš„0å’Œ1ä»£è¡¨æ¯ä¸ªç¯çš„å‚æ•°ï¼‰</li><li>è¿›å…¥å‡½æ•°åï¼Œå†æŠŠmixå¾—åˆ°çš„ä¸€ä¸ªäºŒè¿›åˆ¶æ•°å’Œå„è‡ª<strong>åªæœ‰è‡ªå·±ä¸º1çš„äºŒè¿›åˆ¶æ•°è¿›è¡ŒæŒ‰ä½ä¸</strong>æ“ä½œï¼Œå°±èƒ½æŠŠè‡ªèº«ä»æŒ‰ä½æˆ–ä¹‹åçš„äºŒè¿›åˆ¶æ•°ä¸­<strong>å‰¥ç¦»</strong>å‡ºæ¥</li></ul></li><li><p>æ¥ç€ï¼Œåˆå§‹åŒ–ledç¯ï¼Œé…ç½®tim2è®¡æ—¶å™¨ï¼Œé…ç½®nvic</p><p>ï¼ˆå…¶ä¸­åŒ…å«å¯¹pb4çš„å¤ç”¨ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹åŒ–GPIO</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»™pb4 remap</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO,ENABLE);<span class="comment">//afio (to remap pb4)</span></span><br><span class="line">GPIO_PinRemapConfig(GPIO_Remap_SWJ_JTAGDisable, ENABLE); <span class="comment">//ç”¨afioå°†jtagè§£é™¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"><span class="comment">//pb0</span></span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line"><span class="comment">//pb1</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_1;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line"><span class="comment">//pb5</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_5);</span><br><span class="line"><span class="comment">//pf11</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line"><span class="comment">//pf12</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;</span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_12);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//pb4</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_4);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//===============================</span></span><br><span class="line"><span class="comment">//å¼€å¯timå®šæ—¶å™¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);</span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_InitStructure;</span><br><span class="line">TIM_InitStructure.TIM_ClockDivision = TIM_CKD_DIV1;</span><br><span class="line">TIM_InitStructure.TIM_CounterMode = TIM_CounterMode_Up;</span><br><span class="line">TIM_InitStructure.TIM_Period = <span class="number">10000</span><span class="number">-1</span>;</span><br><span class="line">TIM_InitStructure.TIM_Prescaler = <span class="number">7200</span><span class="number">-1</span>;</span><br><span class="line">TIM_InitStructure.TIM_RepetitionCounter = <span class="number">0</span>;</span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_InitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update);<span class="comment">//æ¸…ç©ºä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">TIM_ITConfig(TIM2,TIM_FLAG_Update,ENABLE);<span class="comment">//å¼€å¯ä¸­æ–­åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority =<span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åä¸€æ­¥ï¼Œäº‹ä»¶å‡½æ•°çš„ç¼–å†™</p><ul><li>æ¯ç§’é’Ÿè¿›è¡Œä¸€æ¬¡æ“ä½œï¼Œå…ˆæ‰“å¼€å½“å‰è¦å¼€çš„ç¯ï¼Œå†æ ¹æ®ä¸Šä¸€ä¸ªç¯çš„ä½ç½®åä¸Šä¸€ä¸ªç¯ç†„ç­</li><li>æ ¹æ®æ•°ç»„ä¸­ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦ä¸º0æ¥åˆ¤æ–­iåº”è¯¥åŠ ä¸€è¿˜æ˜¯æ¸…é›¶</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(TIM_GetITStatus(TIM2,TIM_IT_Update) == SET)</span><br><span class="line">&#123;</span><br><span class="line">LED_ON(led_should_on[i]);</span><br><span class="line"><span class="keyword">if</span>(i&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">LED_OFF(led_should_on[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j = led_count<span class="number">-1</span>;</span><br><span class="line">LED_OFF(led_should_on[j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(led_should_on[i+<span class="number">1</span>]==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">TIM_ClearITPendingBit(TIM2,TIM_IT_Update);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®Œæ•´ä»£ç ï¼š"><a href="#å®Œæ•´ä»£ç ï¼š" class="headerlink" title="å®Œæ•´ä»£ç ï¼š"></a>å®Œæ•´ä»£ç ï¼š</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//============================</span></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–GPIO</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»™pb4 remap</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO,ENABLE);<span class="comment">//afio (to remap pb4)</span></span><br><span class="line">GPIO_PinRemapConfig(GPIO_Remap_SWJ_JTAGDisable, ENABLE); <span class="comment">//ç”¨afioå°†jtagè§£é™¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"><span class="comment">//pb0</span></span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line"><span class="comment">//pb1</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_1;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line"><span class="comment">//pb5</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_5);</span><br><span class="line"><span class="comment">//pf11</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line"><span class="comment">//pf12</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;</span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_12);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//pb4</span></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_4);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//=================================================</span></span><br><span class="line"><span class="comment">//è®¾ç½®å¼€å…³ledçš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_ON</span><span class="params">(<span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_5);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">GPIO_ResetBits(GPIOB,GPIO_Pin_4);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">GPIO_ResetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">GPIO_ResetBits(GPIOF,GPIO_Pin_12);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_OFF</span><span class="params">(<span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_5);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">GPIO_SetBits(GPIOB,GPIO_Pin_4);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_12);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//====================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//===============================</span></span><br><span class="line"><span class="comment">//å¼€å¯timå®šæ—¶å™¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);</span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_InitStructure;</span><br><span class="line">TIM_InitStructure.TIM_ClockDivision = TIM_CKD_DIV1;</span><br><span class="line">TIM_InitStructure.TIM_CounterMode = TIM_CounterMode_Up;</span><br><span class="line">TIM_InitStructure.TIM_Period = <span class="number">10000</span><span class="number">-1</span>;</span><br><span class="line">TIM_InitStructure.TIM_Prescaler = <span class="number">7200</span><span class="number">-1</span>;</span><br><span class="line">TIM_InitStructure.TIM_RepetitionCounter = <span class="number">0</span>;</span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_InitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update);<span class="comment">//æ¸…ç©ºä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">TIM_ITConfig(TIM2,TIM_FLAG_Update,ENABLE);<span class="comment">//å¼€å¯ä¸­æ–­åˆ°nvicçš„é€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority =<span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=================================================</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> led_should_on[<span class="number">6</span>]; <span class="comment">//å­˜è¦å¼€å…³çš„ç¯,å¤šç•™ä¸€ä¸ª0ä½ï¼Œç”¨äºæ ‡è®°</span></span><br><span class="line"><span class="type">int</span> led_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">led_waterfall</span><span class="params">(<span class="type">uint8_t</span> leds)</span></span><br><span class="line">&#123;</span><br><span class="line">LED_Init();</span><br><span class="line">TIM_Init();</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; <span class="number">0x01</span>) == <span class="number">0x01</span>)</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">1</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">1</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">2</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">2</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">3</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">3</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">3</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">4</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">4</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">4</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">5</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((leds &amp; (<span class="number">0x01</span> &lt;&lt; <span class="number">5</span>)) == (<span class="number">0x01</span> &lt;&lt; <span class="number">5</span>))</span><br><span class="line">&#123;</span><br><span class="line">led_should_on[led_count] = <span class="number">6</span>;</span><br><span class="line">led_count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//=================================================</span></span><br><span class="line"><span class="comment">//å…·ä½“äº‹ä»¶ç¼–å†™</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(TIM_GetITStatus(TIM2,TIM_IT_Update) == SET)</span><br><span class="line">&#123;</span><br><span class="line">LED_ON(led_should_on[i]);</span><br><span class="line"><span class="keyword">if</span>(i&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">LED_OFF(led_should_on[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j = led_count<span class="number">-1</span>;</span><br><span class="line">LED_OFF(led_should_on[j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(led_should_on[i+<span class="number">1</span>]==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">TIM_ClearITPendingBit(TIM2,TIM_IT_Update);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘ï¼š-2"><a href="#è§†é¢‘ï¼š-2" class="headerlink" title="è§†é¢‘ï¼š"></a>è§†é¢‘ï¼š</h3><p><a href ="https://lark-video.oss-cn-hangzhou.aliyuncs.com/outputs/prod/yuque/2024/44392709/mp4/1729184451456-34aaa9d9-2689-4abb-862b-9df182355abb.mp4?OSSAccessKeyId=LTAI4GKnqTWmz2X8mzA1Sjbv&amp;Expires=1729705398&amp;Signature=C8MTR6QCKfZAFqcr67jZ3QvdfwY%3D">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p></li></ol><h2 id="è¿›é˜¶ä»»åŠ¡ï¼šå…±åœ°å’Œä¸Šæ‹‰-ä¸‹æ‹‰ç”µé˜»çš„ä½œç”¨"><a href="#è¿›é˜¶ä»»åŠ¡ï¼šå…±åœ°å’Œä¸Šæ‹‰-ä¸‹æ‹‰ç”µé˜»çš„ä½œç”¨" class="headerlink" title="è¿›é˜¶ä»»åŠ¡ï¼šå…±åœ°å’Œä¸Šæ‹‰\ä¸‹æ‹‰ç”µé˜»çš„ä½œç”¨"></a>è¿›é˜¶ä»»åŠ¡ï¼šå…±åœ°å’Œä¸Šæ‹‰\ä¸‹æ‹‰ç”µé˜»çš„ä½œç”¨</h2><h3 id="1-å…±åœ°"><a href="#1-å…±åœ°" class="headerlink" title="1. å…±åœ°"></a>1. <strong>å…±åœ°</strong></h3><p>å…±åœ°æ˜¯æŒ‡ç”µè·¯ä¸­çš„ä¸åŒéƒ¨åˆ†ï¼ˆå¦‚ç”µæºã€ä¼ æ„Ÿå™¨ã€å¤–è®¾ã€å¤„ç†å™¨ç­‰ï¼‰å…±äº«åŒä¸€ä¸ªGNDä½œä¸ºç”µå‹ä¸ºé›¶çš„å‚è€ƒç‚¹ï¼Œæ‰€æœ‰ä¿¡å·ç”µå‹éƒ½æ˜¯ç›¸å¯¹äºè¿™ä¸ªå‚è€ƒç‚¹æ¥æµ‹é‡çš„ï¼Œé¿å…ä¿¡å·ä¼ è¾“è¿‡ç¨‹ä¸­äº§ç”Ÿè¯¯å·®ã€‚</p><p>å¦‚æœä¸å…±åœ°ï¼Œä¿¡å·å¯èƒ½ä¼šä¸ç¨³å®šï¼Œä¸å…±åœ°çš„ç”µè·¯å¯èƒ½ä¼šåœ¨åœ°çº¿ä¹‹é—´å½¢æˆç¯è·¯ï¼Œäº§ç”Ÿç”µç£å¹²æ‰°ï¼Œå¯èƒ½æŸåç”µè·¯å…ƒä»¶</p><h3 id="2-ä¸Šæ‹‰ç”µé˜»å’Œä¸‹æ‹‰ç”µé˜»"><a href="#2-ä¸Šæ‹‰ç”µé˜»å’Œä¸‹æ‹‰ç”µé˜»" class="headerlink" title="2. ä¸Šæ‹‰ç”µé˜»å’Œä¸‹æ‹‰ç”µé˜»"></a>2. <strong>ä¸Šæ‹‰ç”µé˜»å’Œä¸‹æ‹‰ç”µé˜»</strong></h3><p>ä¸Šæ‹‰ç”µé˜» å’Œ ä¸‹æ‹‰ç”µé˜» æ˜¯ç”¨æ¥ç¨³å®šæ•°å­—ç”µè·¯ä¸­æœªè¿æ¥çŠ¶æ€æ—¶çš„ä¿¡å·ç”µå¹³çš„ç”µé˜»å™¨ã€‚å®ƒä»¬ç”¨äºé˜²æ­¢è¾“å…¥å¼•è„šæ‚¬ç©ºï¼Œå¹¶ç¡®ä¿å…¶å¤„äºå·²çŸ¥çš„é€»è¾‘ç”µå¹³ã€‚ä¸Šæ‹‰ç”µé˜»è¿æ¥åœ¨ ä¿¡å·å¼•è„šå’Œç”µæºæ­£æ ä¹‹é—´ã€‚å½“è¾“å…¥å¼•è„šæ²¡æœ‰é©±åŠ¨æ—¶ï¼Œä¸Šæ‹‰ç”µé˜»å°†å¼•è„šç”µå‹æ‹‰é«˜åˆ°é«˜ç”µå¹³ï¼Œç¡®ä¿ä¿¡å·å¤„äºç¨³å®šçš„é«˜ç”µå¹³ã€‚ä¸‹æ‹‰ç”µé˜»è¿æ¥ä¿¡å·å¼•è„šå’Œåœ° ä¹‹é—´ã€‚å½“è¾“å…¥å¼•è„šæ²¡æœ‰é©±åŠ¨æ—¶ï¼Œä¸‹æ‹‰ç”µé˜»å°†å¼•è„šç”µå‹æ‹‰ä½åˆ°é€»è¾‘ä½ç”µå¹³ï¼Œç¡®ä¿ä¿¡å·å¤„äºç¨³å®šçš„ä½ç”µå¹³ã€‚</p><h3 id="åˆ†æå›¾ç‰‡"><a href="#åˆ†æå›¾ç‰‡" class="headerlink" title="åˆ†æå›¾ç‰‡"></a>åˆ†æå›¾ç‰‡</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018005115582.png" alt="image-20241018005115582" style="zoom:33%;" />è¿™ä¸ªå›¾ç‰‡ä¸­ï¼Œå½“å¼€å…³æ–­å¼€æ—¶ï¼Œnrstç›´æ¥è¿åœ¨ä¸Šæ‹‰ç”µé˜»ä¸Šï¼Œä¸ºç¨³å®šçš„é«˜ç”µå¹³ï¼Œå½“å¼€å…³é—­åˆæ—¶ï¼Œnrstæ¥åœ°ï¼Œä¸ºä½ç”µå¹³</p><h2 id="å…¶å®ƒâ€”â€”timå®šæ—¶å™¨å­¦ä¹ ç¬”è®°"><a href="#å…¶å®ƒâ€”â€”timå®šæ—¶å™¨å­¦ä¹ ç¬”è®°" class="headerlink" title="å…¶å®ƒâ€”â€”timå®šæ—¶å™¨å­¦ä¹ ç¬”è®°"></a>å…¶å®ƒâ€”â€”timå®šæ—¶å™¨å­¦ä¹ ç¬”è®°</h2><h3 id="å®šæ—¶å™¨å¤–éƒ¨ä¸­æ–­"><a href="#å®šæ—¶å™¨å¤–éƒ¨ä¸­æ–­" class="headerlink" title="å®šæ—¶å™¨å¤–éƒ¨ä¸­æ–­"></a>å®šæ—¶å™¨å¤–éƒ¨ä¸­æ–­</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016182413622.png" alt="image-20241016182413622"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016182924178.png" alt="image-20241016182924178"></p><ul><li>ä¸»ä»è§¦å‘æ¨¡å¼çš„ä½œç”¨ï¼šå®ƒèƒ½è®©å†…éƒ¨çš„ç¡¬ä»¶åœ¨ä¸å—ç¨‹åºçš„æ§åˆ¶ä¸‹å®ç°è‡ªåŠ¨è¿è¡Œï¼ˆå¯ä»¥å‡è½»cpuçš„è´Ÿæ‹…ï¼‰</li></ul><h4 id="åŸºæœ¬å®šæ—¶å™¨å·¥ä½œåŸç†ï¼šï¼ˆåªèƒ½å‘ä¸Šè®¡æ•°ï¼‰"><a href="#åŸºæœ¬å®šæ—¶å™¨å·¥ä½œåŸç†ï¼šï¼ˆåªèƒ½å‘ä¸Šè®¡æ•°ï¼‰" class="headerlink" title="åŸºæœ¬å®šæ—¶å™¨å·¥ä½œåŸç†ï¼šï¼ˆåªèƒ½å‘ä¸Šè®¡æ•°ï¼‰"></a>åŸºæœ¬å®šæ—¶å™¨å·¥ä½œåŸç†ï¼šï¼ˆåªèƒ½å‘ä¸Šè®¡æ•°ï¼‰</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016184838791.png" alt="image-20241016184838791"></p><ul><li>æŠŠä¸‹é¢é‚£ä¸ªUæ˜ å°„åˆ°è§¦å‘è¾“å‡ºï¼ˆTRGOï¼‰ï¼Œæ— éœ€é¢‘ç¹ä¸­æ–­ï¼Œä¹Ÿå¯è¿›è¡Œdacè½¬æ¢ï¼Œè§¦å‘å®šæ—¶å™¨çš„çš„æ›´æ–°</li><li>ä¸Šé¢é‚£ä¸ªuiï¼Œè®¡æ•°å€¼ç­‰äºæ›´æ–°é‡è£…å€¼äº§ç”Ÿçš„ä¸­æ–­ï¼Œå«åšâ€œæ›´æ–°ä¸­æ–­â€</li></ul><p>é€šç”¨å®šæ—¶å™¨å’Œé«˜çº§å®šæ—¶å™¨è¿˜æ”¯æŒå‘ä¸‹è®¡æ•°å’Œä¸­å¤®å¯¹é½è®¡æ•°</p><h4 id="é€šç”¨å®šæ—¶å™¨"><a href="#é€šç”¨å®šæ—¶å™¨" class="headerlink" title="é€šç”¨å®šæ—¶å™¨"></a>é€šç”¨å®šæ—¶å™¨</h4><p>æ¨¡å¼äºŒâ€”â€”æœ€ç®€å•ï¼Œæœ€ç›´æ¥</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016203406894.png" alt="image-20241016203406894"></p><p>æ¨¡å¼1â€”â€”trgiå½“ä½œå¤–éƒ¨æ—¶é’Ÿä½¿ç”¨ï¼šï¼ˆä¸»è¦ä½¿ç”¨etrï¼‰</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016202456391.png" alt="image-20241016202456391"></p><ul><li>å®šæ—¶å™¨çš„çº§è”ï¼šé»„è‰²é‚£æ¡çº¿ï¼Œä¸€ä¸ªtimè®¡æ—¶å™¨çš„äº‹ä»¶å¯ä»¥é©±åŠ¨å¦ä¸€ä¸ªè®¡æ—¶å™¨çš„itrï¼Œè¿™ä¸ªè®¡æ—¶å™¨é€šè¿‡trgiè¾“å‡ºï¼Œå°±å®ç°äº†ä¸¤ä¸ªè®¡æ—¶å™¨çš„çº§è”</li></ul><h4 id="ä¸‰ç§å®šæ—¶å™¨çš„åŒºåˆ«ï¼š"><a href="#ä¸‰ç§å®šæ—¶å™¨çš„åŒºåˆ«ï¼š" class="headerlink" title="ä¸‰ç§å®šæ—¶å™¨çš„åŒºåˆ«ï¼š"></a>ä¸‰ç§å®šæ—¶å™¨çš„åŒºåˆ«ï¼š</h4><p><strong>åŸºæœ¬å®šæ—¶å™¨</strong>ï¼šåŸºæœ¬å®šæ—¶å™¨æœ‰è®¡æ•°å™¨ã€é¢„åˆ†é¢‘å™¨å’Œè‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨ï¼Œèƒ½å®ŒæˆåŸºæœ¬çš„è®¡æ•°å’Œè§¦å‘ä¸­æ–­ï¼Œä¸»è¦ç”¨äºç”Ÿæˆå®šæ—¶ä¸­æ–­ã€‚<strong>æ²¡æœ‰è¾“å…¥æ•è·ã€è¾“å‡ºæ¯”è¾ƒå’Œ PWM åŠŸèƒ½</strong>ã€‚å¸¸ç”¨äº DAC è§¦å‘æˆ–ç®€å•çš„æ—¶é—´é—´éš”ç”Ÿæˆ</p><p><strong>é€šç”¨å®šæ—¶å™¨</strong>ï¼šé€šç”¨å®šæ—¶å™¨å…·å¤‡è®¡æ•°ã€æ•è·æ¯”è¾ƒã€PWM ç”Ÿæˆç­‰åŠŸèƒ½ã€‚</p><p><strong>é«˜çº§å®šæ—¶å™¨</strong>ï¼šåŒ…æ‹¬å¤æ‚çš„ PWM è¾“å‡ºã€æ­»åŒºæ§åˆ¶ã€äº’è¡¥è¾“å‡ºç­‰åŠŸèƒ½</p><h5 id="å®šæ—¶ä¸­æ–­åŸºæœ¬ç»“æ„"><a href="#å®šæ—¶ä¸­æ–­åŸºæœ¬ç»“æ„" class="headerlink" title="å®šæ—¶ä¸­æ–­åŸºæœ¬ç»“æ„"></a>å®šæ—¶ä¸­æ–­åŸºæœ¬ç»“æ„</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241016204528525.png" alt="image-20241016204528525"></p><p>ä¸­æ–­è¾“å‡ºæ§åˆ¶ï¼šä¸­æ–­è¾“å‡ºçš„å…è®¸ä½ï¼Œåœ¨ä¸€ä¸ªæ—¶é’Ÿé…ç½®é‡Œï¼Œå¯èƒ½æœ‰å¾ˆå¤šåœ°æ–¹ç”³è¯·ä¸­æ–­ï¼Œå¦‚æœç”¨ä¸åˆ°ï¼Œå°±æŠŠä¸­æ–­è¾“å‡ºå…è®¸ä½è®¾ç½®ä¸ºä¸å…è®¸ï¼Œè¦ç”¨çš„è¯å°±è®¾ä¸ºå…è®¸</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DELAY.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OLED.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint16_t</span> Num;</span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">OLED_Init();</span><br><span class="line">Timer_Init();</span><br><span class="line">OLED_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;Num:&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">OLED_ShowNum(<span class="number">1</span>,<span class="number">5</span>,Num,<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM2_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(TIM_GetITStatus(TIM2,TIM_IT_Update) == SET)</span><br><span class="line">&#123;</span><br><span class="line">Num++;</span><br><span class="line">TIM_ClearITPendingBit(TIM2,TIM_IT_Update);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿™ä¸ªç¨‹åºä½¿ç”¨å†…éƒ¨æ—¶é’Ÿ</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Timer.c</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>                  <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);<span class="comment">//ä½¿èƒ½æ—¶é’Ÿ</span></span><br><span class="line"></span><br><span class="line">TIM_InternalClockConfig(TIM2);</span><br><span class="line"></span><br><span class="line">TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1; <span class="comment">//Ö¸è®¾ç½®æ—¶é’Ÿåˆ†é¢‘ï¼ˆ1åˆ†é¢‘ï¼‰</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; <span class="comment">//å‘ä¸Šè®¡æ•°</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Period=<span class="number">10000</span><span class="number">-1</span>;</span><br><span class="line">TIM_TimeBaseInitStructure.TIM_Prescaler=<span class="number">7200</span><span class="number">-1</span>; <span class="comment">//72mzh / 7200 = 10k ,72mhz / 7200 = 10k</span></span><br><span class="line">TIM_TimeBaseInitStructure.TIM_RepetitionCounter=<span class="number">0</span>;<span class="comment">//é‡å¤è®¡æ•°ï¼ˆé«˜çº§è®¡æ—¶å™¨æœ‰ï¼Œç°åœ¨ä¸ç”¨ï¼‰</span></span><br><span class="line">TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);</span><br><span class="line"></span><br><span class="line">TIM_ClearFlag(TIM2,TIM_FLAG_Update); <span class="comment">//æ¸…é™¤TIM2çš„æ›´æ–°ä¸­æ–­æ ‡å¿—ä½ï¼Œç¡®ä¿å®šæ—¶å™¨å¼€å§‹æ—¶æ²¡æœ‰æ®‹ç•™çš„ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"></span><br><span class="line">TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);<span class="comment">//å¼€å¯æ›´æ–°ä¸­æ–­åˆ°nvicé€šè·¯</span></span><br><span class="line"></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line"></span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel= TIM2_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=<span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority=<span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line">TIM_Cmd(TIM2,ENABLE);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* //ç”¨çš„æ—¶å€™å¤åˆ¶è¿›mian</span></span><br><span class="line"><span class="comment">void TIM2_IRQHandler(void)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(TIM_GetITStatus(TIM2,TIM_IT_Update) == SET)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">TIM_ClearITPendingBit(TIM2,TIM_IT_Update);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="çº¢å¤–å¯¹ç®¡"><a href="#çº¢å¤–å¯¹ç®¡" class="headerlink" title="çº¢å¤–å¯¹ç®¡"></a>çº¢å¤–å¯¹ç®¡</h5><h5 id="pwmé©±åŠ¨å‘¼å¸ç¯"><a href="#pwmé©±åŠ¨å‘¼å¸ç¯" class="headerlink" title="pwmé©±åŠ¨å‘¼å¸ç¯"></a>pwmé©±åŠ¨å‘¼å¸ç¯</h5><p>æ›´æ–°ä¸­</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘ä¸–ä»£æ•°-001-äºŒå…ƒè¿ç®—åŠå…¶æ€§è´¨</title>
      <link href="/2024/10/13/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E4%BA%8C%E5%85%83%E8%BF%90%E7%AE%97%E5%8F%8A%E5%85%B6%E6%80%A7%E8%B4%A8/"/>
      <url>/2024/10/13/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E4%BA%8C%E5%85%83%E8%BF%90%E7%AE%97%E5%8F%8A%E5%85%B6%E6%80%A7%E8%B4%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241013103139067.png" alt="image-20241013103139067"></p><p><strong>äºŒå…ƒè¿ç®—çš„å®šä¹‰</strong>ï¼šè®¾Sä¸ºé›†åˆï¼Œæ˜ å°„fï¼šSxS-&gt;Sç§°ä¸ºSä¸Šçš„ä¸€ä¸ªäºŒå…ƒè¿ç®—</p><ul><li>Sä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ éƒ½å¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä¸”è¿ç®—çš„ç»“æœå”¯ä¸€</li><li>Sä¸­ä»»ä½•ä¸¤ä¸ªå…ƒç´ çš„è¿ç®—ç»“æœéƒ½å±äºSï¼Œè¿™ä¸ªæ€§è´¨æˆä¸ºè¿ç®—çš„<strong>å°é—­æ€§</strong></li><li>æŒ‰ç…§å®šä¹‰ï¼Œè¿ç®—çš„å°é—­æ€§å·²ç»è•´å«åœ¨å®šä¹‰ä¸­</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241013104002682.png" alt="image-20241013104002682"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241013104933404.png" alt="image-20241013104933404"></p><p><strong>ä¸€å…ƒè¿ç®—çš„å®šä¹‰</strong>ï¼šè®¾Sä¸ºé›†åˆï¼Œæ˜ å°„f : Sâ†’S ç§°ä¸ºSä¸Šçš„ä¸€å…ƒè¿ç®—.</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241013105049418.png" alt="image-20241013105049418"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015102834810.png" alt="image-20241015102834810"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015102847256.png" alt="image-20241015102847256"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015102857820.png" alt="image-20241015102857820"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015102908957.png" alt="image-20241015102908957"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015102918846.png" alt="image-20241015102918846"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103014770.png" alt="image-20241015103014770"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103032266.png" alt="image-20241015103032266"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103057817.png" alt="image-20241015103057817"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103728223.png" alt="image-20241015103728223"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103810852.png" alt="image-20241015103810852"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015103834722.png" alt="image-20241015103834722"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015104002518.png" alt="image-20241015104002518"></p><ul><li>åŒç†ï¼Œå¦‚æœä¸€ä¸ªäºŒå…ƒè¿ç®—æœ‰å·¦é›¶å…ƒÎ¸lï¼Œä¸€å®šæœ‰å³é›¶å…ƒÎ¸rå—ï¼Ÿ</li></ul><p>â€‹ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œè€ƒè™‘äºŒå…ƒè¿ç®— x ã€‚y &#x3D;  x</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015104200533.png" alt="image-20241015104200533"></p><p>ï¼ˆ1ï¼‰ï¼ˆ2ï¼‰ä¸ä¸€å®š</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015104618563.png" alt="image-20241015104618563"></p><ul><li><p>å¦‚æœxæœ‰å·¦é€†å…ƒylï¼Œé‚£xä¸€å®šæœ‰å³é€†å…ƒyrå—?ï¼ˆä¸ä¸€å®šï¼‰</p><p>â€”â€”å•å°„å·¦å¯é€†ï¼Œæ»¡å°„å³å¯é€†</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿‘ä¸–ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘ä¸–ä»£æ•°-002-ä»£æ•°ç³»ç»ŸåŠå…¶åŒæ€ä¸åŒæ„</title>
      <link href="/2024/10/13/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E4%BB%A3%E6%95%B0%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%85%B6%E5%90%8C%E6%80%81%E4%B8%8E%E5%90%8C%E6%9E%84/"/>
      <url>/2024/10/13/%E8%BF%91%E4%B8%96%E4%BB%A3%E6%95%B0-%E4%BB%A3%E6%95%B0%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%85%B6%E5%90%8C%E6%80%81%E4%B8%8E%E5%90%8C%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015110807262.png" alt="image-20241015110807262"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015110744452.png" alt="image-20241015110744452"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015111357536.png" alt="image-20241015111357536"></p><p>è¿‘ä¸–ä»£æ•°ï¼ˆæˆ–æŠ½è±¡ä»£æ•°ï¼‰çš„ä¸»è¦ç ”ç©¶å†…å®¹å°±æ˜¯ ç ”ç©¶æ‰€è°“çš„ä»£æ•°ç³»ç»Ÿï¼Œå³å¸¦æœ‰è¿ç®—çš„é›†åˆã€‚åœ¨è¿‘ä¸– ä»£æ•°é‡Œï¼Œä¸ç®¡æ˜¯åœ¨ç¾¤ã€ç¯é‡Œè¿˜æ˜¯åœ¨å…¶å®ƒä»£æ•°ç³»ç»Ÿ é‡Œï¼Œç ”ç©¶ä¸€ç§ä»£æ•°ç³»ç»Ÿå°±æ˜¯è¦è§£å†³è¿™ä¸€ç³»ç»Ÿçš„<strong>å­˜åœ¨é—®é¢˜ã€æ•°é‡é—®é¢˜å’Œæ„é€ é—®é¢˜</strong>ã€‚å¦‚æœå¯¹äºä¸€ä¸ªä»£æ•°ç³» ç»Ÿï¼Œè¿™ä¸‰ä¸ªé—®é¢˜èƒ½å¾—åˆ°åœ†æ»¡çš„è§£ç­”ï¼Œç ”ç©¶çš„ç›®çš„å°± ç®—è¾¾åˆ°äº†</p><p><strong>ç”±å·²çŸ¥çš„ä»£æ•°ç³»ç»Ÿå¯ä»¥é€šè¿‡ç³»ç»Ÿçš„æ–¹æ³•æ„å»ºæ–° çš„ä»£æ•°ç³»ç»Ÿï¼Œå³å­ä»£æ•°å’Œç§¯ä»£æ•°ã€‚ è¿™äº›ä»£æ•°ç³»ç»Ÿï¼ˆå³å­ä»£æ•°å’Œç§¯ä»£æ•°ï¼‰èƒ½å¤Ÿä¿æŒ æˆ–è€…åŸºæœ¬ä¸Šä¿æŒåŸæœ‰ä»£æ•°ç³»ç»Ÿçš„è‰¯å¥½æ€§è´¨ã€‚</strong></p><h2 id="å­ä»£æ•°"><a href="#å­ä»£æ•°" class="headerlink" title="å­ä»£æ•°"></a>å­ä»£æ•°</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015112033678.png" alt="image-20241015112033678"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015112158434.png" alt="image-20241015112158434"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015112411970.png" alt="image-20241015112411970"></p><h2 id="ç§¯ä»£æ•°"><a href="#ç§¯ä»£æ•°" class="headerlink" title="ç§¯ä»£æ•°"></a>ç§¯ä»£æ•°</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015112447943.png" alt="image-20241015112447943"></p><ol><li>ç¬¬ä¸€æ­¥ï¼ŒæŠŠå®šä¹‰åŸŸæ‰©å……åˆ°<strong>ç¬›å¡å°”ç§¯</strong></li><li>ç¬¬äºŒæ­¥ï¼Œç¬›å¡å°”ç§¯ä¸­å–å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œè¿›è¡Œæ–°å®šä¹‰è¿ç®—</li><li>ç¬¬ä¸‰æ­¥ï¼Œå®šä¹‰çš„æ–°è¿ç®—ç­‰äºä¸¤ä¸ªç¬›å¡å°”ç§¯ä¸­ï¼Œå±äºaçš„å…ƒç´ å’Œå±äºbçš„å…ƒç´ åˆ†åˆ«è¿›è¡ŒåŸæœ‰è¿ç®—</li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015113323852.png" alt="image-20241015113323852"></p><p>åœ¨ä»£æ•°ç³»ç»Ÿçš„ç ”ç©¶ä¸­ï¼Œå­ä»£æ•°å’Œç§¯ä»£æ•°æ˜¯ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µã€‚è®©æˆ‘ä»¬é€ä¸€è®¨è®ºè¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p><h3 id="1-å­ä»£æ•°çš„å­˜åœ¨æ€§"><a href="#1-å­ä»£æ•°çš„å­˜åœ¨æ€§" class="headerlink" title="1. å­ä»£æ•°çš„å­˜åœ¨æ€§"></a>1. <strong>å­ä»£æ•°çš„å­˜åœ¨æ€§</strong></h3><ul><li><strong>å­ä»£æ•°ï¼ˆSubalgebraï¼‰</strong>ï¼šå­ä»£æ•°æ˜¯ä»åŸä»£æ•°ç³»ç»Ÿä¸­é€‰å‡ºä¸€ä¸ªå­é›†ï¼Œå¹¶ä¸”è¿™ä¸ªå­é›†åœ¨ä»£æ•°è¿ç®—ä¸‹ä»ç„¶å°é—­ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå­é›†ä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ è¿›è¡ŒåŸä»£æ•°ç³»ç»Ÿçš„è¿ç®—ï¼Œç»“æœä»åœ¨å­é›†ä¸­ï¼‰ã€‚å­ä»£æ•°ç»§æ‰¿äº†åŸä»£æ•°ç³»ç»Ÿçš„è¿ç®—å’Œæ€§è´¨ã€‚</li></ul><h4 id="é—®é¢˜ï¼šè®¾-V-æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ-V-ä¸€å®šæœ‰å­ä»£æ•°å—ï¼Ÿæˆ–è€…-V-çš„å­ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ"><a href="#é—®é¢˜ï¼šè®¾-V-æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ-V-ä¸€å®šæœ‰å­ä»£æ•°å—ï¼Ÿæˆ–è€…-V-çš„å­ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šè®¾ ( V ) æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ( V ) ä¸€å®šæœ‰å­ä»£æ•°å—ï¼Ÿæˆ–è€… ( V ) çš„å­ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ"></a>é—®é¢˜ï¼šè®¾ ( V ) æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ( V ) ä¸€å®šæœ‰å­ä»£æ•°å—ï¼Ÿæˆ–è€… ( V ) çš„å­ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ</h4><ul><li><p><strong>ç­”æ¡ˆï¼šæ˜¯çš„ï¼Œä»£æ•°ç³»ç»Ÿ ( V ) æ€»æ˜¯æœ‰å­ä»£æ•°çš„</strong>ã€‚</p></li><li><p><strong>è§£é‡Šï¼š</strong> æ¯ä¸ªä»£æ•°ç³»ç»Ÿè‡³å°‘æœ‰ä¸¤ä¸ªå­ä»£æ•°ï¼š</p><ol><li><strong>å¹³å‡¡å­ä»£æ•°ï¼ˆtrivial subalgebraï¼‰</strong>ï¼šåŒ…å«ä»£æ•°ç³»ç»Ÿçš„å•ä½å…ƒæˆ–æŸäº›ç‰¹æ®Šå…ƒç´ ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿä¸­å”¯ä¸€çš„é›¶å…ƒç´ æˆ–å•ä½å…ƒç´ ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç¾¤ä¸­ï¼ŒåŒ…å«å”¯ä¸€å•ä½å…ƒçš„å­é›†æ„æˆå¹³å‡¡å­ç¾¤ï¼‰ã€‚</li><li><strong>è‡ªèº«å­ä»£æ•°</strong>ï¼šä»£æ•°ç³»ç»Ÿæœ¬èº«å°±æ˜¯å®ƒçš„ä¸€ä¸ªå­ä»£æ•°ã€‚</li></ol></li><li><p><strong>æ€»ç»“</strong>ï¼šå› æ­¤ï¼Œä»£æ•°ç³»ç»Ÿ ( V ) è‡³å°‘æœ‰ä¸¤ä¸ªå­ä»£æ•°ï¼Œå¹³å‡¡å­ä»£æ•°å’Œä»£æ•°ç³»ç»Ÿæœ¬èº«ã€‚è¿™æ„å‘³ç€<strong>å­ä»£æ•°æ€»æ˜¯å­˜åœ¨çš„</strong>ã€‚</p></li></ul><h3 id="2-ç§¯ä»£æ•°çš„å­˜åœ¨æ€§"><a href="#2-ç§¯ä»£æ•°çš„å­˜åœ¨æ€§" class="headerlink" title="2. ç§¯ä»£æ•°çš„å­˜åœ¨æ€§"></a>2. <strong>ç§¯ä»£æ•°çš„å­˜åœ¨æ€§</strong></h3><ul><li><strong>ç§¯ä»£æ•°ï¼ˆProduct Algebraï¼‰</strong>ï¼šç§¯ä»£æ•°æ˜¯æŒ‡åœ¨ç»™å®šçš„ä»£æ•°ç³»ç»Ÿä¸Šï¼Œæ„é€ ä¸€ä¸ªæ–°ä»£æ•°ç³»ç»Ÿï¼Œå…¶å…ƒç´ æ˜¯åŸç³»ç»Ÿçš„å…ƒç´ å¯¹ï¼ˆæˆ–æ›´é«˜ç»´çš„å…ƒç´ ç»„ï¼‰ï¼Œå¹¶ä¸”æ–°ç³»ç»Ÿä¸­çš„è¿ç®—æ˜¯åœ¨æ¯ä¸ªåæ ‡åˆ†é‡ä¸Šåˆ†åˆ«è¿›è¡ŒåŸç³»ç»Ÿçš„è¿ç®—ã€‚å½¢å¼ä¸Šï¼Œå¦‚æœ ( V_1 ) å’Œ ( V_2 ) æ˜¯ä¸¤ä¸ªä»£æ•°ç³»ç»Ÿï¼Œé‚£ä¹ˆå®ƒä»¬çš„ç§¯ä»£æ•° ( V_1 \times V_2 ) æ˜¯ç”±æ‰€æœ‰å½¢å¼ä¸º ( (v_1, v_2) ) çš„å…ƒç´ ç»„æˆï¼Œå…¶ä¸­ ( v_1 \in V_1 )ï¼Œ( v_2 \in V_2 )ï¼Œä¸”ä»£æ•°è¿ç®—æ˜¯åˆ†é‡çš„é€ç‚¹è¿ç®—ã€‚</li></ul><h4 id="é—®é¢˜ï¼šè®¾-V-æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ-V-ä¸€å®šæœ‰ç§¯ä»£æ•°å—ï¼Ÿæˆ–è€…-V-çš„ç§¯ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ"><a href="#é—®é¢˜ï¼šè®¾-V-æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ-V-ä¸€å®šæœ‰ç§¯ä»£æ•°å—ï¼Ÿæˆ–è€…-V-çš„ç§¯ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šè®¾ ( V ) æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ( V ) ä¸€å®šæœ‰ç§¯ä»£æ•°å—ï¼Ÿæˆ–è€… ( V ) çš„ç§¯ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ"></a>é—®é¢˜ï¼šè®¾ ( V ) æ˜¯ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼Œ( V ) ä¸€å®šæœ‰ç§¯ä»£æ•°å—ï¼Ÿæˆ–è€… ( V ) çš„ç§¯ä»£æ•°ä¸€å®šå­˜åœ¨å—ï¼Ÿ</h4><ul><li><p><strong>ç­”æ¡ˆï¼šæ˜¯çš„ï¼Œç§¯ä»£æ•°ä¸€å®šå­˜åœ¨</strong>ï¼Œä½†è¿™å–å†³äºä½ æ˜¯å¦ç»™å®šäº†å¦ä¸€ä¸ªä»£æ•°ç³»ç»Ÿè¿›è¡Œç§¯è¿ç®—ã€‚</p></li><li><p><strong>è§£é‡Šï¼š</strong></p><ul><li>å¦‚æœä½ æœ‰ä¸¤ä¸ªä»£æ•°ç³»ç»Ÿ ( V_1 ) å’Œ ( V_2 )ï¼Œä½ å¯ä»¥æ€»æ˜¯æ„é€ å®ƒä»¬çš„ç§¯ä»£æ•° ( V_1 \times V_2 )ã€‚ç§¯ä»£æ•°çš„å®šä¹‰æ˜¯æ ¹æ®ä¸¤ä¸ªä»£æ•°ç³»ç»Ÿçš„é€åˆ†é‡è¿ç®—æ„é€ çš„ï¼Œå› æ­¤ï¼Œåªè¦ä½ æœ‰ä¸¤ä¸ªä»£æ•°ç³»ç»Ÿï¼Œç§¯ä»£æ•°æ€»æ˜¯å¯ä»¥å­˜åœ¨çš„ã€‚</li><li>å¯¹äºä¸€ä¸ªä»£æ•°ç³»ç»Ÿ ( V ) è‡ªèº«ï¼Œå¦‚æœä½ æƒ³æ„é€ ä¸è‡ªå·±åšç§¯ä»£æ•°ï¼ˆå³ ( V \times V )ï¼‰ï¼Œè¿™ä¸ªç§¯ä»£æ•°ä¹Ÿæ˜¯å­˜åœ¨çš„ã€‚</li></ul></li><li><p><strong>æ€»ç»“</strong>ï¼šç§¯ä»£æ•°æ€»æ˜¯å¯ä»¥æ„é€ çš„ï¼Œå› ä¸ºç§¯ä»£æ•°æ˜¯ä¸€ä¸ªä»£æ•°è¿ç®—çš„æ‰©å±•ï¼Œå®ƒå–å†³äºç»™å®šä»£æ•°ç³»ç»Ÿçš„é€ç‚¹è¿ç®—ã€‚å› æ­¤ï¼Œ<strong>ç§¯ä»£æ•°çš„å­˜åœ¨æ€§æ˜¯å¯ä»¥ä¿è¯çš„</strong>ï¼Œåªè¦æœ‰è‡³å°‘ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼ˆå¦‚è‡ªèº«æˆ–å…¶ä»–ä»£æ•°ç³»ç»Ÿï¼‰æ¥æ„é€ ç§¯ã€‚</p></li></ul><hr><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><ol><li><strong>å­ä»£æ•°çš„å­˜åœ¨æ€§</strong>ï¼šæ¯ä¸ªä»£æ•°ç³»ç»Ÿè‡³å°‘æœ‰ä¸¤ä¸ªå­ä»£æ•°ï¼ˆå¹³å‡¡å­ä»£æ•°å’Œè‡ªèº«å­ä»£æ•°ï¼‰ï¼Œå› æ­¤å­ä»£æ•°æ€»æ˜¯å­˜åœ¨çš„ã€‚</li><li><strong>ç§¯ä»£æ•°çš„å­˜åœ¨æ€§</strong>ï¼šç»™å®šä¸€ä¸ªä»£æ•°ç³»ç»Ÿ ( V )ï¼Œå®ƒçš„ç§¯ä»£æ•°ï¼ˆæ— è®ºæ˜¯è‡ªèº«çš„ç§¯ä»£æ•°ï¼Œè¿˜æ˜¯ä¸å…¶ä»–ç³»ç»Ÿçš„ç§¯ä»£æ•°ï¼‰æ€»æ˜¯å¯ä»¥æ„é€ ï¼Œå› æ­¤ç§¯ä»£æ•°ä¹Ÿä¸€å®šå­˜åœ¨ã€‚</li></ol><h2 id="åŒæ€æ˜ å°„"><a href="#åŒæ€æ˜ å°„" class="headerlink" title="åŒæ€æ˜ å°„"></a>åŒæ€æ˜ å°„</h2><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015114138959.png" alt="image-20241015114138959"></p><ol><li>ä¸¤ä¸ªå®šä¹‰åŸŸä¸ºA,Bçš„ä»£æ•°ç³»ç»Ÿï¼Œä¸€ä¸ªA-&gt;Bçš„æ˜ å°„</li><li>å¦‚æœAä¸­å–å‡ºxï¼Œyï¼Œè¿›è¡ŒAç³»ç»Ÿå†…çš„è¿ç®—ä»¥åï¼Œæ˜ å°„åˆ°Bç³»ç»Ÿï¼Œï¼Œç­‰äºAä¸­çš„ä¸¤ä¸ªå…ƒç´ å…ˆæ˜ å°„åˆ°Bç³»ç»Ÿï¼Œå†è¿›è¡ŒBç³»ç»Ÿå†…çš„è¿ç®—ï¼Œåˆ™è¿™ä¸ª<strong>æ˜ å°„f</strong>ç§°ä¸ºåŒæ€æ˜ å°„ï¼Œç®€ç§°åŒæ€</li><li>fæ˜¯å•å°„ï¼Œæ»¡å°„ï¼ŒåŒå°„åˆ†åˆ«ç§°ä¸º å•åŒæ€ï¼Œæ»¡åŒæ€ï¼ˆæ­¤æ—¶ç§°V2æ˜¯V1çš„åŒæ€åƒï¼Œè®°ä½œV1~V2ï¼‰,åŒæ„</li><li>å¦‚æœv1&#x3D;v2ï¼Œè‡ªåŒæ€</li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015115806377.png" alt="image-20241015115806377"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241015115906592.png" alt="image-20241015115906592"></p><ol><li><p>a@b &#x3D; b@a ,f(a@b) &#x3D; <strong>f(a)#f(b)</strong> &#x3D;  f(b@a) &#x3D; <strong>f(b)#f(a)</strong>,</p><p>è‡³äºä¸ºä»€ä¹ˆè¦è§„å®šæ»¡åŒæ€æ‰æˆç«‹ï¼Œæƒ³æƒ³ä¾¿çŸ¥ï¼Œä¸Šé¢çš„å¼å­å…¶å®å·²ç»éšå«äº†ä¸€ä¸ªæ¡ä»¶ï¼Œé‚£å°±æ˜¯å¯¹äºbé‡Œé¢çš„æ‰€æœ‰èƒ½è¡¨ç¤ºæˆ<strong>f(xå±äºA)<strong>çš„å…ƒç´ ï¼Œè¿ç®—#å…·æœ‰äº¤æ¢å¾‹ï¼Œé‚£æƒ³è¦è®©æ‰€æœ‰B</strong>ä¸­å…ƒç´ å¯¹äºè¿ç®—#éƒ½å…·æœ‰äº¤æ¢å¾‹ï¼Œå°±è¦ä¿è¯æ‰€æœ‰Bä¸­çš„çš„å…ƒç´ éƒ½èƒ½è¡¨ç¤ºæˆaä¸­å…ƒç´ çš„fæ˜ å°„</strong>ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»A-&gt;Bçš„æ˜ å°„fä¸ºæ»¡å°„ï¼Œå³æ»¡åŒæ€</p></li><li><p>a@(b?c) &#x3D; a@c ?b@c , f(a@(b?c)) &#x3D; f(a)#f(b?c) &#x3D;<strong>f(a)#(f(b)&amp;f(c)</strong></p><p>f(a@c ?b@c) &#x3D; f(a@c) &amp; f(b@c) &#x3D; <strong>f(a)#f(c) &amp;f(b)#f(c)</strong></p><p>åŒç†ï¼Œè§„å®šæ»¡åŒæ€æˆç«‹çš„åŸå› ï¼Œä¹Ÿæ˜¯è¦æŠŠå­˜åœ¨Aä¸­å…ƒç´ ï¼Œèƒ½æ˜ å°„åˆ°Bä¸­å…ƒç´ çš„æ¯ä¸€ä¸ªè§’è½ï¼Œä½¿å¾—Bä¹Ÿæœ‰è¿™ä¸ªæ€§è´¨</p></li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018162651115.png" alt="image-20241018162651115"></p><ul><li><strong>æ€»ç»“æ¥è¯´ï¼Œå¯¹äºæ»¡åŒæ€æ˜ å°„fï¼ŒAä¸­çš„ äº¤æ¢å¾‹ åˆ†é…å¾‹ å•ä½å…ƒ é›¶å…ƒ é€†å…ƒ å‡èƒ½ç”±fæ˜ å°„åˆ°B</strong></li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018163006857.png" alt="image-20241018163006857"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241018163028610.png" alt="image-20241018163028610"></p><h3 id="æ³¨æ„ï¼Œç¾¤ç†è®ºä¸­çš„kerå’Œå•†é›†çš„å®šä¹‰-ä¸-é›†åˆè®º-ç­‰ä»·ç±»ä¸­kerå’Œå•†é›†çš„å®šä¹‰ä¸ä¸€æ ·ï¼"><a href="#æ³¨æ„ï¼Œç¾¤ç†è®ºä¸­çš„kerå’Œå•†é›†çš„å®šä¹‰-ä¸-é›†åˆè®º-ç­‰ä»·ç±»ä¸­kerå’Œå•†é›†çš„å®šä¹‰ä¸ä¸€æ ·ï¼" class="headerlink" title="æ³¨æ„ï¼Œç¾¤ç†è®ºä¸­çš„kerå’Œå•†é›†çš„å®šä¹‰ ä¸ é›†åˆè®º ç­‰ä»·ç±»ä¸­kerå’Œå•†é›†çš„å®šä¹‰ä¸ä¸€æ ·ï¼"></a><strong>æ³¨æ„ï¼Œç¾¤ç†è®ºä¸­çš„kerå’Œå•†é›†çš„å®šä¹‰ ä¸ é›†åˆè®º ç­‰ä»·ç±»ä¸­kerå’Œå•†é›†çš„å®šä¹‰ä¸ä¸€æ ·ï¼</strong></h3><h3 id="1-ç¾¤è®ºä¸­çš„â€œæ ¸â€å’Œâ€œå•†ç¾¤â€"><a href="#1-ç¾¤è®ºä¸­çš„â€œæ ¸â€å’Œâ€œå•†ç¾¤â€" class="headerlink" title="1. ç¾¤è®ºä¸­çš„â€œæ ¸â€å’Œâ€œå•†ç¾¤â€"></a>1. ç¾¤è®ºä¸­çš„â€œæ ¸â€å’Œâ€œå•†ç¾¤â€</h3><p>åœ¨<strong>ç¾¤è®º</strong>ä¸­ï¼Œæ ¸å’Œå•†ç¾¤æ˜¯ä¸<strong>ç¾¤åŒæ€</strong>ç›¸å…³çš„æ¦‚å¿µï¼š</p><ul><li><strong>æ ¸ï¼ˆkernelï¼‰</strong>ï¼šå¯¹äºä¸€ä¸ªç¾¤åŒæ€ f:Gâ†’Gâ€²<em>f</em>:<em>G</em>â†’<em>G</em>â€²ï¼Œæ ¸æ˜¯é‚£äº›è¢«æ˜ å°„åˆ°ç›®æ ‡ç¾¤ Gâ€²<em>G</em>â€² ä¸­<strong>å•ä½å…ƒ</strong>çš„å…ƒç´ é›†åˆã€‚æ ¸åªåŒ…æ‹¬é‚£äº›åœ¨åŒæ€ä¸‹â€œå¤±å»â€åŒºåˆ«çš„å…ƒç´ ï¼Œå®ƒä»¬è¢«çœ‹ä½œç›¸ç­‰ã€‚</li><li><strong>å•†ç¾¤ï¼ˆquotient groupï¼‰</strong>ï¼šå•†ç¾¤æ˜¯é€šè¿‡æ ¸æ¥æ„é€ çš„ï¼Œå®ƒçš„å…ƒç´ æ˜¯<strong>é™ªé›†ï¼ˆcosetï¼‰</strong>ã€‚é™ªé›†å°†åŸç¾¤ G<em>G</em> ä¸­é‚£äº›åœ¨åŒæ€ä¸‹è¢«æ˜ å°„åˆ° Gâ€²<em>G</em>â€² ä¸­åŒä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰å…ƒç´ å½’ä¸ºä¸€ç»„ã€‚å•†ç¾¤ä¸­çš„æ¯ä¸ªå…ƒç´ å®é™…ä¸Šæ˜¯åŸç¾¤çš„ä¸€ä¸ªç­‰ä»·ç±»ï¼Œè¿™äº›ç­‰ä»·ç±»æ˜¯æ ¹æ®æ˜ å°„åˆ° Gâ€²<em>G</em>â€² ä¸­åŒä¸€å…ƒç´ æ¥åˆ†çš„ã€‚</li></ul><h3 id="2-ç­‰ä»·å…³ç³»å’Œç­‰ä»·ç±»ä¸­çš„â€œæ ¸â€å’Œâ€œå•†é›†â€"><a href="#2-ç­‰ä»·å…³ç³»å’Œç­‰ä»·ç±»ä¸­çš„â€œæ ¸â€å’Œâ€œå•†é›†â€" class="headerlink" title="2. ç­‰ä»·å…³ç³»å’Œç­‰ä»·ç±»ä¸­çš„â€œæ ¸â€å’Œâ€œå•†é›†â€"></a>2. ç­‰ä»·å…³ç³»å’Œç­‰ä»·ç±»ä¸­çš„â€œæ ¸â€å’Œâ€œå•†é›†â€</h3><p>åœ¨<strong>ç­‰ä»·å…³ç³»</strong>å’Œ<strong>é›†åˆè®º</strong>ä¸­ï¼Œç¡®å®æœ‰ç±»ä¼¼çš„æ¦‚å¿µï¼Œä½†å®šä¹‰ç•¥æœ‰ä¸åŒï¼š</p><ul><li><strong>ç­‰ä»·ç±»</strong>ï¼šç­‰ä»·å…³ç³»æ˜¯é›†åˆä¸­çš„ä¸€ç§å…³ç³»ï¼Œè¡¨ç¤ºä¸¤ä¸ªå…ƒç´ â€œç­‰ä»·â€ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ é€šè¿‡æŸä¸ªç­‰ä»·å…³ç³»è¢«è®¤ä¸ºæ˜¯ç­‰ä»·çš„ï¼Œå®ƒä»¬å±äºåŒä¸€ä¸ª<strong>ç­‰ä»·ç±»</strong>ã€‚ä¸€ä¸ªé›†åˆå¯ä»¥æ ¹æ®ç­‰ä»·å…³ç³»åˆ†æˆè‹¥å¹²ä¸ªç­‰ä»·ç±»ã€‚</li><li><strong>æ ¸</strong>ï¼šåœ¨ä¸€äº›ä»£æ•°ç»“æ„ï¼ˆå¦‚æ¨¡ç³Šé›†åˆã€æ³›ä»£æ•°ï¼‰ä¸­ï¼Œæ ¸å¯ä»¥è¡¨ç¤º<strong>æ˜ å°„åˆ°åŒä¸€å…ƒç´ çš„å…ƒç´ é›†åˆ</strong>ã€‚è¿™ä¸ä½ æåˆ°çš„æƒ…å†µç±»ä¼¼ï¼Œå³æ ¸æ˜¯é‚£äº›é€šè¿‡æŸä¸ªæ˜ å°„è¢«æ˜ å°„åˆ°ç›¸åŒå…ƒç´ çš„å…ƒç´ çš„é›†åˆã€‚</li><li>**å•†é›†ï¼šåœ¨ç­‰ä»·å…³ç³»ä¸‹ï¼Œå•†é›†æ˜¯å°†æ‰€æœ‰ç­‰ä»·ç±»ä½œä¸ºé›†åˆä¸­çš„å•ä¸ªå…ƒç´ çœ‹å¾…çš„ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå•†é›†ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç­‰ä»·ç±»ï¼Œè¿™äº›ç­‰ä»·ç±»åŒ…å«äº†åŸé›†åˆä¸­æ‰€æœ‰ç›¸äº’ç­‰ä»·çš„å…ƒç´ ã€‚</li></ul><h3 id="3-äºŒè€…çš„å¼‚åŒ"><a href="#3-äºŒè€…çš„å¼‚åŒ" class="headerlink" title="3. äºŒè€…çš„å¼‚åŒ"></a>3. äºŒè€…çš„å¼‚åŒ</h3><p>å°½ç®¡<strong>ç¾¤è®º</strong>ä¸­çš„æ ¸å’Œå•†ç¾¤ä¸<strong>é›†åˆè®º</strong>ä¸­çš„æ ¸å’Œå•†é›†å­˜åœ¨ä¸€äº›è”ç³»ï¼Œä½†å®ƒä»¬çš„å®šä¹‰å’Œä½¿ç”¨æ–¹å¼æ˜¯ä¸åŒçš„ï¼š</p><ul><li><strong>æ ¸çš„ç›¸ä¼¼ç‚¹</strong>ï¼šåœ¨é›†åˆè®ºçš„ç­‰ä»·ç±»ä¸­ï¼Œæ ¸å¯ä»¥çœ‹ä½œæ˜¯é‚£äº›é€šè¿‡æŸä¸ªæ˜ å°„æˆ–ç­‰ä»·å…³ç³»è¢«å½’ä¸ºåŒä¸€ç±»çš„å…ƒç´ é›†åˆã€‚è€Œåœ¨ç¾¤è®ºä¸­ï¼Œæ ¸æ˜¯æ˜ å°„åˆ°å•ä½å…ƒçš„å…ƒç´ é›†åˆï¼Œå®ƒä»¬ä¹Ÿæ˜¯åœ¨æ˜ å°„ä¸‹â€œæ— æ³•åŒºåˆ†â€çš„å…ƒç´ ã€‚</li><li><strong>å•†é›†å’Œå•†ç¾¤çš„åŒºåˆ«</strong>ï¼šé›†åˆè®ºä¸­çš„<strong>å•†é›†</strong>æ˜¯å°†ç­‰ä»·ç±»è§†ä¸ºé›†åˆä¸­çš„å•ä¸ªå…ƒç´ ï¼Œè€Œ<strong>å•†ç¾¤</strong>åˆ™ä¸ä»…ä»…æ˜¯åˆ†ç±»ï¼Œæ›´æ˜¯ä¿ç•™äº†ç¾¤çš„ç»“æ„ï¼ˆè¿ç®—è§„åˆ™ï¼‰ã€‚ç¾¤è®ºä¸­çš„å•†ç¾¤ä¸ä»…æ˜¯â€œåˆ†ç±»â€ï¼Œè¿˜è¦æ»¡è¶³ç¾¤çš„è¿ç®—æ€§è´¨ã€‚</li></ul><h3 id="å¯¹äºç¾¤è®ºä¸­kerå’Œå•†é›†çš„ç†è§£ï¼ˆç›¸å¯¹äºé›†åˆè®ºï¼Œå®ƒæœ‰ä»€ä¹ˆæ”¹å˜ï¼‰ï¼š"><a href="#å¯¹äºç¾¤è®ºä¸­kerå’Œå•†é›†çš„ç†è§£ï¼ˆç›¸å¯¹äºé›†åˆè®ºï¼Œå®ƒæœ‰ä»€ä¹ˆæ”¹å˜ï¼‰ï¼š" class="headerlink" title="å¯¹äºç¾¤è®ºä¸­kerå’Œå•†é›†çš„ç†è§£ï¼ˆç›¸å¯¹äºé›†åˆè®ºï¼Œå®ƒæœ‰ä»€ä¹ˆæ”¹å˜ï¼‰ï¼š"></a>å¯¹äºç¾¤è®ºä¸­kerå’Œå•†é›†çš„ç†è§£ï¼ˆç›¸å¯¹äºé›†åˆè®ºï¼Œå®ƒæœ‰ä»€ä¹ˆæ”¹å˜ï¼‰ï¼š</h3><ol><li><strong>ä¸ºä»€ä¹ˆæ ¸æ˜¯æ˜ å°„åˆ°å•ä½å…ƒçš„å…ƒç´ ï¼Œè€Œä¸æ˜¯æ˜ å°„åˆ°å…¶ä»–å…ƒç´ çš„å…ƒç´ ï¼Ÿ</strong><ul><li>æ ¸çš„å®šä¹‰å°±æ˜¯ç”¨æ¥æ•æ‰æ˜ å°„ä¸‹å˜æˆå•ä½å…ƒçš„å…ƒç´ çš„ã€‚è¿™ä¸ªå®šä¹‰åœ¨åŒæ€ç†è®ºä¸­å¾ˆé‡è¦ï¼Œå› ä¸ºæ ¸çš„æ€§è´¨ä¸åŒæ€çš„æ€§è´¨ç›´æ¥ç›¸å…³ã€‚æ¯”å¦‚ï¼Œkerâ¡(f)ker(<em>f</em>) çš„å…ƒç´ å†³å®šäº†å“ªäº›å…ƒç´ åœ¨åŒæ€æ˜ å°„ä¸­â€œæ— å˜åŒ–â€ã€‚</li></ul></li><li><strong>æ˜ å°„åˆ°å…¶ä»–å…ƒç´ çš„åŸç¾¤ä¸­çš„å…ƒç´ æ€ä¹ˆåŠï¼Ÿ</strong><ul><li>å®ƒä»¬æ²¡æœ‰è¢«â€œé—å¼ƒâ€ï¼Œè€Œæ˜¯é€šè¿‡é™ªé›†çš„æ–¹å¼å‡ºç°åœ¨å•†ç¾¤ G&#x2F;kerâ¡(f)<em>G</em>&#x2F;ker(<em>f</em>) ä¸­ã€‚G<em>G</em> ä¸­æ¯ä¸€ä¸ªæ˜ å°„åˆ° Gâ€²<em>G</em>â€² ä¸­ä¸åŒå…ƒç´  gâ€²âˆˆGâ€²<em>g</em>â€²âˆˆ<em>G</em>â€² çš„å…ƒç´ å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„é™ªé›† gkerâ¡(f)<em>g</em>ker(<em>f</em>)ã€‚è¿™å°±æ˜¯å•†ç¾¤çš„æ„é€ æ–¹å¼ï¼Œå•†ç¾¤ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆé™ªé›†ï¼‰å®é™…ä¸Šä»£è¡¨äº† G<em>G</em> ä¸­ä¸€ç±»è¢« f<em>f</em> æ˜ å°„ä¸ºåŒä¸€ Gâ€²<em>G</em>â€² å…ƒç´ çš„å…ƒç´ ã€‚</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿‘ä¸–ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>stm32å­¦ä¹ ç¬”è®°001</title>
      <link href="/2024/10/12/stm3201/"/>
      <url>/2024/10/12/stm3201/</url>
      
        <content type="html"><![CDATA[<h1 id="stm32å­¦ä¹ ç¬”è®°001"><a href="#stm32å­¦ä¹ ç¬”è®°001" class="headerlink" title="stm32å­¦ä¹ ç¬”è®°001"></a>stm32å­¦ä¹ ç¬”è®°001</h1><h3 id="æ–°å»ºkeil5å·¥ç¨‹"><a href="#æ–°å»ºkeil5å·¥ç¨‹" class="headerlink" title="æ–°å»ºkeil5å·¥ç¨‹"></a>æ–°å»ºkeil5å·¥ç¨‹</h3><ol><li>è£…å¥½keil5</li><li>project-&gt;new..project,é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹</li><li>é€‰å¥½åæŠŠstm32åº“æ–‡ä»¶ä¸­æœ‰å…³å¯åŠ¨å’Œå„ç§åº“ç²˜è´´åˆ°starupæ–‡ä»¶å¤¹ä¸‹ï¼›</li><li>åœ¨é­”æœ¯æ£’-&gt;c&#x2F;c++é‡Œé¢ï¼Œæ·»åŠ define ä¸ºUSE_STDPERIPH_DRIVER,ï¼Œå¹¶æŠŠlibraryæ–‡ä»¶å¤¹æ·»åŠ åˆ°includepathé‡Œ</li></ol><h3 id="å¯„å­˜å™¨ç‚¹ç¯ï¼ˆä»»åŠ¡1-1ï¼‰"><a href="#å¯„å­˜å™¨ç‚¹ç¯ï¼ˆä»»åŠ¡1-1ï¼‰" class="headerlink" title="å¯„å­˜å™¨ç‚¹ç¯ï¼ˆä»»åŠ¡1.1ï¼‰"></a>å¯„å­˜å™¨ç‚¹ç¯ï¼ˆä»»åŠ¡1.1ï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>  </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    RCC-&gt;APB2ENR = <span class="number">0x00000008</span>;</span><br><span class="line">GPIOB-&gt;CRL = <span class="number">0x00300033</span>;</span><br><span class="line">GPIOB-&gt;ODR = <span class="number">0x00000000</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è‹¥è¦ç†„ç­ï¼Œå°†odrè®¾ç½®ä¸ºé«˜ç”µå¹³ï¼š</span></span><br><span class="line">    <span class="comment">//GPIOB-&gt;ODR = 0x00000001; </span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;<span class="comment">//è¿™é‡Œä¸‹é¢è¦æœ‰æœ€åä¸€è¡Œç©ºè¡Œï¼Œå¦åˆ™æŠ¥é”™</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»£ç è§£æï¼š</p><ul><li>RCC-&gt;APB2ENR &#x3D; 0x00000008;</li></ul><p>â€‹RCCä»£è¡¨å¯„å­˜å™¨ï¼ŒAPB2ENRä»£è¡¨APB2å¤–è®¾æ—¶é’Ÿä½¿èƒ½å¯„å­˜å™¨</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241012131906762.png" alt="image-20241012131906762"></p><p>â€‹è¦æƒ³ä½¿ç”¨å„ä¸ª<strong>å¤–è®¾</strong>ï¼ˆå®šä¹‰è§æ–‡æœ«é™„å½•ï¼‰ï¼Œå°±è¦å…ˆæŠŠè¿™ä¸ªå¤–è®¾<strong>ä½¿èƒ½</strong></p><p>â€‹æœ‰å®˜æ–¹æ‰‹å†Œå¯çœ‹å‡ºï¼ŒGPIOBå£åœ¨APB2ä¸­ä½¿èƒ½ï¼Œä¸”åœ¨â€œ3â€ç¼–å·ä¸Šï¼ŒæŠŠ3è¿™ä¸ªç¼–å·èµ‹å€¼1ï¼Œå…¶ä»–ä¸º0ï¼Œå››ä¸ªä¸€ç»„è½¬æ¢æˆ16è¿›åˆ¶ï¼Œå¾—å‡º0x00000008ï¼›</p><ul><li>GPIOB-&gt;CRL &#x3D; 0x00300033;</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241012132818313.png" alt="image-20241012132818313"></p><p>GPIOx_CRL:       1.x:GPIO åé¢çš„å­—æ¯   2.CRLçš„L:LOW,ä»£è¡¨ä½å¯„å­˜å™¨ï¼ˆHä»£è¡¨é«˜ï¼‰</p><ul><li>GPIOB-&gt;ODR &#x3D; 0x00000000ï¼›</li></ul><p>â€‹<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241012133231074.png" alt="image-20241012133231074"></p><p>ODRçš„O:output</p><ul><li>è¿è¡Œç»“æœï¼š</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241012150653517.png" alt="image-20241012150653517"></p><h3 id="åº“å‡½æ•°ç‚¹ç¯ï¼ˆä»»åŠ¡1-2ï¼‰ï¼š"><a href="#åº“å‡½æ•°ç‚¹ç¯ï¼ˆä»»åŠ¡1-2ï¼‰ï¼š" class="headerlink" title="åº“å‡½æ•°ç‚¹ç¯ï¼ˆä»»åŠ¡1.2ï¼‰ï¼š"></a>åº“å‡½æ•°ç‚¹ç¯ï¼ˆä»»åŠ¡1.2ï¼‰ï¼š</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pf11</span></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line"><span class="comment">//è¿™å¥ä»£ç ç›¸å½“äºå¯„å­˜å™¨ç‚¹ç¯æ“ä½œæ—¶çš„gpioä½¿èƒ½ï¼Œè¿™é‡Œé€‰ç”¨gpiof</span></span><br><span class="line"></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructurePF11;</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªGPIO_InitTypeDefç±»å‹çš„ç»“æ„ä½“ï¼Œç»“æ„ä½“ç”¨äºåˆå§‹åŒ–gpioçš„å„ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment">//åˆ†åˆ«æ˜¯ mode ï¼Œpin ï¼Œspeedï¼Œè¿™ä¸‰ä¸ªå‚æ•°åœ¨åº“æ–‡ä»¶ä¸­å‡ä»¥æšä¸¾å®šä¹‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GPIO_InitStructurePF11.GPIO_Mode = GPIO_Mode_Out_PP; <span class="comment">//æ¨æŒ½è¾“å‡º</span></span><br><span class="line">GPIO_InitStructurePF11.GPIO_Pin = GPIO_Pin_11; <span class="comment">//11å·å¼•è„š</span></span><br><span class="line">GPIO_InitStructurePF11.GPIO_Speed = GPIO_Speed_50MHz; <span class="comment">//é€Ÿç‡</span></span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructurePF11); </span><br><span class="line"><span class="comment">//åˆå§‹åŒ–gpioå¼•è„šï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯GPIOxï¼ˆå®é™…ä¸Šæ˜¯æŒ‡é’ˆï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯ç»“æ„ä½“åˆå§‹åŒ–æ•°ç»„çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GPIO_ResetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line"><span class="comment">//è®¾ç½®è¾“å‡ºä¸ºä½ç”µå¹³</span></span><br></pre></td></tr></table></figure><p>æ¶‰åŠçš„å¯é€‰å‚æ•°è¯¦è§é™„å½•</p><ul><li>æ•ˆæœï¼š</li></ul><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241012150710945.png" alt="image-20241012150710945"></p><h3 id="GPIOè¾“å…¥è¾“å‡ºï¼ˆä»»åŠ¡2ï¼‰"><a href="#GPIOè¾“å…¥è¾“å‡ºï¼ˆä»»åŠ¡2ï¼‰" class="headerlink" title="GPIOè¾“å…¥è¾“å‡ºï¼ˆä»»åŠ¡2ï¼‰"></a>GPIOè¾“å…¥è¾“å‡ºï¼ˆä»»åŠ¡2ï¼‰</h3><h4 id="è¯»å–è¾“å…¥çš„æ–¹æ³•"><a href="#è¯»å–è¾“å…¥çš„æ–¹æ³•" class="headerlink" title="è¯»å–è¾“å…¥çš„æ–¹æ³•"></a>è¯»å–è¾“å…¥çš„æ–¹æ³•</h4><h5 id="è¯»å–è¾“å…¥å¯„å­˜å™¨ï¼ˆIDRï¼‰"><a href="#è¯»å–è¾“å…¥å¯„å­˜å™¨ï¼ˆIDRï¼‰" class="headerlink" title="è¯»å–è¾“å…¥å¯„å­˜å™¨ï¼ˆIDRï¼‰"></a>è¯»å–è¾“å…¥å¯„å­˜å™¨ï¼ˆIDRï¼‰</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯»å–GPIOè¾“å‡ºçš„æ–¹æ³•----è¯»å–å®ƒçš„è¾“å…¥å¯„å­˜å™¨</span></span><br><span class="line"><span class="comment">//å³ä½¿goioæ˜¯è¾“å‡ºæ¨¡å¼ï¼ŒIDRä¹Ÿèƒ½åæ˜ å®ƒçš„çŠ¶æ€</span></span><br><span class="line"><span class="type">int</span> pinState;</span><br><span class="line"></span><br><span class="line">pinState = (GPIOF-&gt;IDR &amp; GPIO_PIN_x) ? <span class="number">1</span> : <span class="number">0</span>;  <span class="comment">// è¯»å– GPIOF 11 å¼•è„šçŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•2 ---- åº“å‡½æ•°GPIO_ReadInputDataBitï¼ˆåŸºäºè¾“å…¥å¯„å­˜å™¨ï¼‰</span></span><br><span class="line"><span class="keyword">if</span>(GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_0)==Bit_RESET)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Bit_SET:é«˜ç”µå¹³</span></span><br><span class="line">    <span class="comment">//Bit_RESET:ä½ç”µå¹³</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="è¯»å–è¾“å‡ºå¯„å­˜å™¨ï¼ˆODRï¼‰"><a href="#è¯»å–è¾“å‡ºå¯„å­˜å™¨ï¼ˆODRï¼‰" class="headerlink" title="è¯»å–è¾“å‡ºå¯„å­˜å™¨ï¼ˆODRï¼‰"></a>è¯»å–è¾“å‡ºå¯„å­˜å™¨ï¼ˆODRï¼‰</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›´æ¥è¯»å–è¾“å‡ºå¯„å­˜å™¨ï¼ˆODRï¼‰</span></span><br><span class="line"><span class="type">int</span> pinState;</span><br><span class="line"></span><br><span class="line">pinState = (GPIOF-&gt;ODR &amp; GPIO_PIN_x) ? <span class="number">1</span> : <span class="number">0</span>;  <span class="comment">// è¯»å– GPIOF 11 å¼•è„šçŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure><h5 id="äºŒè€…çš„åŒºåˆ«"><a href="#äºŒè€…çš„åŒºåˆ«" class="headerlink" title="äºŒè€…çš„åŒºåˆ«"></a>äºŒè€…çš„åŒºåˆ«</h5><p>IDRååº”å®é™…ç‰©ç†çŠ¶æ€ï¼ŒODRååº”ä»£ç è®¾ç½®çš„çŠ¶æ€ï¼ˆä¸ä¸€å®šæ˜¯å®é™…ï¼‰</p><p>å‡è®¾æœ‰ä¸€ä¸ª GPIO å¼•è„šé…ç½®ä¸ºè¾“å‡ºæ¨¡å¼ï¼Œåœ¨ä»£ç ä¸­è®¾ç½®äº†å®ƒä¸ºé«˜ç”µå¹³ï¼Œä½†è¿™ä¸ªå¼•è„šè¿æ¥äº†ä¸€ä¸ªå¤–éƒ¨ç”µè·¯ï¼Œå¤–éƒ¨ç”µè·¯å¼ºè¡ŒæŠŠè¿™ä¸ªå¼•è„šæ‹‰ä½äº†çš„è¯ï¼ŒäºŒè€…çš„åŒºåˆ«å°±ä¼šæ˜¾ç°</p><ul><li><strong>IDR</strong>ï¼šåæ˜ è¿™ä¸ªå¼•è„šçš„å®é™…ç”µå¹³ä¸ºä½ç”µå¹³ï¼Œå› ä¸ºå®ƒå—åˆ°äº†å¤–éƒ¨ç”µè·¯çš„å½±å“ã€‚</li><li><strong>ODR</strong>ï¼šä»ç„¶ä¼šåæ˜ ä½ åœ¨ä»£ç ä¸­è®¾ç½®çš„é«˜ç”µå¹³ï¼Œå› ä¸ºå®ƒè¡¨ç¤ºçš„æ˜¯ä½ é€šè¿‡ MCU è®¾ç½®çš„è¾“å‡ºå€¼ï¼Œè€Œä¸æ˜¯å®é™…çš„ç”µå¹³ã€‚</li></ul><h4 id="å»¶æ—¶å‡½æ•°çš„å®ç°"><a href="#å»¶æ—¶å‡½æ•°çš„å®ç°" class="headerlink" title="å»¶æ—¶å‡½æ•°çš„å®ç°"></a>å»¶æ—¶å‡½æ•°çš„å®ç°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">SysTick_Init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// SystemCoreClock æ˜¯ç³»ç»Ÿæ—¶é’Ÿé¢‘ç‡ï¼Œæ¯”å¦‚ 72 MHzï¼ˆ72000000 Hzï¼‰</span></span><br><span class="line">    <span class="comment">// é…ç½® SysTick æ¯ 1 æ¯«ç§’è§¦å‘ä¸€æ¬¡ä¸­æ–­</span></span><br><span class="line">    SysTick_Config(SystemCoreClock / <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">uint32_t</span> sysTickCounter = <span class="number">0</span>;<span class="comment">//å®šä¹‰ä¸€ä¸ªè®¡æ•°å™¨</span></span><br><span class="line"><span class="comment">//ä½¿ç”¨ volatile å…³é”®å­—æ˜¯å› ä¸ºè¯¥å˜é‡ä¼šåœ¨ä¸­æ–­ä¸­ä¿®æ”¹ï¼Œé˜²æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SysTick_Handler</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (sysTickCounter &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        sysTickCounter--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ³¨æ„ï¼ŒSysTick_Handlerå‡½æ•°åœ¨åº“æ–‡ä»¶ä¸­å·²ç»æœ‰å®šä¹‰äº†</span></span><br><span class="line"><span class="comment">//ä½†æ˜¯å†…å®¹æ˜¯ç©ºçš„</span></span><br><span class="line"><span class="comment">//å› æ­¤ï¼Œåœ¨æ­¤åº“æ–‡ä»¶ä¸­å£°æ˜externçš„è®¡æ•°å™¨å˜é‡ï¼Œç„¶ååœ¨åº“æ–‡ä»¶ä¸­ä¿®æ”¹æ­¤å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay_ms</span><span class="params">(<span class="type">uint32_t</span> ms)</span> &#123;</span><br><span class="line">    sysTickCounter = ms;</span><br><span class="line">    <span class="keyword">while</span> (sysTickCounter != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// ç­‰å¾…å»¶æ—¶ç»“æŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>sysTickCounter è¢«è®¾ç½®ä¸ºå»¶æ—¶çš„æ¯«ç§’æ•°ã€‚</p></li><li><p>æ¯ 1 æ¯«ç§’ï¼ŒSysTick è§¦å‘ä¸­æ–­ï¼Œè°ƒç”¨ SysTick_Handler() å‡½æ•°ï¼Œé€’å‡ sysTickCounter</p><p><strong>å› æ­¤ï¼Œèµ·åˆ°å»¶æ—¶ä½œç”¨çš„æ˜¯SysTick_Handler() å‡½æ•°</strong></p></li><li><p>å½“ sysTickCounter å‡åˆ° 0 æ—¶ï¼Œwhile å¾ªç¯ç»“æŸï¼Œå»¶æ—¶å‡½æ•°å®Œæˆã€‚</p></li></ol><p>SysTick_Handler() åªæœ‰åœ¨å€’è®¡æ—¶ä¸­æ¯éš” 1 æ¯«ç§’è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå¹¶ä¸”åªæœ‰åœ¨ sysTickCounter &gt; 0 æ—¶å®ƒæ‰ä¼šé€’å‡è®¡æ•°å™¨ã€‚ä¸€æ—¦è®¡æ•°å™¨å‡åˆ° <strong>0</strong>ï¼ŒSysTick_Handler() ä»ç„¶ä¼šè¢« 1 æ¯«ç§’è§¦å‘ä¸€æ¬¡ï¼Œåªä¸è¿‡å®ƒä¸å†æ‰§è¡Œä»»ä½•é€’å‡æ“ä½œ</p><h4 id="æ€»ä»£ç å¦‚ä¸‹"><a href="#æ€»ä»£ç å¦‚ä¸‹" class="headerlink" title="æ€»ä»£ç å¦‚ä¸‹"></a>æ€»ä»£ç å¦‚ä¸‹</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SysTick_Init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    SysTick_Config(SystemCoreClock / <span class="number">1000</span>);</span><br><span class="line">&#125; <span class="comment">//åˆå§‹åŒ–æ—¶é’Ÿå»¶è¿Ÿä¸º1ms</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">uint32_t</span> sysTickCounter = <span class="number">0</span>;<span class="comment">//åˆå§‹åŒ–è®¡æ•°å™¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay_ms</span><span class="params">(<span class="type">uint32_t</span> ms)</span> &#123;</span><br><span class="line">    sysTickCounter = ms;</span><br><span class="line">    <span class="keyword">while</span> (sysTickCounter != <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//å®šä¹‰delayå‡½æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//RCC-&gt;APB2ENR = 0x00000008;</span></span><br><span class="line">    <span class="comment">//GPIOB-&gt;CRL = 0x00300033;</span></span><br><span class="line">    <span class="comment">//GPIOB-&gt;ODR = 0x00000000;       //å¯„å­˜å™¨ç‚¹ç¯çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//__enable_irq();  //å¯ç”¨å…¨å±€ä¸­æ–­ï¼ˆä½†æ˜¯ä¸å¯ç”¨ä¹Ÿèƒ½è·‘ï¼‰</span></span><br><span class="line"></span><br><span class="line">    SysTick_Init();<span class="comment">//åˆå§‹åŒ–è®¡æ—¶å™¨</span></span><br><span class="line"></span><br><span class="line">    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE);</span><br><span class="line">    <span class="comment">//ä½¿èƒ½GPIOB</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//GPIO_InitTypeDef GPIO_InitStructurePB5;</span></span><br><span class="line">    <span class="comment">//GPIO_InitStructurePB5.GPIO_Mode=GPIO_Mode_Out_PP;</span></span><br><span class="line">    <span class="comment">//GPIO_InitStructurePB5.GPIO_Pin=GPIO_Pin_5;</span></span><br><span class="line">    <span class="comment">//GPIO_InitStructurePB5.GPIO_Speed=GPIO_Speed_50MHz;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//GPIO_Init(GPIOB,&amp;GPIO_InitStructurePB5);</span></span><br><span class="line">    <span class="comment">/////ç‚¹äº®GPIOB5çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–gpio0</span></span><br><span class="line">    GPIO_InitTypeDef GPIO_InitStructurePB0;</span><br><span class="line">    GPIO_InitStructurePB0.GPIO_Mode=GPIO_Mode_Out_PP;</span><br><span class="line">    GPIO_InitStructurePB0.GPIO_Pin=GPIO_Pin_0;</span><br><span class="line">    GPIO_InitStructurePB0.GPIO_Speed=GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">    GPIO_Init(GPIOB, &amp;GPIO_InitStructurePB0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    GPIO_ResetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line">    <span class="comment">//Â³ÃµÃŠÂ¼Â»Â¯GPIOB0Â£Â¬Ã‡Ã’Â½Â«Ã†Ã¤Ã‰Ã¨ÃÂªÂµÃÂµÃ§Ã†Â½Â£Â¨ÃÃÂµÃ†Â£Â©</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    GPIO_InitTypeDef GPIO_InitStructurePB1;</span><br><span class="line">    GPIO_InitStructurePB1.GPIO_Mode=GPIO_Mode_Out_PP;</span><br><span class="line">    GPIO_InitStructurePB1.GPIO_Pin=GPIO_Pin_1;</span><br><span class="line">    GPIO_InitStructurePB1.GPIO_Speed=GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">    GPIO_Init(GPIOB, &amp;GPIO_InitStructurePB1);</span><br><span class="line">    <span class="comment">//Â³ÃµÃŠÂ¼Â»Â¯GPIOB1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//pf11ï¼ˆè®©å®ƒå¸¸äº®å§ï¼‰</span></span><br><span class="line">    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line"></span><br><span class="line">    GPIO_InitTypeDef GPIO_InitStructurePF11;</span><br><span class="line">    GPIO_InitStructurePF11.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">    GPIO_InitStructurePF11.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">    GPIO_InitStructurePF11.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">    GPIO_Init(GPIOF,&amp;GPIO_InitStructurePF11);</span><br><span class="line">    GPIO_ResetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line">    GPIO_SetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//åˆ¤æ–­GPIO0çš„çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span>(GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_0)==Bit_RESET)</span><br><span class="line">        &#123;</span><br><span class="line">            Delay_ms(<span class="number">1000</span>);</span><br><span class="line">            GPIO_ResetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line">            GPIO_SetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line">            Delay_ms(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            GPIO_SetBits(GPIOB,GPIO_Pin_1);</span><br><span class="line">            GPIO_ResetBits(GPIOB,GPIO_Pin_0);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>è¾“å‡ºæ¼”ç¤ºè§†é¢‘ï¼š</p><p><a href="https://lark-video.oss-cn-hangzhou.aliyuncs.com/outputs/prod/yuque/2024/44392709/mp4/1728726330624-46c344cb-e02f-4a81-bc7a-e7395e288175.mp4?OSSAccessKeyId=LTAI4GKnqTWmz2X8mzA1Sjbv&Expires=1729702347&Signature=Z%2F%2BjsbCjdoHoJVjojl2fqPv47LQ%3D">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p></li></ul><h3 id="å¤–éƒ¨ä¸­æ–­"><a href="#å¤–éƒ¨ä¸­æ–­" class="headerlink" title="å¤–éƒ¨ä¸­æ–­"></a>å¤–éƒ¨ä¸­æ–­</h3><h4 id="ä¸€ä¸ªæŒ‰é”®çš„"><a href="#ä¸€ä¸ªæŒ‰é”®çš„" class="headerlink" title="ä¸€ä¸ªæŒ‰é”®çš„"></a>ä¸€ä¸ªæŒ‰é”®çš„</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">uint32_t</span> sysTickCounter = <span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI_Config</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯çš„åˆå§‹åŒ–</span></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‰é”®åˆå§‹åŒ–</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line">GPIO_EXTILineConfig(GPIO_PortSourceGPIOA,GPIO_PinSource0);<span class="comment">//å°†GPIOA0è¿æ¥åˆ°EXTIå¤–è®¾</span></span><br><span class="line">EXTI_InitTypeDef EXTI_InitStructure;</span><br><span class="line">EXTI_InitStructure.EXTI_Line=EXTI_Line0;</span><br><span class="line">EXTI_InitStructure.EXTI_LineCmd=ENABLE;</span><br><span class="line">EXTI_InitStructure.EXTI_Mode=EXTI_Mode_Interrupt;</span><br><span class="line">EXTI_InitStructure.EXTI_Trigger=EXTI_Trigger_Falling;</span><br><span class="line"></span><br><span class="line">EXTI_Init(&amp;EXTI_InitStructure);<span class="comment">//åˆå§‹åŒ–EXIT</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å¯NVIC</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">2</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI0_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(EXTI_GetITStatus(EXTI_Line0)==SET)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(GPIO_ReadInputDataBit(GPIOF,GPIO_Pin_11)==Bit_SET)</span><br><span class="line">&#123;</span><br><span class="line">GPIO_ResetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXTI_ClearITPendingBit(EXTI_Line0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">EXTI_Config();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¸¤ä¸ªæŒ‰é”®çš„"><a href="#ä¸¤ä¸ªæŒ‰é”®çš„" class="headerlink" title="ä¸¤ä¸ªæŒ‰é”®çš„"></a>ä¸¤ä¸ªæŒ‰é”®çš„</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span>      <span class="comment">// Device header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">uint32_t</span> sysTickCounter = <span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI_Config</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);</span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, ENABLE); </span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯çš„åˆå§‹åŒ–</span></span><br><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‰é”®åˆå§‹åŒ–</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOA,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒä¸ªæŒ‰é”®åˆå§‹åŒ–</span></span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;</span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_1;</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line"></span><br><span class="line">GPIO_Init(GPIOF,&amp;GPIO_InitStructure);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†GPIOA0è¿æ¥åˆ°extiå¤–è®¾</span></span><br><span class="line">GPIO_EXTILineConfig(GPIO_PortSourceGPIOA,GPIO_PinSource0);</span><br><span class="line">EXTI_InitTypeDef EXTI_InitStructure;</span><br><span class="line">EXTI_InitStructure.EXTI_Line=EXTI_Line0;</span><br><span class="line">EXTI_InitStructure.EXTI_LineCmd=ENABLE;</span><br><span class="line">EXTI_InitStructure.EXTI_Mode=EXTI_Mode_Interrupt;</span><br><span class="line">EXTI_InitStructure.EXTI_Trigger=EXTI_Trigger_Falling;</span><br><span class="line"></span><br><span class="line">EXTI_Init(&amp;EXTI_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†GPIOF1è¿æ¥åˆ°extiå¤–è®¾</span></span><br><span class="line">GPIO_EXTILineConfig(GPIO_PortSourceGPIOF,GPIO_PinSource1);</span><br><span class="line"><span class="comment">//EXTI_InitStructureå·²ç»å®šä¹‰ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨</span></span><br><span class="line">EXTI_InitStructure.EXTI_Line=EXTI_Line1;<span class="comment">//æ¢ä¸€ä¸ªä¸­æ–­çº¿è·¯</span></span><br><span class="line">EXTI_InitStructure.EXTI_LineCmd=ENABLE;</span><br><span class="line">EXTI_InitStructure.EXTI_Mode=EXTI_Mode_Interrupt;</span><br><span class="line">EXTI_InitStructure.EXTI_Trigger=EXTI_Trigger_Falling;</span><br><span class="line"></span><br><span class="line">EXTI_Init(&amp;EXTI_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…ç½®NVIC</span></span><br><span class="line">NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);</span><br><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºæŒ‰é”®1é…ç½®NVIC</span></span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">1</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºæŒ‰é”®2é…ç½®NVIC</span></span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = EXTI1_IRQn;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="number">2</span>;</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="number">2</span>;</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI0_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(EXTI_GetITStatus(EXTI_Line0)==SET)</span><br><span class="line">&#123;</span><br><span class="line">GPIO_ResetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">EXTI_ClearITPendingBit(EXTI_Line0);<span class="comment">//æ¸…ç©ºä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI1_IRQHandler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(EXTI_GetITStatus(EXTI_Line1)==SET)</span><br><span class="line">&#123;</span><br><span class="line">GPIO_SetBits(GPIOF,GPIO_Pin_11);</span><br><span class="line">&#125;</span><br><span class="line">EXTI_ClearITPendingBit(EXTI_Line1);<span class="comment">//æ¸…ç©ºä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">EXTI_Config();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="è§†é¢‘ï¼š"><a href="#è§†é¢‘ï¼š" class="headerlink" title="è§†é¢‘ï¼š"></a>è§†é¢‘ï¼š</h4><h5 id="ä¸€ä¸ªæŒ‰é”®çš„ï¼š"><a href="#ä¸€ä¸ªæŒ‰é”®çš„ï¼š" class="headerlink" title="ä¸€ä¸ªæŒ‰é”®çš„ï¼š"></a>ä¸€ä¸ªæŒ‰é”®çš„ï¼š</h5><p><a href="https://bizsec-auth.alicdn.com/d946ca083b65cd66/f80ebf33b1f6af3b/20241012_19fb5ed7c3bece04_486428009028_181701368300603_published_mp4_264_hd_unlimit_taobao.mp4?auth_key=1729699652-0-0-b10db018812c27132b7aed5bbe6515e9&biz=video-d63683b96e69ef50&t=213da87517296969520431973e1658&t=213da87517296969520431973e1658&b=video&p=cloudvideo_http_from_v1_800000012">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p><h5 id="ä¸¤ä¸ªæŒ‰é”®çš„ï¼š"><a href="#ä¸¤ä¸ªæŒ‰é”®çš„ï¼š" class="headerlink" title="ä¸¤ä¸ªæŒ‰é”®çš„ï¼š"></a>ä¸¤ä¸ªæŒ‰é”®çš„ï¼š</h5><p><a href="https://cloud.video.taobao.com/play/u/44392709/p/1/d/ld/e/6/t/1/486428009029.mp4?auth_key=YXBwX2tleT04MDAwMDAwMTImYXV0aF9pbmZvPXsidGltZXN0YW1wRW5jcnlwdGVkIjoiNGM3MWFhYWJlNDAyZWFjNDUwZGFmMjI3MzM5MGQ1N2EifSZkdXJhdGlvbj0mdGltZXN0YW1wPTE3Mjk2OTUxNDc=">ç‚¹å‡»æŸ¥çœ‹è§†é¢‘</a></p><h2 id="é™„å½•ï¼ˆä¿¡æ¯æ•´åˆï¼‰"><a href="#é™„å½•ï¼ˆä¿¡æ¯æ•´åˆï¼‰" class="headerlink" title="é™„å½•ï¼ˆä¿¡æ¯æ•´åˆï¼‰"></a>é™„å½•ï¼ˆä¿¡æ¯æ•´åˆï¼‰</h2><h3 id="å¤–è®¾ç›¸å…³ä¿¡æ¯"><a href="#å¤–è®¾ç›¸å…³ä¿¡æ¯" class="headerlink" title="å¤–è®¾ç›¸å…³ä¿¡æ¯"></a>å¤–è®¾ç›¸å…³ä¿¡æ¯</h3><ul><li><ul><li><h3 id="1-GPIOï¼ˆé€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ï¼‰"><a href="#1-GPIOï¼ˆé€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ï¼‰" class="headerlink" title="1. GPIOï¼ˆé€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ï¼‰"></a>1. <strong>GPIOï¼ˆé€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ï¼‰</strong></h3><h4 id="åŠŸèƒ½ï¼š"><a href="#åŠŸèƒ½ï¼š" class="headerlink" title="åŠŸèƒ½ï¼š"></a>åŠŸèƒ½ï¼š</h4><p>GPIO æ˜¯ STM32 æ§åˆ¶å™¨ä¸­æœ€åŸºæœ¬çš„å¤–è®¾ä¹‹ä¸€ï¼Œç”¨äºæ§åˆ¶è®¾å¤‡ä¸å¤–éƒ¨ç”µè·¯ä¹‹é—´çš„æ•°å­—ä¿¡å·äº¤äº’ã€‚æ¯ä¸ª GPIO å¼•è„šéƒ½å¯ä»¥ç‹¬ç«‹é…ç½®ä¸ºè¾“å…¥ã€è¾“å‡ºã€æ¨¡æ‹Ÿæ¨¡å¼æˆ–ç”¨äºç‰¹å®šå¤–è®¾çš„åŠŸèƒ½å¤ç”¨æ¨¡å¼ï¼ˆå¦‚ USARTã€I2C ç­‰ï¼‰ã€‚</p><h4 id="å¸¸è§ç”¨é€”ï¼š"><a href="#å¸¸è§ç”¨é€”ï¼š" class="headerlink" title="å¸¸è§ç”¨é€”ï¼š"></a>å¸¸è§ç”¨é€”ï¼š</h4><ul><li><strong>æ•°å­—è¾“å…¥</strong>ï¼šè¯»å–æŒ‰é”®ã€å¼€å…³æˆ–ä¼ æ„Ÿå™¨çŠ¶æ€ã€‚</li><li><strong>æ•°å­—è¾“å‡º</strong>ï¼šæ§åˆ¶ LEDã€ç»§ç”µå™¨ã€èœ‚é¸£å™¨ç­‰ã€‚</li><li><strong>PWM è¾“å‡º</strong>ï¼šæ§åˆ¶ç”µæœºé€Ÿåº¦ã€LED äº®åº¦ã€‚</li><li><strong>å¤–éƒ¨ä¸­æ–­</strong>ï¼šç”¨äºæ£€æµ‹å¼•è„šç”µå¹³å˜åŒ–ï¼ˆå¦‚æŒ‰é”®æŒ‰ä¸‹æˆ–æ¾å¼€æ—¶è§¦å‘ä¸­æ–­ï¼‰ã€‚</li></ul><h4 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h4><ul><li><p>æ¨¡å¼é…ç½®</p><p>ï¼š</p><ul><li><strong>è¾“å…¥æ¨¡å¼</strong>ï¼šå¯ä»¥é…ç½®ä¸ºæµ®ç©ºè¾“å…¥ã€ä¸Šæ‹‰è¾“å…¥æˆ–ä¸‹æ‹‰è¾“å…¥ã€‚</li><li><strong>è¾“å‡ºæ¨¡å¼</strong>ï¼šæ”¯æŒæ¨æŒ½è¾“å‡ºå’Œå¼€æ¼è¾“å‡ºï¼Œé€‚åˆé©±åŠ¨ä¸åŒç±»å‹çš„è´Ÿè½½ã€‚</li><li><strong>æ¨¡æ‹Ÿæ¨¡å¼</strong>ï¼šç”¨äºè¿æ¥æ¨¡æ‹Ÿä¿¡å·è¾“å…¥ï¼Œå¦‚ ADCï¼ˆæ¨¡æ•°è½¬æ¢å™¨ï¼‰çš„æ¨¡æ‹Ÿä¿¡å·é€šé“ã€‚</li><li><strong>å¤ç”¨åŠŸèƒ½</strong>ï¼šå¼•è„šå¯ä»¥ä½œä¸ºå¤–è®¾çš„ä¿¡å·å¼•è„šä½¿ç”¨ï¼Œå¦‚ USART çš„ TX&#x2F;RXã€‚</li></ul></li><li><p><strong>å¤–éƒ¨ä¸­æ–­</strong>ï¼šæ”¯æŒå¼•è„šçš„ä¸Šå‡æ²¿ã€ä¸‹é™æ²¿æˆ–åŒè¾¹æ²¿è§¦å‘ä¸­æ–­äº‹ä»¶ï¼Œå…è®¸ç³»ç»Ÿå¯¹å¤–éƒ¨äº‹ä»¶åšå‡ºå¿«é€Ÿå“åº”ã€‚</p></li><li><p><strong>å¿«é€Ÿåˆ‡æ¢</strong>ï¼šGPIO å¼•è„šçš„çŠ¶æ€å¯ä»¥é€šè¿‡å¯„å­˜å™¨å¿«é€Ÿè¯»å–å’Œä¿®æ”¹ï¼Œå…·å¤‡é«˜æ•ˆçš„å“åº”èƒ½åŠ›ã€‚</p></li></ul><h4 id="å®é™…åº”ç”¨ï¼š"><a href="#å®é™…åº”ç”¨ï¼š" class="headerlink" title="å®é™…åº”ç”¨ï¼š"></a>å®é™…åº”ç”¨ï¼š</h4><p>é…ç½® GPIO ä¸ºè¾“å‡ºæ¨¡å¼æ§åˆ¶ä¸€ä¸ª LEDï¼Œå½“æŒ‰é”®æŒ‰ä¸‹æ—¶é€šè¿‡å¤–éƒ¨ä¸­æ–­æœºåˆ¶ç‚¹äº® LEDã€‚</p></li></ul></li></ul><pre><code>------   ### 2. **USART / UARTï¼ˆé€šç”¨å¼‚æ­¥æ”¶å‘å™¨ï¼‰**   #### åŠŸèƒ½ï¼š   USARTï¼ˆUniversal Synchronous Asynchronous Receiver Transmitterï¼‰æˆ– UART æ˜¯å¸¸ç”¨äºä¸²è¡Œé€šä¿¡çš„å¤–è®¾ï¼Œæ”¯æŒå¼‚æ­¥å’ŒåŒæ­¥é€šä¿¡ã€‚å®ƒé€šå¸¸ç”¨äºä¸è®¡ç®—æœºã€å¤–éƒ¨æ¨¡å—æˆ–å…¶ä»–å¾®æ§åˆ¶å™¨ä¹‹é—´çš„é€šä¿¡ã€‚   #### å¸¸è§ç”¨é€”ï¼š   - **è°ƒè¯•æ¥å£**ï¼šå°†è°ƒè¯•ä¿¡æ¯å‘é€åˆ°ä¸²å£ç»ˆç«¯ï¼Œå¸®åŠ©å¼€å‘äººå‘˜å®æ—¶æŸ¥çœ‹ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ã€‚   - **æ¨¡å—é€šä¿¡**ï¼šä¸è“ç‰™æ¨¡å—ã€GPS æ¨¡å—ã€GSM æ¨¡å—ç­‰å¤–è®¾è¿›è¡Œæ•°æ®äº¤äº’ã€‚   - **è®¾å¤‡é€šä¿¡**ï¼šä¸ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨ã€å…¶ä»–å¾®æ§åˆ¶å™¨é€šä¿¡ã€‚   #### ç‰¹ç‚¹ï¼š   - **æ³¢ç‰¹ç‡**ï¼šæ”¯æŒå¤šç§æ³¢ç‰¹ç‡è®¾ç½®ï¼ˆå¦‚ 9600ã€115200ï¼‰ï¼Œå¯ä»¥é€‚åº”ä¸åŒé€Ÿåº¦çš„é€šä¿¡éœ€æ±‚ã€‚   - æ•°æ®æ ¼å¼     ï¼šçµæ´»è®¾ç½®æ•°æ®ä½ã€åœæ­¢ä½ã€æ ¡éªŒä½ç­‰ï¼Œé€‚åº”ä¸åŒåè®®éœ€æ±‚ã€‚     - å¸¸è§é…ç½®ï¼š8 æ•°æ®ä½ã€1 åœæ­¢ä½ã€æ— æ ¡éªŒä½ã€‚   - **ç¡¬ä»¶æµæ§**ï¼šæ”¯æŒ RTS/CTS ç¡¬ä»¶æµæ§ï¼Œå‡å°‘æ•°æ®ä¸¢å¤±é£é™©ï¼Œç‰¹åˆ«é€‚åˆé«˜é€Ÿé€šä¿¡ã€‚   - **ä¸­æ–­å’Œ DMA æ”¯æŒ**ï¼šå¯ä»¥é€šè¿‡ä¸­æ–­æˆ– DMA ä¼ è¾“æ•°æ®ï¼Œå‡å°‘ CPU è´Ÿæ‹…ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡ã€‚   - **å¤šå¤„ç†å™¨æ¨¡å¼**ï¼šå…è®¸å¤šå¤„ç†å™¨é—´çš„ä¸²è¡Œé€šä¿¡ï¼Œé€šè¿‡åœ°å€æ ‡è¯†è¿›è¡Œé€‰æ‹©æ€§é€šä¿¡ã€‚   #### å®é™…åº”ç”¨ï¼š   ä½¿ç”¨ STM32 çš„ `USART2` ç«¯å£ä¸è®¡ç®—æœºä¸²å£ç»ˆç«¯é€šä¿¡ï¼Œå°†ä¼ æ„Ÿå™¨æ•°æ®é€šè¿‡ UART å‘é€åˆ°ç»ˆç«¯ï¼Œä»¥è¿›è¡Œå®æ—¶ç›‘æ§ã€‚------   ### 3. **SPIï¼ˆä¸²è¡Œå¤–è®¾æ¥å£ï¼‰**   #### åŠŸèƒ½ï¼š   SPIï¼ˆSerial Peripheral Interfaceï¼‰æ˜¯ä¸€ç§é«˜é€Ÿçš„åŒæ­¥ä¸²è¡Œé€šä¿¡æ¥å£ï¼Œé€šå¸¸ç”¨äºä¸å¤–éƒ¨ä¼ æ„Ÿå™¨ã€å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ EEPROMã€Flashï¼‰å’Œæ˜¾ç¤ºå™¨ç­‰å¤–è®¾è¿›è¡Œé€šä¿¡ã€‚STM32 çš„ SPI æ¥å£æ”¯æŒå…¨åŒå·¥é€šä¿¡ï¼Œå¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚   #### å¸¸è§ç”¨é€”ï¼š   - **å­˜å‚¨å™¨é€šä¿¡**ï¼šä¸ SPI é—ªå­˜æˆ– EEPROM è¿›è¡Œé«˜é€Ÿè¯»å†™æ“ä½œã€‚   - **æ˜¾ç¤ºå™¨æ§åˆ¶**ï¼šä¸ OLEDã€LCD å±å¹•è¿›è¡Œé€šä¿¡ï¼Œå¿«é€Ÿåˆ·æ–°æ˜¾ç¤ºå†…å®¹ã€‚   - **ä¼ æ„Ÿå™¨æ•°æ®è¯»å–**ï¼šè·å– MEMS ä¼ æ„Ÿå™¨ã€åŠ é€Ÿåº¦è®¡ã€é™€èºä»ªç­‰ä¼ æ„Ÿå™¨çš„æ•°æ®ã€‚   - **éŸ³é¢‘æ¨¡å—**ï¼šé€šè¿‡ SPI ä¸éŸ³é¢‘èŠ¯ç‰‡é€šä¿¡ï¼Œè¿›è¡ŒéŸ³é¢‘æ•°æ®çš„ä¼ è¾“å’Œæ§åˆ¶ã€‚   #### ç‰¹ç‚¹ï¼š   - **ä¸»ä»æ¨¡å¼**ï¼šSPI æ”¯æŒä¸»ä»é€šä¿¡æ¨¡å¼ï¼ŒSTM32 å¯ä»¥é…ç½®ä¸ºä¸»è®¾å¤‡æˆ–ä»è®¾å¤‡ã€‚   - **é«˜æ•°æ®é€Ÿç‡**ï¼šSPI çš„é€šä¿¡é€Ÿç‡å¯è¾¾å‡ å MHzï¼Œé€‚åˆé«˜é€Ÿæ•°æ®ä¼ è¾“åº”ç”¨ã€‚   - **å…¨åŒå·¥é€šä¿¡**ï¼šæ”¯æŒåŒæ—¶å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œé€‚åˆéœ€è¦é«˜é€ŸåŒå‘é€šä¿¡çš„åœºæ™¯ã€‚   - **å¤šä»è®¾å¤‡æ”¯æŒ**ï¼šé€šè¿‡ç‰‡é€‰å¼•è„šï¼ˆCSï¼‰ï¼Œå¯ä»¥è¿æ¥å¤šä¸ªä»è®¾å¤‡ï¼Œçµæ´»æ§åˆ¶ä¸åŒçš„å¤–è®¾ã€‚   #### å®é™…åº”ç”¨ï¼š   ä½¿ç”¨ STM32 ä½œä¸ºä¸»è®¾å¤‡ï¼Œé€šè¿‡ SPI æ¥å£è¯»å–å¤–éƒ¨ EEPROM çš„æ•°æ®ï¼Œæˆ–è€…é©±åŠ¨ OLED æ˜¾ç¤ºå±æ˜¾ç¤ºå›¾åƒæ•°æ®ã€‚------   ### 4. **I2Cï¼ˆé›†æˆç”µè·¯äº’è”ï¼‰**   #### åŠŸèƒ½ï¼š   I2C æ˜¯ä¸€ç§å¸¸ç”¨çš„åŒçº¿ä¸²è¡Œé€šä¿¡åè®®ï¼Œé€‚ç”¨äºä½é€Ÿå¤–å›´è®¾å¤‡ï¼ˆå¦‚ä¼ æ„Ÿå™¨ã€å­˜å‚¨å™¨ã€RTC æ¨¡å—ï¼‰çš„é€šä¿¡ã€‚å®ƒåªéœ€è¦ä¸¤æ ¹çº¿ï¼šSCLï¼ˆæ—¶é’Ÿï¼‰å’Œ SDAï¼ˆæ•°æ®ï¼‰ï¼Œå³å¯åœ¨å¤šä¸»å¤šä»æ¶æ„ä¸­è¿›è¡Œé€šä¿¡ã€‚   #### å¸¸è§ç”¨é€”ï¼š   - **ä¼ æ„Ÿå™¨é€šä¿¡**ï¼šä¸æ¸©åº¦ä¼ æ„Ÿå™¨ã€å‹åŠ›ä¼ æ„Ÿå™¨ç­‰ä½é€Ÿè®¾å¤‡é€šä¿¡ã€‚   - **å­˜å‚¨å™¨æ¥å£**ï¼šå¦‚ I2C EEPROMï¼Œç”¨äºå­˜å‚¨é…ç½®ä¿¡æ¯æˆ–æ—¥å¿—ã€‚   - **RTCï¼ˆå®æ—¶æ—¶é’Ÿï¼‰æ¨¡å—**ï¼šè¯»å–å®æ—¶æ—¶é’Ÿçš„æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ã€‚   - **æ˜¾ç¤ºæ¨¡å—**ï¼šé©±åŠ¨ I2C åè®®çš„ OLED æˆ– LCD æ˜¾ç¤ºå±ã€‚   #### ç‰¹ç‚¹ï¼š   - **åŒçº¿é€šä¿¡**ï¼šä½¿ç”¨ SDA å’Œ SCL ä¸¤æ¡çº¿ï¼Œå‡å°‘é€šä¿¡æ¥å£æ•°é‡ã€‚   - **å¤šä¸»å¤šä»æ”¯æŒ**ï¼šå…è®¸å¤šä¸ªè®¾å¤‡åŒæ—¶è¿æ¥åˆ°åŒä¸€æ¡æ€»çº¿ä¸Šï¼Œæ”¯æŒå¤šä¸»è®¾å¤‡é€šä¿¡ã€‚   - **åœ°å€è¯†åˆ«**ï¼šæ¯ä¸ªä»è®¾å¤‡éƒ½æœ‰å”¯ä¸€çš„ 7 ä½æˆ– 10 ä½åœ°å€ï¼Œä¸»è®¾å¤‡é€šè¿‡åœ°å€è®¿é—®ç‰¹å®šä»è®¾å¤‡ã€‚   - **å¤šç§é€šä¿¡é€Ÿç‡**ï¼šæ”¯æŒæ ‡å‡†æ¨¡å¼ï¼ˆ100kHzï¼‰ã€å¿«é€Ÿæ¨¡å¼ï¼ˆ400kHzï¼‰å’Œé«˜é€Ÿæ¨¡å¼ï¼ˆ1MHzï¼‰ã€‚   #### å®é™…åº”ç”¨ï¼š   ä½¿ç”¨ STM32 çš„ I2C æ¥å£ä¸æ¸©åº¦ä¼ æ„Ÿå™¨é€šä¿¡ï¼Œå‘¨æœŸæ€§è¯»å–ç¯å¢ƒæ¸©åº¦ï¼Œå¹¶é€šè¿‡ä¸²å£å°†æ•°æ®å‘é€åˆ°ç”µè„‘è¿›è¡Œç›‘æ§ã€‚------   ### 5. **ADCï¼ˆæ¨¡æ•°è½¬æ¢å™¨ï¼‰**   #### åŠŸèƒ½ï¼š   ADCï¼ˆAnalog to Digital Converterï¼‰ç”¨äºå°†æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡å·ï¼Œæ˜¯è¯»å–ä¼ æ„Ÿå™¨ç­‰æ¨¡æ‹Ÿè®¾å¤‡æ•°æ®çš„é‡è¦æ¥å£ã€‚STM32 çš„ ADC é€šå¸¸å…·æœ‰å¤šé€šé“å’Œé«˜åˆ†è¾¨ç‡çš„ç‰¹ç‚¹ï¼Œé€‚ç”¨äºé«˜ç²¾åº¦çš„æ¨¡æ‹Ÿä¿¡å·é‡‡é›†ã€‚   #### å¸¸è§ç”¨é€”ï¼š   - **ä¼ æ„Ÿå™¨ä¿¡å·é‡‡é›†**ï¼šé‡‡é›†æ¸©åº¦ä¼ æ„Ÿå™¨ã€ç”µä½å™¨ç­‰æ¨¡æ‹Ÿè®¾å¤‡çš„ä¿¡å·ã€‚   - **ç”µå‹ç›‘æµ‹**ï¼šç›‘æµ‹ç”µæ± ç”µå‹ã€ç”µæºç”µå‹ç­‰ï¼Œé˜²æ­¢è¿‡å……æˆ–æ¬ å‹æƒ…å†µã€‚   - **éŸ³é¢‘è¾“å…¥**ï¼šåœ¨éŸ³é¢‘å¤„ç†åº”ç”¨ä¸­ï¼Œé‡‡é›†éº¦å…‹é£æˆ–éŸ³é¢‘ä¿¡å·ã€‚   - **ç¯å¢ƒç›‘æµ‹**ï¼šç”¨äºå…‰ç…§å¼ºåº¦ã€æ°”ä½“æµ“åº¦ç­‰çš„æ¨¡æ‹Ÿæ•°æ®è¯»å–ã€‚   #### ç‰¹ç‚¹ï¼š   - **å¤šé€šé“æ”¯æŒ**ï¼šSTM32 çš„ ADC é€šå¸¸æ”¯æŒå¤šé€šé“é‡‡æ ·ï¼Œå¯ä»¥è½®è¯¢å¤šä¸ªæ¨¡æ‹Ÿä¿¡å·æºã€‚   - **é«˜åˆ†è¾¨ç‡**ï¼šæ”¯æŒ 12 ä½ç”šè‡³ 16 ä½åˆ†è¾¨ç‡ï¼Œç¡®ä¿é«˜ç²¾åº¦çš„æ•°æ®è½¬æ¢ã€‚   - **è¿ç»­è½¬æ¢æ¨¡å¼**ï¼šå¯ä»¥é…ç½®ä¸ºè¿ç»­é‡‡æ ·æ¨¡å¼ï¼ŒæŒç»­é‡‡é›†æ¨¡æ‹Ÿä¿¡å·ã€‚   - **DMA æ”¯æŒ**ï¼šä¸ DMA ååŒå·¥ä½œï¼Œå…è®¸å¤§æ•°æ®é‡çš„è‡ªåŠ¨é‡‡é›†è€Œæ— éœ€å ç”¨ CPUã€‚   - **é‡‡æ ·æ—¶é—´å¯è°ƒ**ï¼šå¯ä»¥æ ¹æ®ä¸åŒè¾“å…¥ä¿¡å·æºçš„é˜»æŠ—è°ƒæ•´é‡‡æ ·æ—¶é—´ï¼Œç¡®ä¿å‡†ç¡®æ€§ã€‚   #### å®é™…åº”ç”¨ï¼š   ä½¿ç”¨ ADC æ¥å£è¯»å–ç”µä½å™¨çš„æ¨¡æ‹Ÿä¿¡å·ï¼Œé€šè¿‡ ADC è½¬æ¢ä¸ºæ•°å­—ä¿¡å·åè¿›è¡Œå¤„ç†ï¼Œè°ƒæ•´ç³»ç»Ÿçš„è¾“å‡ºå‚æ•°ï¼Œå¦‚æ§åˆ¶ LED çš„äº®åº¦æˆ–è°ƒæ•´ç”µæœºè½¬é€Ÿã€‚------   ### 6. **TIMï¼ˆå®šæ—¶å™¨ï¼‰**   #### åŠŸèƒ½ï¼š   å®šæ—¶å™¨ï¼ˆTIMï¼‰æ˜¯ STM32 ä¸­éå¸¸å¼ºå¤§çš„å¤–è®¾ï¼Œæ”¯æŒè®¡æ—¶ã€äº‹ä»¶æ§åˆ¶ã€PWM ç”Ÿæˆã€è¾“å…¥æ•è·ã€è¾“å‡ºæ¯”è¾ƒç­‰åŠŸèƒ½ã€‚STM32 ä¸­æœ‰å¤šç§ç±»å‹çš„å®šæ—¶å™¨ï¼Œå¯ç”¨äºä¸åŒçš„ä»»åŠ¡ã€‚   #### å¸¸è§ç”¨é€”ï¼š   - **æ—¶é—´å»¶è¿Ÿ**ï¼šç”Ÿæˆç²¾ç¡®çš„æ—¶é—´å»¶è¿Ÿï¼Œç”¨äºå®šæ—¶ä»»åŠ¡æˆ–å‘¨æœŸæ€§ä¸­æ–­ã€‚   - **PWM ç”Ÿæˆ**ï¼šæ§åˆ¶ç”µæœºè½¬é€Ÿã€è°ƒå…‰ LED äº®åº¦ã€éŸ³é¢‘è¾“å‡ºç­‰ã€‚   - **è¾“å…¥æ•è·**ï¼šæµ‹é‡è¾“å…¥ä¿¡å·çš„è„‰å†²å®½åº¦æˆ–é¢‘ç‡ï¼Œå¦‚æµ‹é€Ÿåº”ç”¨ã€‚   - **äº‹ä»¶è®¡æ•°**ï¼šç”¨äºè®°å½•å¤–éƒ¨äº‹ä»¶çš„å‘ç”Ÿæ¬¡æ•°ï¼Œå¦‚è„‰å†²è®¡æ•°ã€‚   #### ç‰¹ç‚¹ï¼š   - **å¤šç§æ¨¡å¼**ï¼šæ”¯æŒå•æ¬¡è®¡æ—¶ã€å‘¨æœŸæ€§è®¡æ—¶ç­‰å¤šç§æ¨¡å¼ã€‚   - **é«˜ç²¾åº¦è®¡æ—¶**ï¼šå¯ä»¥é€šè¿‡å®šæ—¶å™¨é¢„åˆ†é¢‘å™¨å®ç°é«˜ç²¾åº¦æ—¶é—´æ§åˆ¶ï¼Œæ”¯æŒä»å¾®ç§’çº§åˆ«åˆ°æ•°ç§’çº§åˆ«çš„è®¡æ—¶ä»»åŠ¡ã€‚   - **PWM è¾“å‡º**ï¼šå®šæ—¶å™¨æ”¯æŒå¤šé€šé“ PWM è¾“å‡ºï¼Œå¯ä»¥åŒæ—¶æ§åˆ¶å¤šä¸ªè®¾å¤‡ï¼Œå¦‚æ§åˆ¶å¤šè·¯ LED çš„äº®åº¦æˆ–å¤šè½´ç”µæœºçš„é€Ÿåº¦ã€‚   - **è¾“å…¥æ•è·/è¾“å‡ºæ¯”è¾ƒ**ï¼šè¾“å…¥æ•è·ç”¨äºç²¾ç¡®æµ‹é‡è¾“å…¥ä¿¡å·çš„æ—¶é—´ç‰¹æ€§ï¼Œè¾“å‡ºæ¯”è¾ƒç”¨äºåœ¨ç‰¹å®šæ—¶é—´è¾“å‡ºæ§åˆ¶ä¿¡å·ã€‚   #### å®é™…åº”ç”¨ï¼š   é…ç½® STM32 çš„ TIM å®šæ—¶å™¨ç”Ÿæˆ PWM ä¿¡å·æ§åˆ¶ç›´æµç”µæœºçš„è½¬é€Ÿï¼Œæˆ–è€…é€šè¿‡è¾“å…¥æ•è·åŠŸèƒ½æµ‹é‡å¤–éƒ¨ä¿¡å·çš„é¢‘ç‡ã€‚</code></pre><h3 id="GPIO-InitTypeDefï¼ŒEXTI-InitTypeDefï¼ŒNVIC-InitTypeDefç­‰å¸¸ç”¨çš„defçš„å„ä¸ªå‚æ•°åŠä½¿ç”¨æ–¹æ³•"><a href="#GPIO-InitTypeDefï¼ŒEXTI-InitTypeDefï¼ŒNVIC-InitTypeDefç­‰å¸¸ç”¨çš„defçš„å„ä¸ªå‚æ•°åŠä½¿ç”¨æ–¹æ³•" class="headerlink" title="GPIO_InitTypeDefï¼ŒEXTI_InitTypeDefï¼ŒNVIC_InitTypeDefç­‰å¸¸ç”¨çš„defçš„å„ä¸ªå‚æ•°åŠä½¿ç”¨æ–¹æ³•"></a>GPIO_InitTypeDefï¼ŒEXTI_InitTypeDefï¼ŒNVIC_InitTypeDefç­‰å¸¸ç”¨çš„defçš„å„ä¸ªå‚æ•°åŠä½¿ç”¨æ–¹æ³•</h3><h3 id="1-GPIO-InitTypeDef"><a href="#1-GPIO-InitTypeDef" class="headerlink" title="1. GPIO_InitTypeDef"></a>1. <strong>GPIO_InitTypeDef</strong></h3><p><code>GPIO_InitTypeDef</code> æ˜¯ç”¨äºé…ç½® GPIO å¼•è„šçš„ç»“æ„ä½“ã€‚å®ƒçš„æˆå‘˜å˜é‡å†³å®šäº†å¼•è„šçš„å·¥ä½œæ¨¡å¼ã€è¾“å‡ºç±»å‹ã€é€Ÿåº¦ä»¥åŠä¸Šä¸‹æ‹‰ç”µé˜»é…ç½®ã€‚</p><h4 id="ç»“æ„ä½“å®šä¹‰ï¼š"><a href="#ç»“æ„ä½“å®šä¹‰ï¼š" class="headerlink" title="ç»“æ„ä½“å®šä¹‰ï¼š"></a>ç»“æ„ä½“å®šä¹‰ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">  uint32_t GPIO_Pin;        // GPIO å¼•è„šå·</span><br><span class="line">  GPIOMode_TypeDef GPIO_Mode; // GPIO æ¨¡å¼ï¼ˆè¾“å…¥ã€è¾“å‡ºã€å¤ç”¨ã€æ¨¡æ‹Ÿï¼‰</span><br><span class="line">  GPIOSpeed_TypeDef GPIO_Speed; // GPIO é€Ÿåº¦</span><br><span class="line">  GPIOOType_TypeDef GPIO_OType; // GPIO è¾“å‡ºç±»å‹ï¼ˆæ¨æŒ½/å¼€æ¼ï¼‰</span><br><span class="line">  GPIOPuPd_TypeDef GPIO_PuPd;   // GPIO ä¸Šæ‹‰/ä¸‹æ‹‰ç”µé˜»é…ç½®</span><br><span class="line">&#125; GPIO_InitTypeDef;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°è¯´æ˜ï¼š"><a href="#å‚æ•°è¯´æ˜ï¼š" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a>å‚æ•°è¯´æ˜ï¼š</h4><ul><li>**<code>GPIO_Pin</code>**ï¼šæŒ‡å®šè¦é…ç½®çš„ GPIO å¼•è„šã€‚å¯ä»¥æ˜¯ä»¥ä¸‹å¸¸é‡çš„ç»„åˆï¼Œç”¨äºåŒæ—¶é…ç½®å¤šä¸ªå¼•è„šï¼š<ul><li><code>GPIO_Pin_0</code>, <code>GPIO_Pin_1</code>, <code>GPIO_Pin_2</code>, â€¦, <code>GPIO_Pin_15</code>ã€‚</li></ul></li><li>**<code>GPIO_Mode</code>**ï¼šè®¾ç½®å¼•è„šçš„å·¥ä½œæ¨¡å¼ã€‚å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ¨¡å¼ï¼š<ul><li><code>GPIO_Mode_IN</code>ï¼šè¾“å…¥æ¨¡å¼ã€‚</li><li><code>GPIO_Mode_OUT</code>ï¼šè¾“å‡ºæ¨¡å¼ã€‚</li><li><code>GPIO_Mode_AF</code>ï¼šå¤ç”¨æ¨¡å¼ï¼ˆç”¨äºå¤–è®¾ï¼Œå¦‚ USARTã€SPI ç­‰ï¼‰ã€‚</li><li><code>GPIO_Mode_AN</code>ï¼šæ¨¡æ‹Ÿæ¨¡å¼ï¼ˆç”¨äº ADCï¼‰ã€‚</li></ul></li><li>**<code>GPIO_Speed</code>**ï¼šé…ç½®å¼•è„šçš„é€Ÿåº¦ï¼Œä¸»è¦ç”¨äºè¾“å‡ºæ¨¡å¼ã€‚é€Ÿåº¦å–å†³äºåº”ç”¨éœ€æ±‚ä»¥åŠå¤–è®¾è¦æ±‚ï¼š<ul><li><code>GPIO_Speed_2MHz</code>ï¼šä½é€Ÿï¼ˆ2MHzï¼‰ã€‚</li><li><code>GPIO_Speed_25MHz</code>ï¼šä¸­é€Ÿï¼ˆ25MHzï¼‰ã€‚</li><li><code>GPIO_Speed_50MHz</code>ï¼šé«˜é€Ÿï¼ˆ50MHzï¼‰ã€‚</li><li><code>GPIO_Speed_100MHz</code>ï¼šéå¸¸é«˜é€Ÿï¼ˆ100MHzï¼‰ã€‚</li></ul></li><li>**<code>GPIO_OType</code>**ï¼šè¾“å‡ºç±»å‹ï¼Œå†³å®šå¼•è„šæ˜¯æ¨æŒ½è¿˜æ˜¯å¼€æ¼è¾“å‡ºã€‚ä¸»è¦ç”¨äºè¾“å‡ºæ¨¡å¼ï¼š<ul><li><code>GPIO_OType_PP</code>ï¼šæ¨æŒ½è¾“å‡ºã€‚</li><li><code>GPIO_OType_OD</code>ï¼šå¼€æ¼è¾“å‡ºã€‚</li></ul></li><li>**<code>GPIO_PuPd</code>**ï¼šé…ç½®ä¸Šæ‹‰æˆ–ä¸‹æ‹‰ç”µé˜»ï¼Œä¸»è¦ç”¨äºè¾“å…¥æ¨¡å¼ï¼š<ul><li><code>GPIO_PuPd_NOPULL</code>ï¼šæ— ä¸Šæ‹‰æˆ–ä¸‹æ‹‰ç”µé˜»ã€‚</li><li><code>GPIO_PuPd_UP</code>ï¼šä¸Šæ‹‰ç”µé˜»ã€‚</li><li><code>GPIO_PuPd_DOWN</code>ï¼šä¸‹æ‹‰ç”µé˜»ã€‚</li></ul></li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹ï¼š"><a href="#ä½¿ç”¨ç¤ºä¾‹ï¼š" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹ï¼š"></a>ä½¿ç”¨ç¤ºä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);  // ä½¿èƒ½ GPIOA æ—¶é’Ÿ</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5;              // é…ç½® PA5 å¼•è„š</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;          // è¾“å‡ºæ¨¡å¼</span><br><span class="line">GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;         // æ¨æŒ½è¾“å‡º</span><br><span class="line">GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;      // 50MHz é€Ÿåº¦</span><br><span class="line">GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;       // æ— ä¸Šæ‹‰/ä¸‹æ‹‰</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);                 // åˆå§‹åŒ– GPIOA å¼•è„š</span><br></pre></td></tr></table></figure><h3 id="2-EXTI-InitTypeDef"><a href="#2-EXTI-InitTypeDef" class="headerlink" title="2. EXTI_InitTypeDef"></a>2. <strong>EXTI_InitTypeDef</strong></h3><p><code>EXTI_InitTypeDef</code> ç”¨äºé…ç½®å¤–éƒ¨ä¸­æ–­ï¼ˆEXTIï¼‰ï¼ŒSTM32 çš„ EXTI æ¨¡å—å¯ä»¥é€šè¿‡ GPIO å¼•è„šå¼•å‘å¤–éƒ¨ä¸­æ–­ã€‚</p><h4 id="ç»“æ„ä½“å®šä¹‰ï¼š-1"><a href="#ç»“æ„ä½“å®šä¹‰ï¼š-1" class="headerlink" title="ç»“æ„ä½“å®šä¹‰ï¼š"></a>ç»“æ„ä½“å®šä¹‰ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">  uint32_t EXTI_Line;    // å¤–éƒ¨ä¸­æ–­çº¿</span><br><span class="line">  EXTIMode_TypeDef EXTI_Mode; // ä¸­æ–­æ¨¡å¼æˆ–äº‹ä»¶æ¨¡å¼</span><br><span class="line">  EXTITrigger_TypeDef EXTI_Trigger; // ä¸­æ–­è§¦å‘æ¡ä»¶ï¼ˆä¸Šå‡æ²¿ã€ä¸‹é™æ²¿ã€åŒè¾¹æ²¿ï¼‰</span><br><span class="line">  FunctionalState EXTI_LineCmd;     // å¤–éƒ¨ä¸­æ–­ä½¿èƒ½æˆ–ç¦ç”¨</span><br><span class="line">&#125; EXTI_InitTypeDef;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°è¯´æ˜ï¼š-1"><a href="#å‚æ•°è¯´æ˜ï¼š-1" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a>å‚æ•°è¯´æ˜ï¼š</h4><ul><li>**<code>EXTI_Line</code>**ï¼šæŒ‡å®šè¦é…ç½®çš„ EXTI çº¿ï¼ŒèŒƒå›´ä» <code>EXTI_Line0</code> åˆ° <code>EXTI_Line15</code>ï¼Œå¯¹åº”ä¸åŒçš„ GPIO å¼•è„šï¼ˆä¾‹å¦‚ï¼Œ<code>EXTI_Line0</code> å¯¹åº” GPIO 0 å·å¼•è„šï¼‰ã€‚</li><li>**<code>EXTI_Mode</code>**ï¼šé…ç½® EXTI çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯ä»¥ä¸‹ä¸¤ç§ï¼š<ul><li><code>EXTI_Mode_Interrupt</code>ï¼šä¸­æ–­æ¨¡å¼ã€‚</li><li><code>EXTI_Mode_Event</code>ï¼šäº‹ä»¶æ¨¡å¼ï¼Œä¸äº§ç”Ÿä¸­æ–­ï¼Œä½†å¯ä»¥è§¦å‘äº‹ä»¶ã€‚</li></ul></li><li>**<code>EXTI_Trigger</code>**ï¼šè®¾ç½®ä¸­æ–­è§¦å‘æ¡ä»¶ï¼Œå¯ä»¥é€‰æ‹©ä»¥ä¸‹è§¦å‘æ¡ä»¶ï¼š<ul><li><code>EXTI_Trigger_Rising</code>ï¼šä¸Šå‡æ²¿è§¦å‘ã€‚</li><li><code>EXTI_Trigger_Falling</code>ï¼šä¸‹é™æ²¿è§¦å‘ã€‚</li><li><code>EXTI_Trigger_Rising_Falling</code>ï¼šä¸Šå‡æ²¿å’Œä¸‹é™æ²¿éƒ½è§¦å‘ã€‚</li></ul></li><li>**<code>EXTI_LineCmd</code>**ï¼šç”¨äºä½¿èƒ½æˆ–ç¦ç”¨ EXTI çº¿ï¼š<ul><li><code>ENABLE</code>ï¼šä½¿èƒ½ EXTI çº¿ã€‚</li><li><code>DISABLE</code>ï¼šç¦ç”¨ EXTI çº¿ã€‚</li></ul></li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹ï¼š-1"><a href="#ä½¿ç”¨ç¤ºä¾‹ï¼š-1" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹ï¼š"></a>ä½¿ç”¨ç¤ºä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">EXTI_InitTypeDef EXTI_InitStructure;</span><br><span class="line"></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);  // ä½¿èƒ½ SYSCFG æ—¶é’Ÿ</span><br><span class="line">SYSCFG_EXTILineConfig(EXTI_PortSourceGPIOA, EXTI_PinSource0); // å°† PA0 é…ç½®ä¸º EXTI_Line0</span><br><span class="line"></span><br><span class="line">EXTI_InitStructure.EXTI_Line = EXTI_Line0;              // é…ç½® EXTI Line0</span><br><span class="line">EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;     // ä¸­æ–­æ¨¡å¼</span><br><span class="line">EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;  // ä¸Šå‡æ²¿è§¦å‘</span><br><span class="line">EXTI_InitStructure.EXTI_LineCmd = ENABLE;               // ä½¿èƒ½ EXTI Line0</span><br><span class="line">EXTI_Init(&amp;EXTI_InitStructure);                         // åˆå§‹åŒ– EXTI</span><br></pre></td></tr></table></figure><h3 id="3-NVIC-InitTypeDef"><a href="#3-NVIC-InitTypeDef" class="headerlink" title="3. NVIC_InitTypeDef"></a>3. <strong>NVIC_InitTypeDef</strong></h3><p><code>NVIC_InitTypeDef</code> ç”¨äºé…ç½®åµŒå¥—å‘é‡ä¸­æ–­æ§åˆ¶å™¨ (NVIC)ï¼Œç”¨äºç®¡ç†ä¸­æ–­ä¼˜å…ˆçº§å¹¶ä½¿èƒ½ä¸­æ–­è¯·æ±‚ã€‚</p><h4 id="ç»“æ„ä½“å®šä¹‰ï¼š-2"><a href="#ç»“æ„ä½“å®šä¹‰ï¼š-2" class="headerlink" title="ç»“æ„ä½“å®šä¹‰ï¼š"></a>ç»“æ„ä½“å®šä¹‰ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">  uint8_t NVIC_IRQChannel; // è¦é…ç½®çš„ä¸­æ–­é€šé“</span><br><span class="line">  uint8_t NVIC_IRQChannelPreemptionPriority; // æŠ¢å ä¼˜å…ˆçº§</span><br><span class="line">  uint8_t NVIC_IRQChannelSubPriority;        // å“åº”ä¼˜å…ˆçº§</span><br><span class="line">  FunctionalState NVIC_IRQChannelCmd;        // ä¸­æ–­ä½¿èƒ½æˆ–ç¦ç”¨</span><br><span class="line">&#125; NVIC_InitTypeDef;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°è¯´æ˜ï¼š-2"><a href="#å‚æ•°è¯´æ˜ï¼š-2" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a>å‚æ•°è¯´æ˜ï¼š</h4><ul><li>**<code>NVIC_IRQChannel</code>**ï¼šæŒ‡å®šè¦é…ç½®çš„ä¸­æ–­é€šé“ã€‚ä¾‹å¦‚ï¼š<ul><li><code>EXTI0_IRQn</code>ï¼šEXTI Line0 çš„ä¸­æ–­ã€‚</li><li><code>TIM2_IRQn</code>ï¼šTIM2 å®šæ—¶å™¨çš„ä¸­æ–­ã€‚</li></ul></li><li>**<code>NVIC_IRQChannelPreemptionPriority</code>**ï¼šè®¾ç½®æŠ¢å ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šä½ä¼˜å…ˆçº§è¶Šé«˜ã€‚åœ¨ STM32F4 ä¸­é€šå¸¸æ”¯æŒ 4 ä½ä¼˜å…ˆçº§åˆ’åˆ†ã€‚</li><li>**<code>NVIC_IRQChannelSubPriority</code>**ï¼šè®¾ç½®å“åº”ä¼˜å…ˆçº§ï¼Œç”¨äºåŒä¸€æŠ¢å ä¼˜å…ˆçº§ä¸‹çš„å¤šä¸ªä¸­æ–­ä¹‹é—´çš„è°ƒåº¦ï¼Œæ•°å€¼è¶Šä½ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li><li>**<code>NVIC_IRQChannelCmd</code>**ï¼šä½¿èƒ½æˆ–ç¦ç”¨ä¸­æ–­é€šé“ï¼š<ul><li><code>ENABLE</code>ï¼šä½¿èƒ½ä¸­æ–­é€šé“ã€‚</li><li><code>DISABLE</code>ï¼šç¦ç”¨ä¸­æ–­é€šé“ã€‚</li></ul></li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹ï¼š-2"><a href="#ä½¿ç”¨ç¤ºä¾‹ï¼š-2" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹ï¼š"></a>ä½¿ç”¨ç¤ºä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line"></span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn;                   // é…ç½® EXTI Line0 ä¸­æ–­</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0x01;        // æŠ¢å ä¼˜å…ˆçº§ 1</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0x01;               // å“åº”ä¼˜å…ˆçº§ 1</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;                     // ä½¿èƒ½ä¸­æ–­</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);                                     // åˆå§‹åŒ– NVIC</span><br></pre></td></tr></table></figure><hr><h3 id="ç»¼åˆç¤ºä¾‹ï¼šå¤–éƒ¨ä¸­æ–­é…ç½®"><a href="#ç»¼åˆç¤ºä¾‹ï¼šå¤–éƒ¨ä¸­æ–­é…ç½®" class="headerlink" title="ç»¼åˆç¤ºä¾‹ï¼šå¤–éƒ¨ä¸­æ–­é…ç½®"></a>ç»¼åˆç¤ºä¾‹ï¼šå¤–éƒ¨ä¸­æ–­é…ç½®</h3><p>å‡è®¾æˆ‘ä»¬è¦é…ç½®ä¸€ä¸ªæŒ‰é”®ä¸­æ–­ï¼ŒæŒ‰ä¸‹æŒ‰é”®æ—¶é€šè¿‡ EXTI è§¦å‘ PA0 å¼•è„šçš„ä¸­æ–­ï¼Œä»¥ä¸‹æ˜¯å®Œæ•´çš„é…ç½®æµç¨‹ï¼š</p><ol><li><strong>é…ç½® GPIO å¼•è„šä¸ºè¾“å…¥æ¨¡å¼</strong>ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);</span><br><span class="line"></span><br><span class="line">GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;            // é…ç½® PA0</span><br><span class="line">GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;         // è¾“å…¥æ¨¡å¼</span><br><span class="line">GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;     // æ— ä¸Šæ‹‰/ä¸‹æ‹‰</span><br><span class="line">GPIO_Init(GPIOA, &amp;GPIO_InitStructure);</span><br></pre></td></tr></table></figure><ol><li><strong>é…ç½® EXTI</strong>ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">EXTI_InitTypeDef EXTI_InitStructure;</span><br><span class="line"></span><br><span class="line">RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);</span><br><span class="line">SYSCFG_EXTILineConfig(EXTI_PortSourceGPIOA, EXTI_PinSource0);  // é…ç½® EXTI Line0 å¯¹åº” PA0</span><br><span class="line"></span><br><span class="line">EXTI_InitStructure.EXTI_Line = EXTI_Line0;                    // é…ç½® EXTI Line0</span><br><span class="line">EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;           // ä¸­æ–­æ¨¡å¼</span><br><span class="line">EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;        // ä¸Šå‡æ²¿è§¦å‘</span><br><span class="line">EXTI_InitStructure.EXTI_LineCmd = ENABLE;                     // ä½¿èƒ½ EXTI Line0</span><br><span class="line">EXTI_Init(&amp;EXTI_InitStructure);</span><br></pre></td></tr></table></figure><ol><li><strong>é…ç½® NVIC</strong>ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NVIC_InitTypeDef NVIC_InitStructure;</span><br><span class="line"></span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn;               // é…ç½® EXTI0 ä¸­æ–­</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0x00;   // æŠ¢å ä¼˜å…ˆçº§ 0</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0x00;          // å“åº”ä¼˜å…ˆçº§ 0</span><br><span class="line">NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;                // ä½¿èƒ½ä¸­æ–­</span><br><span class="line">NVIC_Init(&amp;NVIC_InitStructure);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ˆå’Œé˜Ÿåˆ—</title>
      <link href="/2024/09/23/%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97/"/>
      <url>/2024/09/23/%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<h4 id="æ ˆçš„é¡ºåºå­˜å‚¨å®ç°"><a href="#æ ˆçš„é¡ºåºå­˜å‚¨å®ç°" class="headerlink" title="æ ˆçš„é¡ºåºå­˜å‚¨å®ç°"></a>æ ˆçš„é¡ºåºå­˜å‚¨å®ç°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> STACK_INIT_SIZE 80</span></span><br><span class="line">#DEFINE STACK_INCREMENT <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    elemtype *base;</span><br><span class="line">    elemtype *top;</span><br><span class="line">    <span class="type">int</span> stacksize;<span class="comment">//æ ˆé•¿åº¦ï¼ˆæœ‰å¤šå°‘å…ƒç´ ï¼‰ï¼Œä¸æ˜¯sizeof</span></span><br><span class="line">&#125;SqStack;</span><br><span class="line"></span><br><span class="line">Sqstack s;</span><br><span class="line"></span><br><span class="line">Status <span class="title function_">StackInit</span> <span class="params">(Sqstack *s)</span> <span class="comment">//ä¼ å…¥ç»“æ„ä½“æŒ‡é’ˆå˜é‡</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!(s-&gt;base = (elemtype*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(elemtype)*STACK_INIT_SIZE)))</span><br><span class="line">        <span class="comment">//å¯¹äºçº¿æ€§è¡¨ï¼Œåˆ†é…å†…å­˜ç©ºé—´æ˜¯ç»™Lç›´æ¥åˆ†é…ï¼Œå› ä¸ºLè‡ªèº«çš„å«ä¹‰å°±æ˜¯å¤´æŒ‡é’ˆçš„åœ°å€ï¼Œå¹¶ä¸”çº¿æ€§è¡¨æ˜¯å¤šä¸ªç»“æ„ä½“æŒ‡é’ˆå˜é‡è¿èµ·æ¥çš„ï¼Œè€Œå¯¹äºé¡ºåºæ ˆæ¥è¯´ï¼Œä»–åªæœ‰ä¸€ä¸ªæ­£å¸¸çš„ç»“æ„ä½“ï¼Œç»“æ„ä½“é‡Œé¢æ‰åŒ…å«å¤´å°¾æŒ‡é’ˆï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åœ¨è¿™ä¸ªç»“æ„ä½“å†…éƒ¨ï¼Œä½¿ç”¨è¿™ä¸€ä¸ªç»“æ„ä½“çš„æˆå‘˜å˜é‡å®Œæˆçš„</span></span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">    s-&gt;top = s-&gt;base;</span><br><span class="line">    <span class="keyword">return</span> OK;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é¡ºåºæ ˆçš„ä½¿ç”¨"><a href="#é¡ºåºæ ˆçš„ä½¿ç”¨" class="headerlink" title="é¡ºåºæ ˆçš„ä½¿ç”¨"></a>é¡ºåºæ ˆçš„ä½¿ç”¨</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…¥æ ˆ</span></span><br><span class="line">Status <span class="title function_">Push</span><span class="params">(Sqstack *s, elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼Œå…ˆå¤„ç†ä¸€ä¸‹æ ˆå®¹é‡å¤Ÿä¸å¤Ÿçš„é—®é¢˜</span></span><br><span class="line">    <span class="keyword">if</span>(s-&gt;top-s-&gt;base &gt;= s-&gt;stacksize )<span class="comment">//cè¯­è¨€æŒ‡é’ˆçš„è¿ç®—ï¼Œå‡å‡ºæ¥ç»“æœç­‰äºsizeof(elemtype)</span></span><br><span class="line">    &#123;</span><br><span class="line">        s-&gt;base = (elemtype*)<span class="built_in">realloc</span>(s-&gt;base,(stacksize+STACK_INCREMENT)*<span class="keyword">sizeof</span>(elemtype));</span><br><span class="line">        <span class="keyword">if</span>(!(s-&gt;base))</span><br><span class="line">            <span class="keyword">return</span> ERROR;</span><br><span class="line">        s-&gt;top = s-&gt;base + s-&gt;stacksize;</span><br><span class="line">        s-&gt;stacksize += STACK_INCREMENT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å…¥æ ˆ</span></span><br><span class="line">    *(s-&gt;top) = e;  <span class="comment">//æ­£ç¡®çš„è§£å¼•ç”¨æ–¹å¼ï¼Œä¸è¦æŠŠå®ƒå†™æˆ   s-&gt; *top  ,è¿™ä¸æ˜¯æ­£ç¡®çš„è§£å¼•ç”¨æ–¹å¼</span></span><br><span class="line">    s -&gt; top++;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡ºæ ˆ</span></span><br><span class="line">Status <span class="title function_">Pop</span><span class="params">(Sqstack *s, elemtype*e)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼Œå…ˆåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span>(s-&gt;base == s-&gt;top)</span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    <span class="comment">//å‡ºæ ˆ</span></span><br><span class="line">    *e = *(--(s -&gt; top));  <span class="comment">//åŒæ ·çš„ï¼Œå¯¹topè¿›è¡Œæ“ä½œï¼Œç°åœ¨å‰é¢åŠ ä¸Šs-&gt;,è€Œä¸æ˜¯å†™æˆ  s-&gt; --top</span></span><br><span class="line">   *(s-&gt;top) = <span class="number">0</span>; <span class="comment">//è¿™ä¸€æ­¥å¯ä»¥çœç•¥</span></span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é“¾æ ˆçš„å®ç°"><a href="#é“¾æ ˆçš„å®ç°" class="headerlink" title="é“¾æ ˆçš„å®ç°"></a>é“¾æ ˆçš„å®ç°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">SNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    elemtype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">SNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;SNode,*LinkStack;</span><br><span class="line"></span><br><span class="line"><span class="comment">//init</span></span><br><span class="line">LinkStack s;</span><br><span class="line"></span><br><span class="line">Status <span class="title function_">LinkStackInit</span> <span class="params">(LinkStack *s)</span> <span class="comment">//å¦‚æœä½¿ç”¨&amp;sï¼Œåˆ™å‡½æ•°å†…å¯ä»¥ç›´æ¥ä½¿ç”¨sï¼Œ</span></span><br><span class="line">     <span class="comment">//ä¸ç”¨åŠ *å·ï¼Œä½¿ç”¨æŒ‡é’ˆçš„è¯åˆ™å¿…é¡»åŠ ä¸Š*å·</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!(*s = (SNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(SNode))))</span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    ï¼ˆ*sï¼‰ -&gt; next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é“¾æ ˆçš„åŸºæœ¬ä½¿ç”¨"><a href="#é“¾æ ˆçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="é“¾æ ˆçš„åŸºæœ¬ä½¿ç”¨"></a>é“¾æ ˆçš„åŸºæœ¬ä½¿ç”¨</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…¥æ ˆ</span></span><br><span class="line">Status <span class="title function_">Push</span><span class="params">(LinkStack *s, elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    SNode* p;</span><br><span class="line">    <span class="keyword">if</span>(!(p=(SNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(SNode))))</span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    p-&gt;next = *s;</span><br><span class="line">    p-&gt;data = e;</span><br><span class="line">    *s = p;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡ºæ ˆ</span></span><br><span class="line">Status <span class="title function_">Pop</span><span class="params">(LinkStack *s, elemtype *e)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(*s == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> EMPTY;</span><br><span class="line">    *e = (*s)-&gt;data;</span><br><span class="line">    LinkStack p = *s;</span><br><span class="line">    *s = (*s)-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> OK;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ ˆçš„åº”ç”¨ä¸¾ä¾‹"><a href="#æ ˆçš„åº”ç”¨ä¸¾ä¾‹" class="headerlink" title="æ ˆçš„åº”ç”¨ä¸¾ä¾‹"></a>æ ˆçš„åº”ç”¨ä¸¾ä¾‹</h4><h5 id="æ•°åˆ¶è½¬æ¢"><a href="#æ•°åˆ¶è½¬æ¢" class="headerlink" title="æ•°åˆ¶è½¬æ¢"></a>æ•°åˆ¶è½¬æ¢</h5><p>æ•°å€¼è½¬æ¢çš„æ€è·¯éƒ½æ˜¯æŠŠä¸€ä¸ªæ•°ä¸æ–­é™¤ä»¥è¿›åˆ¶nï¼Œ<strong>ä»æ™šåˆ°æ—©</strong> çš„ä½™æ•°æ’åˆ—å°±æ˜¯  <strong>ä»é«˜åˆ°ä½</strong> çš„æ–°æ•°ä½</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240924203654511.png" alt="image-20240924203654511"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a; <span class="comment">//è¿›åˆ¶</span></span><br><span class="line">    <span class="type">int</span> num; <span class="comment">//æ•°å­—</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">        </span><br><span class="line">    LinkStack s = <span class="literal">NULL</span>; <span class="comment">//åˆå§‹åŒ–æ ˆé¡¶æŒ‡é’ˆè¦è®©ä»–ä¸ºNULL</span></span><br><span class="line">    <span class="keyword">while</span>(num &gt; <span class="number">0</span>)  <span class="comment">//å¦‚æœè¿™ä¸ªåœ°æ–¹ç”¨ num%a!=0 ä½œä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œæœ‰å¯èƒ½å›å¯¼è‡´æœ€åä¸€æ¬¡åˆ¤æ–­å¤±è¯¯ï¼ˆå¦‚æœæ­£å¥½é™¤å°½ï¼‰</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> b = num%a;</span><br><span class="line">        num /= a;</span><br><span class="line">        Push(&amp;s,b);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">while</span>(s != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> temp;</span><br><span class="line">        pop(&amp;s,&amp;temp);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,temp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="æ‹¬å·åŒ¹é…çš„æ£€éªŒ"><a href="#æ‹¬å·åŒ¹é…çš„æ£€éªŒ" class="headerlink" title="æ‹¬å·åŒ¹é…çš„æ£€éªŒ"></a>æ‹¬å·åŒ¹é…çš„æ£€éªŒ</h5><p>è®¾è®¡ç®—æ³•æ£€éªŒè¡¨è¾¾å¼ä¸­æ‰€ä½¿ç”¨æ‹¬å·çš„åˆæ³•æ€§</p><p>æ€è·¯ï¼šæ‹¬å·çš„åˆæ³•ï¼ŒæŒ‡çš„å°±æ˜¯  å·¦å³æˆå¯¹å‡ºç°ï¼Œä¹Ÿå°±æ˜¯</p><p>ä¸€ç›´å…¥æ ˆï¼Œå¦‚æœä¸Šä¸€ä¸ªå·¦æ‹¬å·å’Œä¸‹ä¸€ä¸ªå³æ‹¬å·åŒ¹é…ï¼Œåˆ™äºŒè€…å‡ºæ ˆï¼Œçœ‹æœ€åèƒ½ä¸èƒ½å‡ºå®Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">SNode</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="type">char</span> c;</span><br><span class="line">&#125;SNode,*LinkStack;</span><br><span class="line">pop(LinkStack *s,<span class="type">char</span>*e); <span class="comment">//å‡ºæ ˆ</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(*s == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> EMPTY;</span><br><span class="line">    *e = (*s)-&gt;data;</span><br><span class="line">    LinkStack p = *s;</span><br><span class="line">    *s = (*s)-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> OK;  </span><br><span class="line">&#125;</span><br><span class="line">push(LinkStack *s); <span class="comment">//å…¥æ ˆ</span></span><br><span class="line">&#123;</span><br><span class="line">    SNode* p;</span><br><span class="line">    <span class="keyword">if</span>(!(p=(SNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(SNode))))</span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    p-&gt;next = *s;</span><br><span class="line">    p-&gt;data = e;</span><br><span class="line">    *s = p;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line">getelem(LinkStack s); <span class="comment">//è¯»å–å½“å‰æ ˆé¡¶å…ƒç´ ï¼Œä½†æ˜¯ä¸å–å‡º</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">50</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line">    <span class="type">int</span> i =<span class="number">0</span>;</span><br><span class="line">    LinkStack s = <span class="literal">NULL</span>;<span class="comment">//åˆå§‹åŒ–ä¸ºç©ºï¼Œåˆ‡è®°</span></span><br><span class="line">    <span class="keyword">while</span>(str[i]!=<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] == <span class="string">&#x27;(&#x27;</span> || str[i] ==<span class="string">&#x27;[&#x27;</span> || str[i] == <span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            push(&amp;s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">&#x27;)&#x27;</span> || str[i] ==<span class="string">&#x27;]&#x27;</span> || str[i] == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i] == <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">char</span> c;</span><br><span class="line">                getelem(s,&amp;c);</span><br><span class="line">                <span class="keyword">if</span>(c == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">                    pop(&amp;s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">char</span> c;</span><br><span class="line">                getelem(s,&amp;c);</span><br><span class="line">                <span class="keyword">if</span>(c == <span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">                    pop(&amp;s);</span><br><span class="line">            &#125;            </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(str[i] == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">char</span> c;</span><br><span class="line">                getelem(s,&amp;c);</span><br><span class="line">                <span class="keyword">if</span>(c == <span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">                    pop(&amp;s);</span><br><span class="line">            &#125;            </span><br><span class="line">&#125;</span><br><span class="line">        i++;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span>(isEmpty(s))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;CORRECT&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;SOMETHING WENT WRONG&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿·å®«é—®é¢˜</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240925155124181.png" alt="image-20240925155124181"></p><p>æ€è·¯ï¼š</p><ol><li>å…ˆç¡®å®šä¸€ä¸ªé¡ºåºï¼ˆå¦‚ï¼Œå¯¹äºä¸€ä¸ªå…ƒç´ è€Œè¨€ï¼Œåœ¨å…¶å‘¨å›´éå†çš„é¡ºåºæ˜¯ä»å³ä¸Šè§’å¼€å§‹ï¼Œé¡ºæ—¶é’ˆï¼‰</li><li>å»ºç«‹ä¸€ä¸ªæ ˆï¼Œè¿™ä¸ªæ ˆç”¨æ¥å­˜æ”¾å½“å‰åæ ‡ä¿¡æ¯ï¼Œå¯¹äºä¸€ä¸ªå…ƒç´ è€Œè¨€ï¼Œæ‰¾åˆ°ä¸€ä¸ª0ï¼Œå°±æŠŠè¿™ä¸ª0å…¥æ ˆï¼Œç„¶åæŠŠè¿™ä¸ª0 å½“ä½œå½“å‰çš„ä¸­å¿ƒï¼ŒåŒæ—¶æŠŠä¸Šä¸€ä¸ª0æ ‡è®°æˆ-1ï¼Œä»£è¡¨å‡ºå£ä¸èƒ½ä»ä»–è¿™æ‰¾</li><li>å¦‚æœå½“å‰çš„0å‘¨å›´æ²¡æœ‰æ‰¾åˆ°å‡ºå£ï¼Œé‚£ä¹ˆé€€æ ˆï¼Œé‡æ–°ä»¥ä¸Šä¸€ä¸ª0ä¸ºä¸­å¿ƒç»§ç»­æ‰¾å‘¨å›´ä¸‹ä¸€ä¸ª0è¿›è¡Œå°è¯•ï¼Œå¦‚æœä¸€åœˆéƒ½ä¸è¡Œï¼ŒæŠŠè¿™ä¸ªä¹Ÿé€€æ ˆï¼Œä»¥æ­¤ç±»æ¨</li><li>ä¸ºäº†è®©è¿™ä¸ªç®—æ³•èƒ½å¤Ÿé€‚ç”¨äºè¿·å®«é˜µçš„è§’è§’è½è½ï¼ŒæŠŠå‘¨å›´ä¸€åœˆè¡¥ä¸Š1</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> STACK_INIT_SIZE 80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STACK_INCREASMENT 10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROW 7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> COL 8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> Stack[STACK_INIT_SIZE][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> *base;</span><br><span class="line">    <span class="type">int</span> *top;</span><br><span class="line">&#125;SNode;</span><br><span class="line"></span><br><span class="line">SNode s;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰è¿·å®«æ•°ç»„</span></span><br><span class="line"><span class="type">int</span> maze[ROW][COL] = &#123;</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;,  </span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> maze_after[ROW+<span class="number">2</span>][COL+<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">maze_increase</span><span class="params">(<span class="type">int</span>(*maze)[COL], <span class="type">int</span>(*maze_after)[COL+<span class="number">2</span>])</span><span class="comment">//ç”¨æŒ‡é’ˆä¼ é€’äºŒç»´æ•°ç»„çš„æ–¹æ³•</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= (ROW + <span class="number">1</span>); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= (COL + <span class="number">1</span>); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> || i == (ROW + <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                maze_after[i][j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (j == <span class="number">0</span> || j == (COL + <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                maze_after[i][j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                maze_after[i][j] = maze[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//test</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ROW+<span class="number">1</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= COL+<span class="number">1</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, maze_after[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç°åœ¨ï¼Œmaze_afterå·²ç»æ˜¯ä¿®æ­£ä»¥åçš„è¿·å®«äº†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹é¢æ˜¯è¿·å®«å…·ä½“ç®—æ³•</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">check</span><span class="params">(SNode s, <span class="type">int</span>(*maze_after)[COL + <span class="number">2</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">1</span>; <span class="comment">//æ ‡è®°è¡Œä½ç½®</span></span><br><span class="line">    <span class="type">int</span> y = <span class="number">1</span>; <span class="comment">//æ ‡è®°åˆ—ä½ç½®</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>; <span class="comment">//æ ‡è®°æ ˆå…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    s.Stack[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">//æ ˆåˆå§‹åŒ–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆèµ·ç‚¹è¡Œï¼‰</span></span><br><span class="line">    s.Stack[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;<span class="comment">//ï¼ˆèµ·ç‚¹åˆ—ï¼‰</span></span><br><span class="line">    maze_after[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">-1</span>; <span class="comment">//æ ‡è®°èµ·ç‚¹ä½ç½®ä¸ºèµ°è¿‡çš„</span></span><br><span class="line">    <span class="keyword">while</span> (s.Stack[<span class="number">0</span>][<span class="number">0</span>] != <span class="number">0</span>) <span class="comment">//åªè¦åˆ«æ²¡æœ‰è·¯ï¼Œå¯¼è‡´æŠŠèµ·ç‚¹ç»™é€€æ ˆäº†ï¼Œå°±ä¸€ç›´å¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (s.Stack[i - <span class="number">1</span>][<span class="number">0</span>] == ROW &amp;&amp; s.Stack[i - <span class="number">1</span>][<span class="number">1</span>] == COL) <span class="comment">//æ ˆèµ°åˆ°ç»ˆç‚¹äº†</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ‰¾åˆ°ä¸€æ¡\n&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> n = <span class="number">0</span>; n &lt;= i; n++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>, s.Stack[n][<span class="number">0</span>], s.Stack[n][<span class="number">1</span>]); <span class="comment">//è¾“å‡ºæ ˆ</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (maze_after[x][y] == <span class="number">0</span> || maze_after[x][y] == <span class="number">-1</span>) <span class="comment">//å½“å‰çš„å…ƒç´ è‡ªèº«æ˜¯é€šè·¯</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å½“å‰ä»¥x=%d,y=%dä¸ºä¸­å¿ƒ\n&quot;</span>,x, y);</span><br><span class="line">            maze_after[x][y] = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span> (maze_after[x - <span class="number">1</span>][y + <span class="number">1</span>] == <span class="number">0</span>)  <span class="comment">//å¦‚æœå³ä¸Šæ–¹çš„æ˜¯é€šè·¯ï¼Œå¼€å§‹å…¥æ ˆ</span></span><br><span class="line">            &#123;</span><br><span class="line">                i++; </span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x - <span class="number">1</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y + <span class="number">1</span>;</span><br><span class="line">                x--;</span><br><span class="line">                y++;</span><br><span class="line">                maze[x - <span class="number">1</span>][y + <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x][y + <span class="number">1</span>] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y + <span class="number">1</span>;</span><br><span class="line">                y++;</span><br><span class="line">                maze[x][y + <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x + <span class="number">1</span>][y + <span class="number">1</span>] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x + <span class="number">1</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y + <span class="number">1</span>;</span><br><span class="line">                x++;</span><br><span class="line">                y++;</span><br><span class="line">                maze[x + <span class="number">1</span>][y + <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x + <span class="number">1</span>][y] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x + <span class="number">1</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y;</span><br><span class="line">                x++;</span><br><span class="line">                maze[x + <span class="number">1</span>][y] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x + <span class="number">1</span>][y - <span class="number">1</span>] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x + <span class="number">1</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y - <span class="number">1</span>;</span><br><span class="line">                x++;</span><br><span class="line">                y--;</span><br><span class="line">                maze[x + <span class="number">1</span>][y - <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x][y - <span class="number">1</span>] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y - <span class="number">1</span>;</span><br><span class="line">                y--;</span><br><span class="line">                maze[x][y - <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (maze_after[x - <span class="number">1</span>][y - <span class="number">1</span>] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = x - <span class="number">1</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = y - <span class="number">1</span>;</span><br><span class="line">                x--;</span><br><span class="line">                y--;</span><br><span class="line">                maze[x - <span class="number">1</span>][y - <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;    x=%d,y=%dè¿›æ ˆäº†\n&quot;</span>, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;x=%d,y=%dé€€æ ˆäº†\n&quot;</span>, x, y);   <span class="comment">//è½¬äº†ä¸€åœˆæ²¡é€šè·¯ï¼ŒæŠŠå½“å‰çš„ç»™é€€æ ˆ</span></span><br><span class="line">                s.Stack[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">                s.Stack[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">                maze_after[x][y] = <span class="number">-1</span>;</span><br><span class="line">                i--;</span><br><span class="line">                x = s.Stack[i][<span class="number">0</span>];</span><br><span class="line">                y = s.Stack[i][<span class="number">1</span>];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;é€€æ ˆå®Œæˆ\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    maze_increase(maze, maze_after);</span><br><span class="line">    check(s, maze_after);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¡¨è¾¾å¼æ±‚å€¼"><a href="#è¡¨è¾¾å¼æ±‚å€¼" class="headerlink" title="è¡¨è¾¾å¼æ±‚å€¼"></a>è¡¨è¾¾å¼æ±‚å€¼</h4><p>è®¾ç½®ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªå­˜å‚¨æ“ä½œæ•°ï¼Œä¸€ä¸ªå­˜å‚¨æ“ä½œç¬¦</p><p>è¿ç®—ç¬¦æ ˆåº•åˆå§‹åŒ–ä¸ºâ€œ#â€ï¼Œä¾¿äºå®šä½æ“ä½œå§‹æœ«ï¼ˆå®é™…ä¸Šæ˜¯æŠŠè¡¨è¾¾å¼å§‹æœ«è®¾ç½®ä¸ºâ€œ#â€ï¼‰</p><p>é‡åˆ°æ•°å­—ï¼Œå…¥æ ˆ</p><p>é‡åˆ°ç¬¦å·ï¼š</p><ol><li>new&gt;top,å…¥æ ˆ</li><li>new&#x3D;top,å»é™¤ä¸€å¯¹æ‹¬å·ï¼Œæˆ–è€…ç»“æŸï¼ˆåªæœ‰  â€œï¼ˆâ€  ï¼Œ â€œï¼‰â€ æˆ–è€…ä¸¤ä¸ªâ€œ#â€ ä¼˜å…ˆçº§ä¸€æ ·ï¼‰</li><li>new&lt;top,å–å‡ºæ•°å­—æ ˆä¸¤ä¸ªå…ƒç´ ï¼Œå’Œæ ˆé¡¶å…ƒç´ ï¼Œè¿›è¡Œè¿ç®—å¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°å­—å­˜å›æ•°å­—æ ˆ</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰æ ˆ</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">char</span> *top_opera;</span><br><span class="line">    <span class="type">char</span> opera[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> opera_length;</span><br><span class="line">&#125;OPERA;</span><br><span class="line">OPERA opera;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="type">int</span>*top_num;</span><br><span class="line">        <span class="type">int</span> num[<span class="number">20</span>];</span><br><span class="line">        <span class="type">int</span> num_length;</span><br><span class="line">    &#125;NUM;</span><br><span class="line">NUM num;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    init_opera(&amp;opera);<span class="comment">//åˆå§‹åŒ–åˆ«å¿˜äº†åŠ &amp;ç¬¦å·</span></span><br><span class="line">    init_num(&amp;num);</span><br><span class="line">    <span class="type">char</span> temp_c = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="type">char</span> c =<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> a =<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> b =<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> exps [<span class="number">50</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªè¡¨è¾¾å¼&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,exps);</span><br><span class="line">    <span class="type">int</span> length = <span class="built_in">strlen</span>(exps);</span><br><span class="line">    <span class="comment">//å¼€å§‹æ“ä½œ</span></span><br><span class="line">    opera.opera[<span class="number">0</span>]=<span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">0</span>;i&lt;length;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//if((((int)exps[i])&gt;=48)&amp;&amp;(((int)exps[i])&lt;=57))</span></span><br><span class="line">        <span class="keyword">if</span>((exps[i]&gt;=<span class="string">&#x27;0&#x27;</span>)&amp;&amp;(exps[i]&lt;=<span class="string">&#x27;9&#x27;</span>)) <span class="comment">//æ›´æ˜“è¯»</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//åº”ä½¿ç”¨push_numä»£æ›¿</span></span><br><span class="line">            *(num.top_num)=exps[i]-<span class="string">&#x27;0&#x27;</span>; <span class="comment">//å­˜ //åˆ‡è®°ï¼Œå…ˆç‚¹å·ï¼Œå†æ˜Ÿå·</span></span><br><span class="line">            num.top_num++;<span class="comment">//ç§»</span></span><br><span class="line">            num.num_length++;<span class="comment">//åŠ </span></span><br><span class="line">            <span class="keyword">if</span>(num.num_length&gt;=<span class="number">20</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//é‡æ–°åˆ†é…å†…å­˜</span></span><br><span class="line">&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>((exps[i]==<span class="string">&#x27;+&#x27;</span>)||(exps[i]==<span class="string">&#x27;-&#x27;</span>)||(exps[i]==<span class="string">&#x27;*&#x27;</span>)||(exps[i]==<span class="string">&#x27;/&#x27;</span>)||(exps[i]==<span class="string">&#x27;(&#x27;</span>)||(exps[i]==<span class="string">&#x27;)&#x27;</span>)||(exps[i]==<span class="string">&#x27;#&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(exps[i]==<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span>(GetTop(num));</span><br><span class="line">            <span class="comment">//ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°compareæ¥æ¯”è¾ƒç¬¦å·ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="keyword">switch</span>(compare(GetTop(opera),exps[i]))</span><br><span class="line">            &#123;</span><br><span class="line">                    <span class="keyword">case</span><span class="number">&#x27;</span>&lt;<span class="string">&#x27;:push_opera(opera,exps[i]);</span></span><br><span class="line"><span class="string">                        break;</span></span><br><span class="line"><span class="string">                    case&#x27;</span>=<span class="string">&#x27;:pop_opera(opera,temp_c);</span></span><br><span class="line"><span class="string">                    pop_opera(opera,temp_c);</span></span><br><span class="line"><span class="string">                    break;</span></span><br><span class="line"><span class="string">                    case&#x27;</span>&gt;<span class="string">&#x27;:pop_num(num,a);</span></span><br><span class="line"><span class="string">                    pop_num(num,b);</span></span><br><span class="line"><span class="string">                    pop_oprea(opera,c);</span></span><br><span class="line"><span class="string">                    push(num,operate(a,c,b));</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            printf(&quot;error input&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    return 0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><h3 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241008212735165.png" alt="image-20241008212735165"></p><p>ç‰¹ç‚¹ï¼šå…ˆè¿›å…ˆå‡ºï¼Œåªå…è®¸åœ¨é˜Ÿå¤´åˆ é™¤ï¼Œåªå…è®¸åœ¨é˜Ÿå°¾æ’å…¥</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241008212911946.png" alt="image-20241008212911946"></p><ul><li>åˆ†æï¼šå‡ºé˜Ÿé¡ºåºå°±æ˜¯å…¥é˜Ÿé¡ºåºï¼Œå³bdcfeaï¼Œä¹Ÿæ˜¯å‡ºæ ˆé¡ºåº ï¼Œå…¥æ ˆé¡ºåºæ˜¯abcdefï¼Œåå…¥å…ˆå‡º</li><li>aå…¥æ ˆï¼Œbå…¥æ ˆï¼Œbå‡ºæ ˆï¼Œcå…¥æ ˆï¼Œdå…¥æ ˆï¼Œdå‡ºæ ˆï¼Œcå‡ºæ ˆï¼Œeï¼Œfå…¥æ ˆï¼Œfeå‡ºæ ˆï¼Œaå‡ºæ ˆï¼Œæœ€å°æ ˆå®¹é‡è‡³å°‘ä¸º3</li></ul><h4 id="é“¾é˜Ÿåˆ—å®ç°"><a href="#é“¾é˜Ÿåˆ—å®ç°" class="headerlink" title="é“¾é˜Ÿåˆ—å®ç°"></a>é“¾é˜Ÿåˆ—å®ç°</h4><p>æ€è€ƒï¼šé“¾æ ˆå’Œé“¾é˜Ÿåˆ—å®šä¹‰ä¸Šçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä»€ä¹ˆé€ æˆäº†åŒºåˆ«ï¼Ÿ</p><ul><li><p>åœ¨å®šä¹‰é“¾æ ˆçš„æ—¶å€™ï¼ŒæŠŠæ ˆç»“ç‚¹ç»“æ„ä½“å®šä¹‰ä¸ºæŒ‡é’ˆç±»å‹ï¼ŒåŒæ—¶ä¸Šä¸€ä¸ªç»“ç‚¹ä¸­åŒ…å«æŒ‡å‘æ–°ç»“ç‚¹çš„æŒ‡é’ˆï¼Œå½¢æˆé“¾ï¼Œæ ˆçš„åå­— sï¼Œæ°¸è¿œæ˜¯æŒ‡å‘æ ˆé¡¶å…ƒç´ çš„æŒ‡é’ˆ</p></li><li><p>åœ¨å®šä¹‰é“¾é˜Ÿåˆ—çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯æŠŠé˜Ÿåˆ—èŠ‚ç‚¹å®šä¹‰ä¸ºæŒ‡é’ˆç±»å‹ï¼Œä¸Šä¸€ä¸ªèŠ‚ç‚¹åŒ…å«æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œé˜Ÿåˆ—çš„åå­—Qæ— æ„ä¹‰ï¼Œè€Œæ˜¯è¦è¯»å–Q.front å’ŒQ.rear æ¥åˆ¤æ–­é˜Ÿåˆ—å¤´å°¾æŒ‡é’ˆ</p></li><li><p>é€ æˆåŒºåˆ«çš„åŸå› ï¼š</p><p><strong>æ ˆåªéœ€è¦å§‹ç»ˆæ‰¾æ ˆé¡¶å…ƒç´ å³å¯ï¼Œå› æ­¤æ ˆåå°±æ˜¯æŒ‡å‘æ ˆé¡¶å…ƒç´ çš„æŒ‡é’ˆ</strong>ï¼Œè€Œé˜Ÿåˆ—è¦æœ‰å¤´æœ‰å°¾ï¼Œå¤´å‡ºå°¾è¿›ï¼Œå› æ­¤æ–°å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ¥è¡¨ç¤º</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ˆé˜Ÿåˆ—ç»“ç‚¹ç±»å‹å®šä¹‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Qnode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    QElemType data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">QNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;QNode,*QueuePtr</span><br><span class="line">    </span><br><span class="line"><span class="comment">//æ ˆé˜Ÿåˆ—å®ç°</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    QueuePtr front; <span class="comment">//é˜Ÿå¤´æŒ‡é’ˆ</span></span><br><span class="line">    QueuePtr rear; <span class="comment">//é˜Ÿå°¾æŒ‡é’ˆ</span></span><br><span class="line">&#125;LinkQueue;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20241008224155300.png" alt="image-20241008224155300"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¸¦å¤´ç»“ç‚¹çš„é˜Ÿåˆ—å§‹åŒ–</span></span><br><span class="line">LinkQueue Q;</span><br><span class="line">Q.front = <span class="literal">NULL</span>;</span><br><span class="line">Q.rear = <span class="literal">NULL</span>;</span><br><span class="line">Status <span class="title function_">InitQueue</span> <span class="params">(LinkQueue *Q)</span> <span class="comment">//ä¼ å…¥è¦åˆå§‹åŒ–çš„é˜Ÿåˆ—</span></span><br><span class="line">&#123;</span><br><span class="line">    QueuePtr q1; <span class="comment">//ä¸€ä¸ªtempä¸´æ—¶q1</span></span><br><span class="line">    <span class="keyword">if</span>(!(q1 = (QNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(QNode)))) <span class="comment">//åˆ†é…å†…å­˜</span></span><br><span class="line">    <span class="keyword">return</span> error;</span><br><span class="line">    q1-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    Q-&gt;front = q1;</span><br><span class="line">    Q-&gt;rear = q1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¸¦å¤´ç»“ç‚¹çš„é˜Ÿåˆ—æ’å…¥ç®—æ³•</span></span><br><span class="line">Status <span class="title function_">QueueInsert</span> <span class="params">(LinkQueue *Q,elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    QueuePtr q1;</span><br><span class="line">    <span class="keyword">if</span>(!(q1=(*QNode)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(QNode))))</span><br><span class="line">        <span class="built_in">exit</span>(OVERFLOW);</span><br><span class="line">    q1-&gt;data = e;</span><br><span class="line">    </span><br><span class="line">    Q.rear-&gt;next =q1;</span><br><span class="line">    Q.rear=q1;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡ºé˜Ÿ</span></span><br><span class="line">Status <span class="title function_">DelQueue</span><span class="params">(LinkQueue *Q,elemtype *e)</span></span><br><span class="line">&#123;</span><br><span class="line">    QueuePtr q1;</span><br><span class="line">    q1=Q.front-&gt;next;</span><br><span class="line">    *e = *(q1.data); <span class="comment">//å“ˆå“ˆ</span></span><br><span class="line">    Q.front = q1-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(q1);</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯é˜Ÿåˆ—"><a href="#å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—"></a>å¾ªç¯é˜Ÿåˆ—</h3><h4 id="åˆå§‹åŒ–å¾ªç¯é˜Ÿåˆ—"><a href="#åˆå§‹åŒ–å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="åˆå§‹åŒ–å¾ªç¯é˜Ÿåˆ—"></a>åˆå§‹åŒ–å¾ªç¯é˜Ÿåˆ—</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹åŒ–å¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    elemtype <span class="built_in">queue</span> [];<span class="comment">//QElemType *base;</span></span><br><span class="line">    <span class="type">int</span> front;</span><br><span class="line">    <span class="type">int</span> rear;</span><br><span class="line">    <span class="comment">// elemtype *front;   //è¯¯åŒºï¼šå¤´å°¾æŒ‡é’ˆï¼Œç©¶å…¶ä½œç”¨è¿˜æ˜¯â€œæŒ‡å‘â€</span></span><br><span class="line">    <span class="comment">//elemtype *rear;  //ä¸ä¸€å®šéè¦æ˜¯æŒ‡é’ˆç±»å‹ï¼Œå¯¹äºç”±æ•°ç»„å®ç°çš„æ•°æ®ç»“æ„</span></span><br><span class="line">    <span class="comment">//æ•´å‹æ•°å­—çš„æŒ‡å‘åŠŸèƒ½åè€Œæ›´å¥½</span></span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">&#125;Queue;</span><br><span class="line"></span><br><span class="line">Queue Q;</span><br><span class="line"></span><br><span class="line">Status <span class="title function_">InitQueueCurl</span><span class="params">(Queue *q)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!((q-&gt;<span class="built_in">queue</span>)=(elemtype*)<span class="built_in">malloc</span>(MAXSIZE*<span class="keyword">sizeof</span>(elemtype))))</span><br><span class="line">        <span class="built_in">exit</span> (OVERFLOW);</span><br><span class="line">    (*q).front = <span class="number">0</span>;</span><br><span class="line">    (*q).rear = <span class="number">0</span>;</span><br><span class="line">    (*q).count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯é˜Ÿåˆ—-å…¥é˜Ÿçš„ä¸¤ç§æ€è·¯"><a href="#å¾ªç¯é˜Ÿåˆ—-å…¥é˜Ÿçš„ä¸¤ç§æ€è·¯" class="headerlink" title="å¾ªç¯é˜Ÿåˆ— å…¥é˜Ÿçš„ä¸¤ç§æ€è·¯"></a>å¾ªç¯é˜Ÿåˆ— å…¥é˜Ÿçš„ä¸¤ç§æ€è·¯</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…¥å¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•ä¸€ï¼šcountæ³•</span></span><br><span class="line">Status <span class="title function_">QueueInsert</span><span class="params">(Queue *q,elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((*q).count!=MAXSIZE)</span><br><span class="line">    &#123;</span><br><span class="line">        (*q).<span class="built_in">queue</span>[(*q).rear]=e;</span><br><span class="line"><span class="keyword">if</span>((*q).rear = MAXSIZE)  </span><br><span class="line">        &#123;</span><br><span class="line">            (*q).rear = <span class="number">0</span>;</span><br><span class="line">            (*q).count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            (*q).rear++;</span><br><span class="line">            (*q).count++;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•äºŒï¼šæ•´é™¤åˆ¤æ–­æ³•</span></span><br><span class="line">Status <span class="title function_">QueneInsert</span><span class="params">(Queue *q,elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>((((*q).rear)+<span class="number">1</span>)%MAXSIZE == (*q).front)</span><br><span class="line">        <span class="comment">//å°¾æŒ‡é’ˆåŠ 1ï¼Œå–ä½™æœ€å¤§é•¿åº¦ï¼Œæ˜¯å¦ç­‰äºå¤´æŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    (*q).<span class="built_in">queue</span>[(*q).rear]=e;</span><br><span class="line">    (*q).rear = ((*q).rear+<span class="number">1</span>)%MAXSIZE;<span class="comment">//å°¾æŒ‡é’ˆåŠ ä¸€ï¼Œå–ä½™æœ€å¤§é•¿åº¦ï¼ˆå°äºæœ€å¤§é•¿åº¦</span></span><br><span class="line">    <span class="comment">//å°±ç›¸å½“äºæ²¡å–ä½™ï¼Œå¤§äºæœ€å¤§é•¿åº¦äº†å°±ç›¸å½“äºå†æ¥ä¸€è½®ï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯é˜Ÿåˆ—é•¿åº¦æ±‚æ³•"><a href="#å¾ªç¯é˜Ÿåˆ—é•¿åº¦æ±‚æ³•" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—é•¿åº¦æ±‚æ³•"></a>å¾ªç¯é˜Ÿåˆ—é•¿åº¦æ±‚æ³•</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ±‚å¾ªç¯é˜Ÿåˆ—é•¿åº¦çš„ç®—æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">ququelenth</span><span class="params">(Queue q)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> answer = (q.rear-q.front+MAXSIZE)%MAXSIZE; <span class="comment">//  rear - fount è¡¨ç¤ºä¸¤è€…è·ç¦»ä¹‹å·®ï¼ŒåŠ ä¸Šmaxsizeä¸€å®šä¸ºæ­£æ•°ï¼Œå†å–ä½™</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿™é‡Œä¹Ÿæä¾›äº† ç¯å½¢ç»“æ„ æ±‚ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„è·ç¦»ï¼ŒåŠ ç»å¯¹å€¼æ—¶å€™çš„ä¸€ç§ç®—æ³•æ€è·¯ï¼Œå°±æ˜¯å…ˆå‡å‡ºä¸€ä¸ªç¬¦å·ä¸å®šçš„è·ç¦»ï¼Œç„¶ååŠ ä¸Šæœ€å¤§é•¿åº¦ï¼Œå†å–ä½™æœ€å¤§é•¿åº¦</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯é˜Ÿåˆ—åº”ç”¨ä¹‹å›æ–‡æ•°"><a href="#å¾ªç¯é˜Ÿåˆ—åº”ç”¨ä¹‹å›æ–‡æ•°" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—åº”ç”¨ä¹‹å›æ–‡æ•°"></a>å¾ªç¯é˜Ÿåˆ—åº”ç”¨ä¹‹å›æ–‡æ•°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡½æ•°å‚æ•°ä¸­æœ‰é“¾è¡¨æ—¶ï¼Œå¯¹&amp;ç¬¦å·çš„ç†è§£ä¸è®¨è®º</title>
      <link href="/2024/09/22/%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E4%B8%AD%E6%9C%89%E9%93%BE%E8%A1%A8%E6%97%B6%EF%BC%8C%E5%AF%B9&amp;%E7%AC%A6%E5%8F%B7%E7%9A%84%E7%90%86%E8%A7%A3%E4%B8%8E%E8%AE%A8%E8%AE%BA/"/>
      <url>/2024/09/22/%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E4%B8%AD%E6%9C%89%E9%93%BE%E8%A1%A8%E6%97%B6%EF%BC%8C%E5%AF%B9&amp;%E7%AC%A6%E5%8F%B7%E7%9A%84%E7%90%86%E8%A7%A3%E4%B8%8E%E8%AE%A8%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å…ˆè¯´ç»“è®ºï¼š"><a href="#å…ˆè¯´ç»“è®ºï¼š" class="headerlink" title="å…ˆè¯´ç»“è®ºï¼š"></a>å…ˆè¯´ç»“è®ºï¼š</h2><p>Lå’Œ å‰¯æœ¬L <strong>æœ¬èº«çš„åœ°å€æ˜¯ä¸€ä¸ªå­˜å‚¨è‡ªèº«çš„åœ°æ–¹ï¼ŒäºŒè€…ä¸åŒ</strong>ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªå˜é‡<strong>æ‰€å‚¨å­˜çš„åœ°å€éƒ½æ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹</strong>ï¼Œ</p><p>å› æ­¤å¯ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹å‰¯æœ¬l-&gt;nextæ¥ä¿®æ”¹åŸlå¤´èŠ‚ç‚¹çš„æŒ‡å‘ï¼Œ</p><p>ä½†æ˜¯å¦‚æœæƒ³è¦æ”¹å˜å¤´èŠ‚ç‚¹è‡ªèº«çš„åœ°å€ï¼Œå¦‚æœä¸åŠ &amp;ç¬¦å·ï¼Œé‚£å°±ç›¸å½“äºä¿®æ”¹äº†å‰¯æœ¬læ‰€å‚¨å­˜çš„åœ°å€ï¼ŒåŸlä¸å—å½±å“</p><p>å…³é”®ç‚¹ï¼šä¸è¦é”™è¯¯çš„ä»¥ä¸º å‡½æ•°ä¸­çš„l-&gt;next æ˜¯ç”±å‰¯æœ¬lè®°å½•çš„ï¼Œå®é™…ä¸Šè¿™ä¸ªæ˜¯ç”±å¤´ç»“ç‚¹è®°å½•çš„ï¼Œ<strong>å‰¯æœ¬læŒ‡å‘çš„åœ°å€å®é™…ä¸Šæ˜¯è®°å½•äº†å¤´ç»“ç‚¹çš„åœ°å€</strong></p><h3 id="L-å’Œå‰¯æœ¬-L-æœ¬èº«æ˜¯å­˜å‚¨åœ°å€çš„å˜é‡ï¼š"><a href="#L-å’Œå‰¯æœ¬-L-æœ¬èº«æ˜¯å­˜å‚¨åœ°å€çš„å˜é‡ï¼š" class="headerlink" title="L å’Œå‰¯æœ¬ L æœ¬èº«æ˜¯å­˜å‚¨åœ°å€çš„å˜é‡ï¼š"></a><strong><code>L</code> å’Œå‰¯æœ¬ <code>L</code> æœ¬èº«æ˜¯å­˜å‚¨åœ°å€çš„å˜é‡</strong>ï¼š</h3><ul><li><code>L</code> å’Œå®ƒçš„å‰¯æœ¬ <code>L</code> æ˜¯ä¸¤ä¸ªä¸åŒçš„æŒ‡é’ˆå˜é‡ï¼Œ<strong>å®ƒä»¬æœ¬èº«ï¼ˆå³ <code>L</code> å’Œå‰¯æœ¬ <code>L</code>ï¼‰å­˜åœ¨äºä¸åŒçš„å†…å­˜åœ°å€ä¸­</strong>ã€‚</li><li>ä½†æ˜¯ï¼Œ<strong>å®ƒä»¬å­˜å‚¨çš„å€¼æ˜¯ç›¸åŒçš„</strong>ï¼Œéƒ½å­˜å‚¨äº†é“¾è¡¨å¤´èŠ‚ç‚¹çš„åœ°å€ï¼ˆæ¯”å¦‚è¯´åœ°å€ <code>3</code>ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æ— è®ºæ˜¯ <code>L</code> è¿˜æ˜¯å‰¯æœ¬ <code>L</code>ï¼Œå®ƒä»¬æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹</strong>ï¼Œè¿™æ˜¯é“¾è¡¨å¤´èŠ‚ç‚¹çš„åœ°å€ã€‚</li></ul><h3 id="2-L-next-æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æˆå‘˜ï¼š"><a href="#2-L-next-æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æˆå‘˜ï¼š" class="headerlink" title="2. L-&gt;next æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æˆå‘˜ï¼š"></a>2. <strong><code>L-&gt;next</code> æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æˆå‘˜</strong>ï¼š</h3><ul><li><code>L-&gt;next</code> å­˜å‚¨çš„æ˜¯é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ã€‚è¿™ä¸ªæˆå‘˜å±äºé“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ— è®ºä½ æ˜¯é€šè¿‡åŸå§‹çš„ <code>L</code> è¿˜æ˜¯å‰¯æœ¬ <code>L</code> æ¥è®¿é—® <code>L-&gt;next</code>ï¼Œä½ ä¿®æ”¹çš„éƒ½æ˜¯åŒä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹çš„ <code>next</code> æˆå‘˜ã€‚</li></ul><h3 id="3-ä¿®æ”¹-L-next-ä¼šå½±å“åŸå§‹-L-ï¼š"><a href="#3-ä¿®æ”¹-L-next-ä¼šå½±å“åŸå§‹-L-ï¼š" class="headerlink" title="3. **ä¿®æ”¹ L-&gt;next ä¼šå½±å“åŸå§‹ L**ï¼š"></a>3. **ä¿®æ”¹ <code>L-&gt;next</code> ä¼šå½±å“åŸå§‹ <code>L</code>**ï¼š</h3><ul><li>å› ä¸º <code>L</code> å’Œå‰¯æœ¬ <code>L</code> éƒ½æŒ‡å‘åŒä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼ˆåŒä¸€ä¸ªå¤´èŠ‚ç‚¹ï¼‰ï¼Œæ‰€ä»¥**ä¿®æ”¹ <code>L-&gt;next</code>ï¼ˆå³ä¿®æ”¹å¤´èŠ‚ç‚¹çš„ <code>next</code> æŒ‡å‘çš„åœ°å€ï¼‰ä¼šåŒæ—¶å½±å“åŸå§‹ <code>L-&gt;next</code>**ã€‚</li><li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ é€šè¿‡å‰¯æœ¬ä¿®æ”¹ <code>L-&gt;next</code>ï¼ŒåŸå§‹çš„ <code>L</code> ä¹Ÿä¼šâ€œæ„ŸçŸ¥â€åˆ°è¿™ä¸ªå˜åŒ–çš„åŸå› ï¼Œå› ä¸ºå®ƒä»¬æŒ‡å‘çš„èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªã€‚</li></ul><h3 id="4-æ”¹å˜-L-æœ¬èº«ï¼ˆå¤´èŠ‚ç‚¹çš„åœ°å€ï¼‰éœ€è¦-ï¼š"><a href="#4-æ”¹å˜-L-æœ¬èº«ï¼ˆå¤´èŠ‚ç‚¹çš„åœ°å€ï¼‰éœ€è¦-ï¼š" class="headerlink" title="4. **æ”¹å˜ L æœ¬èº«ï¼ˆå¤´èŠ‚ç‚¹çš„åœ°å€ï¼‰éœ€è¦ &amp;**ï¼š"></a>4. **æ”¹å˜ <code>L</code> æœ¬èº«ï¼ˆå¤´èŠ‚ç‚¹çš„åœ°å€ï¼‰éœ€è¦ <code>&amp;</code>**ï¼š</h3><ul><li>å¦‚æœä½ æƒ³è¦æ”¹å˜çš„æ˜¯ <code>L</code> æœ¬èº«ï¼ˆä¹Ÿå°±æ˜¯æƒ³è®© <code>L</code> æŒ‡å‘ä¸åŒçš„åœ°å€ï¼Œæ¯”å¦‚è®© <code>L</code> ä»æŒ‡å‘å¤´èŠ‚ç‚¹å˜æˆæŒ‡å‘å…¶ä»–èŠ‚ç‚¹ï¼‰ï¼Œé‚£ä¹ˆ<strong>ä¸åŠ  <code>&amp;</code> æ˜¯ä¸è¡Œçš„</strong>ã€‚å› ä¸ºå¦‚æœä¸åŠ  <code>&amp;</code>ï¼Œä¼ é€’çš„åªæ˜¯ <code>L</code> çš„å‰¯æœ¬ï¼Œä¿®æ”¹çš„æ˜¯å‰¯æœ¬çš„å€¼ï¼Œä¸ä¼šå½±å“åŸå§‹çš„ <code>L</code>ã€‚</li><li><strong>åŠ ä¸Š <code>&amp;</code> çš„è¯</strong>ï¼Œä¼ é€’çš„å°±ç›¸å½“äº <code>L</code> çš„åœ°å€ï¼ˆå³æŒ‡é’ˆçš„æŒ‡é’ˆï¼‰ï¼Œè¿™æ ·åœ¨å‡½æ•°å†…ä¿®æ”¹ <code>L</code> æœ¬èº«ï¼ˆè®© <code>L</code> æŒ‡å‘æ–°çš„èŠ‚ç‚¹ï¼‰å°±èƒ½å½±å“åˆ°åŸå§‹çš„ <code>L</code>ã€‚</li></ul><h3 id="5-L-next-å’Œ-L-æœ¬èº«æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼š"><a href="#5-L-next-å’Œ-L-æœ¬èº«æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼š" class="headerlink" title="5. L-&gt;next å’Œ L æœ¬èº«æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼š"></a>5. <strong><code>L-&gt;next</code> å’Œ <code>L</code> æœ¬èº«æ˜¯ä¸åŒçš„ä¸œè¥¿</strong>ï¼š</h3><ul><li><code>L</code> æˆ–å‰¯æœ¬ <code>L</code> å­˜å‚¨çš„æ˜¯é“¾è¡¨å¤´èŠ‚ç‚¹çš„åœ°å€ï¼Œ<strong>è¿™ä¸ªå€¼æ˜¯é“¾è¡¨å¤´èŠ‚ç‚¹çš„åœ°å€</strong>ã€‚</li><li><code>L-&gt;next</code> å­˜å‚¨çš„æ˜¯é“¾è¡¨å¤´èŠ‚ç‚¹çš„ <code>next</code> æˆå‘˜ï¼Œè¿™ä¸ªå€¼æ˜¯é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typrdef strucrt LNode</span><br><span class="line">&#123;</span><br><span class="line">ElemType data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;*LNode,LinkList;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸ªç”¨äºé“¾è¡¨çš„ç»“æ„ä½“æŒ‡é’ˆç±»å‹å®šä¹‰</p><p>å‡½æ•°ä¸€ï¼šä¿®æ”¹ä¸€ä¸ªé“¾è¡¨ç¬¬iä¸ªå…ƒç´ ï¼ˆiï¼‰  åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œ&#x2F;<em>è¦ä¼ å…¥çš„é“¾è¡¨L</em>&#x2F; æ— éœ€åŠ &amp;ç¬¦å·ï¼Œå› ä¸ºä»–ä¸æ¶‰åŠå¯¹å¤´æŒ‡é’ˆçš„æ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Status <span class="title function_">ChangeElem</span><span class="params">(<span class="comment">/*è¦ä¼ å…¥çš„é“¾è¡¨L*/</span>,<span class="type">int</span> i,elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> *<span class="title">LNode</span> <span class="title">point</span> =</span> L;</span><br><span class="line"><span class="type">int</span> j = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(j&lt;=i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!(point = point-&gt;next))</span><br><span class="line"><span class="keyword">return</span> ERROR;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line">point -&gt; data = e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°äºŒï¼šåˆå§‹åŒ–ä¸€ä¸ªå¸¦å¤´èŠ‚ç‚¹çš„ç©ºé“¾è¡¨  è¿™ä¸ªå‡½æ•°ä¸­ï¼Œä¼ å…¥çš„å‚æ•°å°±å¿…é¡»æ˜¯&amp;Lï¼Œå› ä¸ºå®ƒæ¶‰åŠå¯¹å¤´æŒ‡é’ˆçš„æ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Status <span class="title function_">LinkInit</span><span class="params">(<span class="comment">/*è¦ä¼ å…¥çš„é“¾è¡¨L*/</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">L = ï¼ˆLNode*ï¼‰<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));</span><br><span class="line">    <span class="comment">// *L = ï¼ˆLNode*ï¼‰malloc(sizeof(LNode)); å¦‚æœä½¿ç”¨æŒ‡é’ˆçš„è¯</span></span><br><span class="line">L-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨"><a href="#æ³¨" class="headerlink" title="æ³¨"></a>æ³¨</h3><p><strong>å¦‚æœä½¿ç”¨å¼•ç”¨ç¬¦å·&amp;ï¼Œåˆ™å‡½æ•°å†…éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨Lï¼Œ</strong></p><p><strong>ä½†å¦‚æœä½¿ç”¨æŒ‡é’ˆçš„è¯ï¼Œè¦æŠŠæ‰€æœ‰Læ¢æˆ*L</strong></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
            <tag> ç»†èŠ‚è¾¨æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§è¡¨</title>
      <link href="/2024/09/18/%E7%BA%BF%E6%80%A7%E8%A1%A8/"/>
      <url>/2024/09/18/%E7%BA%BF%E6%80%A7%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="å¤ä¹ "><a href="#å¤ä¹ " class="headerlink" title="å¤ä¹ "></a>å¤ä¹ </h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/rrr.png" alt="rrr"></p><p>å„ä¸ªå¾ªç¯æ¬¡æ•°ç›¸ä¹˜ï¼Œå†…å±‚ä¸ºnï¼Œå¤–å±‚ä¸ºlog2nï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯nlog2n</p><h4 id="çº¿æ€§è¡¨çš„ç±»å‹å®šä¹‰"><a href="#çº¿æ€§è¡¨çš„ç±»å‹å®šä¹‰" class="headerlink" title="çº¿æ€§è¡¨çš„ç±»å‹å®šä¹‰"></a>çº¿æ€§è¡¨çš„ç±»å‹å®šä¹‰</h4><p>çº¿æ€§è¡¨æ˜¯nä¸ª<strong>ç±»å‹ç›¸åŒ</strong>çš„æ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ—</p><p>å­˜åœ¨å”¯ä¸€çš„ç¬¬ä¸€å…ƒç´ &#x2F;æœ€åå…ƒç´ ï¼Œé™¤ç¬¬ä¸€å…ƒç´ å¤–ï¼Œå…¶ä»–å…ƒç´ å‡æœ‰å”¯ä¸€åç»§ï¼Œé™¤æœ€åå…ƒç´ å¤–ï¼Œå…¶ä»–å…ƒç´ éƒ½æœ‰å”¯ä¸€å‰é©±</p><ul><li><p><strong>å°è®° ï¼š</strong> c++ä¸­å¼•å…¥äº†å¼•ç”¨ç±»å‹ &amp; ï¼Œç”¨æ³•æ˜¯ b &#x3D; &amp;a ï¼Œä»£è¡¨bå¼•ç”¨aï¼ŒäºŒè€…å…±ç”¨å‚¨å­˜ç©ºé—´ï¼Œåœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™ï¼Œç›´æ¥ä¼ å…¥å®å‚å³å¯ï¼Œä¸ç”¨åŠ å–åœ°å€ç¬¦</p><p>å¦‚swapï¼ˆaï¼Œbï¼‰ï¼Œä½†æ˜¯å‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œè¦æŠŠå½¢å‚å®šä¹‰ä¸ºå¼•ç”¨ç±»å‹ å¦‚ void swapï¼ˆ&amp;aï¼Œ&amp;bï¼‰ï¼Œè®©ä¼ å…¥çš„å®å‚ç›´æ¥è¢«å½¢å‚å¼•ç”¨</p></li></ul><h4 id="é¡ºåºçº¿æ€§è¡¨çš„æ’å…¥æ“ä½œç®—æ³•"><a href="#é¡ºåºçº¿æ€§è¡¨çš„æ’å…¥æ“ä½œç®—æ³•" class="headerlink" title="é¡ºåºçº¿æ€§è¡¨çš„æ’å…¥æ“ä½œç®—æ³•"></a>é¡ºåºçº¿æ€§è¡¨çš„æ’å…¥æ“ä½œç®—æ³•</h4><p>ç»™ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯sqlistç±»çº¿æ€§è¡¨åœ°å€&amp;Lï¼Œä¸€ä¸ªæ•´æ•°iä»£è¡¨è¦æ’å…¥çš„ä½ç½®ï¼Œä¸€ä¸ªç±»å‹eä»£è¡¨è¦æ’å…¥çš„æ•°æ®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">Status <span class="title function_">ListInsert</span><span class="params">(sqlist &amp;L,<span class="type">int</span> i,elementtype e)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//é¦–å…ˆè¦åˆ¤æ–­ä¸€ä¸‹ï¼Œç©ºé—´å¤Ÿä¸å¤Ÿï¼Œå½“å‰é¢å®šå®¹é‡æ˜¯L.listsizeï¼Œå·²ç”¨å®¹é‡æ˜¯L.lenth</span></span><br><span class="line"><span class="keyword">if</span>(L.lenth&gt;=L.listsize);</span><br><span class="line"><span class="comment">//åˆ†é…ä¸€ä¸ªæ–°çš„ç©ºé—´ï¼Œè¿™ä¸ªæ–°ç©ºé—´è¿å¸¦ç€æ–°åŸºå€ä¸€èµ·åˆ†é…,æ—§åŸºå€æ˜¯L.elem</span></span><br><span class="line">newbase = (elemtype*)<span class="built_in">realloc</span>(L.elem,(L.listsize+LISTINCERASEMENT)*<span class="keyword">sizeof</span>(elemtype));</span><br><span class="line"><span class="comment">//åˆ¤æ–­ä¸€ä¸‹æˆåŠŸäº†æ²¡</span></span><br><span class="line"><span class="keyword">if</span>(!newbase)</span><br><span class="line">L.elem = newbase;</span><br><span class="line">listsize +=LISTINCREASEMENT;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç°åœ¨å®¹é‡å¤Ÿç”¨äº†ï¼Œå¾€é‡Œé¢æ’å…¥</span></span><br><span class="line"><span class="comment">//é¡ºåºè¡¨å¾€é‡Œæ’å…¥ï¼Œå°±æŠŠåé¢çš„å…ƒç´ åç§»</span></span><br><span class="line"><span class="keyword">for</span>(j=L.lenth<span class="number">-1</span>; j&gt;=i<span class="number">-1</span>,--j)</span><br><span class="line">&#123;</span><br><span class="line">L.elem[j+<span class="number">1</span>]=L.elem[j]; <span class="comment">//åç§»</span></span><br><span class="line">&#125;</span><br><span class="line">L.elem[i<span class="number">-1</span>]=e;</span><br><span class="line">L.lenth++; <span class="comment">//åˆ«å¿˜äº†åŠ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆå®ç°ï¼š</span></span><br><span class="line">elemtype *q =&amp;L.elem[L.lenth<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j = L.lenth<span class="number">-1</span>; j&gt;i<span class="number">-1</span> ;--j)</span><br><span class="line">&#123;</span><br><span class="line">*(q+<span class="number">1</span>) =*q;</span><br><span class="line">q--;</span><br><span class="line">&#125;<span class="comment">//è¿™æ®µforå¾ªç¯ç›¸å½“äºå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œè®©ä»–å’ŒæŒ‡é’ˆqåŒæ—¶å˜åŒ–ï¼Œå®é™…ä¸Šå®Œå…¨å¯ä»¥æŠŠæŒ‡é’ˆqæ”¾åœ¨forå¾ªç¯è¯­å¥çš„ä¸´æ—¶åˆå§‹åŒ–é‡Œï¼Œè®©ä»–è‡ªå·±å˜åŒ–å³å¯</span></span><br><span class="line"> <span class="comment">//ä¹‹æ‰€ä»¥ç”¨jæ¥æ ‡å¿—ï¼Œä¸€ä¸ªåŸå› æ˜¯æ„Ÿè§‰æŒ‡é’ˆéš¾ä»¥æ¯”è¾ƒï¼Œå…¶å®ä¸ç„¶ï¼Œå› ä¸ºè¦æ’å…¥å…ƒç´ æ‰€ä»¥æ—©æ™šè¦ç”¨åˆ°è¢«æ’å…¥å…ƒç´ æ‰€åœ¨çš„æŒ‡é’ˆï¼Œä¸å¦‚æå‰åˆå§‹åŒ–å¥½ï¼Œç”¨å®ƒæ¥åšæ¯”è¾ƒ</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span></span><br><span class="line">elmtype *p = &amp;(L.elem[i<span class="number">-1</span>]); <span class="comment">//å…ˆæŠŠæ ‡å¿—åˆå§‹åŒ–å¥½</span></span><br><span class="line"><span class="keyword">for</span>(elemtype *q =&amp;L.elem[L.lenth<span class="number">-1</span>]; q&gt;=p;--q) <span class="comment">//qå’Œpä½œæ¯”è¾ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">*(q+<span class="number">1</span>) =*q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elmtype *p = &amp;(L.elem[i<span class="number">-1</span>]);<span class="comment">//ç®€åŒ–åæ²¡æœ‰è¿™å¥</span></span><br><span class="line">*p =e;</span><br><span class="line">++ L.lenth;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•é“¾è¡¨"><a href="#å•é“¾è¡¨" class="headerlink" title="å•é“¾è¡¨"></a>å•é“¾è¡¨</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">ElemType  data;  <span class="comment">//æ•°æ®åŸŸ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>   //æŒ‡é’ˆåŸŸ</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;<span class="title">LNode</span>,*<span class="title">LinkList</span> //<span class="title">LNode</span>æ˜¯åˆ«åï¼Œ*<span class="title">LinkList</span> æ˜¯æŒ‡å‘è¯¥ç»“æ„ä½“çš„æŒ‡é’ˆç±»å‹åˆ«å</span></span><br><span class="line"><span class="class">// <span class="title">LNode</span> <span class="title">L</span>å’Œ *<span class="title">LinkList</span> <span class="title">L</span>ä¸ç­‰ä»·ï¼Œ<span class="title">LNode</span> *<span class="title">L</span>å’Œ <span class="title">LinkList</span> <span class="title">L</span>ç­‰ä»· </span></span><br><span class="line"><span class="class">// <span class="title">typedf</span> å®šä¹‰çš„æ˜¯ç±»å‹åï¼Œä¸è¦å’Œå˜é‡æ··ä¸ºä¸€è°ˆ</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240918174751225.png" alt="image-20240918174751225"></p><ul><li>å½“ç„¶ï¼ŒL-&gt;data ä¹Ÿå¯ä»¥å†™ä¸º (*L).data</li></ul><h5 id="æ„é€ ä¸€ä¸ªç©ºçš„å¸¦å¤´ç»“ç‚¹çš„çº¿æ€§è¡¨L"><a href="#æ„é€ ä¸€ä¸ªç©ºçš„å¸¦å¤´ç»“ç‚¹çš„çº¿æ€§è¡¨L" class="headerlink" title="æ„é€ ä¸€ä¸ªç©ºçš„å¸¦å¤´ç»“ç‚¹çš„çº¿æ€§è¡¨L"></a>æ„é€ ä¸€ä¸ªç©ºçš„å¸¦å¤´ç»“ç‚¹çš„çº¿æ€§è¡¨L</h5><p>ï¼ˆåˆ‡è®°åŠ Lè¦åŠ &amp;ç¬¦å·ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ</span></span><br><span class="line">LinkList Lï¼›<span class="comment">//æ­¤æ—¶Lå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼Œå¯ä»¥è¿›è¡Œ&amp;æ“ä½œä¼ å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¼–å†™å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">linkinit</span><span class="params">(LinkList &amp;L)</span><span class="comment">//è¿™é‡Œä¹‹æ‰€ä»¥è¦åŠ &amp;ç¬¦å·ï¼Œæ˜¯å› ä¸ºè¦ä¼ å…¥æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œæ‰èƒ½ä¿®æ”¹åŸæŒ‡é’ˆ</span></span><br><span class="line">&#123;</span><br><span class="line">L = (Lnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Lnode));  </span><br><span class="line">L-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><h5 id="åŠ -ç¬¦å·çš„ç†è§£"><a href="#åŠ -ç¬¦å·çš„ç†è§£" class="headerlink" title="åŠ &amp;ç¬¦å·çš„ç†è§£"></a>åŠ &amp;ç¬¦å·çš„ç†è§£</h5></li></ul><p>å…ˆä¸è€ƒè™‘ç»“æ„ä½“ç›¸å…³çš„ä¸œè¥¿ï¼Œè€Œæ˜¯è€ƒè™‘æŒ‡é’ˆå˜é‡æœ€ç®€å•çš„æƒ…å†µï¼Œåœ¨å‡½æ•°å¤–å®šä¹‰ä¸€ä¸ªint aï¼Œè¦æƒ³æŠŠint aä¼ å…¥ç»™å‡½æ•°å¹¶ä¸”è®©å‡½æ•°èƒ½å¤Ÿæ”¹å˜ä»–ï¼Œå°±è¦ä¼ å…¥&amp;aï¼Œè¿™æ ·å‡½æ•°å†…çš„æŒ‡é’ˆå˜é‡å°±èƒ½è·Ÿå°±è¿™ä¸ªåœ°å€å¯¹ä»–ä¿®æ”¹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŠ &amp;ç¬¦å·æ˜¯ä¸ºäº†è®©å‡½æ•°å†…éƒ¨çš„æŒ‡é’ˆå˜é‡è¯»å–åˆ°ä»–çš„åœ°å€ï¼Œä»è€Œå¯¹å®ƒè¿›è¡Œä¿®æ”¹ </p><p>å¯¹äºlinklist lï¼Œè™½ç„¶å®ƒæœ¬èº«å·²ç»æ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆå˜é‡äº†ï¼Œä»–å·²ç»è¡¨ç¤ºä¸€ä¸ªåœ°å€ï¼Œä½†æ˜¯å¦‚æœç›´æ¥æŠŠä»–ä¼ è¿›å‡½æ•°ï¼Œå®é™…ä¸Šä¼ å…¥çš„æ˜¯è¿™ä¸ªåœ°å€å˜é‡çš„å‰¯æœ¬ï¼Œè™½ç„¶å½¢å‚å’Œå®å‚çš„å…·ä½“å€¼æ˜¯ä¸€æ ·çš„ï¼ˆå³læ‰€ä»£è¡¨çš„åœ°å€ï¼‰ï¼Œä½†æ˜¯åªæœ‰è¿™ä¸ªåœ°å€æ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œæ“ä½œçš„ï¼Œå› ä¸ºå¯¹äºä¸€ä¸ªç»“ç‚¹æ¥è¯´ï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆå˜é‡ï¼Œç›®çš„æ˜¯ä¸ºäº†èƒ½è®©åˆ«çš„ç»“æ„ä½“æŒ‡é’ˆå˜é‡çš„æŒ‡é’ˆåŸŸèƒ½æŒ‡å‘è‡ªå·±ï¼Œä»è€Œå¯¹è‡ªå·±è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å»æ“ä½œåˆ«çš„ç»“ç‚¹ï¼Œå› ä¸ºæŒ‡å‘åˆ«çš„èŠ‚ç‚¹ä½¿ç”¨å®ƒçš„æŒ‡é’ˆåŸŸå®Œæˆçš„ï¼Œè€Œä¸æ˜¯ç»“æ„ä½“æŒ‡é’ˆè‡ªèº«å»æŒ‡ï¼Œå› æ­¤å¦‚æœä¸åŠ &amp;ç¬¦å·ï¼Œè™½ç„¶æŒ‡å‘çš„ä¸œè¥¿æ²¡æœ‰æ”¹å˜ï¼ˆä½†è¿™å°±åƒåˆšæ‰è¯´çš„ï¼Œä»–æŒ‡å‘çš„ä¸œè¥¿æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨ä»–å†…éƒ¨çš„æŒ‡é’ˆåŸŸæ¥æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯ç”¨å®ƒè‡ªèº«ï¼‰ï¼Œä½†æ˜¯ä¼ å…¥çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡é’ˆçš„å‰¯æœ¬ï¼Œä»–æŒ‡å‘çš„ä¸œè¥¿ä¸å˜ï¼Œä½†åœ¨å‡½æ•°å¤–åˆ«çš„ä¸œè¥¿å°±æ²¡æ³•æŒ‡å‘å‰¯æœ¬äº†ï¼Œè¿™æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› æ­¤è¦åŠ &amp;ç¬¦å·ï¼Œä¼ å…¥æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œè®©æŒ‡é’ˆèƒ½æŒ‡å‘ç»“æ„ä½“æŒ‡é’ˆ</p><p>ç®€å•æ¥è¯´ï¼Œ ä¹‹æ‰€ä»¥å®šä¹‰LinkListä¸ºæŒ‡é’ˆç±»å‹ï¼Œæ˜¯ä¸ºäº†èƒ½è®©ä»–è¢«èµ‹å€¼ç»™å…¶ä»–ç»“æ„ä½“æŒ‡é’ˆå˜é‡å†…éƒ¨çš„ æŒ‡é’ˆåŸŸ ï¼Œä»è€Œè¿èµ·æ¥</p><h5 id="åˆ¤æ–­æ˜¯å¦ä¸ºç©º"><a href="#åˆ¤æ–­æ˜¯å¦ä¸ºç©º" class="headerlink" title="åˆ¤æ–­æ˜¯å¦ä¸ºç©º"></a>åˆ¤æ–­æ˜¯å¦ä¸ºç©º</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">LinkEmpty</span><span class="params">(LinkList L)</span><span class="comment">//è¿™ä¸ªåªæ˜¯è¯»å–ï¼Œä¸ç”¨ä¿®æ”¹ï¼Œæ‰€åˆ¶ä¹‹ä¼ å…¥åŸæŒ‡é’ˆå³å¯ï¼Œæ— éœ€åŠ &amp;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (L-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="æ’å…¥å…ƒç´ "><a href="#æ’å…¥å…ƒç´ " class="headerlink" title="æ’å…¥å…ƒç´ "></a>æ’å…¥å…ƒç´ </h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240919170652246.png" alt="image-20240919170652246"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LinkList sForE = (Lnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Lnode));</span><br><span class="line">sForE-&gt;data = e;</span><br><span class="line">sForE-&gt;next = pre-&gt;next;</span><br><span class="line">pre-next -&gt; sForE</span><br></pre></td></tr></table></figure><h5 id="åˆ é™¤å…ƒç´ "><a href="#åˆ é™¤å…ƒç´ " class="headerlink" title="åˆ é™¤å…ƒç´ "></a>åˆ é™¤å…ƒç´ </h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240919171428791.png" alt="image-20240919171428791"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¿…é¡»çŸ¥é“açš„åœ°å€</span></span><br><span class="line">delet = pre-&gt;next; <span class="comment">//å…ˆæŠŠè¦åˆ é™¤çš„æ ‡è®°ä¸€ä¸‹ï¼Œå¾…ä¼šfreeï¼›</span></span><br><span class="line">pre -&gt; next = delet -&gt;next;</span><br><span class="line"><span class="built_in">free</span> (delete);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="å–å¾—å…ƒç´ "><a href="#å–å¾—å…ƒç´ " class="headerlink" title="å–å¾—å…ƒç´ "></a>å–å¾—å…ƒç´ </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç»™ä¸‰ä¸ªå‚æ•°ï¼Œé“¾è¡¨L ï¼Œ å…ƒç´ ä½ç½®int i ï¼Œè¦å–çš„å…ƒçš„åœ°å€elementtype &amp;e</span></span><br><span class="line">GetElem(linkList L; <span class="type">int</span> i; ElemType *e)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//è®¾å®šä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„èŠ‚ç‚¹</span></span><br><span class="line">SearchPoint = L -&gt; next;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j&lt;=i; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(SearchPoint-&gt;next == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> ERROR;</span><br><span class="line">SearchPoint = SearchPoint -&gt; next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(SearchPoint-&gt;next == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> ERROR;</span><br><span class="line">&#125;</span><br><span class="line">*e = SearchPoint -&gt; data;</span><br><span class="line"><span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯é“¾è¡¨"><a href="#å¾ªç¯é“¾è¡¨" class="headerlink" title="å¾ªç¯é“¾è¡¨"></a>å¾ªç¯é“¾è¡¨</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240922113439208.png" alt="image-20240922113439208"></p><ul><li>å•é“¾è¡¨æœ€åä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆåŸŸæ²¡æœ‰åˆ©ç”¨ï¼Œå¦‚æœä½¿å…¶æŒ‡å‘å¤´æŒ‡é’ˆï¼ˆå¤´èŠ‚ç‚¹ï¼‰ï¼Œåˆ™é¦–å°¾æ„æˆä¸€ä¸ªé“¾è¡¨ï¼Œç§°ä½œå¾ªç¯é“¾è¡¨</li></ul><h4 id="åŒå‘é“¾è¡¨"><a href="#åŒå‘é“¾è¡¨" class="headerlink" title="åŒå‘é“¾è¡¨"></a>åŒå‘é“¾è¡¨</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240922114101755.png" alt="image-20240922114101755"></p><ul><li>ä¸€ä¸ªé“¾è¡¨çš„æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶å‰é©±èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶åç»§èŠ‚ç‚¹</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typrdef <span class="class"><span class="keyword">struct</span> <span class="title">DuLNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">elemtype data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DuLNode</span> *<span class="title">pre</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DuLNode</span> *<span class="title">next</span></span></span><br><span class="line"><span class="class">&#125;<span class="title">DuLNode</span>,*<span class="title">DuLinkList</span>;</span></span><br></pre></td></tr></table></figure><ul><li>p-&gt;pre-&gt;next  å’Œ p-&gt;next-&gt;pre éƒ½æ˜¯pè‡ªèº«</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒå‘é“¾è¡¨åœ¨iä½ç½®å‰æ’å…¥å…ƒç´ e</span></span><br><span class="line">Status <span class="title function_">LinkInsert_Dul</span><span class="params">(DuLinkList&amp;L,<span class="type">int</span> i elemtype e)</span></span><br><span class="line">&#123;</span><br><span class="line">    DuLinkList PointForE;</span><br><span class="line"><span class="keyword">if</span>(!(point=(GetElemPoint_dul(Lï¼Œi)))) <span class="comment">// GetElemPoint å’Œ GetElem ä¸ä¸€æ ·</span></span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    <span class="keyword">if</span>(!(PointForE = (DulLinkList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DulNode))));</span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">    <span class="comment">//ä¸‹é¢å¼€å§‹æ’å…¥</span></span><br><span class="line">    PointForE -&gt; next = point;</span><br><span class="line">    PointForE -&gt; pre = point -&gt; pre;</span><br><span class="line">    point -&gt; pre -&gt; next = PointForE;</span><br><span class="line">    point -&gt; pre = point;</span><br><span class="line">    PointForE -&gt; data = e;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒå‘é“¾è¡¨åˆ é™¤ä½ç½®içš„å…ƒç´ </span></span><br><span class="line">Status <span class="title function_">LinkDelete_Dul</span><span class="params">(DuLinkList&amp;L,<span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(!(p=(GetElemPoint_dul(Lï¼Œi))))</span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    p-&gt;pre-&gt;next = p-&gt;next;</span><br><span class="line">    p-&gt;next-&gt;pre = p-&gt;pre;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä¸€å…ƒå¤šé¡¹å¼"><a href="#ä¸€å…ƒå¤šé¡¹å¼" class="headerlink" title="ä¸€å…ƒå¤šé¡¹å¼"></a>ä¸€å…ƒå¤šé¡¹å¼</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//struct</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ploy</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">float</span> factor;</span><br><span class="line">    <span class="type">int</span> power;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ploy</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;ploy,*ployPoint;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–ç•¥ï¼Œä¸‹é¢è®¡ç®—</span></span><br><span class="line">    Status <span class="title function_">PloyAdd</span> <span class="params">(ployPoint *a1, ployPoint *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//è®¡ç®—è¿‡ç¨‹ï¼šå¹‚æ¬¡ä»å°åˆ°å¤§ï¼Œç³»æ•°ç›¸åŠ ï¼Œå¦‚æœå¾—0åˆ™å»æ‰è¿™ä¸€é¡¹</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> a1_Maxpower = getMaxPower(a1);</span><br><span class="line">    <span class="type">int</span> a2_Maxpower = getMaxPower(a2);   </span><br><span class="line">    <span class="type">int</span> a3_Power = Max(a1,a2);<span class="comment">//å®šä¹‰ä¸€ä¸ªå–å¤§çš„å€¼çš„å‡½æ•°</span></span><br><span class="line">    a1 = a1 -&gt;next;</span><br><span class="line">    a2 = a2 -&gt;next;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;=a3_power;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a2-&gt;power==a1-&gt;power)</span><br><span class="line">        &#123;</span><br><span class="line">            a3-&gt;power = a1 -&gt; power;</span><br><span class="line">            a3-&gt;factor = a1-&gt;factor + a2-&gt;factor;</span><br><span class="line">            a1 = a1-&gt;next;</span><br><span class="line">            a2 = a2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a2-&gt;power&lt;a1-&gt;power)</span><br><span class="line">        &#123;</span><br><span class="line">            a3-&gt;power = a2 -&gt; power;</span><br><span class="line">            a3-&gt;factor = a2 -&gt; power;</span><br><span class="line">            a2 = a2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            a3 -&gt; power = a1 -&gt; power;</span><br><span class="line">            a3 -&gt; factor = a1 -&gt; factor;</span><br><span class="line">            a1 = a1-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        a3 = a3-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘å’ŒäºŒå‰æ ‘</title>
      <link href="/2024/09/18/%E6%A0%91%E5%92%8C%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
      <url>/2024/09/18/%E6%A0%91%E5%92%8C%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h3 id="äºŒå‰æ ‘çš„æ€§è´¨"><a href="#äºŒå‰æ ‘çš„æ€§è´¨" class="headerlink" title="äºŒå‰æ ‘çš„æ€§è´¨"></a>äºŒå‰æ ‘çš„æ€§è´¨</h3><ul><li><p><strong>n &#x3D; n0 + n1 +n2</strong></p></li><li><p><strong>n0 &#x3D; n2 +1</strong></p></li><li><p><strong>n-1 &#x3D; n1 + 2*n2</strong>ï¼ˆæ€»åº¦æ•°ä¸ºn-1ï¼‰</p></li><li><p>æ»¡äºŒå‰æ ‘ï¼š æ»¡çš„</p></li><li><p>å®Œå…¨äºŒå‰æ ‘ï¼šç°æœ‰çš„èŠ‚ç‚¹ç¼–å·å’Œæ»¡äºŒå‰æ ‘çš„ä¸€è‡´</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240923141022960.png" alt="image-20240923141022960"></p></li><li><p>å…·æœ‰nä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ä¸º<img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240923141344836.png" alt="image-20240923141344836"></p></li><li><p>å·²çŸ¥ç¼–å·i,æ±‚åŒäº²çš„ç¼–å·ï¼Ÿï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼‰</p></li></ul><p>â€‹<strong>i&#x2F;2 å‘ä¸‹å–æ•´</strong></p><ul><li><p>å·²çŸ¥ç¼–å·iï¼Œå·¦å­©å­çš„èŠ‚ç‚¹æ˜¯2iï¼Œå³å­©å­æ˜¯2i+1</p><h3 id="äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„"><a href="#äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„" class="headerlink" title="äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„"></a>äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„</h3><h4 id="é¡ºåºå­˜å‚¨ç»“æ„"><a href="#é¡ºåºå­˜å‚¨ç»“æ„" class="headerlink" title="é¡ºåºå­˜å‚¨ç»“æ„"></a>é¡ºåºå­˜å‚¨ç»“æ„</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126200632995.png" alt="image-20241126200632995"></p><h4 id="é“¾å¼å­˜å‚¨ç»“æ„"><a href="#é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="é“¾å¼å­˜å‚¨ç»“æ„"></a>é“¾å¼å­˜å‚¨ç»“æ„</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126200733448.png" alt="image-20241126200733448"></p><h6 id="nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘é“¾å¼å­˜å‚¨ä¸­ï¼Œå…±æœ‰n-1ä¸ªç©ºæŒ‡é’ˆåŸŸ"><a href="#nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘é“¾å¼å­˜å‚¨ä¸­ï¼Œå…±æœ‰n-1ä¸ªç©ºæŒ‡é’ˆåŸŸ" class="headerlink" title="nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘é“¾å¼å­˜å‚¨ä¸­ï¼Œå…±æœ‰n+1ä¸ªç©ºæŒ‡é’ˆåŸŸ"></a><strong>nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘é“¾å¼å­˜å‚¨ä¸­ï¼Œå…±æœ‰n+1ä¸ªç©ºæŒ‡é’ˆåŸŸ</strong></h6><p>è¯æ˜ï¼šnä¸ªç»“ç‚¹çš„äºŒå‰æ ‘ï¼Œé™¤äº†æ ¹èŠ‚ç‚¹ä»¥å¤–ï¼Œå…¶ä½™çš„ç»“ç‚¹éƒ½æœ‰ä¸Šä¸€ä¸ªåŒäº²ç»“ç‚¹æŒ‡æ¥çš„æŒ‡é’ˆï¼Œå› æ­¤ä¸€å…±æœ‰n-1ä¸ªæŒ‡é’ˆåŸŸè¢«åˆ©ç”¨ï¼Œæ‰€ä»¥å‰©ä¸‹äº†n+1ä¸ªæŒ‡é’ˆåŸŸä¸ºç©º</p><h6 id="äºŒå‰é“¾è¡¨ç¼ºç‚¹ï¼šå¾ˆéš¾æ‰¾åˆ°åŒäº²ç»“ç‚¹"><a href="#äºŒå‰é“¾è¡¨ç¼ºç‚¹ï¼šå¾ˆéš¾æ‰¾åˆ°åŒäº²ç»“ç‚¹" class="headerlink" title="äºŒå‰é“¾è¡¨ç¼ºç‚¹ï¼šå¾ˆéš¾æ‰¾åˆ°åŒäº²ç»“ç‚¹"></a>äºŒå‰é“¾è¡¨ç¼ºç‚¹ï¼šå¾ˆéš¾æ‰¾åˆ°åŒäº²ç»“ç‚¹</h6><h5 id="å¸¦åŒäº²æŒ‡é’ˆçš„äºŒå‰é“¾è¡¨ï¼ˆä¸‰å‰é“¾è¡¨ï¼‰"><a href="#å¸¦åŒäº²æŒ‡é’ˆçš„äºŒå‰é“¾è¡¨ï¼ˆä¸‰å‰é“¾è¡¨ï¼‰" class="headerlink" title="å¸¦åŒäº²æŒ‡é’ˆçš„äºŒå‰é“¾è¡¨ï¼ˆä¸‰å‰é“¾è¡¨ï¼‰"></a>å¸¦åŒäº²æŒ‡é’ˆçš„äºŒå‰é“¾è¡¨ï¼ˆä¸‰å‰é“¾è¡¨ï¼‰</h5><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126202059907.png" alt="image-20241126202059907"></p><h3 id="éå†äºŒå‰æ ‘"><a href="#éå†äºŒå‰æ ‘" class="headerlink" title="éå†äºŒå‰æ ‘"></a>éå†äºŒå‰æ ‘</h3><h4 id="éå†çš„é€’å½’ç®—æ³•"><a href="#éå†çš„é€’å½’ç®—æ³•" class="headerlink" title="éå†çš„é€’å½’ç®—æ³•"></a>éå†çš„é€’å½’ç®—æ³•</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126203450680.png" alt="image-20241126203450680"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126203459533.png" alt="image-20241126203459533"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126203509644.png" alt="image-20241126203509644"></p><h4 id="éå†çš„éé€’å½’ç®—æ³•"><a href="#éå†çš„éé€’å½’ç®—æ³•" class="headerlink" title="éå†çš„éé€’å½’ç®—æ³•"></a>éå†çš„éé€’å½’ç®—æ³•</h4><h5 id="å…ˆåºéå†"><a href="#å…ˆåºéå†" class="headerlink" title="å…ˆåºéå†"></a>å…ˆåºéå†</h5><p>å…ˆåºéå†ï¼šç›¸å½“äºç¬¬ä¸€æ¬¡é‡åˆ°å…ƒç´ å°±ç›´æ¥éå†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">PreOrder</span><span class="params">(BiTNode *root)</span></span><br><span class="line">&#123;</span><br><span class="line">    BiTNode *p,*node[MAX]; <span class="comment">//pç”¨æ¥æ›´æ–°å½“å‰æŒ‡å‘çš„ç»“ç‚¹  node[]ç”¨æ¥å½“æ ˆ</span></span><br><span class="line"><span class="type">int</span> top = <span class="number">0</span>;</span><br><span class="line">    p = root;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(p!=<span class="literal">NULL</span>) <span class="comment">//ä¸€ç›´æ»‘åˆ°æœ€å·¦è¾¹</span></span><br><span class="line">        &#123;</span><br><span class="line">            visit(p-&gt;data);<span class="comment">//ç›´æ¥å¼€å§‹éå†</span></span><br><span class="line">            node[top] = p; <span class="comment">//å…¥æ ˆ</span></span><br><span class="line">            top ++;</span><br><span class="line">            p = p-&gt;lch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(top&gt;<span class="number">0</span>) <span class="comment">//æ—¢ç„¶æ»‘åˆ°äº†æœ€å·¦è¾¹ï¼Œé‚£è¯´æ˜ä¹‹å‰æ»‘è¿‡å»çš„å·²ç»éå†å®Œäº†ï¼Œç›´æ¥å›é€€æœ€åä¸€æ¬¡çš„nullï¼Œç„¶åæŒ‡å‘æœ€å·¦è¾¹èŠ‚ç‚¹çš„å³å­©å­</span></span><br><span class="line">        &#123;</span><br><span class="line">            top --;</span><br><span class="line">            p = node[top];</span><br><span class="line">            p = p-&gt;rch;</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;<span class="keyword">while</span>(!(top == <span class="number">0</span> &amp;&amp; p==<span class="literal">NULL</span>)) <span class="comment">//åªæœ‰å½“æ ˆä¸ºç©ºï¼Œä¸”pæŒ‡å‘nullçš„æ—¶å€™ï¼Œæ‰æ ‡å¿—ç€éå†ç»“æŸ</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä¸­åºéå†"><a href="#ä¸­åºéå†" class="headerlink" title="ä¸­åºéå†"></a>ä¸­åºéå†</h5><p>ä¸­åºéå†ï¼šç›¸å½“äºç¬¬äºŒæ¬¡é‡åˆ°å…ƒç´ çš„æ—¶å€™æ‰§è¡Œæ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">MidOrder</span><span class="params">(BiTNode *root)</span></span><br><span class="line">&#123;</span><br><span class="line">BiTNode *p,*node[MAX]; <span class="comment">//pç”¨æ¥æ›´æ–°å½“å‰æŒ‡å‘çš„ç»“ç‚¹  node[]ç”¨æ¥å½“æ ˆ </span></span><br><span class="line"><span class="type">int</span> top = <span class="number">0</span>;</span><br><span class="line">    p = root;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(p!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            node[top] = p;</span><br><span class="line">            top++;</span><br><span class="line">            p = p-&gt;lch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(top&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            top--;</span><br><span class="line">            p = node[top];</span><br><span class="line">            visit(p-&gt;data);</span><br><span class="line">            p = node[top]-&gt;rch;</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;<span class="keyword">while</span>(!(top==<span class="number">0</span> &amp;&amp; p==<span class="literal">NULL</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ååºéå†"><a href="#ååºéå†" class="headerlink" title="ååºéå†"></a>ååºéå†</h5><p>ååºéå†ï¼šç›¸å½“äºç¬¬ä¸‰æ¬¡ç¢°åˆ°å…ƒç´ çš„æ—¶å€™è¿›è¡Œæ“ä½œ</p></li></ul><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><h4 id="1-è®¡ç®—èŠ‚ç‚¹ä¸ªæ•°"><a href="#1-è®¡ç®—èŠ‚ç‚¹ä¸ªæ•°" class="headerlink" title="1.è®¡ç®—èŠ‚ç‚¹ä¸ªæ•°"></a>1.è®¡ç®—èŠ‚ç‚¹ä¸ªæ•°</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127003226931.png" alt="image-20241127003226931"></p><ul><li>äºŒå‰æ ‘nbçš„åœ°æ–¹ï¼Œå°±åœ¨äºå®ƒçš„ç»“æ„ï¼Œå®¹æ˜“å®ç°é€’å½’</li><li>å› æ­¤ï¼Œå¯ç›´æ¥è®¾ç½®é€’å½’ï¼š</li><li>å¦‚æœf(b) &#x3D;&#x3D; NULL,é‚£f(b) &#x3D; 0;(é€’å½’ç»ˆæ­¢æ¡ä»¶)</li><li>å¦‚æœf(b)!&#x3D;NULL,é‚£f(b) &#x3D; f(b-&gt;lch)+f(b-&gt;rch)</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">compute_node</span><span class="params">(BitTree *node)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(node-&gt;data == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> count = compute_node(node-&gt;lch)+compute_node(node-&gt;rch);</span><br><span class="line"><span class="keyword">return</span> count +<span class="number">1</span>;<span class="comment">//åˆ«å¿˜äº†æŠŠè‡ªå·±åŠ ä¸Š</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-è®¡ç®—å¶å­èŠ‚ç‚¹ä¸ªæ•°"><a href="#2-è®¡ç®—å¶å­èŠ‚ç‚¹ä¸ªæ•°" class="headerlink" title="2.è®¡ç®—å¶å­èŠ‚ç‚¹ä¸ªæ•°"></a>2.è®¡ç®—å¶å­èŠ‚ç‚¹ä¸ªæ•°</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127003904677.png" alt="image-20241127003904677"></p><ul><li>åŒä¸Šä¸€é¢˜ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯æ”¹æ”¹è¿”å›æ—¶çš„æ¡ä»¶</li><li>åªæœ‰å½“ä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå†æŠŠå®ƒç®—æ•°</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">compute_yezi</span><span class="params">(BiTree *node)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="comment">//æ”¾åœ¨æœ€å‰é¢åˆ¤æ–­ï¼Œé˜²æ­¢ç©ºæŒ‡é’ˆäº§ç”Ÿé”™è¯¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(node-&gt;lch || node-&gt;rch)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (compute_yezi(node-&gt;lch) + compute_yezi(node-&gt;rch));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-å¤åˆ¶äºŒå‰æ ‘"><a href="#3-å¤åˆ¶äºŒå‰æ ‘" class="headerlink" title="3.å¤åˆ¶äºŒå‰æ ‘"></a>3.å¤åˆ¶äºŒå‰æ ‘</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127004644915.png" alt="image-20241127004644915"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">copy_tree</span><span class="params">(BiTree *backup,BiTree *copy)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(backup == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        copy == <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        copy = (BTNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BTNode)); <span class="comment">//åˆ†é…å†…å­˜ç©ºé—´</span></span><br><span class="line">        copy-&gt;data = back_up-&gt;data;</span><br><span class="line">        copy_tree(backup-&gt;lch,copy-&gt;lch);</span><br><span class="line">        copy_tree(backup-&gt;rch,copy-&gt;rch);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-äº¤æ¢å·¦å³å­æ ‘"><a href="#4-äº¤æ¢å·¦å³å­æ ‘" class="headerlink" title="4.äº¤æ¢å·¦å³å­æ ‘"></a>4.äº¤æ¢å·¦å³å­æ ‘</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127082721170.png" alt="image-20241127082721170"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">change</span><span class="params">(BiTree *backup,BiTree *change)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        change = (BTNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BTNode));</span><br><span class="line">        change-&gt;data = back_up-&gt;data;</span><br><span class="line">        <span class="comment">//======ä¸‹é¢çš„ä¸å¤åˆ¶ä¸åŒï¼Œæ˜¯åçš„====</span></span><br><span class="line">        change(backup-&gt;lch,change-&gt;rch);</span><br><span class="line">        change(backup-&gt;rch,change-&gt;lch);</span><br><span class="line"><span class="comment">//==============================</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-æ„å»ºäºŒå‰æ ‘"><a href="#5-æ„å»ºäºŒå‰æ ‘" class="headerlink" title="5.æ„å»ºäºŒå‰æ ‘"></a>5.æ„å»ºäºŒå‰æ ‘</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127084354935.png" alt="image-20241127084354935"></p><ul><li>éé€’å½’æ±‚è§£çš„è¯ï¼Œå°±è¦ç”¨åˆ°æ ˆ</li><li>é€’å½’æ±‚è§£æ¯”è¾ƒç®€æ´</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">creat_tree</span><span class="params">(BiTree *node,<span class="type">char</span>*s)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="built_in">strlen</span>(s))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            node = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            node = (BiTNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BiTNode));</span><br><span class="line">            node-&gt;data = s[i];</span><br><span class="line">            creat_tree(node-&gt;lch);</span><br><span class="line">            creat_tree(node-&gt;rch);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-æ±‚äºŒå‰æ ‘é«˜åº¦"><a href="#6-æ±‚äºŒå‰æ ‘é«˜åº¦" class="headerlink" title="6.æ±‚äºŒå‰æ ‘é«˜åº¦"></a>6.æ±‚äºŒå‰æ ‘é«˜åº¦</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127090727823.png" alt="image-20241127090727823"></p><ul><li><p>åˆ«ä»€ä¹ˆéƒ½æƒ³æ‰¯åˆ°éå†ä¸Šï¼Œè¦æœ‰é€’å½’çš„â€œåˆ†æ²»æ€æƒ³â€</p></li><li><p>äºŒå‰æ ‘çš„é«˜åº¦ï¼Œå°±æ˜¯å·¦å­æ ‘å’Œå³å­æ ‘ä¸­ï¼Œæ›´é«˜çš„é‚£ä¸€æ”¯çš„é«˜åº¦åŠ ä¸€ï¼Œå¯ä»¥ç”¨é€’å½’æ±‚è§£</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">height</span><span class="params">(BiTree t)</span> <span class="comment">//å› ä¸ºä¸éœ€è¦åšä¿®æ”¹ï¼Œæ‰€ä»¥ç›´æ¥ä¼ å‚å³å¯</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(t == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="type">int</span> h1 = height(t.lch);</span><br><span class="line">    <span class="type">int</span> h2 = height(t.rch); </span><br><span class="line">        <span class="keyword">return</span> max(h1,h2);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-åˆ é™¤äºŒå‰æ ‘"><a href="#7-åˆ é™¤äºŒå‰æ ‘" class="headerlink" title="7.åˆ é™¤äºŒå‰æ ‘"></a>7.åˆ é™¤äºŒå‰æ ‘</h4><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241127091633041.png" alt="image-20241127091633041"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">destory</span><span class="params">(BitTree *t)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(t != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">destory(t-&gt;lch);</span><br><span class="line">destory(t-&gt;rch);</span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åªèƒ½ä½¿ç”¨ç±»ååºéå†çš„æ–¹æ³•ï¼Œå› ä¸ºèŠ‚ç‚¹ä¿¡æ¯å¿…é¡»æœ€ååˆ é™¤ï¼Œä¸ç„¶ä¿¡æ¯ä¼šä¸¢å¤±</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°ç»„å¹¿ä¹‰è¡¨</title>
      <link href="/2024/09/18/%E6%95%B0%E7%BB%84%E5%B9%BF%E4%B9%89%E8%A1%A8/"/>
      <url>/2024/09/18/%E6%95%B0%E7%BB%84%E5%B9%BF%E4%B9%89%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//äºŒç»´æ•°ç»„A[b1][b2]ä¸­å…ƒç´ Aijçš„èµ·å§‹åœ°å€ä¸ºï¼š</span><br><span class="line">LOC[i,j]=LOC[0,0]+(b2*i+j) ï‚´ L</span><br><span class="line">//ä¸‰ç»´æ•°ç»„A[b1][b2][b3]ä¸­æ•°æ®å…ƒç´ A[i][j][k]çš„èµ·å§‹åœ°</span><br><span class="line">å€ä¸ºï¼š</span><br><span class="line">LOC[i,j,k]=LOC[0,0,0]+(b2*b3*i+b3*j+k)*L</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="çŸ©é˜µçš„å‹ç¼©å­˜å‚¨"><a href="#çŸ©é˜µçš„å‹ç¼©å­˜å‚¨" class="headerlink" title="çŸ©é˜µçš„å‹ç¼©å­˜å‚¨"></a>çŸ©é˜µçš„å‹ç¼©å­˜å‚¨</h2><h3 id="ç‰¹æ®ŠçŸ©é˜µ"><a href="#ç‰¹æ®ŠçŸ©é˜µ" class="headerlink" title="ç‰¹æ®ŠçŸ©é˜µ"></a>ç‰¹æ®ŠçŸ©é˜µ</h3><p><strong>ä¸Šä¸‹ä¸‰è§’çŸ©é˜µï¼šåˆ©ç”¨çŸ©é˜µçš„ç‰¹æ®Šç»“æ„è¿›è¡Œé™ç»´å­˜å‚¨</strong><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125200614453.png" alt="image-20241125200614453"></p><p><strong>å¯¹ç§°çŸ©é˜µï¼šå­˜åœ¨é™ç»´çš„ä¸‹ä¸‰è§’çŸ©é˜µé‡Œï¼Œç„¶åå¯¹ç§°æ˜ å°„</strong></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125201459375.png" alt="image-20241125201459375"></p><h3 id="ç¨€ç–çŸ©é˜µ"><a href="#ç¨€ç–çŸ©é˜µ" class="headerlink" title="ç¨€ç–çŸ©é˜µ"></a>ç¨€ç–çŸ©é˜µ</h3><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241125202133776.png" alt="image-20241125202133776"></p><p>ä¸‰å…ƒç»„è¡¨ç¤ºï¼šåªå­˜å‚¨éé›¶å…ƒç´ çš„ <strong>è¡Œ åˆ— å€¼</strong></p><p>ä»£ç å®ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 12500</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> i,j; <span class="comment">//row and column</span></span><br><span class="line">    ElementType e; <span class="comment">//value</span></span><br><span class="line">&#125;Triple_node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Tripe_node [MAXSIZE+<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> mu ,nu ,tu;</span><br><span class="line">&#125;TSMatrix;</span><br><span class="line"></span><br><span class="line">TSMartix M;</span><br></pre></td></tr></table></figure><h3 id="çŸ©é˜µçš„å‹ç¼©å­˜å‚¨-1"><a href="#çŸ©é˜µçš„å‹ç¼©å­˜å‚¨-1" class="headerlink" title="çŸ©é˜µçš„å‹ç¼©å­˜å‚¨"></a>çŸ©é˜µçš„å‹ç¼©å­˜å‚¨</h3><h3 id="ä¸‰å…ƒç»„çš„è½¬ç½®"><a href="#ä¸‰å…ƒç»„çš„è½¬ç½®" class="headerlink" title="ä¸‰å…ƒç»„çš„è½¬ç½®"></a>ä¸‰å…ƒç»„çš„è½¬ç½®</h3><p>æ™®é€šæ–¹æ³•ï¼šæœ€åä¸€åˆ—ä»£è¡¨å…ƒç´ çš„å€¼ï¼Œä¸å˜â€”â€”&gt;å‰ä¸¤åˆ—è½¬è¿‡æ¥â€”â€”&gt;è¿›è¡Œæ’åºï¼Œä»¥è¡Œä¸ºåŸºå‡†</p><p><strong>ä¸€æ­¥å®ç°ï¼šç›´æ¥å¯¹ç¬¬äºŒåˆ—è¿›è¡Œæ‰«æï¼Œä»å°åˆ°å¤§è¿›è¡Œè½¬ç½®å¹¶æ”¾åˆ°æ–°çš„ä¸‰å…ƒç»„</strong></p><p>â€‹é«˜å¤æ‚åº¦ï¼šæ¯æ¬¡éƒ½å¯¹ç¬¬äºŒåˆ—è¿›è¡Œæ‰«æï¼Œé€‰å‡ºå½“å‰æ•°å€¼æœ€å°çš„ï¼ˆæ—¶é—´å¤æ‚åº¦ nu*tuï¼‰</p><p>â€‹<strong>ä½å¤æ‚åº¦ï¼šåªæ‰«æä¸€éç¬¬äºŒåˆ—ï¼Œè®°å½•è½¬ç½®ä¹‹åæ¯ä¸€è¡Œæœ‰å‡ ä¸ªå…ƒç´ ï¼Œç„¶åè®¡ç®—å‡ºè½¬ç½®ä¹‹åæ¯è¡Œå¼€å§‹å­˜çš„çš„é¦–åœ°å€</strong></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240918102538589.png" alt="image-20240918102538589"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240918104202569.png"></p><h2 id="å¹¿ä¹‰è¡¨"><a href="#å¹¿ä¹‰è¡¨" class="headerlink" title="å¹¿ä¹‰è¡¨"></a>å¹¿ä¹‰è¡¨</h2><p>è¡¨å¤´ï¼šç¬¬ä¸€ä¸ªå…ƒç´ </p><p>è¡¨å°¾ï¼šé™¤äº†è¡¨å¤´ä»¥å¤–å…¶ä»–å…ƒç´ ç»„æˆçš„è¡¨</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126173845577.png" alt="image-20241126173845577"></p><p>å› æ­¤ï¼Œgethead å–å‡ºçš„æ˜¯å…ƒç´ ï¼ˆä½¿ç”¨åæœ€å¤–ä¸€å±‚æ‹¬å·å·²ç»å»æ‰ï¼‰ï¼Œgettail å–å‡ºçš„æ˜¯å¹¿ä¹‰è¡¨ï¼ˆä½¿ç”¨åæ‹¬å·å±‚æ•°ä¸å˜ï¼‰</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog-img/image-20240918105333031.png" alt="v"></p><h3 id="å¹¿ä¹‰è¡¨çš„ç‰¹ç‚¹"><a href="#å¹¿ä¹‰è¡¨çš„ç‰¹ç‚¹" class="headerlink" title="å¹¿ä¹‰è¡¨çš„ç‰¹ç‚¹"></a>å¹¿ä¹‰è¡¨çš„ç‰¹ç‚¹</h3><p>â‘  å¹¿ä¹‰è¡¨ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯åŸå­ä¹Ÿå¯ä»¥æ˜¯å­è¡¨ï¼Œå¹¿ä¹‰è¡¨æ˜¯ä¸€ä¸ªå¤šå±‚æ¬¡ç»“æ„</p><p>â‘¡ å¹¿ä¹‰è¡¨æ˜¯å¯ä»¥å…±äº«çš„ã€‚å¦‚å¹¿ä¹‰è¡¨Bæ˜¯Dçš„å­è¡¨</p><p>â‘¢ å¹¿ä¹‰è¡¨å…è®¸é€’å½’ï¼Œå¦‚å¹¿ä¹‰è¡¨Eæ˜¯ä¸€ä¸ªé€’å½’è¡¨ </p><p>â‘£ å¹¿ä¹‰è¡¨çš„å…ƒç´ é—´å­˜åœ¨æ¬¡åºå…³ç³»å’Œå±‚æ¬¡å…³ç³»ï¼Œå¹¿ä¹‰è¡¨å±•å¼€ååŒ…å«çš„ æ‹¬å·å±‚æ•°ç§°ä¸ºå¹¿ä¹‰è¡¨çš„æ·±åº¦ã€‚å¦‚Cçš„æ·±åº¦ä¸º2ï¼ŒEçš„æ·±åº¦ä¸º infinity</p><h3 id="å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„"><a href="#å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„" class="headerlink" title="å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„"></a>å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„</h3><ol><li>å¤´å°¾æŒ‡é’ˆç»“ç‚¹ç»“æ„</li></ol><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126174218547.png" alt="image-20241126174218547"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126191603999.png" alt="image-20241126191603999"></p><p>2. </p><p>æ‰©å±•å¤´å°¾æŒ‡é’ˆç»“ç‚¹ç»“æ„</p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126191817080.png" alt="image-20241126191817080"></p><p><img src="https://raw.githubusercontent.com/TheRiddler-EdwardNygma/imgupload/main/blog_imgimage-20241126191826122.png" alt="image-20241126191826122"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
